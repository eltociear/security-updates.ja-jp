---
TOCTitle: 'MS01-013'
Title: 'マイクロソフト セキュリティ情報 MS01-013 - 緊急'
ms:assetid: 'ms01-013'
ms:contentKeyID: 61228354
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms01-013(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS01-013 - 緊急
===============================================

Windows 2000 イベント ビューアが問題のあるバッファを含む
--------------------------------------------------------

公開日: 2001年2月27日 | 最終更新日: 2001年11月26日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**  
Microsoft® Windows® 2000 のイベント ビューアを使用しているユーザー、特にシステム管理者

**脆弱性の影響** **:**  
攻撃者の選択したコードが実行される

**推奨する対応策** **:**  
システム管理者は全ての重要なサーバーにこの更新プログラムをインストールして下さい。また、Windows 2000 システムへの更新プログラムのインストールを考慮して下さい。

**影響を受けるソフトウェアのバージョン** **:**  

-   Microsoft Windows 2000 Professional
-   Microsoft Windows 2000 Server
-   Microsoft Windows 2000 Advanced Server
-   Microsoft Windows 2000 Datacenter Server

### 詳細

問題
----

**技術的な説明** **:**  
Windows 2000 のイベント ビューア スナップインはイベント レコードの詳細を表示するコードのセクション内に問題のあるバッファを含んでいます。イベント ビューアがフィールドの 1 つに改ざんされたデータを含むイベント レコードを表示しようとすると、次のいずれかの結果が生じます。まず、イベント ビューアが異常終了します。さらに深刻な場合は、バッファ オーバーランにより攻撃者の選択したコードが実行されます。

仕様により、特権を持たないプロセスがシステムとアプリケーション ログでイベントのログをとります。特権を持たないユーザーが対話的にログオンすると、それらを表示することができます。しかし、特権的のあるプロセスだけがセキュリティ ログでイベントのログをとることができ、対話的にログオンした管理者だけがそれらを表示できます。攻撃者の選択によるコードを実行するためにこの脆弱性が利用される場合、該当するレコードを表示しているユーザーのセキュリティ コンテキスト内でそのコードが実行されます。

**脆弱性を緩和する要素** **:**  

-   単にログ内のイベントの一覧を詳細に調べるだけではこの脆弱性を利用することはできません。ユーザーが該当するレコードを開き、イベントの詳細を表示する場合のみこの脆弱性が利用されます。
-   一般的にイベント ビューアは管理ツールであると考えられていますが、特定のイベント レコードを開くユーザーが特権を持っているという保証はありません。特権を持たないユーザーはシステムとアプリケーション ログを読み取ることができます。特権を持つユーザーだけがセキュリティ ログを読み取ることができますが、それに書き込みができるのは特権を持つプロセスだけです。
-   我々の知る限りでは、Windows 2000 サービスの通常の監査機能を操作してこの脆弱性を利用するイベント レコードを作成することはできません。このようなレコードを作成するためには、特殊なコードを作成し、実行する必要があります。
-   ファイアウォールによる防御やその他の対策が講じられている場合、認証されたユーザーだけがネットワーク マシンにアクセス権を持ち、イベント ログ レコードに書き込みができます。

**脆弱性識別番号** **:**
[CAN-2001-0147](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0147)

よく寄せられる質問
------------------

**どのようなことが起こる可能性がありますか?**

これは[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者がマシンのイベント ログに特に不正なレコードを入力することによって、そのレコードを開いた際に次の ２ つのどちらの事象が発生する可能性があります。まず、イベント ビューアが異常終了する可能性があります。より深刻な場合では、イベント ビューアの機能が動作中に変更され、他のユーザーのマシン上で攻撃者が選択したタスクが実行される恐れがあります。

この脆弱性に関する最も重要な緩和要因は、攻撃者は攻撃したいマシンへ認証を行う必要があるということです。つまり、適切に設定されたシステム上ではインターネット ユーザーなどの部外者がこの脆弱性を利用する可能性は低いと言えます。

**何が原因で起こりますか?**

Windows 2000 のイベント ビューアには問題のあるバッファが含まれています。イベント ビューアが不正のレコードを含むイベント ログ レコードを表示した場合、バッファがオーバーランし、最悪の場合、他のユーザーが選択したコードがマシン上で実行される可能性があります。

**イベント ビューアとは何ですか?**

イベント ビューアは、Windows NT® 及び Windows 2000 の[イベント ログ](http://technet.microsoft.com/ja-jp/library/cc163042.aspx)を表示するのに使用するツールです。アプリケーション エラー、システム警告、セキュリティ上重要なオペレーションなどのイベントが発生した際、イベント ログ システムは、アプリケーション ログ、システム ログ、セキュリティ ログのそれぞれのイベント ログにレコードを作成します。イベント ビューアを使用すると、権限を与えられたユーザーがレコードを表示し、ログを管理できます。

**Windows 2000** **のイベント ビューアの何が問題になっていますか?**

イベント ビューアにはイベント レコードのプロパティを表示し、処理するコードの一部に問題があるバッファが含まれています。イベント ビューアがある特定の種類の不正の情報を含むイベント レコードのプロパティを表示するのに使用された場合、バッファがオーバーランする可能性があります。  

他のバッファ オーバーラン攻撃の脆弱性と同様に、次のいずれかの結果が生じます。まず、ランダム データによってバッファがオーバーランし、イベント ビューアが異常終了する可能性があります。より深刻な場合は、攻撃者がイベント レコードの該当のフィールドを注意深く選択したデータで満たし、イベント ビューアの機能が動作中に変更され、設定と異なる動作をしてしまう可能性があります。

**1** **つ目のケースでは攻撃者は何ができますか?**

イベント レコードがランダム データで満たされた場合、イベント ビューアは不正のレコードを読み取ろうとすると異常終了します。ユーザーはイベント ビューアを再起動することによって通常の動作を続けることができます。攻撃者が特定のレコードを削除することはできませんが、ログ全体を消去するまでレコードの表示を無効にすることができます。

**2** **つ目のケースでは攻撃者は何ができますか?**

攻撃者が特別に選択したデータを含むイベント レコードを挿入した場合、イベント ビューアがそのデータを処理する際、攻撃者が望む任意の操作を行います。コードが行うことのできる操作に関する唯一の制限はユーザーがマシンでほとんど特権を持たない場合、コードが実行できる操作はごくわずかです。しかし、ユーザーが管理者である場合、コードは実質上マシンで全ての操作を行うことができます。

**誰がイベント ログを表示することができますか?**

そのイベント ログにより異なります。アプリケーションとシステム ログは全てのユーザーにより表示されますが、セキュリティ ログは管理者だけが表示できます。

**バッファ オーバーランをトリガするために、ユーザーは何をする必要がありますか?**

攻撃者が作成した不正なイベント レコードに関する詳細情報をユーザーが表示する場合にのみ、バッファ オーバーランが発生します。イベント ビューアが起動すると、左ウィンドウはコンソール ツリーを、そして右ウィンドウはログ内の全てのイベントの一覧を表示します。単にこの画面での情報を表示するだけでは、バッファ オーバーランをトリガできません。ユーザーが攻撃者のイベント レコードをダブルクリックした場合、または右クリックで 「プロパティ」 を選択した場合のみバッファ オーバーランが発生します。

**攻撃者はどのようにして不正なイベント レコードを作成するのですか?**

仕様上、特権を持たないプロセスが標準 Win32 API コールを使用してアプリケーションとシステム ログにイベント レコードを書き込むことができます。（しかし、セキュリティ ログには書き込みはできません。）攻撃者はこれらの API コールを使用するアプリケーションを記述し、イベント ログに対し不正なレコードを書き込みします。

**システムを通常通り使用して、そのようなレコードは偶発的に作成されることはありますか?**

いいえ、ありません。全てのシステム サービスはここで問題となっている特定の不正を含むレコードを作成することはできません。どのような状況でも、単にシステムを使用してこのようなレコードを作成することはできません。

**リモートからこの脆弱性を侵害することはできますか?**

リモートでイベント レコードを書き込むことは可能です。しかし、これが行われる仕組みは通常、ファイアウォールによりブロックされています。したがって、適切にセキュリティで保護された環境では、この脆弱性はイントラネット ユーザーにのみ利用される可能性があります。

**攻撃者はイベント ビューアに不正なレコードを挿入し、権限を昇格させる手段として、故意にレコードを表示させることができますか?**

いいえ、できません。攻撃者がログにレコードを挿入し、それを表示させたとしても、イベント ビューアは攻撃者自身のセキュリティ コンテキスト内で動作します。このため、攻撃者はこの行為によって何も取得することはできません。

**イベント ログを安全に表示する方法はありますか?**

もちろん、イベント ビューアを安全に使用する最善の方法は更新プログラムを適用することです。また、[Dumpel](http://support.microsoft.com/kb/927229) ツールを使用し、イベント ログを Excel ファイルにダンプし、Excel を使用してイベント ログを表示させることも可能です。

**この脆弱性は** **Windows NT 4.0** **システムに影響を及ぼしますか?**

Windows NT 4.0 イベント ビューアはこの脆弱性の影響を受けません。しかし、Windows NT 4.0 システムがこの脆弱性を利用するシナリオに関わる場合もあります。

イベント ビューアを使用して、リモートで別のマシンのイベント ログを表示することができます。ここで重要な要因はどのシステムが改ざんされたレコードを保持しているかではなく、該当するイベント ビューアがレコードを表示するために使用されたかどうかです。つまり、攻撃者が Windows NT 4.0 システムのイベント ログに改ざんされたレコードを挿入し、Windows 2000 システムのユーザーがリモートでそれを表示した場合、このユーザーは脆弱性の影響を受けます。

**だれが更新プログラムを適用する必要がありますか?**

マイクロソフトは全ての Windows 2000 ユーザーにこの更新プログラムの適用を考慮することを推奨します。特に、サーバー、ドメイン コントローラなど重要なマシンに更新プログラムを適用することが重要です。

**更新プログラムは何を修正しますか?**

この更新プログラムはイベント ビューアが入力を使用する前に、それらをチェックするようにし、バッファがオーバーランすることを防ぎます。このようにして脆弱性を排除します。

更新プログラム
--------------

この問題に対する修正は Windows 2000 Service Pack 3 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。  
[http://www.microsoft.com/downloads/details.aspx?FamilyID=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&DisplayLang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&displaylang=ja)

なお、個別の更新プログラムは以下の Web サイトから入手できます。  

-   Microsoft Windows 2000 Professional, Windows 2000 Server, および Windows 2000 Advanced Server:
    [http://www.microsoft.com/Downloads/details.aspx?displaylang=ja&FamilyID=2BA6B2F3-9BB7-4ECF-8B46-47DB89BA86CE](http://www.microsoft.com/downloads/details.aspx?displaylang=ja&familyid=2ba6b2f3-9bb7-4ecf-8b46-47db89ba86ce)
-   Microsoft Windows 2000 Datacenter Server:  
    Windows 2000 Datacenter Server の更新プログラムの適用に関してはそれぞれのデータセンター サーバーを購入されたハードウェア ベンダー様へご相談下さい。

#### この更新プログラムに関する追加情報  

**対象プラットフォーム** **:**  
この更新プログラムは、Windows 2000、Service Pack 1 および Service Pack 2 を動作しているシステムにインストールすることができます。

**今後リリースされるサービス パックに含まれる更新プログラム** **:**  
この問題に対する更新プログラムは Windows 2000 Service Pack 3 に含まれています。

**更新プログラムのインストール確認方法** **:**  

-   マシンに更新プログラムがインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認してください。 : HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP3\\Q285156  
-   各ファイルを確認するためには、以下のレジストリ キーにある日時とバージョン情報を使用してください。 :  
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP3\\Q285156\\Filelist

**警告** **:**  
なし

**他のセキュリティ更新プログラムの入手先** **:**  
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS01-013）  
    [http://www.microsoft.com/technet/security/bulletin/ms01-013.mspx](http://technet.microsoft.com/security/bulletin/ms01-013)
-   サポート技術情報 （KB） 文書番号 ： 285156  
    [Windows 2000 イベント ビューアが未チェックのバッファを含む](http://support.microsoft.com/kb/285156)

**更新履歴** **:**

-   2001/2/27: このセキュリティ情報ページを公開しました。
-   2001/3/6: この問題に対する日本語版更新プログラムを公開しました。
-   2001/3/12: この問題に対する日本語版 KB を公開しました。
-   2001/11/26: このセキュリティ情報を更新し、サポート技術情報 [299549](http://support.microsoft.com/kb/299549) (英語情報) で説明されているように、SP 2 以降のパッケージに関する問題を解決するための更新プログラムの新しいバージョンがリリースされたことをお知らせしました。(更新プログラムのより前のバージョン、新しいバージョンの両方とも、このセキュリティ情報で説明されている脆弱性からマシンを保護します。) これに伴い、「更新プログラムのインストール確認方法」 欄のレジストリ キーのデータを更新しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*