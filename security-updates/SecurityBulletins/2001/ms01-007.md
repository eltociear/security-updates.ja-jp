---
TOCTitle: 'MS01-007'
Title: 'マイクロソフト セキュリティ情報 MS01-007 - 緊急'
ms:assetid: 'ms01-007'
ms:contentKeyID: 61228341
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms01-007(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS01-007 - 緊急
===============================================

Network DDE Agent の要求が、システム コンテキストでコードを実行してしまう
-------------------------------------------------------------------------

公開日: 2001年2月6日 | 最終更新日: 2002年1月15日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**  
Microsoft® Windows® 2000 サーバーまたはワークステーションを使用しているシステム管理者

**脆弱性の影響** **:**  
特権の昇格

**推奨する対応策** **:**  
システム管理者は、アクセス権のないユーザーがプログラムのロードや実行ができる全ての Windows 2000 に更新プログラムを適用し、また全ての Windows 2000 Web サーバーにも予防策として更新プログラムの適用を推奨します。

**影響を受けるソフトウェア** **:**  

-   Microsoft Windows 2000 Professional
-   Microsoft Windows 2000 Server
-   Microsoft Windows 2000 Advanced Server
-   Microsoft Windows 2000 Datacenter Server

### 詳細

問題
----

Network Dynamic Data Exchange (DDE) は 異なるWindows コンピュータ上のアプリケーション間で、データを動的に共有することを可能にする技術です。この共有は、信頼する共有と呼ばれる通信チャンネルを介して行われ、その通信チャンネルはNetwork DDE Agent というサービスに管理されています。仕様上、ローカル コンピュータの処理は、Network DDE Agent に要求を提出します。それらの要求には、ある特定の信頼する共有と連携して動作するアプリケーションを指定するものが含まれます。しかしWindows 2000 では、Network DDE Agent がローカル システムのセキュリティ コンテキストを使用して動作し、ユーザーのセキュリティ コンテキストではなく、ローカル システムのセキュリティ コンテキストを使用して要求を処理するために脆弱性が発生します。この脆弱性を利用して攻撃者は Network DDE Agent がローカル システム コンテキスト上で任意のコードを実行し、ローカル コンピュータを完全に制御する恐れがあります。

攻撃者がこの脆弱性を利用するためには、該当のコンピュータ上でプログラムを実行し、適切な要求を提出する必要があります。しかし、高いアクセス権限を所有しないユーザーがドメイン コントローラや他のサーバーなどのセキュリティ上重要なコンピュータ上で、今後コードを実行されないように設定しておくことを強く推奨します。これに従った場合、それらのコンピュータに危険性が発生することはないと考えられます。従ってこの脆弱性による影響を受ける可能性があるのは、主にワークステーションとターミナル サーバーです。これによってこの脆弱性による被害は限定される可能性があります。というのは大抵の場合、ワークステーションとターミナル サーバーを全面的に制御できたとしても、ドメインでのアクセス特権が昇格することはないからです。

マイクロソフトは Windows 2000 ワークステーションをご使用のお客様と、Windows 2000 サーバーで高いアクセス権を所有しないユーザーにコードを実行させているお客様に、この更新プログラムを直ちに適用されることを推奨します。さらに Windows 2000 Web サーバーを動作しているお客様も予防措置としてこの更新プログラムの適用をお考えになることをお勧めします。攻撃者が他の脆弱性を利用して、Web サーバー上の制限されたコンテキストでコードを実行することが可能になった場合、この脆弱性が攻撃者のアクセス権限を直ちに昇格させ、より大きな損害をもたらす恐れがあります。

**問題を緩和する要素** **:**

-   この脆弱性を利用するには、適切なリクエストを送信する該当のマシンでプログラムを実行することができる必要があります。しかし、アクセス権を所有しないユーザーに、ドメインコントローラや他のサーバーなどのセキュリティ上重要なマシンでコードを実行することができないように最善策を講じておくことを強く推奨します。このご案内に従われた場合、それらのマシンがこの危険にさらされることはありません。
-   この脆弱性による影響を受けるマシンは主にワークステーションとターミナル サーバーです。この事実により、この脆弱性による被害は制限されます。その理由は、大抵の場合、それらの種類のマシンを完全に制御できたとしても、ドメインでの権限が昇格することはないからです。

**脆弱性識別番号** **:**
[CAN-2001-0015](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0015)

よく寄せられる質問
------------------

**マイクロソフトセキュリティ情報** **MS01-007** **はどのような内容の通知ですか?**

このマイクロソフト セキュリティ情報 MS01-007 は、Microsoft® Windows® 2000 のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことをお客様にお知らせするものです。

**どのようなことが起こる可能性がありますか?**

これは[特権の昇格](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者がこの脆弱性を利用して、オペレーティング システム自体のアクセス特権をもったコマンドとプログラムを実行する可能性があります。これにより攻撃者は該当のコンピュータ上で、事実上全ての操作をすることができます。

この脆弱性には ２ つの明確な制限があります。

-   該当のコンピュータで任意のコードを実行できる攻撃者のみがこの脆弱性を利用できます。最善の回避策が講じられていて、高いアクセス権限を所有しないユーザーがサーバーや他のセキュリティ上重要なコンピュータ上で、コードを実行することができない場合、この脆弱性で危険性が発生するのはワークステーションのみです。（ターミナル サーバーはこの脆弱性による影響は受けません。）
-   ワークステーションを完全に制御できたとしてもドメインでのアクセス権限を昇格することはできません。

**この脆弱性の原因は何ですか?**

この脆弱性は、ローカル コンピュータで動作している処理が Network DDE Agent へメッセージを送信し、Network DDE Agent がメッセージの中で指定された実行を開始します。実行可能なものはローカル システム コンテキストで動作している Network DDE Agent のセキュリティ コンテキストを使用して実行されます。

**Network DDE** **とは何ですか?**

[Network Dynamic Data Exchange (DDE)](http://msdn2.microsoft.com/en-us/library/aa365778.aspx)は異なるコンピュータ上を動作しているアプリケーションが情報を動的に共有することができる技術です。例えば、Network DDE を使用すると コンピュータ Ａ 上を動作している Word のインスタンスは コンピュータ B 上を動作している Excel のインスタンスに動的にリンクし、両方のアプリケーションからの情報が混在した文書を表示します。

**Network DDE Agent** **とは何ですか?**

Network DDE では、クライアントとサーバー アプリケーションは信頼する共有として知られるチャンネルを介して通信します。Network DDE Agent と呼ばれる Windows サービスは、信頼する共有が動作し、生成、削除、また必要な際に信頼する共有を管理することができる通信サービスを供給します。この脆弱性は Network DDE Agent の問題により発生します。

**Network DDE Agent** **の何が問題になっていますか?**

従来の バージョンの Windows システムでは、Network DDE Agent はユーザーのセキュリティ コンテキスト上を動作していました。その結果、ローカル コンピュータ上を動作している処理からの要求を受け付けても安全でした。結局、処理がユーザーのセキュリティ コンテキストで既に動作していて、Network DDE Agent へ要求を提出してもアクセス権限が昇格することはありませんでした。

Windows 2000 では、Network DDE Agent は、オペレーティング システムの 一部を動作しているコンポーネントに移動されましたが、ローカル コンピュータの処理からの要求は受け付けます。新しい状況下では、処理はローカル システムのセキュリティ コンテキストで実行される要求を提出します。

**前の質問で、Network DDE Agent** **は信頼する共有を管理すると説明されていました。これによりコードが実行されるのはなぜですか?**

Network DDE Agent が受け取る要求の中には、信頼する共有をアクティブ化する必要があるものが含まれます。その共有に関連するアプリケーションの名前が要求に含まれます。このような要求をNetwork DDE Agent が受け取ると、アプリケーションが起動します。

攻撃者は Network DDE Agent へ要求を提出し、任意の実行を指定したプログラムを、ある特定の信頼する共有に関連させて書く可能性があります。このことにより Network DDE Agent がローカル システム コンテキストでコードを実行します。

**コンピュータに信頼する共有がない場合、攻撃者は要求を提出できますか?**

信頼する共有があるのは攻撃者にとっては必須条件ですが、信頼する共有がなくても攻撃者に必ずしも攻撃を思いとどまらせるわけではありません。Windows 2000 システムではデフォルトで 3 つの信頼する共有があります。これら取り除かれても [Network DDE Share Manager](http://support.microsoft.com/kb/114089) を使用して新しい共有を作成することができます。

**攻撃者がこの脆弱性を利用した場合、攻撃者は何ができますか?**

ローカル システム アクセス権限ではコードがオペレーティング システムの一部として機能します。これらの権限を使用して、攻撃者のコードはローカル コンピュータで文字通り全ての操作が可能になります。例えば、自分をローカル管理者グループに追加したり、新たなオペレーティング システム コンポーネントをインストールしたり、ハード ドライブを再フォーマットしたりできます。

**この脆弱性によって、攻撃者はドメインでのアクセス権限を昇格できますか?**

攻撃者が侵害したコンピュータによって異なります。それ自体ではこの脆弱性によって攻撃者はローカル コンピュータでのアクセス権限を昇格できるだけです。ワークステーションやメンバー サーバーなどのコンピュータを完全に制御できたとしても、攻撃者はそのドメインでは高度なアクセス特権を得られません。しかし、攻撃されたコンピュータは攻撃者が自分のコントロールの範囲を広げようとして他の攻撃を仕掛ける足がかりとなります。

攻撃者がドメイン コントローラでこの脆弱性を利用できた場合、攻撃者はもちろん、定義上はドメインを完全に制御することができます。しかしながら下に説明されているように、最善の回避策を講じれば、この脆弱性からドメイン コントローラなどのコンピュータを守ることができます。

**この脆弱性はリモートで利用されますか?**

いいえ、利用されません。要求が Network DDE Agent に送信されるメカニズムはローカル コンピュータ上のみで動作します。攻撃者は、別のコンピュータでこの脆弱性を利用する可能性のあるコンピュータ上ではプログラムを実行できません。

これは重要なポイントです。というのは、この脆弱性がサーバーと他の機密情報を扱うコンピュータに与える危険性を軽減する可能性があるからです。攻撃者は該当のコンピュータで任意のプログラムを開始できなければ攻撃できませんが、高いアクセス権限を所有しないユーザーがドメイン コントローラやデータベース サーバー、ERP サーバー、印刷、ファイルサーバーなどのコンピュータ上でプログラムを実行しないように最善の回避策を講じておくことを強く推奨します。このように、回避策が講じられていれば、この脆弱性による影響を受けるのはワークステーションに限定されます。

**ターミナルサーバーに関してはどうですか?** **高いアクセス権限を所有しないユーザーは通常ターミナルサーバーでコードを実行できないのですか?**

この脆弱性を利用するための必須条件は、実際には上記で説明されているよりもずっと厳密です。攻撃者のコードがローカルで実行される必要があるだけでなく、Network DDE Agent と同じウインドウ ステーションとデスクトップで実行される必要があります。（ウインドウ ステーションとデスクトップに関する詳細は マイクロソフト セキュリティ情報 [よく寄せられる質問 (FAQ)](http://technet.microsoft.com/security/bulletin/ms00-020) をご覧ください。）

このことはワークステーションとサーバーにとっては、違いではなく区別です。しかし、ターミナル サーバーはこの違いは重要です。ターミナル サーバー上のユーザー セッションはそれぞれ異なるウインドウ ステーションで動作するので、どちらもNetwork DDE Agent 上の要求を提出できません。コンソール セッションは Network DDE Agent と同じウインドウ ステーションとデスクトップで動作しますが、最善の回避策が講じられていれば、高いアクセス権限を所有しないユーザーがコンソールのターミナル サーバーにログオンすることはできないでしょう。

**この脆弱性はWindows NT 4.0** **に影響を及ぼしますか?**

いいえ。Windows NT 4.0 では、the Network DDE Agent はユーザー自身のセキュリティ コンテキストで動作していたためこの脆弱性は存在していませんでした。

**だれが更新プログラムを適用する必要がありますか?**

マイクロソフトは 全ての Windows 2000 ユーザーにこの更新プログラムの適用をお考えになることをお勧めします。また Windows 2000 ワークステーションを使用しているお客様と Windows 2000 サーバーで高いアクセス権限を所有しないユーザーにコードを実行させているお客様に、この更新プログラムを直ちに適用されることを強く推奨します。

また、Windows 2000 Web サーバーを動作しているお客様にも予防措置として、この更新プログラムの適用を考えられることをお勧めします。Web サーバーはもちろん高いアクセス権限を所有しないユーザーに、コードを実行させないようにすることが必要です。しかし、攻撃者が他の脆弱性を利用して Web サーバーに攻撃を与え、そのサーバー上でコードを実行できるようになった場合には、そのサーバー上でのコントロールの範囲を広げるためにこの脆弱性を利用することが考えられます。

**更新プログラムは何を変更しますか?**

この更新プログラムは Network DDE Agent が要求者のセキュリティ コンテキスト上の全ての要求を実行するようにしてこの脆弱性を排除します。

**どこから更新プログラムを入手できますか?**

マイクロソフト セキュリティ情報 MS01-007 をご覧ください。

**更新プログラムはどのように使用するのですか?**

サポート技術情報 [285851](http://support.microsoft.com/kb/285851) は、お客様のサイトに更新プログラムを提供するための詳細な情報が記載されています。

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS01-007 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](http://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトは、[285851](http://support.microsoft.com/kb/285851) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか** **?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](http://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカルサポートを受けるにはどこに問い合わせればよいですか** **?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](http://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

-   Microsoft Windows 2000 Professional、Server および Advanced Server:

    この問題に対する修正は Windows 2000 Service Pack 3 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

    <http://www.microsoft.com/japan/windows2000/downloads/>
    なお、個別の更新プログラムは以下の Web サイトから入手できます。  
    -   PC/AT 互換機用  
        [http://www.microsoft.com/downloads/details.aspx?FamilyId=9F7C3381-78AF-4D86-9F3D-62C962A7A33E&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=9f7c3381-78af-4d86-9f3d-62c962a7a33e&displaylang=ja)
    -   NEC PC-9800 シリーズ用
        [http://download.microsoft.com/download/win2000platform/patchNEC/q285851/NT5/JA/Q285851\_W2K\_SP3\_nec98\_JA.exe](http://download.microsoft.com/download/win2000platform/patchnec/q285851/nt5/ja/q285851_w2k_sp3_nec98_ja.exe)

-   Microsoft Windows 2000 Datacenter Server:  
    Windows 2000 Datacenter Server の更新プログラムの適用に関してはそれぞれのデータセンター サーバーを購入されたハードウェア ベンダー様へご相談下さい。

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**    
この更新プログラムは Windows 2000、Service Pack 1 および Service Pack 2 を動作しているシステムにインストールすることができます。

**今後リリースされるサービスパックに含まれる更新プログラム** **:**    
この問題に対する更新プログラムは Windows 2000 Service Pack 3 に含まれています。

**更新プログラムのインストール確認方法** **:**

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。  
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP3\\Q285851  
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。  
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP3\\Q285851\\Filelist

**警告** **:**  
なし

**他のセキュリティ更新プログラムの入手先** **:**  
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/) Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS01-007）  
    [http://www.microsoft.com/technet/security/bulletin/ms01-007.mspx](http://technet.microsoft.com/security/bulletin/ms01-007)
-   サポート技術情報 （KB） 文書番号 ： 285851  
    [「Network DDE Agent 要求」の脆弱性に対する対策](http://support.microsoft.com/kb/285851)

**更新履歴** **:**

-   2001/2/6: このセキュリティ情報ページを公開しました。
-   2001/2/13: ターミナルサーバもこの問題の影響を受けることをお知らせしました。
-   2001/2/20: この問題に対する日本語版更新プログラムを公開しました。
-   2001/2/28: この問題に対する日本語版 KB を公開しました。
-   2002/01/15: このセキュリティ情報を更新し、サポート技術情報 [299549](http://support.microsoft.com/kb/299549/en-us) (英語情報) で説明されているように、SP 2 以降のパッケージに関する問題を解決するための更新プログラムの新しいバージョンがリリースされたことをお知らせしました。(更新プログラムの以前のバージョン、新しいバージョンの両方とも、このセキュリティ情報で説明されている脆弱性からマシンを保護します。) これに伴い、「更新プログラムのインストール確認方法」 欄のレジストリ キーのデータを更新しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。  

*Built at 2014-04-18T01:50:00Z-07:00*