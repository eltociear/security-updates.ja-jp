---
TOCTitle: 'MS02-060'
Title: 'マイクロソフト セキュリティ情報 MS02-060 - 警告'
ms:assetid: 'ms02-060'
ms:contentKeyID: 61228485
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-060(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS02-060 - 警告
===============================================

Windows XP 「ヘルプとサポート センター」 の問題によりファイルが削除される (328940)
----------------------------------------------------------------------------------

公開日: 2002年10月17日 | 最終更新日: 2002年10月23日

#### 概要 :

**このセキュリティ情報の対象となるユーザー :**  
Microsoft® Windows® XP をご使用のお客様

**脆弱性の影響 :**  
ユーザーのシステム上でファイルが削除される

**最大深刻度 :**  
中

**推奨する対応策 :**  
お客様は Windows XP [Service Pack 1](http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/default.mspx) をインストールすることを推奨します。Windows XP Service Pack 1 を適用できないお客様は、当面の対応策として、この更新プログラムをインストールして下さい。

**影響を受けるソフトウェア :**  

-   Microsoft Windows XP

### 詳細

問題
----

<span></span>
**技術的な説明 :**  
「ヘルプとサポート センター」 では様々なトピックに関してユーザーがサポートを受けることができる機能が集まっています。たとえば、製品に関する文書、ハードウェア互換性を確認するためのサポート、Windows Update へのリンク、マイクロソフトからのオンライン ヘルプおよびそのほかのサポートが提供されています。

Windows XP の 「ヘルプとサポート センター」 にセキュリティ上の脆弱性が存在します。それはシステムでの使用のみを目的としているファイルが、すべての Web ページによって使用されるためです。このファイルは、ユーザーの許可を得た上で、ハードウェア情報の匿名のアップロードを可能にし、これにより、マイクロソフトはユーザーに必要なデバイス ドライバの最新の情報を得ることができます。この情報は、次にハードウェア ベンダーとデバイス チームが協力し、Windows で利用可能なドライバの品質および量を向上させるために使用されます。仕様上、ハードウェア情報を含む XML ファイルのアップロードを試行した後、そのファイルはシステムによって削除されます。

攻撃者がこの脆弱性を悪用し、ある Web ページを作成し、そのページがユーザーによって開かれると不正な機能が呼び出され、既存のファイルまたはフォルダの名前が引数として入力される可能性があります。ファイルまたはフォルダのアップロードの試行は異常終了しますが、そのファイルは削除される可能性があります。そのようなページは Web サイト上にホストされ、それにより、そのサイトを訪問したユーザーが攻撃されるか、または HTML 形式の電子メールとして送信され、受信者がそのメールを開くと攻撃される可能性があります。

**問題を緩和する要素 :**  

-   Windows XP [Service Pack 1](http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/default.mspx) を適用しているお客様はこの脆弱性による危険はありません。
-   この脆弱性は、ユーザーが何らかの操作をしない限り、悪用されることはありません。攻撃者にとって最も有利な場合であっても、「ヘルプとサポート センター」 ウィンドウが予期せず表示され、ユーザーが応答するまで、ファイルの削除は行われません。(\[キャンセル\] を選択しても、ファイルの削除が行われます。) ユーザーがそのプロセスに応答するのではなく、強制終了した場合、削除は行われません。
-   攻撃が行われるのは、ユーザーが攻撃者の管理している Web サイトを訪問する、または攻撃者からの HTML 形式の電子メールを受信することが必要条件となります。
-   この脆弱性により、攻撃者はファイルの削除以外の操作を行うことはできません。この脆弱性が悪用されても、システム上でいかなる形式の管理者権限も取得されず、攻撃者にファイルの読み取り、変更を行われることはありません。
-   「ヘルプとサポート センター」 の機能は、Internet Explorer 6.0 Service Pack 1 が実行されている Outlook Express または Outlook、また、[「テキスト形式で表示」](http://support.microsoft.com/kb/307594) 機能が有効にされている Outlook 2002では自動的に起動しません。
-   攻撃者がファイルを削除するためには、その標的となるファイルおよびパス名を知っていることが必要条件となります。フォルダを削除するためには、攻撃者はその正確なパスを知っていることが必要条件となります。
-   攻撃者がこの脆弱性を悪用し、システム操作を妨害した場合、Automatic System Recovery により通常の操作を回復することができるようになります。また、システム ファイルが削除された場合、Windows XP ではそれらの多くが自動的に復元されます。

**深刻度 :**  

|                | インターネット サーバー | イントラネット サーバー | クライアント システム |
|----------------|-------------------------|-------------------------|-----------------------|
| **Windows XP** | 低                      | 低                      | 中                    |

上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。この脆弱性は主にワークステーションに影響を及ぼし、サービス拒否の脅威をもたらしますが、その問題を緩和するための重要な要素があります。

**脆弱性識別番号 :**  
[CAN-2002-0974](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0974)

**テストしたバージョン :**  
マイクロソフトは Windows XP、Windows 2000、Windows NT 4.0、Windows Millennium、Windows 98 のテストを行い、これらの脆弱性による影響を評価しました。それ以前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**この脆弱性に対する修正は、既にWindows XP Service Pack 1に含まれていましたが、なぜマイクロソフトはこの更新プログラムとしてリリースしたのですか?**

この問題に対する修正は Windows XP [Service Pack 1](http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/default.mspx) に含まれており、通常の状況では、マイクロソフトはこれを更新プログラムとしてリリースしません。ほとんどの場合、サービス パックは更新プログラムよりも、セキュリティ更新プログラムを配布する[よりよい](http://www.microsoft.com/japan/technet/archive/community/columns/security/essays/srvpatch.mspx) 媒体です。確かに、更新プログラムの唯一の目的は、次のサービス パックがリリースされるまで、特定の脆弱性に対し、お客様のシステムをセキュリティで保護する手段を提供することです。

当初マイクロソフトはこの問題に対する修正を Service Pack 1 で提供する予定でした。しかし、これを更新プログラムとしても利用可能にすることにしました。最初の決定には確固たる理由がありましたが、マイクロソフトは Service Pack 1 を展開するには充分な時間がないというお客様からのフィードバックに基づき、再検討しました。

**どのようなことが起こる可能性がありますか?**

この脆弱性により、攻撃者は Web サイトまたは電子メールを介し、別のユーザーのコンピュータ上のファイルを削除できる可能性があります。このような攻撃は次のいずれかの目的のために行われます。それらの目的とは、ユーザーが作成した価値の高いファイルを削除する、またはシステム操作の中断を試行するためにシステム ファイルを削除することです。

この脆弱性は Windows XP のみに影響を及ぼしますが、その影響はファイルの削除のみです。この脆弱性が悪用されても、ファイルの追加、ファイルの内容の変更、プログラムの実行、またはそのほかの操作は行われません。攻撃者は 「ヘルプとサポート センター」 の機能を Internet Explorer 6.0 Service Pack 1 が実行されている Outlook Express または Outlook、また、[「テキスト形式で表示」](http://support.microsoft.com/kb/307594) 機能が有効にされている Outlook 2002で、電子メール ベースの攻撃の方法により、自動的に起動させることはできません。

**何が原因で起こりますか?**

「ヘルプとサポート センター」 の Windows XP の実装にはスクリプト ファイルが含まれており、仕様上、これは信頼されるプログラムにのみアクセス可能であるべきですが、実際は広範囲にアクセス可能であるため、この脆弱性が起こります。スクリプトが呼び出されると、スクリプトは指定されたファイルのアップロードを試行し、次に操作の結果としてそのファイルを削除します。

**「ヘルプとサポートセンター」とは何ですか?**

[「ヘルプとサポート センター」](http://www.microsoft.com/japan/technet/prodtechnol/winxppro/support/hsc.mspx) (HSC: Help and Support Center) とは、様々なトピックに関するヘルプを提供する Windows の機能です。たとえば、HSC により、ユーザーは新しい Windows 機能について知る、ソフトウェアの更新をダウンロードし、インストールする、特定のハードウェア デバイスが Windows と互換性があるかどうかを確認する、マイクロソフトからのサポートを得るなどができます。

**HSCの何が問題になっていますか?**

HSC は数多くのファイルから構成されており、あるファイルはすべての Web ページにより利用可能であり、またほかのファイルは HSC 自体のみによる利用を目的とされています。これらの中の 1 つのファイルは HSC のみに利用可能であるべきですが、実際は Web ページによる使用が可能となります。このファイルにより利用可能となる機能が、信頼されない Web ページにより不適切に使用されるため、セキュリティ上の脆弱性が起こります。

**ここで問題となっているファイルは何をしますか?**

お客様が \[新しいハードウェアの検出\] ウィザードを使用してローカル メディアまたは Windows Update サイトでドライバの検出に成功しなかった場合にこのファイルが使用されます。これが起こると、システム ハードウェアに関する情報を含む XML ファイルをマイクロソフトに匿名でアップロードできるプロセスの一部として、ユーザーにさらにヘルプを得るためのオプションが表示されます。ここで問題となっているファイルはアップロード操作を実行し、次に XML ファイルを削除します。

**この機能を信頼されないWebページに利用可能にすると、なぜセキュリティ上の脆弱性が起こるのですか?**

アップロード (後に削除) されるファイルの名前は、この機能が呼び出される時に引数として指定されます。すべての Web ページがこの機能を呼び出せるため、信頼されない Web ページがユーザーのシステム上のファイルまたはフォルダを削除することができます。

**この脆弱性により攻撃者は何をする可能性がありますか?**

次のいずれかの目的のために攻撃者はこの脆弱性を悪用する可能性があります。まず、攻撃者は文書、スプレッドシートまたはそのほかの重要なファイルを削除する可能性があります。しかし、攻撃者はそのファイルの名前または少なくともそのファイルが存在するフォルダの名前を知ることが必要条件となります。

また、攻撃者はユーザーがシステムを使用できないようにするために、システム ファイルを標的とする場合があります。しかし、Windows XP は特定のシステム ファイルが破損した場合、それらを自動的に復元します。これ以外でも、自動回復システムが通常の機能を回復する方法を提供します。

**攻撃者はどのようにしてこの脆弱性を悪用する可能性がありますか?**

攻撃者はこの機能を呼び出し、削除する対象となるファイルまたはフォルダの名前を提供する Web ページを作成することが必要となります。攻撃は次のいずれかの方法により行われる可能性があります。まず、攻撃者は Web サイトで Web ページをホストし、ユーザーがその Web サイトを訪問すると、この脆弱性を悪用するために Web ページがこの機能の呼び出しを試行します。または、攻撃者は HTML 形式の電子メールとして Web ページを送る可能性があります。受信者がその Web ページを開くと、この脆弱性を悪用するために Web ページがこの機能の呼び出しを試行します。

**Webページがこの機能の呼び出しを「試行する」とのことですが、この試行が成功したかどうかをどのように確認できますか?**

Web サイト ベースの攻撃では、攻撃者はユーザーを攻撃者の管理する Web サイトを訪問するよう誘導することが必要条件となります。ユーザーのブラウザが Internet Explorer 6.0 Service Pack 1 で、ユーザーがリンクをクリックした場合のみこの機能が起動する場合以外は、この機能が自動的に起動する可能性があります。

電子メール ベースの攻撃では、攻撃者は HTML 形式の電子メールを送る可能性があります。ユーザーが Internet Explorer 6.0 Service Pack 1 を実行している場合、この機能は Outlook Express または Outlook から自動的に起動することはありません。また、この機能は [「テキスト形式で表示」](http://support.microsoft.com/kb/307594) 機能が有効にされている Outlook 2002では自動的に起動しません。

**攻撃者がHSCを実行させることができる場合、脆弱性が悪用されますか?**

攻撃者が HSC を実行させることができる場合でも、攻撃を自動的に進行させることはできません。下記に示されている HSC ウィンドウが表示され、ユーザーがこのウィンドウのボタンの 1 つをクリックするまでファイルの削除は行われません。

![](../../images/Dn636307.hcp-0(ja-JP,Security.10).gif)  

[拡大図を表示](http://www.microsoft.com/technet/../../images/security/bulletin/hcp-0.gif)

ブラウザがフレームをサポートしていない場合、[こちら](http://www.microsoft.com/technet/security/bulletin/../../images/hcp.jpg)をクリックして別のウィンドウを表示して下さい。

重要な点として、\[キャンセル\] が選択されても､削除は続行されます。しかし、予期しない (要求されていない) ウィンドウが表示された場合、これは攻撃が進行中であることを示す警告であり、ユーザーは HelpCtr.exe プロセスを強制終了させるための次のステップに従うことにより、安全にダイアログをクリアすることができます。

-   Ctrl-Alt-Del を押し、次に \[タスク マネージャ\] をクリックします。
-   \[プロセス\] タブをクリックします。
-   \[HelpCtr.exe\] をハイライトします。
-   \[プロセスの終了\] を右クリックします。
-   \[タスク マネージャ\] の警告に対し、\[はい\] を選択します。

**この脆弱性が存在する機能は情報をアップロードするために使用されるとのことでしたが、これは攻撃者がユーザーのシステムからファイルの読み取りができるということですか?**

いいえ。この機能は情報をマイクロソフトにアップロードするのみです。攻撃者がこの機能を悪用し、ファイルを攻撃者にアップロードすることはできません。

**Windows XP以外のWindowsのバージョンを実行していますが、この脆弱性による危険はありますか?**

いいえ、ありません。この脆弱性は 「ヘルプとサポート センター」 の Windows XP のバージョンにのみ存在します。

**更新プログラムは何を修正しますか?**

この更新プログラムは信頼されるシステム コンポーネント以外がこの機能を呼び出さないようにしてこの脆弱性を解決します。さらに、この問題の調査中にマイクロソフトはそのほかの必要となる変更を確認しました。これらのすべての変更もまたこの更新プログラムに実装されています。

**攻撃者はどのようにしてこの問題を悪用する可能性がありますか?**

この問題は上記に説明されている方法と同じように悪用される可能性があります。この問題を悪用する Java アプレットを作成し、そのアプレットを Web ページの一部として攻撃者の Web サイトにホストするか、または HTML 形式の電子メールを介し、直接ユーザーに送ることにより、この脆弱性を悪用する可能性があります。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft Windows XP:
    [http://www.microsoft.com/downloads/details.aspx?FamilyId=84FC577D-F2D5-47B8-AB98-77BA7501B00B&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=84fc577d-f2d5-47b8-ab98-77ba7501b00b&displaylang=ja)
-   Microsoft Windows XP 64 bit:
    [http://www.microsoft.com/downloads/details.aspx?FamilyId=97945A5D-DB0B-40F8-9A2E-DE93CBB5CB3A&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=97945a5d-db0b-40f8-9a2e-de93cbb5cb3a&displaylang=ja)

#### 更新プログラムに関する追加情報

**対象プラットフォーム :**  
この更新プログラムは、Windows XP を実行しているシステムにインストールすることができます。

**この修正を含む予定のサービスパック :**  
この問題に対する更新プログラムは Windows XP [Service Pack 1](http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/default.mspx) に含まれています。

**再起動の必要性 :**  
あり

**更新プログラムのアンインストール :**  
可

**更新プログラムに含まれる過去の修正 :**  
なし

**更新プログラムが正しくインストールされたかどうか確認する方法 :**  

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP1\\Q328940
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP1\\Q328940\\Filelist

**警告 :**  
Windows XP にこの更新プログラムをインストールし、次に Windows XP Service Pack 1 をインストールし、その後 Windows XP Service Pack 1 を***アンインストール***した場合、コンピュータを Windows XP Service Pack 1 をインストールする前の状態に戻すためには、HSCUPD.EXE (%windir%\\pchealth\\helpctr\\binaries\\hscupd.exe) プログラムを実行する必要があります。

**他のセキュリティ更新プログラムの入手先 :**  
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報 :**  

-   US マイクロソフトセキュリティ情報（MS02-060）
    [http://www.microsoft.com/technet/security/bulletin/ms02-060.mspx](http://technet.microsoft.com/security/bulletin/ms02-060)
-   サポート技術情報 （KB） 文書番号 ： 328940
    [MS02-060: Windows XP 「ヘルプとサポート センター」 の問題によりファイルが削除される](http://support.microsoft.com/kb/328940)

**更新履歴 :**  

-   2002/10/17: このセキュリティ情報ページを公開しました。
-   2002/10/23: CAN 番号を修正しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
