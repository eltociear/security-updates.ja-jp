---
TOCTitle: 'MS02-066'
Title: 'マイクロソフト セキュリティ情報 MS02-066 - 緊急'
ms:assetid: 'ms02-066'
ms:contentKeyID: 61228491
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-066(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS02-066 - 緊急
===============================================

Internet Explorer 用の累積的な修正プログラム (328970)
-----------------------------------------------------

公開日: 2002年11月21日 | 最終更新日: 2002年12月16日

#### 概要 :

**このセキュリティ情報の対象となるユーザー :**  
Microsoft® Internet Explorer を使用しているお客様

**脆弱性の影響 :**  
6 つの新しい脆弱性。最も深刻な脆弱性については、攻撃者がユーザーのシステムで任意のコードを実行する可能性があります。

**最大深刻度 :**  
緊急

**推奨する対応策 :**  
お客様はこの累積的な更新プログラムを直ちにインストールして下さい。

**影響を受けるソフトウェア :**  

-   Microsoft Internet Explorer 5.01
-   Microsoft Internet Explorer 5.5
-   Microsoft Internet Explorer 6

### 詳細

問題
----

<span></span>
**技術的な説明 :**  
2002 年 11 月 20 日 (米国日付)、マイクロソフトは深刻度を 「重要」 として、このセキュリティ情報の最初のバージョンをリリースしました。このリリース後に追加された情報に基づき、マイクロソフトは深刻度を再評価し、「緊急」 としました。高められた深刻度は、更新プログラムが適用されていないシステムが悪用された場合に関する追加情報に基づいています。最初にリリースされたセキュリティ情報で提供された累積的な更新プログラムは、この脆弱性を修正します。

このセキュリティ情報に関連する累積的な更新プログラムは、マイクロソフト セキュリティ情報 [MS02-068](http://technet.microsoft.com/security/bulletin/ms02-068) に既に含まれています。MS02-068 もまた、深刻度は 「緊急」 です。[MS02-068](http://technet.microsoft.com/security/bulletin/ms02-068) で提供された累積的な更新プログラムはこのセキュリティ情報で説明されているセキュリティ上の脆弱性に対する更新プログラムだけでなく、追加のセキュリティ上の脆弱性に対する更新プログラムも含みます。したがって、マイクロソフトはお客様に最新である MS02-068 で提供されている累積的な更新プログラムを適用することを強く推奨します。

これは累積的な更新プログラムで、IE 5.01、5.5 および 6 用に以前にリリースされたすべての更新プログラムの機能を含みます。さらに、新たに確認された次の 6 つの脆弱性を排除します。

-   PNG グラフィック ファイルが開かれた時、Internet Explorer が PNG グラフィック ファイルのパラメータを正しくチェックしないために起こるバッファ オーバーランの脆弱性。攻撃者はこの脆弱性を悪用し、ユーザーのシステムで任意のコードを実行する可能性があります。多くのマイクロソフト製品、特にほとんどの Microsoft Office 製品および Microsoft Index Server は PNG ファイルのレンダリングを Internet Explorer に依存します。このようなアプリケーションでこの脆弱性が悪用されると、そのアプリケーションでバッファ オーバーランが起こる可能性もあります。このため、マイクロソフトはお客様に Internet Explorer を主要な Web ブラウザとして使用しているかどうかに関わらず、この累積的な更新プログラムをインストールすることを推奨します。
-   Internet Explorer が URL のエンコードされた文字列を処理する方法に関連する情報漏えいの脆弱性。この脆弱性により、攻撃者はエンコードされた文字列を含む URL を作成し、これがユーザーを別の Web サイトにリダイレクトする可能性があります。ユーザーがこの URL にアクセスすると、攻撃者がユーザーのアクセスを別の Web サイトに転送させる可能性があり、これにより攻撃者に、ユーザーが別の Web サイトと共有する情報にアクセスされる可能性があります。
-   特定の状況で Internet Explorer がオブジェクト タグが呼び出すコンポーネントを正しくチェックしないために起こる脆弱性。この脆弱性により、攻撃者にユーザーのローカル マシンのインターネット一時ファイルのフォルダの名前を取得される可能性があります。インターネット一時ファイルのフォルダはインターネット セキュリティ ゾーンに存在するため、攻撃者にこの脆弱性が悪用されてもユーザーのローカル システムのファイルの読み取りまたは変更が行われることはありません。攻撃者がインターネット一時ファイルのフォルダ名を知っている場合、ログオンしたユーザーのユーザー名を識別し、Cookie などのインターネット一時ファイルのフォルダ内の情報が読み取られる可能性があります。
-   異なる原因を持ちますが、実質的に同じ影響を及ぼす 3 つの脆弱性。これらの 3 つの脆弱性は、Web ページで特定のプログラミング技術を使用している場合に、充分なセキュリティ チェックが行われない結果として起こります。これらの脆弱性の影響として、ある Web サイトがユーザーのローカル システムなどの別のドメイン内の情報にアクセスする可能性があります。最悪の場合、これにより、Web サイト オペレータに、ユーザーのシステムに悪質なコードを読み込まれる可能性があります。さらに、攻撃者にローカル システムに既に存在している実行可能ファイルを呼び出される可能性があります。マイクロソフト サポート技術情報 [810687](http://support.microsoft.com/kb/810687) で説明されているレジストリ キーの設定が HTML ヘルプのショートカットを無効にしている場合、これらの脆弱性が悪用される可能性が大幅に低減されます。

さらに、この累積的な更新プログラムは、レガシー DirectX ActiveX コントロール (これは取り下げられましたが、セキュリティ上の脆弱性が存在します) に [Killbit](http://support.microsoft.com/kb/240797) を設定します。Killbit を設定することにより、脆弱性の影響を受けるコントロールがユーザーのシステムに再導入されないようにし、このコントロールが存在するシステムを使用中のユーザーを保護します。この詳細はサポート技術情報 [810202](http://support.microsoft.com/kb/810202) で説明されています。

また、この累積的な更新プログラムは、最初に Internet Explorer 6 [Service Pack 1](http://www.microsoft.com/downloads/details.aspx?familyid=1e1550cb-5e5d-48f5-b02b-20b602228de6&displaylang=ja) で導入されたクロス ドメインの検証に対してさらに改善を行います。この詳細は 「よく寄せられる質問」 で説明されています。

**問題を緩和する要素 :**  
「不正な PNG イメージ ファイルのバッファ オーバーラン」 の脆弱性以外は、すべての脆弱性において、共通の問題を緩和する要素があります。

-   攻撃者は特定の脆弱性を悪用するため、Web ページを含む Web サイトをホストすることが必要となります。
-   攻撃者にはユーザーを強制的に Web サイトに訪問させる方法はありません。しかし、攻撃者はユーザーに攻撃者の Web サイトへのリンクをクリックさせ、ユーザーをその Web サイトに誘導する必要があります。
-   既定で Outlook Express 6.0 および Outlook 2002 は HTML 形式の電子メールを 「制限付きサイト ゾーン」 で開きます。Outlook 98 および Outlook 2000 については、Outlook 電子メール セキュリティ アップデートがインストールされている場合、HTML 形式の電子メールを 「制限付きサイトゾーン」 で開きます。これらの製品を使用しているお客様は電子メールによるこれらの脆弱性を悪用した攻撃の危険にさらされません。

さらに、個々の脆弱性に対し、問題を緩和する要素があります。

不正な PNG イメージ ファイルのエラー

-   この脆弱性は Internet Explorer 6 Service Pack 1 には存在しません。

エンコードされた文字列の情報漏えい

-   この脆弱性が悪用されても、攻撃者にローカル システムのファイルの読み取りまたは実行が行われることはありません。

インターネット一時ファイルのフォルダ名の読み取り

-   攻撃者にこの脆弱性が悪用されても、インターネット一時ファイルのフォルダに含まれている情報以外のユーザーのローカル システムのファイルが読み取り、削除、変更が行われることはありません。
-   攻撃者がユーザーに悪質な Web サイトを訪問させ、次にその Web サイトにあるユーザーが信頼する別の Web サイトへの不正なリンクを追うようにする場合のみ、この脆弱性が悪用される可能性があります。
-   この脆弱性は Internet Explorer 6 Service Pack 1 には存在しません。

フレームのクロスサイト スクリプティング、キャッシュされたメソッドを介すクロス ドメインの検証およびフレームの不適切なクロス ドメインのセキュリティ検証

-   これらの脆弱性が悪用された場合でも、攻撃者に可能な操作はブラウザ ウィンドウでレンダリングできるユーザーのローカル システムのファイル (例 : イメージ ファイル、HTML ファイル、テキスト ファイルなど) の読み取りのみです。これらの脆弱性が悪用された場合に可能となる操作はユーザーがアクセスしたファイルで、ユーザーまたはオペレーティング システムにより開かれなかったファイルの読み取りのみになります。
-   マイクロソフト サポート技術情報 [810687](http://support.microsoft.com/kb/810687) で説明されているステップを行い、HTML ヘルプのショートカットを制限している場合、次の 「問題を緩和する要素」 が当てはまります。

    -   これらの脆弱性が悪用されても、攻撃者が選択したプログラムがユーザーのシステムに置かれることはありません。

    -   システムのファイルを呼び出すには、攻撃者はファイルの名前と場所を知っていることが必要条件となります。

    -   この脆弱性が悪用され、行われる操作は、ローカル実行可能ファイルの表示または呼び出しのみになります。これらの脆弱性により、任意または悪質なファイルの作成、削除、変更は行われません。

**深刻度 :**  

 
<table style="border:1px solid black;">
<thead>
<tr class="header">
<th style="border:1px solid black;" ></th>
<th style="border:1px solid black;" >Internet Explorer 5.01</th>
<th style="border:1px solid black;" >Internet Explorer 5.5</th>
<th style="border:1px solid black;" >Internet Explorer 6</th>
<th style="border:1px solid black;" >Internet Explorer 6 SP1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;"><strong>不正な</strong> <strong>PNG</strong> <strong>イメージファイルのバッファオーバーラン</strong></td>
<td style="border:1px solid black;">緊急</td>
<td style="border:1px solid black;">緊急</td>
<td style="border:1px solid black;">緊急</td>
<td style="border:1px solid black;">なし</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>エンコードされた文字列の情報漏えい</strong></td>
<td style="border:1px solid black;">警告</td>
<td style="border:1px solid black;">警告</td>
<td style="border:1px solid black;">警告</td>
<td style="border:1px solid black;">警告</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>フレームのクロスサイトスクリプティング</strong></td>
<td style="border:1px solid black;">重要</td>
<td style="border:1px solid black;">重要</td>
<td style="border:1px solid black;">重要</td>
<td style="border:1px solid black;">重要</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>インターネット一時ファイルの</strong><br />
<strong>フォルダ名の読み取り</strong></td>
<td style="border:1px solid black;">注意</td>
<td style="border:1px solid black;">注意</td>
<td style="border:1px solid black;">注意</td>
<td style="border:1px solid black;">なし</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>キャッシュされたメソッドを介す</strong><br />
<strong>クロスドメインの検証</strong></td>
<td style="border:1px solid black;">なし</td>
<td style="border:1px solid black;">重要</td>
<td style="border:1px solid black;">重要</td>
<td style="border:1px solid black;">重要</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>フレームの不適切なクロスドメインの</strong><br />
<strong>セキュリティ検証</strong></td>
<td style="border:1px solid black;">なし</td>
<td style="border:1px solid black;">重要</td>
<td style="border:1px solid black;">重要</td>
<td style="border:1px solid black;">なし</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>この累積的な更新プログラムにより排除される</strong><br />
<strong>すべての脆弱性の総合的な深刻度</strong></td>
<td style="border:1px solid black;">緊急</td>
<td style="border:1px solid black;">緊急</td>
<td style="border:1px solid black;">緊急</td>
<td style="border:1px solid black;">重要</td>
</tr>
</tbody>
</table>
  
上記の[評価](http://technet.microsoft.com/security/bulletin/rating)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。

  
**脆弱性識別番号 :**  
  
-   不正な PNG イメージ ファイルのエラー : [CAN-2002-1185](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1185)  
-   エンコードされた文字列の情報漏えい : [CAN-2002-1186](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1186)  
-   フレームのクロスサイト スクリプティング : [CAN-2002-1187](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1187)  
-   インターネット一時ファイルのフォルダ名の読み取り : [CAN-2002-1188](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1188)  
-   キャッシュされたメソッドを介すクロス ドメインの検証 : [CAN-2002-1254](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1254)  
-   フレームの不適切なクロス ドメインのセキュリティ検証 : [CAN-2002-1217](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1217)
  
**テストしたバージョン :**    
マイクロソフトは Internet Explorer バージョン 5.01 SP3、5.5 SP2、6 および 6 SP1 のテストを行い、これらの脆弱性による影響を評価しました。Internet Explorer 5.01 Service Pack 3 以前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていません。Internet Explorer 5.01 Service Pack 3 は Windows® 2000 のみでサポートされています。Windows Operating System Components Lifecycles に関する詳しい情報は <http://support.microsoft.com/gp/lifeselect> をご覧ください。

  
よく寄せられる質問  
------------------
  
<span></span>
**この累積的な更新プログラムはどのような脆弱性を排除しますか?**
  
この累積的な更新プログラムは、以前リリースされた Internet Explorer 用のすべての更新プログラムを含み、さらに、新たに報告された 6 つの脆弱性を排除します。

  
-   攻撃者がユーザーのシステムで任意のコードを実行する可能性のある脆弱性。  
-   ローカル システムに保存されている情報 (個人情報である場合もあります) が漏えいされる可能性のある脆弱性。  
-   攻撃者がユーザーのファイル システムの構成の情報、現在ログオンしているユーザーの名前を発見し、Cookie など、インターネット一時ファイルのフォルダに含まれている情報を読み取る可能性のある脆弱性。  
-   悪質な Web サイト オペレータが、ブラウザ ウィンドウで表示されるユーザーのローカル コンピュータにあるファイルを読み取る可能性のある脆弱性。（しかし、ファイルの変更はできません。） さらに、これらの脆弱性により、攻撃者にローカル システムに既に存在する実行可能ファイルを呼び出される可能性あります。

  
**この累積的な更新プログラムはそのほかのセキュリティ上の変更を含みますか?**
  
はい。この累積的な更新プログラムは [DirectX](http://www.microsoft.com/windows/directx/) (英語情報) ファイルを表示するためのレガシー コンポーネントが使用されないようにします。このコントロールは既定で Internet Explorer にインストールされません。通常、開発者やサポート プロフェッショナルのみにより使用されます。このコントロールは取り下げられ、現在サポートの対象となっていません。しかし、これがセキュリティ上の脆弱性を含むことが確認され、このコントロールを既にダウンロードしたお客様を保護するために、この累積的な更新プログラムはこのコンポーネントに [Killbit](http://support.microsoft.com/kb/240797) を設定することにより、このコントロールが実行される、またはユーザーのシステムに再導入されることを防ぎます。このコントロールに関する Killbit の詳細はサポート技術情報 [810202](http://support.microsoft.com/kb/810202) で説明されています。  
この累積的な更新プログラムは Internet Explorer 6 [Service Pack 1](http://www.microsoft.com/downloads/details.aspx?familyid=1e1550cb-5e5d-48f5-b02b-20b602228de6&displaylang=ja) で行われた変更も改善します。この変更とは、インターネット セキュリティ ゾーン内の Web ページがローカル コンピュータ ゾーンに移動することを防ぎます。この変更は新しいクロス ドメインの脆弱性が悪用された場合の影響を緩和するために導入されました。この累積的な更新プログラムで導入されている変更は、Internet Explorer 6 Service Pack 1 の制限をさらに向上させたものです。

  
**不正なPNGイメージファイルのバッファオーバーラン(CAN-2002-1185) :**  
**1番目の脆弱性でどのようなことが起こる可能性がありますか?**
  
これは[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。これにより、不正な PNG イメージ ファイルを表示すると Internet Explorer が任意のコードを実行する可能性があります。

  
**何が原因で起こりますか?**
  
PNG ファイルが開かれる時、パラメータをチェックする Internet Explorer の一部に未チェックのバッファが含まれるため、この脆弱性が起こります。

  
**PNGファイルとは何ですか?**
  
[PNG](http://www.libpng.org/pub/png/png.html) (英語情報) ファイルとは、グラフィック ファイルの種類です。PNGとは Portable Network Graphics の略です。PNG の仕様は [RFC 2083](http://www.ietf.org/rfc/rfc2083.txt) (英語情報) で定義されています。PNG ファイルは .png ファイル拡張子を持ちます。

  
**Internet ExplorerがPNGファイルを処理する方法の何が問題になっていますか?**
  
PNG ファイルが開かれる時、Internet Explorer が境界チェックを行う方法に問題が存在します。Internet Explorer は PNG ファイルで特定のパラメータについてこれらのチェックを適切に行いません。このため、バッファ オーバーランが起こります。オーバーフローの結果として、Internet Explorer が異常終了する可能性があります。

  
**この脆弱性により、攻撃者は何ができますか?**
  
この脆弱性により、攻撃者に Internet Explorer が異常終了させられ、攻撃者の選択によるコードが実行される可能性があります。

  
**なぜそのほかのマイクロソフト製品もこの脆弱性の影響を受けるのですか?**
  
いくつかのマイクロソフト製品 (例 : Microsoft Office、Index Server) は Internet Explorer に依存して PNGファイルをレンダリングします。結果として、これらの製品は Internet Explorer 自体が影響を受けるため、この脆弱性の影響を受けます。Internet Explorer の場合、これらの製品の 1 つを使用する不正な PNG ファイルを開くと、エラーが発生し、攻撃者の選択によるコードが実行される可能性があります。

  
**バッファオーバーランにより、攻撃者にシステムでコントロールを取得されることがよくありますが、この脆弱性の場合にも当てはまりますか?**
  
これはすべてのバッファ オーバーランに当てはまるわけではありません。この脆弱性について、マイクロソフトはこのバッファ オーバーランを調査しました。攻撃者がこの脆弱性を悪用し、任意のコードを実行し、システムでの制御を取得するメソッドは確認されていません。

  
**攻撃者はどのようにしてこの脆弱性を悪用する可能性がありますか?**
  
攻撃者は故意に不正な PNG ファイルを Web サイトにホストすることにより、この脆弱性を悪用する可能性があります。ユーザーがこのような Web サイトを訪問し、不正な PNG ファイルが存在する Web ページを表示する場合、Internet Explorer が異常終了し、任意のコードが実行される可能性があります。

  
**サーバーでIndex Serverを実行していますが、この累積的な更新プログラムを適用する必要がありますか?**
  
はい。ユーザーがサーバーにファイルをアップロードできるよう、サーバーが構成されており、Index Server を実行している場合、この更新プログラムを適用する必要があります。ユーザーが故意に不正な PNG ファイルをサーバーにアップロードすると、これにより Index Server が次回 PNG ファイルを索引する時に異常終了する可能性があります。これは、ユーザーが PNG ファイルを Web ページで表示するのではなく、PNG ファイルをダウンロードし、サーバーに置かなくてはならないため、ユーザーによる故意の操作です。

  
**この累積的な更新プログラムは何を修正しますか?**
  
この累積的な更新プログラムは、PNG ファイルが開かれる時、正しい境界チェックが行われるようにしてこの脆弱性を解決します。

  
**エンコードされた文字列の情報漏えい(CAN-2002-1186) :**  
**2番目の脆弱性でどのようなことが起こる可能性がありますか?**
  
これは情報漏えいの脆弱性です。ユーザーが攻撃者の Web サイトを訪問する場合、攻撃者はユーザーが訪問する別の Web サイトとのユーザーのセッションを盗み見る可能性があります。しかし、これにより攻撃者にユーザーがインターネットで訪問するすべての Web サイトが追跡されることはありません。この脆弱性は多くの制限を受けます。

  
-   ユーザーはまず、攻撃者の Web サイトを訪問し、次に別の Web サイトへの不正な URL を含むリンクに接続することが必要です。  
-   攻撃者は彼らの準備した Web サイトへのリンクをユーザーに強制的にクリックさせることはできません。  
-   攻撃者は別の Web サイトとのユーザーのセッションを盗み見ること以外はできません。攻撃者はユーザーが訪問するすべての Web サイトを調べることはできません。ユーザーがその後特定の Web サイトに戻ってきた場合、攻撃者はそのセッションを見ることはできません。  
-   攻撃者はどの情報をユーザーが別の Web サイトと共有するかを制御することはできません。これはユーザーが別の Web サイトと共有する情報に価値があるものかどうかによるため、攻撃による影響は状況により異なります。

  
**何が原因で起こりますか?**
  
Internet Explorer が URL を処理する方法に存在する問題のため、この脆弱性が起こります。特定のエンコードされた文字列が URL に含まれる場合、正しいセキュリティ チェックが無視されるため、Internet Explorer に問題が存在します。

  
**文字列のエンコードとは何ですか?**
  
文字列のエンコードとは数値を使用して文字列を表記するシステムです。エンコードは通常、すべての言語で表記されない文字列を表示するために使用されます。たとえば、新しいユーロ通貨記号 (€) は Unicode で "20AC" と表示されます。つまり、プログラムは、基礎となる文字列がそのプログラムにより表示されない場合でも、この文字を数値として処理することができます。Unicode とはエンコードを意味し、最も一般的なエンコード標準であり、「テキスト データを国際的に変換できる複数言語テキストをエンコードする一貫した方法」 を定義します。  
そのほかのエンコード形式はバイナリ、16 進数エンコードが含まれます。[RFC 1738](ftp://ftp.rfc-editor.org/in-notes/rfc1738.txt) で URL で許可されるエンコードされた文字列の種類を説明しています。

  
**Internet Explorerがエンコードを含むURLを処理する方法の何が問題になっていますか?**
  
Internet Explorer は通常、URL にエンコードされた文字が含まれているかどうかに関わらず、同じセキュリティ チェックを行います。しかし、Internet Explorer に問題が存在します。つまり、Internet Explorer は URL が特定のエンコードされた文字を含む場合、適切にこれらのチェックを行いません。

  
**これにより、攻撃者は何ができますか?**
  
この脆弱性により、攻撃者はユーザーが別の Web サイトと共有する情報を盗み見ることができる可能性があります。たとえば、ユーザーが攻撃者の Web サイト (サイト A) を訪問し、サイト A にある、サイト B へのリンクをクリックすると、攻撃者はサイト B とのユーザーのセッションを盗み見ることができる可能性があります。つまり、攻撃者はユーザーがサイト B と共有する情報 (個人情報も含まれます) を見る可能性があります。

  
**どのような情報が攻撃者に漏れる可能性がありますか?**
  
確実には言えませんが、ユーザーが通常 Web サイトに提供する情報は名前、住所、生年月日、クレジット カード情報など、個人を特定するために使用される情報が含まれます。また、これらよりも重要でない情報、好きな色、出身地、現在住んでいる市なども含まれます。

  
**この脆弱性により、攻撃者はインターネットでユーザーを「追う」ことができますか?**
  
いいえ、できません。この脆弱性が悪用されても、攻撃者は攻撃者の Web サイトからリンクされている Web サイトまでユーザーを追うのみにとどまります。たとえば、ユーザーが攻撃者の Web サイト (サイト A) を訪問し、不正なサイト A からサイト B に移動すると、攻撃者はユーザーをサイト B まで追うことができます。しかし、ユーザーが新しい Web ブラウザ ページを開き、サイト C に移動する、またはサイト B からのリンクをクリックし、サイト C に移動する場合、攻撃者はユーザーをサイト C まで追うことはできません。  
さらに、ユーザーが攻撃者の Web サイトにあるリンクを使用してサイト B に移動するのではなく、直接サイト B に移動する場合、攻撃者はサイト B とのユーザーのセッションを盗み見ることはできません。

  
**それでは、ユーザーが特定のWebサイトを訪問する都度、攻撃者はそのWebサイトとのユーザーのセッションを盗み見ることはできないのですか?**
  
はい。ユーザーがサイト B に接続するサイト A のリンクをクリックする場合、攻撃者は Web サイト B とのセッションのみを盗み見ることができます。ユーザーが Web サイト B とのセッションを終了し、後にその Web を直接訪問する場合、攻撃者はこの新しいセッションを盗み見ることはできません。

  
**それでは攻撃者ができることには多くの制限があるのですか?**
  
はい。多くの制限があります。

  
-   ユーザーが攻撃者の Web サイトを訪問するだけでなく、攻撃者の Web サイトから別の Web サイト (サイト B) へのリンクを追うことが必要となります。  
-   サイト B はユーザーが訪問したい Web サイトである必要があります。攻撃者はユーザーに強制的にサイト B を訪問させることはできません。  
-   ユーザーが直接サイト B に移動する場合、攻撃者はユーザーのセッションを盗み見ることはできません。  
-   攻撃者はシステムでデータの追加、変更、削除、スクリプトの実行など、任意の操作を行うことはできません。  
-   ユーザーは攻撃者のリンクを追い、サイト B に移動し、次に別の Web サイトを訪問する場合、攻撃者はその別の Web サイトまでユーザーを追うことはできません。  
-   ユーザーが後に直接サイト B に戻る場合、攻撃者はこのセッションを盗み見ることはできません。

  
**攻撃者はどのようにしてこの脆弱性を悪用する可能性がありますか?**
  
攻撃者がこの脆弱性を悪用する場合、次を行うことが必要となります。

  
-   Web サイト (サイト A) を作成します。この Web サイトには別の Web サイト (サイト B) への不正な URLを含むハイパーリンクがあります。サイト B はユーザーが普通に訪問することを選択する Web サイトである必要があります。  
-   攻撃者は次にユーザーをサイト A を訪問するよう誘導することが必要となります。  
-   ユーザーがサイト A を訪問すると、攻撃者はユーザーにサイト B へのリンクを追うよう誘導する必要があります。  
-   ユーザーがサイト B への URL をクリックすると、攻撃者はサイト B とのユーザーのセッションを盗み見ることができます。

  
**この累積的な更新プログラムは何を修正しますか?**
  
この累積的な更新プログラムは、新しい Web ページがこれらのエンコードされた文字列を含む URL を使用して開かれた時、正しいセキュリティ チェックが行われるようにします。

  
**インターネット一時ファイルのフォルダ名の読み取り(CAN-2002-1188) :**  
**3番目の脆弱性でどのようなことが起こる可能性がありますか?**
  
この脆弱性により、攻撃者にインターネット一時ファイルのフォルダへのパスを識別される可能性があります。これにより、攻撃者はログオン ユーザー名などのユーザーの情報やCookie などのインターネット一時ファイルのフォルダ内に含まれる情報を見つける可能性があります。

  
**何が原因で起こりますか?**
  
オブジェクト タグが使用されている場合、Internet Explorer は正しいセキュリティ チェックを行わないため、この脆弱性が起こります。この結果、オブジェクト タグが悪用され、インターネット一時ファイルのフォルダの名前が読み取られる可能性があります。

  
**インターネット一時ファイルのフォルダとは何ですか?また、それらはどのような用途に使用されますか?**
  
インターネット一時ファイルのフォルダとは Web ページおよびファイル (グラフィックなど) が、ユーザーが表示したようにキャッシュされるハード ディスクの場所です。これにより、頻繁に訪れる、またはすでに閲覧した Web ページの表示を迅速にすることができます。この理由は Internet Explorer は Web ページを Web サイトからではなく、ユーザーのハード ディスクから開くことができるためです。このキャッシュが予期されない場所に保存されるようにする上で、わかりにくくすることは重要な役割を果たします。仕様上、Web サイトが Web ページの物理的な場所を知っている場合、その Web サイト オペレータは Web サイトを訪問するユーザーについてさらに情報を得ることができる可能性があります。キャッシュは Web サイトがこの情報を知ることを防ぎ、Web サイトに Internet Explorer のセキュリティ モデルに送信するようにします。

  
**Internet Explorerがオブジェクトタグを処理する方法の何が問題になっていますか?**
  
通常、オブジェクト タグが使用されると、Internet Explorer は多くのセキュリティ チェックを行い、必要な操作が許可されていることを確認します。しかし、オブジェクト タグが使用されるある状況で、Internet Explorer はこれらのセキュリティ チェックを正しく行いません。つまり、セキュリティ チェックが無視されます。

  
**攻撃者はなぜインターネット一時ファイルのフォルダの場所を知る必要があるのですか?**
  
ユーザーが Web ページを表示する場合、上記で説明した理由により、既定でその Web ページはインターネット一時フォルダのファイルのキャッシュにキャッシュされます。通常、Internet Explorer のみがキャッシュの場所を知っている必要がありますが、攻撃者がそのパスを知っている場合、攻撃者はこれを悪用し、ユーザーの情報をさらに知ることができます。

  
**この脆弱性により、攻撃者は何ができますか?**
  
この脆弱性により、攻撃者にインターネット一時ファイルのフォルダの名前を読み取られる可能性があります。攻撃者はこれを悪用し、ユーザー名などのログオンしているユーザーの情報を取得し、Cookie のデータなどのインターネット一時ファイルのフォルダ内の情報を読み取る可能性もあります。

  
**攻撃者はどのようにしてこの脆弱性を悪用する可能性がありますか?**
  
攻撃者は特定の方法でオブジェクト タグを使用し、別の Web ページを開く Web サイトを作成することにより、この脆弱性を悪用する可能性があります。ユーザーが攻撃者の Web サイトを訪問し、この Web ページを表示すると、別の Web ページが開かれます。攻撃者はこのオブジェクト タグを含む別の Web ページのスクリプトを使用し、インターネット一時ファイルのフォルダの名前を読み取ることができる可能性があります。

  
**攻撃者はどのような情報を取得する可能性がありますか?**
  
この脆弱性により、攻撃者はログオンしているユーザーのユーザー名を知る可能性があります。また、攻撃者はインターネット一時ファイルのフォルダ内で予測可能な名前を使用する Cookie から情報を読み取る可能性があります。しかし、これは攻撃者にとって複雑です。この理由は Cookie は通常予測不可能な名前を持ち、インターネット一時ファイルのフォルダ内の多くの異なる場所に保存されるためです。攻撃者は Cookie を特定するため、これらの場所を個別にチェックすることが必要となります。

  
**Cookieとは何ですか?**
  
Cookie とはユーザーのローカル システムに保存されているデータ ファイルです。これらの構成、内容の形式は自由です。Web サイトは選択したすべての情報を Cookie に保存することができます。しかし、情報は常にクリア テキストで渡されるため、機密性の高い個人情報を Cookie に保存すべきではないことは広く認識されています。

  
**この累積的な更新プログラムは何を修正しますか?**
  
この累積的な更新プログラムは、正しいセキュリティ チェックが行われるようにして、Internet Explorer のセキュリティ モデルを無視するオブジェクト タグを使用するメソッドを防止します。

  
**キャッシュされたメソッドを介すクロスドメインの検証(CAN-2002-1254)、フレームのクロスサイトスクリプティング(CAN-2002-1187)、およびフレームと不適切なクロスドメインのセキュリティ検証(CAN-2002-1217) :**  
**これらの脆弱性でどのようなことが起こる可能性がありますか?**
  
これらの脆弱性は 3 つの異なる問題ですが、その影響と影響を及ぼす範囲は本質的には同じです。これらの脆弱性により、悪質な Web サイト オペレータは別のインターネット ドメインまたはユーザーのローカル システムの情報にアクセスする可能性があります。最悪の場合、攻撃者が悪質な実行可能ファイルをシステムに読み込む、またはすでにユーザーのシステムに存在する実行可能ファイルを起動する可能性があります。  
マイクロソフト サポート技術情報 [810687](http://support.microsoft.com/kb/810687) に説明されているステップを行い、HTML ヘルプのショートカットを制限している場合、この脆弱性による影響は大幅に削減されます。これらの脆弱性が悪用されても、攻撃者が選択したプログラムがシステムに提供されることはありません。攻撃者がプログラムを呼び出すには、そのプログラムがシステムに存在していることが必要条件となります。また、攻撃者により実行可能なプログラムにパラメータが渡されることはありません。

  
**何が原因で起こりますか?**
  
Web ページで 3 つの異なるプログラミング機能が使用される場合、Internet Explorer のクロスドメイン のセキュリティ モデルを無視することができるため、この脆弱性が起こります。

  
**「Internet Explorerの「クロスドメインのセキュリティモデル」とは何ですか?**
  
ブラウザの主なセキュリティ機能の 1 つは、同じ Web サイトからのブラウザ ウィンドウが互いに対話できるようにする一方、異なる Web サイトが管理するブラウザ ウィンドウが互いに干渉しないようにする、または互いのデータにアクセスしないようにすることです。協力するブラウザ ウィンドウと協力しないブラウザ ウィンドウを区別するために、「ドメイン」 という概念が作られました。ドメインとはセキュリティの境界です。同じドメイン内で開かれているウィンドウは互いに対話することができますが、別のドメインからのウィンドウはできません。「クロスドメインのセキュリティ モデル」 とは別のドメインからのウィンドウが互いに干渉しないようにするセキュリティ アーキテクチャの一部です。  
ドメインの最も簡単な例は Web サイトに関連しています。たとえば、ユーザーが www.microsoft.com を訪問し、www.microsoft.com/security へのウィンドウを開くとします。2 つのウィンドウは同じドメインである www.microsoft.com に属しているため、互いに対話することができます。しかし、ユーザーが www.microsoft.com を訪問し、別の Web サイトへのウィンドウを開く場合、クロスドメインのセキュリティ モデルにより、2 つのウィンドウは互いに保護されます。この概念はさらに進みます。たとえば、ユーザーのローカル コンピュータのファイル システムもまたドメインです。このため、たとえば www.microsoft.com がウィンドウを開き、ユーザーにそのユーザーのハード ドライブのファイルを表示することもできます。しかし、ユーザーのローカル ファイル システムはその Web サイトとは別のドメインに存在するため、クロスドメインのセキュリティ モデルは、その Web サイトが表示されているファイルを読み取らないようにする必要があります。  
Internet Explorer のドメインのセキュリティ モデルは Internet Explorer のインターネット セキュリティ ゾーンの設定を使用するように構成することができます。

  
**Internet Explorerのセキュリティゾーンとは何ですか?**
  
Internet Explorer の [セキュリティ ゾーン](http://support.microsoft.com/kb/174360)とはオンライン コンテンツをカテゴリ、またはその信頼度に基づいたゾーンに分類するシステムです。特定の Web ドメインは、各ドメインのコンテンツがどの程度信頼されているかにより、ゾーンに割り当てられます。そしてゾーンは Web コンテンツの権限をそのゾーンの設定に基づき制限します。  
既定で、ほとんどのインターネット ドメインはスクリプトやそのほかのアクティブなコードがローカル マシンのリソースにアクセスすることを防ぐ設定を持つインターネット ゾーンの一部として取り扱われます。一方、ローカル コンピュータ ゾーンはさらに制限の少ないゾーンで、コンテンツがローカル システムのコンテンツへのアクセスや操作を行うことができます。既定で、ローカル コンピュータに保存されているファイルはローカル コンピュータ ゾーンで実行されます。

  
**Internet Explorerがクロスドメインのセキュリティを計算する方法の何が問題になっていますか?**
  
Internet Explorer は、ある Web ページが別のセキュリティ ゾーンのリソースへのアクセスをリクエストする時、セキュリティを評価します。しかし、3 つの異なるプログラミング機能が使用されている場合のセキュリティが計算される方法に 3 つの問題が存在します。この結果、攻撃者はセキュリティ チェックを無視することができます。これらのすべての問題は微妙に異なりますが、影響は同じです。

  
**これらの脆弱性により、攻撃者は何ができますか?**
  
攻撃者はこの脆弱性を悪用し、攻撃者が別のドメインのデータにアクセスすることができる Web ページを作成する可能性があります。これには、攻撃者がフル パスおよびファイル名を知っている場合、ユーザーまたはオペレーティング システムにより使用されていないローカル システムのファイルの読み取りなどが含まれます。また、ユーザーが別の Web サイトと共有するデータへのアクセスも含まれます。攻撃者はユーザーのローカル ファイル システムの実行可能ファイルを呼び出す、またはユーザーのシステムに悪質な実行可能ファイルを読み込む可能性もあります。

  
**攻撃者はこれらの脆弱性をどのように悪用する可能性がありますか?**
  
攻撃者は悪質な Web ページを作成し、ユーザーにその Web ページを訪問するよう誘導することにより、これらの脆弱性を悪用する可能性があります。またはそのような人物からの HTML 形式のメールを開くことが必要条件となります。（HTML 形式のメールの場合には、Outlook 6 または Outlook 2002 を既定の構成で使用するか、またはOutlook 電子メール セキュリティ アップデートをインストールしたOutlook 98 または 2000を使用しているお客様には危険は及びません）ユーザーが Web ページを訪問すると、攻撃者は別のブラウザに別の Web サイトを開かせ、この時点で攻撃者はユーザーと同じ別の Web ページへのアクセスを取得します。また、攻撃者は、ユーザーにより表示されると、ユーザーのローカル システムに既に存在する実行可能ファイルを起動する Web ページを作成する可能性があります。

  
**攻撃者はこれらの脆弱性を悪用し、攻撃者のWebサイトまたはサーバーからユーザーのマシンにプログラムを読み込むことはできますか?**
  
はい、できます。しかし、マイクロソフトはサポート技術情報 [810687](http://support.microsoft.com/kb/810687) を公開し、HTML ヘルプのショートカットを制限するレジストリ キー設定について説明しています。このレジストリ キーを設定すると、攻撃者がユーザーのシステムに悪質な実行可能ファイルを読み込むことができなくなり、攻撃者がユーザーのシステムに既に存在している実行可能ファイルを呼び出すことを制限します。

  
**この累積的な更新プログラムは何を修正しますか?**
  
この累積的な更新プログラムは、これらの脆弱性の影響を受けるプログラミング機能が使用されている場合、正しいクロス ドメインのセキュリティ チェックが行われるようにして、これらの脆弱性を解決します。

  
**この更新プログラムにはMS02-009に対する修正が含まれていますか?**
  
いいえ、含まれていません。[MS02-009](http://technet.microsoft.com/security/bulletin/ms02-009) に対する修正は、VBScript の更新プログラムです。MS02-009 に対する修正は、累積的な更新プログラムよりも広範囲の修正が含まれる Internet Explorer の次回のサービス パックに含まれる予定です。(Internet Explorer 6 SP1 には、MS02-009 に対する修正は含まれています。)
  
更新プログラム  
--------------
  
<span></span>
この問題に対する修正は、MS02-068 以降の累積的な更新プログラムに含まれました。最新の累積的な更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/) または、[こちら](http://go.microsoft.com/fwlink/?linkid=16266&clcid=0x411)の Web サイトから入手できます。

  
-   Windows 2000 で Internet Explorer **5.01** をお使いのお客様におかれましては、この問題に対する Internet Explorer **5.01** 用の修正は Windows 2000 Service Pack 4 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。  
    <http://www.microsoft.com/japan/windows2000/downloads/>
-   なお、個別の更新プログラムは、次のサイトからダウンロードできます。  
    [http://www.microsoft.comhttp://www.microsoft.com/downloads/results.aspx?pocId=&freetext=328970&DisplayLang=ja](http://www.microsoft.com/downloads/results.aspx?pocid=&freetext=328970&displaylang=ja)
  
#### 更新プログラムに関する追加情報
  
**対象プラットフォーム :**  
  
-   Internet Explorer 5.01 用の更新プログラムは Internet Explorer 5.01 Service Pack 3 を適用している Windows 2000 システムにインストールすることができます。Internet Explorer Service Pack 3 を適用していないユーザーは、Service Pack 3 をインストールしてから、本更新プログラムを適用してください。  
-   Internet Explorer 5.5 用の更新プログラムは Internet Explorer 5.5 Service Pack 2 を実行しているシステムにインストールすることができます。Internet Explorer 5.5 Service Pack 2 を適用していないユーザーは、Service Pack 2 をインストールしてから、本更新プログラムを適用してください。  
-   Internet Explorer 6 用の更新プログラムは Internet Explorer 6 または [Service Pack 1](http://www.microsoft.com/downloads/details.aspx?familyid=1e1550cb-5e5d-48f5-b02b-20b602228de6&displaylang=ja) を実行しているシステムにインストールすることができます。64 bit 版 Internet Explorer 6 をお使いのお客様は、Internet Explorer 6 Service Pack 1 にアップグレードしてから本更新プログラムを適用してください。

  
**再起動の必要性 :**    
あり
  
**更新プログラムのアンインストール :**    
不可
  
**更新プログラムに含まれる過去の修正 :**    
この累積的な更新プログラムは、マイクロソフト セキュリティ情報 [MS02-047](http://technet.microsoft.com/security/bulletin/ms02-047) で提供された累積的な更新プログラムを含みます。

  
**更新プログラムが正しくインストールされたかどうか確認する方法 :**  
  
-   この累積的な更新プログラムがマシンにインストールされたことを確認するためには、Internet Explorer を起動し、\[ヘルプ\] から Internet Explorer の \[バージョン情報\] をクリックし、\[更新バージョン\] フィールドに Q328970 が表示されていることを確認して下さい。  
-   各ファイルを確認するためには、サポート技術情報 [328970](http://support.microsoft.com/kb/328970) のファイル欄を参照して下さい。

  
**警告 :**  
なし
  
**他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。 :**  
  
-   セキュリティ更新プログラムは[マイクロソフト ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード探索によって容易に見つけることができます。  
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

  
更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)
  
### その他の情報
  
**詳細情報 :**  
  
-   US マイクロソフトセキュリティ情報（MS02-066）  
    [http://www.microsoft.com/technet/security/bulletin/ms02-066.mspx](http://technet.microsoft.com/security/bulletin/ms02-066)  
-   サポート技術情報 （KB） 文書番号 ： 328970  
    [\[IE\] \[MS02-066\] 2002 年 11 月 Internet Explorer 用の累積的な修正プログラム](http://support.microsoft.com/kb/328970)
  
**謝辞 :**    
「不正な PNG イメージ ファイルのエラー」の問題を連絡し、顧客の保護に協力して下さった [eEye Digital Security](http://www.eeye.com/) に対し、マイクロソフトは深い[謝意](http://technet.microsoft.com/security/bulletin/policy)を表します。

  
**更新履歴 :**  
  
-   2002/11/21: このセキュリティ情報ページを公開しました。  
-   2002/11/26: マイクロソフト サポート技術情報 (KB) 810687 に関する情報を追加しました。  
-   2002/11/27: この問題に対する日本語版 KB を公開しました。  
-   2002/12/16: このセキュリティ情報の深刻度を更新し、「PNG イメージ ファイル」 の脆弱性に関する新しい追加情報を記載しました。

  
本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

  
*Built at 2014-04-18T01:50:00Z-07:00*
