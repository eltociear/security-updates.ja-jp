---
TOCTitle: 'MS02-010'
Title: 'マイクロソフト セキュリティ情報 MS02-010 - 緊急'
ms:assetid: 'ms02-010'
ms:contentKeyID: 61228435
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-010(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS02-010 - 緊急
===============================================

ISAPI フィルタの未チェックのバッファにより、Commerce Server が攻撃を受ける
--------------------------------------------------------------------------

公開日: 2002年2月22日 | 最終更新日: 2002年2月27日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Commerce Server 2000 を使用しているシステム管理者

**脆弱性の影響** **:**
攻撃者の任意のコードが実行される

**最大深刻度** **:**
高

**推奨する対応策** **:**
システム管理者は直ちにこの更新プログラムをインストールしてください。

**影響を受けるソフトウェア** **:**

-   Microsoft Commerce Server 2000

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
Commerce Server 2000 の既定では、サーバーのイベントを処理し拡張機能を提供する ISAPI フィルタが DLL としてインストールされます。認証フィルタ (AuthFilter) と呼ばれるこの ISAPI フィルタは、さまざまな認証方法を提供します。Commerce Server 2000 は、ISAPI フィルタを使用しない他の認証方法を使用するように構成することができます。
このセキュリティ上の脆弱性は、認証フィルタで特定の種類の認証リクエストを処理するコードに未チェックのバッファが含まれるために発生します。攻撃者はバッファをあふれさせる認証データを与えることで、Commerce Server プロセスを異常終了させる、または Commerce Server プロセスのセキュリティ コンテキストでコードを実行することができます。また、このプロセスは LocalSystem 特権で動作するため、この脆弱性は攻撃者にサーバーの完全な制御を与えます。

**問題を緩和する要素** **:**

-   Commerce Server 2000 は、ベースとなる Web サービスとして Internet Information Server に依存しますが、認証フィルタ (ISAPI フィルタ) は Commerce Server の一部としてのみ利用可能です。Internet Information Server のみを使用しているお客様は、この脆弱性による危険性はありません。
-   [URLScan ツール](http://technet.microsoft.com/ja-jp/security/cc242650.aspx)を Commerce Server の既定のルールセットを使用して展開した場合、URL に含むことができるデータの種類を大幅に制限することによって、攻撃者がこの脆弱性を利用することができる場合でも、コードの実行が困難になる可能性があります。しかし、その場合でもサービス拒否の攻撃を仕掛けることができる可能性があります。
-   攻撃者が、攻撃された Web サーバーからほかのマシンに制御の範囲を広げることができるか否かは、ネットワークの設定に大きく依存します。最善策として、DMZ などの手段を使用して全体のリスクを軽減し、また最低限のサービスで実行し、内部ネットワークとの接触を分離することにより、ネットワーク アーキテクチャがインターネットなど、制御されていない環境にあるマシンが受ける潜在的な高いリスクを抑えることが推奨されます。これらのステップにより、全体の危険性が制限され、攻撃者が攻撃の可能性の範囲を広げるのを防ぐことができます。
-   ISAPI フィルタは既定でインストールされますが、すべての Web サーバーには既定でロードされません。ISAPI フィルタは Microsoft 管理コンソール (MMC) の Commerce Server マネージャを使用して有効にする必要があります。

**深刻度** **:**

|                                    | インターネット サーバー | イントラネット サーバー | クライアント システム |
|------------------------------------|-------------------------|-------------------------|-----------------------|
| **Microsoft Commerce Server 2000** | 高                      | 高                      | なし                  |

上記の[評価](http://technet.microsoft.com/security/bulletin/rating)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形態およびこの脆弱性がシステムに及ぼす影響に基づいています。この脆弱性により、オペレーティング システムのセキュリティ コンテキストで、コードをリモートで実行できる可能性があるため、深刻度が上記のようになっています。

**脆弱性識別番号** **:**
[CAN-2002-0050](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0050)

**テストしたバージョン** **:**
マイクロソフトは Commerce Server 2000、Site Server 3.0 および Site Server 3.0 Commerce Edition のテストを行い、これらの脆弱性による影響を評価しました。それより前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**どのようなことが起こる可能性がありますか?**

この脆弱性の利用に成功した攻撃者は、影響を受ける Commerce Web サーバーを完全に制御できるようになる可能性があります。これにより攻撃者は、そのサーバー上で、Web ページの変更、ハード ドライブの再フォーマット、またはローカル管理者グループに新しいユーザーの追加などを含む任意の操作を実行することができるようになります。
この脆弱性は、Microsoft Commerce Server を使用する Web サーバーのみに影響を及ぼします。Internet Information Services を使用する Web サーバー には危険性はありません。また、推奨されるツールをサーバーに適用した場合、この脆弱性の深刻性は、大幅に軽減されます。具体的には、[URLScan](http://technet.microsoft.com/ja-jp/security/cc242650.aspx) ツールを使用している場合、この脆弱性はサービスを異常終了させるために利用されるのみで、その後、自動的に再起動します。URLScan ツールは既定でインストールされません。

**何が原因で起こりますか?**

この脆弱性は、Commerce Server 2000 上でユーザー認証をサポートする ISAPI フィルタに未チェックのバッファが含まれるために発生します。攻撃者は不正な認証情報を与えることによって、バッファのオーバーランの状況を作りだすことができます。

**Microsoft Commerce Server** **とは何ですか?**

[Commerce Server](http://www.microsoft.com/japan/commerceserver/) は、E コマース サイトを作成するために設計された Web サーバー製品です。Commerce Server により、E コマース ソリューションを容易に設計、展開することができるツールと機能が提供され、そのツールにより、サイト管理者はサイトの使用状況を分析することができます。

**Commerce Server** **は** **Internet Information Server** **とは違うのですか?**

はい、違います。Commerce Server は Internet Information Services (IIS) を使用して基本的な Web サーバーの機能だけでなく、その他の機能を提供します。このケースの重要な点は、この脆弱性が IIS ではなく Commerce Server 2000 のコンポーネントによって発生するということです。このため、IIS サーバーはこの脆弱性の危険性はありません。

**ISAPI** **フィルタとは何ですか?**

ISAPI (Internet Services Application Programming Interface) は、開発者が Web サーバーに提供される機能を拡張することができるようになる技術です。[ISAPI フィルタ](http://msdn2.microsoft.com/en-us/library/ms524610.aspx) （英語情報） は ISAPI を使用して、サーバーで起こるイベントに対応するダイナミック リンク ライブラリ (DLL) です。

**ISAPI** **フィルタはこの脆弱性とどのような関連性がありますか?**

この脆弱性は、[認証フィルタ](http://www.microsoft.com/japan/developer/library/comsrv2k/cs_sp_security_ykgk.htm) （ISAPI フィルタ） 内に存在します。認証フィルタは様々な認証方法をサポートします。これらの方法のいくつかの認証データを持つコードに未チェックのバッファが含まれるためにこの脆弱性が発生します。

**この脆弱性を利用して攻撃者は何ができますか?**

この脆弱性により、攻撃者は認証フィルタ内にバッファのオーバーランを発生させるデータを与えることによって、Commerce Server プロセス自体のメモリを上書きすることができます。

**これにより攻撃者は何ができますか?**

攻撃者が選択したデータの種類によって、以下の 2 つの結果が発生する可能性があります。

-   データがランダムに選択されたものである場合、Commerce Server プロセスが異常終了します。
-   データが綿密に選択されたものである場合、攻撃者は Commerce Server ソフトウェアの実行中に、それを変更することができます。

**攻撃者がランダム データを送信した場合、通常の操作を回復するためには何が必要ですか?**

何もする必要はありません。Commerce Server プロセスは、自動的に再起動します。しかし、攻撃された際に進行中であったユーザー セッションはすべて失われる可能性があります。

**攻撃者が綿密に選択したデータを送信し、Commerce Server** **プロセスを変更した場合、その変更されたプロセスで何をすることができますか?**

変更されたプロセスにより、攻撃者が指定したすべての操作を実行することができます。Commerce Server プロセスは LocalSystem 特権で動作するため、攻撃者はサーバーを完全に制御することができるようになり、そのサーバー上ですべての任意の操作を実行することができます。

**この脆弱性は偶発的に利用される可能性はありますか?**

いいえ。Web サイトの認証データは、ほとんどが Web フォームを介して提出されます。Web フォームは適切に実装されている場合、この脆弱性を利用するために使用されるようなデータをフィルタします。 (Commerce Server 2000 に同梱されているサンプルの Web フォームにより、このフィルタリングの方法が示されています。） この脆弱性は、攻撃者がすべての Web フォームを無視し、不正な認証データを直接サーバーに送信した場合にのみ利用される可能性があります。

**認証フィルタは既定でインストールされますか?**

はい、インストールされます。これは適切な既定の設定です。その理由は E コマース サイトは実質的に認証サポートが常に必要になるためです。
Commerce Server 2000 は、ほかの認証方法も使用できるように設定することができます。ほかの認証方法が使用される場合、そのシステムはこの脆弱性による影響を受けません。

**URLScan** **ツールをサーバーにインストールしました。この脆弱性による攻撃を防ぐことができますか?**

既定で、[URLScan](http://technet.microsoft.com/ja-jp/security/cc242650.aspx) は、攻撃者がこの脆弱性を利用してサーバーを制御することを防ぎます。これは、Commerce Server の既定のルールセットにより、ある種類のデータが禁じられているためです。このルールセットがない場合、Commerce Server プロセスを変更して、重要な操作を実行することができなくなる可能性があります。一方、URLScan がインストールされている場合でも、攻撃者は Commerce Server プロセスを異常終了させることができる可能性があります。したがって、URLScan を使用しているお客様も更新プログラムを適用する必要があります。

**この脆弱性はどのように発見されましたか?**

マイクロソフトは社内でセキュリティ コード レビュー中に、この脆弱性を発見しました。

**この更新プログラムを既に適用しているサイトがあると聞きました。本当ですか？**

はい。マイクロソフトはこの脆弱性よって特に危険にさらされるサイトを所有する少数のお客様と連絡を取り、更新プログラムを提供し、このセキュリティ情報がリリースされる前にシステムを保護する機会を提供しました。

**Site Server 3.0 Commerce Edition** **を実行しています。この脆弱性の影響を受ける可能性がありますか?**

いいえ、ありません。Site Server 3.0 および Site Server 3.0 Commerce Edition は Commerce Server 2000 の旧バージョンで、この脆弱性による影響はありません。

**更新プログラムは何を修正しますか?**

この更新プログラムは、認証フィルタ （ISAPI フィルタ） 内のバッファ処理を適切に行うように修正し、この脆弱性を排除します。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft Commerce Server 2000
    [http://www.microsoft.com/downloads/details.aspx?FamilyId=A00F2E9F-2FF4-4FBD-9A90-9F28640DBD26&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=a00f2e9f-2ff4-4fbd-9a90-9f28640dbd26&displaylang=ja)

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**

-   Commerce Server 2000の更新プログラムは Commerce Server 2000 [Service Pack 2](http://www.microsoft.com/downloads/details.aspx?familyid=50602a7b-f2ea-4320-bcd1-2aca9d63759c&displaylang=ja) を実行しているシステムにインストールすることができます。

**この修正を含む予定のサービス パック** **:**

-   Commerce Server 2000 の に対する更新プログラムは Commerce Server 2000 [Service Pack 3](http://www.microsoft.com/japan/commerceserver/downloads/2000/sp3.mspx) に含まれています。

**再起動の必要性** **:**
あり

**更新プログラムに含まれる過去の修正** **:**
なし

**更新プログラムが正しくインストールされたか確認する方法** **:**

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Commerce Server 2000\\SP3\\Q317615
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Commerce Server 2000\\SP3\\Q317615\\Filelist

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-010）
    [http://www.microsoft.com/technet/security/bulletin/ms02-010.mspx](http://technet.microsoft.com/security/bulletin/ms02-010)
-   サポート技術情報 （KB） 文書番号 ： 317615
    [\[CS2000\]MS02-010:認証フィルタの未チェックのバッファによって Commerce Server が攻撃を受ける](http://support.microsoft.com/kb/317615)

**更新履歴** **:**

-   2002/2/22: このセキュリティ情報ページを公開しました。
-   2002/2/23: このセキュリティ情報ページを更新し、Commerce Server 2000 用の更新プログラムが入手可能になったことをお知らせしました。
-   2002/2/27: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
