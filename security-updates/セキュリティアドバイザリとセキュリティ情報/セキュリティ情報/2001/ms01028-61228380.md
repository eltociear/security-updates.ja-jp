---
TOCTitle: 'MS01-028'
Title: 'マイクロソフト セキュリティ情報 MS01-028 - 緊急'
ms:assetid: 'ms01-028'
ms:contentKeyID: 61228380
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms01-028(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS01-028 - 緊急
===============================================

テンプレートにリンクしている RTF 文書が警告なしでマクロを実行する
-----------------------------------------------------------------

公開日: 2001年5月22日 | 最終更新日: 2001年7月11日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Word for Windows または Word for Mac を使用しているお客様

**脆弱性の影響** **:**
警告なしでマクロが実行される

**推奨する対応策** **:**
影響を受ける Word のバージョンを使用しているお客様はこの更新プログラムを適用して下さい。

**影響を受けるソフトウェア** **:**

-   Microsoft Word 97
-   Microsoft Word 2000
-   Microsoft Word 98 (日本語版)
-   Microsoft Word 98 Macintosh Edition
-   Microsoft Word 2001 for Mac

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
他の Office ファミリー製品のように Word はマクロを実行する際にユーザーの承諾を必要とするセキュリティ メカニズムを提供しています。仕様上、文書が開かれる時には、その文書にマクロが含まれている場合、ユーザーに警告します。さらに、このメカニズムは元の文書がリンクしているテンプレートなどの二次的な文書をチェックします。そして、マクロが含まれている場合は警告します。この機能は文書やテンプレートにマクロが含まれているかどうかをスキャンし、含まれている場合にはユーザーに警告します。そしてユーザーにマクロを実行するかどうかを確認します。
攻撃者がテンプレートにマクロを埋め込み、これにリンクする RTF文書を他のユーザーに提供すると、RTF 文書が開かれる時に自動的にマクロが実行される可能性があります。このマクロはユーザーが実行可能な任意の操作を行うことができます。このためユーザーの Word のセキュリティ設定を無効にし、開かれた Word 文書でマクロのチェックが行われなくなることがあります。

**問題を緩和する要素** **:**

-   この脆弱性は Word だけに影響を及ぼします。他の Office 製品は影響を受けません。
-   この脆弱性は Word 文書が開かれる場合には発生しません。テンプレートにリンクしている RTF 文書が開かれる場合のみ発生します。

**脆弱性識別番号** **:**
[CAN-2001-0240](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0240)

**テストしたバージョン** **:**
マイクロソフトは Word 2000、Word 97、Word 98 （日本語版）、Word 98 Macintosh Edition、Word 2001 for Mac のテストを行い、この脆弱性による影響を評価しました。Microsoft Word 2002 はこの脆弱性の影響を受けません。それより前のバージョンに関してはサポートしておらず、この脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**どのようなことが起こる可能性がありますか?**

この脆弱性により攻撃者は、Word 文書が開かれる際にユーザーの承諾を得ないでマクロを実行することができます。マクロはユーザーが実行できる操作の全てを実行することができ、この脆弱性によって攻撃者は、データの改ざん、Web サイトとの通信、ハードディスクの再フォーマット、Word セキュリティ設定の変更等の操作ができる可能性があります。
この脆弱性は Word だけに影響を及ぼします。他の Office 製品は影響を受けません。また、影響があるのはリッチ テキスト形式の文書が開かれた場合のみです。この脆弱性は Word 文書を開く際には発生しません。また、Office XP に同梱されるバージョンの Word 2002 にはこの脆弱性はありません。

**何が原因で起こりますか?**

この脆弱性は、Word テンプレートにリンクしているリッチ テキスト形式の文書を開く際に、Word がテンプレートに組み込まれているマクロのチェックをしないために発生します。

**リッチ テキスト形式とは何ですか?**

[リッチ テキスト形式](http://msdn2.microsoft.com/en-us/library/aa140277) (RTF) (英語情報) は、書式付きテキストとグラフィックスをエンコードするための仕様です。RTF の主な利点は、様々な異なるプラットフォーム上で様々なワード プロセッサにサポートされているという点です。例えば、ジョーという人物が PC で Word を使って RTF ファイルを作成する場合、Macintosh で全く異なるワード プロセッサを使用しているジェーンという人物とそれらのファイルを共有することができます。Word 1.0 以降の全ての Word のバージョンで RTF がネイティブ サポートされています。
Word では、RTF 文書を開き、処理することができます。Word 文書は、必要に応じて RTF 形式で保存することができます。しかし、Word がこのようなファイルを開く方法にセキュリティ上の脆弱性が発生し、これにより、ユーザーの承諾なしにマクロが実行される可能性があります。

**マクロとは何ですか?**

一般的には、マクロという用語は、オペレーティング システムやアプリケーション内で通常行われるタスクを自動化する小さなプログラムのことを示します。例えば、全ての [Office](http://www.microsoft.com/japan/office/) ファミリー製品でマクロの使用がサポートされています。マクロにより、例えば社内で Word、Excel や他のプログラムを使って、それぞれのニーズに合った、生産性の高いツールを実行するマクロを開発することができます。しかし他のコンピュータ プログラムと同様に、マクロは悪用される恐れがあります。特に、Office 製品は広く使用されているため、多くのウィルスは、マクロの形で作成され、Office 文書内に組み込まれています。この問題に対処するために、Office には、[Security Model](http://office.microsoft.com/downloads/2000/o2ksec.aspx) (英語情報) が開発され、マクロが、ユーザーの必要な場合にのみ実行されるように設計されています。しかし、この場合、このセキュリティ モデルに問題があり、マクロを含むテンプレートにリンクされている RTF 文書を開く際にこの問題が発生します。

**テンプレートとは何ですか?**

テンプレートは、文書の骨組みであると考えることができます。例えば研究論文のテンプレートは、あらかじめ作られたヘッダーとフッター、また必要な常用文を含む必要なスタイルが設定されています。ユーザーが新しい研究論文を作成する必要がある場合、実際に書く論文の形式としてこのテンプレートを使用することができます。テンプレートは [Microsoft Office Template Gallery](http://officeupdate.microsoft.com/templategallery/) （英語情報）でダウンロードすることができます。
テンプレートには、他の文書の場合と同様に、マクロを含むことができます。テンプレートを使用した文書を開くのに Word が使用される場合、文書とテンプレートにマクロがあるかをチェックする必要があります。この脆弱性は、このチェックが正しく行われないために発生します。

**脆弱性は何ですか?**

Word が RTF ファイルを開くために使用され、そのファイルがテンプレートへのリンクを含む場合、そのRTF ファイル自身のみマクロがチェックされます。マクロを含む可能性のあるテンプレートはチェックされません。

**これにより攻撃者は何ができますか?**

この脆弱性を利用して、攻撃者は通常の Word のセキュリティ モデルをかいくぐることができます。つまり、攻撃者がテンプレートの RTF ファイルに基づいてマクロを含むテンプレートを作成し、他のユーザーにその RTF ファイルを開くように誘導した場合、テンプレートのマクロはユーザーの許可なしでマクロを実行します。

**マクロは何ができますか?**

マクロはユーザーが自分のマシンで可能な任意の操作を行うことができます。例えば、ファイルの追加、変更、削除、Web サイトとの通信、ハードディスクの再フォーマットなどです。
また、マクロはユーザーのセキュリティ設定も変更することができます。これにはマクロの保護を無効にすることも含まれます。このため、ユーザーがこの脆弱性による攻撃を受けた場合、影響の 1 つとして、ユーザーのセキュリティ設定が弱まり、通常 Word によって実行が防御できる他のマクロが実行されます。

**攻撃者はどのようにして文書を他のユーザーに渡すのですか?**

様々な方法があります。まず、攻撃者は文書を Web サイトにホストすることができます。または十分なアクセス権がある場合、その文書を共有に保存することができます。また、文書を電子メールで送信したり、フロッピー ディスクに保存して渡すなどの方法でユーザーを狙う可能性があります。

**攻撃者が** **RTF** **ファイルを他のユーザーに送信する場合、そのファイルとともにテンプレートも送信する必要がありますか?**

必ずしも、その必要はありません。RTF と Word ファイルは関連するテンプレートと一緒である必要はありません。しかし、テンプレートを離れた場所に格納し、文書を Web （HTTP） 接続を介してテンプレートにリンクすることができます。したがって、攻撃者は自分の Web サイトにあるテンプレートにリンクした RTF ファイルを作成し、RTF ファイルとテンプレートの両方をユーザーに送信する必要を省くことができます。

**ユーザーが** **RTF** **ファイルを開き、Word** **ファイルとして保存したとします。別のユーザーが後でその** **Word** **ファイルを開いた場合、この脆弱性を利用することはできますか?**

いいえ、できません。Word 文書がテンプレートにリンクしている場合でも、その Word ファイルが開かれる時に、セキュリティ設定は正しく動作します。

**この脆弱性は** **Word** **以外の** **Office** **製品にも影響を及ぼしますか?**

いいえ。Word だけが RTF ファイルを開くことができる Office 製品です。したがってこの脆弱性を受ける Office 製品は Word だけです。

**Office XP** **はこの脆弱性の影響を受けますか?**

間もなくリリースされる Word 2002 （Office XP に含まれる Word のバージョン） はこの脆弱性の影響を受けません。

**更新プログラムは何を修正しますか?**

この更新プログラムは Word テンプレートにリンクする RTF ファイルが開かれる時でも、正しいマクロ チェックが行われるようにしてこの脆弱性を排除します。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、以下のサイトからダウンロードできます。

-   Microsoft Word 2000:
    <http://office.microsoft.com/downloads/2000/wd2kmsec.aspx>
-   Microsoft Word 97:
    [http://office.microsoft.com/japan/downloads/9798/Wd97mcrs.aspx](http://office.microsoft.com/japan/downloads/9798/wd97mcrs.aspx)
-   Microsoft Word 98 (日本語版):
    [http://office.microsoft.com/japan/downloads/9798/Wd98mcrs.aspx](http://office.microsoft.com/japan/downloads/9798/wd98mcrs.aspx)
-   Microsoft Word 98 Macintosh Edition:
    <http://www.microsoft.com/japan/mac/download/office98/010607.mspx>
-   Microsoft Word 2001 for Mac:
    <http://www.microsoft.com/japan/mac/download/office2k1/2001_906.mspx>

**注** **:**
これらの更新プログラムはマイクロソフト セキュリティ情報 [MS01-034](http://technet.microsoft.com/security/bulletin/ms01-034) で説明された問題も解決します。

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**
更新プログラム欄に記載されている各 Word のバージョン用の更新プログラムを適用して下さい。

**移行される更新プログラム** **:**
この更新プログラムはマイクロソフト セキュリティ情報 [MS99-002](http://technet.microsoft.com/security/bulletin/ms99-002) (英語情報) で提供された更新プログラムに取って代わるものです。

**更新プログラムのインストール確認** **:**

-   Word 2000:
    Winword.exe のバージョンが 9.00.00.5302 であることを確認してください。
-   Word 97:
    \[ヘルプ\] メニューの Word 97 のバージョン情報で （QFE 6309） を確認して下さい。
-   Word 98 for Macintosh:
    ［ヘルプ］ メニューから Microsoft Word の \[バージョン情報］ を選択し、バージョン情報が 「Word 8.0 (8823)」 以降であることを確認して下さい。
-   Word 2001 for Macintosh:
    ［ヘルプ］ メニューから Microsoft Word の \[バージョン情報］ を選択し、バージョン情報が 「Word 9.0.2 (3411)」 以降であることを確認して下さい。

**警告** **:**
なし

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS01-028）
    [http://www.microsoft.com/technet/security/bulletin/ms01-028.mspx](http://technet.microsoft.com/security/bulletin/ms01-028)
-   サポート技術情報 （KB） 文書番号 ： 288266
    [\[WD2000\] RTF 文書を開いたときにマクロの警告が表示されない](http://support.microsoft.com/kb/288266)

**更新履歴** **:**

-   2001/5/22: このセキュリティ情報ページを公開しました。
-   2001/5/28: この問題に対する日本語版 KB を公開しました。
-   2001/6/8: この問題に対する Microsoft Word 2001 for Mac の日本語版更新プログラムを公開しました。
-   2001/6/13: この問題に対する Microsoft Word 98 Macintosh Edition の日本語版更新プログラムを公開しました。
-   2001/7/11: この問題に対する、Microsoft Word 97 および Microsoft Word 98 (日本語版) の日本語版更新プログラムを公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
