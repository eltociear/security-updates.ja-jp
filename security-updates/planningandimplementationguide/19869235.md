---
TOCTitle: '第 4 章 :メンバ サーバー ベースライン ポリシー'
Title: '第 4 章 :メンバ サーバー ベースライン ポリシー'
ms:assetid: 'd28caa21-4ec2-4556-a92a-5aa8410df6da'
ms:contentKeyID: 19869235
ms:mtpsurl: 'https://technet.microsoft.com/ja-jp/library/Cc163121(v=TechNet.10)'
---

Windows Server 2003 セキュリティ ガイド
=======================================

### 第 4 章 :メンバ サーバー ベースライン ポリシー

最終更新日: 2006年8月14日

**ダウンロード**

[Windows Server 2003 セキュリティ ガイドを入手する (英語情報)](http://download.microsoft.com/download/c/8/6/c86b1b59-0388-4945-8bd9-06f04db13136/windows_server_2003_security_guide_v2.1.zip)

##### トピック

[](#e4b)[概要](#e4b)  
[](#e5f)[Windows Server 2003 のベースライン ポリシー](#e5f)  
[](#ecg)[監査ポリシー](#ecg)  
[](#ejwae)[ユーザー権利の割り当て](#ejwae)  
[](#ecqag)[セキュリティ オプション](#ecqag)  
[](#ej3bg)[イベント ログ](#ej3bg)  
[](#e6cai)[追加のレジストリ エントリ](#e6cai)  
[](#ekqai)[制限されたグループ](#ekqai)  
[](#ehrai)[ファイル システムを保護する](#ehrai)  
[](#ekuai)[追加のセキュリティ設定](#ekuai)  
[](#edbbi)[まとめ](#edbbi)  
概要
----

この章では、Microsoft Windows Server 2003 Service Pack 1 (SP1) を実行しているすべてのサーバーを対象として、ベースライン セキュリティ テンプレートを管理するための構成要件について説明します。また、3 種類の異なる環境においてセキュリティ保護された Windows Server 2003 SP1 構成をセットアップおよび構成するための管理上の指針について説明します。この章で説明する構成要件は、このガイドの以降の章で説明するすべての手順のベースラインとなります。各章では、個々のサーバーの役割をセキュリティ強化する方法について説明します。

この章に示す推奨設定によって、エンタープライズ環境内のビジネス アプリケーション サーバーの基盤にセキュリティを確立することができます。ただし、こうしたセキュリティ構成を運用環境に実装する前に、そのセキュリティ構成を実装することによって社内の業務アプリケーションに不具合が生じないかどうかを、総合的にテストする必要があります。

この章で説明している推奨設定はほとんどの組織に当てはまり、Windows Server 2003 SP1 を実行しているコンピュータであれば、既存のものにでも新規のものにでも適用できます。Windows Server 2003 SP1 の既定のセキュリティ構成は、このガイドの作成チームにより調査、検討、テストが十分になされたものです。それぞれの設定の既定の設定すべてと詳細な説明については、[http://go.microsoft.com/fwlink/?LinkId=15159](https://technet.microsoft.com/ja-jp/library/75849e66-9f52-4ceb-874e-cace62110b09(v=TechNet.10)) の関連ガイド『[*脅威とその対策 : Windows Server 2003 と Windows XP のセキュリティ設定*](https://technet.microsoft.com/ja-jp/library/75849e66-9f52-4ceb-874e-cace62110b09(v=TechNet.10))』を参照してください。全般的に、これから説明する推奨設定のほとんどにより、既定の設定よりセキュリティが強化されます。

この章では、次の 3 種類の環境に対するセキュリティ設定について説明します。

-   **レガシ クライアント (LC)**。この環境には、Windows NT 4.0 やMicrosoft Windows 98 を実行しているコンピュータが含まれます。これらのオペレーティング システムは、*レガシ* オペレーティング システムとも呼ばれます。この環境でも十分なセキュリティは確保されますが、このガイドで定義している 3 種類の環境のうちで最も低いセキュリティに該当します。セキュリティを強化するために、エンタープライズ クライアント環境に移行することでセキュリティを向上させることができます。LC 環境には、上記のレガシ オペレーティング システムに加えて、Windows 2000 Professional ワークステーションと Windows XP Professional ワークステーションが含まれます。また、この環境に存在するドメイン コントローラのオペレーティング システムは、必ず Windows 2000 または Windows Server 2003 です。Windows NT 4.0 を実行しているドメイン コントローラは、存在しません。ただし、Windows NT を実行しているメンバ サーバーは、存在する可能性があります。

-   **エンタープライズ クライアント (EC)**。この環境が実現するセキュリティは強固です。この環境は、最近の Windows オペレーティング システム向けに設計されてます。EC 環境には、Windows 2000 Professional および Windows XP Professional を実行しているクライアントが含まれます。LC 環境から EC 環境に移行するために必要となる作業のほとんどは、Windows 98 や Windows NT 4.0 Workstation を実行するレガシ クライアントを Windows 2000 または Windows XP にアップグレードすることです。この環境では、すべてのドメイン コントローラとメンバ サーバーが Windows 2000 Server または Windows Server 2003 を実行しています。

-   **セキュリティ強化 - 機能制限 (SSLF)**。この環境は、EC 環境よりはるかに強力なセキュリティを実現します。EC 環境からセキュリティ強化 - 機能制限 (SSLF) 環境に移行するには、クライアント コンピュータとサーバーの両方を厳しいセキュリティ ポリシーに従わせる必要があります。この環境には、Windows 2000 Professional や Windows XP Professional を実行するクライアント コンピュータ、および Windows 2000 Server または Windows Server 2003 を実行するドメイン コントローラが含まれます。SSLF 環境では、セキュリティ保護意識が非常に高く、クライアントの機能性および管理の容易さが大幅に低下しても、最高レベルのセキュリティを実現することが優先されます。この環境のメンバ サーバーでは、Windows 2000 Server または Windows Server 2003 を実行します。

多くの場合、SSLF 環境では明示的に既定値を設定します。この構成では、設定を一部ローカルに調整しようとするアプリケーションで障害が発生する可能性があるので、互換性に影響が生じることを想定する必要があります。たとえば、アプリケーションによっては、ユーザー権利の割り当てを調整して、サービス アカウントの特権を追加で取得する必要があります。しかし、グループ ポリシーがローカル コンピュータ ポリシーより優先されるので、このような処理は失敗します。SSLF 設定の場合は特に、推奨設定を運用コンピュータに展開する前に、すべてのアプリケーションを十分にテストする必要があります。

次の図は、3 種類のセキュリティ環境とそれぞれで使用可能なクライアントを示しています。

![](images/Cc163121.sgfg0401(ja-jp,TechNet.10).gif)  
**図 4.1 セキュリティ環境の現状と計画**
[画像を画面全体に表示](https://technet.microsoft.com/ja-jp/cc163121.sgfg0401_big(ja-jp,technet.10).gif)  
組織の環境のセキュリティを段階的に強化する場合は、まずレガシ クライアント環境からスタートし、その後に、アプリケーションとクライアント コンピュータを厳しいセキュリティ設定に更新してテストしながら、徐々に高いセキュリティ レベルに移行します。

次の図は、セキュリティ テンプレート (.inf ファイル) がエンタープライズ クライアント用のメンバ サーバー ベースライン ポリシー (MSBP) の元データとして使用されるようすを示しています。また、このポリシーをリンクして組織内のすべてのサーバーに適用する方法の一例も示します。

Windows Server 2003 SP1 は、出荷時の既定値が、セキュリティで保護された環境が実現するよう構成されています。多くの場合、この章では既定値と異なる設定を規定します。また、3 種類の環境それぞれに特定の既定値を適用します。すべての既定値の詳細については、http://go.microsoft.com/fwlink/?LinkId=15159 の関連ガイド『[*脅威とその対策 : Windows Server 2003 と Windows XP のセキュリティ設定*](https://technet.microsoft.com/ja-jp/library/75849e66-9f52-4ceb-874e-cace62110b09(v=TechNet.10))』を参照してください。

![](images/Cc163121.sgfg0402(ja-jp,TechNet.10).gif)  
**図 4.2 セキュリティ テンプレート EC - Member Server Baseline.inf が MSBP にインポートされ、メンバ サーバー組織単位 (OU) にリンクされます。**
[画像を画面全体に表示](https://technet.microsoft.com/ja-jp/cc163121.sgfg0402_big(ja-jp,technet.10).gif)  

個々のサーバーの役割のセキュリティを強化する手順については、このガイドの以降の章で説明します。このガイドで説明する主なサーバーの役割は次のとおりです。

-   DNS サービスを含むドメイン コントローラ

-   WINS サービスと DHCP サービスを含むインフラストラクチャ サーバー

-   ファイル サーバー

-   プリント サーバー

-   インターネット インフォメーション サービス (IIS) を実行する Web サーバー

-   Microsoft Internet Authentication Server (IAS) サーバー

-   証明書サービス (CA) サーバー

-   要塞ホスト

この章で説明するエンタープライズ クライアント MSBP の多くは、このガイドで定義している 3 種類のセキュリティ環境に存在する上記のサーバーの役割にも適用されます。各セキュリティ テンプレートは、それぞれの環境のセキュリティ要件を満たすように設計されています。次の表は、3 種類の環境に対応するベースライン セキュリティ テンプレートの名前を示しています。

**表 4.1 3 種類の環境で使用するベースライン セキュリティ テンプレート**

 
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">LC-Member Server Baseline.inf</td>
<td style="border:1px solid black;">EC-Member Server Baseline.inf</td>
<td style="border:1px solid black;">SSLF-Member Server Baseline.inf</td>
</tr>
</tbody>
</table>
  
この章の以降では、3 種類すべての環境に共通するセキュリティ設定、つまりすべての **Member Server Baseline** セキュリティ テンプレートについて説明します。
  
ベースライン セキュリティ テンプレートは、「第 5 章 ドメイン コントローラ ベースライン ポリシー」で定義されるドメイン コントローラ セキュリティ テンプレートの基礎でもあります。**Domain Controllers Role** セキュリティ テンプレートには、ドメイン コントローラ グループ ポリシー GPO のベースライン設定が含まれています。この GPO は、3 種類の環境すべてにおいて、ドメイン コントローラ OU にリンクされます。OU とグループ ポリシーを作成し、適切なセキュリティ テンプレートを各 GPO にインポートする手順の詳細については、「第 2 章 Windows Server 2003 のセキュリティ強化メカニズム」を参照してください。
  
**注** :サーバーのセキュリティを強化するために使用される手順の中には、グループ ポリシーで自動化できないものがあります。これらの手順については、この章の「追加のセキュリティ設定」を参照してください。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
Windows Server 2003 のベースライン ポリシー  
-------------------------------------------
  
メンバ サーバー OU レベルの設定は、このガイドで説明しているすべてのメンバ サーバーの役割に共通の設定を定義します。これらの設定を適用するには、メンバ サーバー OU にリンクする GPO を作成します。このような GPO をベースライン ポリシーと呼びます。この GPO は、各サーバーのセキュリティ設定の構成を自動化します。各サーバーの役割に基づいて、サーバー アカウントをメンバ サーバー OU の適切な子 OU に移動する必要があります。
  
以降の各設定の説明順序は、Microsoft 管理コンソール (MMC) の \[セキュリティの構成エディタ (SCE)\] スナップインのユーザー インターフェイス (UI) に表示される順序と同じです。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
監査ポリシー  
------------
  
管理者は監査ポリシーを作成して、レポートするセキュリティ イベントを定義し、特定のイベント カテゴリに含まれるユーザーまたはコンピュータのアクティビティを記録する必要があります。これにより、オブジェクトにアクセスしたユーザー、ユーザーによるコンピュータへのログオンまたはコンピュータからのログオフ、監査ポリシー設定に対する変更など、セキュリティに関連するアクティビティを監視できます。
  
監査ポリシーを実装する前に、環境で監査するイベント カテゴリを決める必要があります。管理者が各イベント カテゴリに対して選択した監査設定によって、組織の監査ポリシーが定義されます。管理者は、個々のイベント カテゴリに対する監査設定を定義してから、組織のセキュリティ ニーズに応える監査ポリシーを作成します。
  
監査ポリシーが存在しない場合、セキュリティ上の問題が発生したときにその詳細を知ることが困難または不可能になります。一方、監査設定が構成されており、許可されている数多くのアクティビティによりイベントが生成されると、セキュリティ イベント ログは無駄なデータでいっぱいになります。以下の推奨事項と設定の説明を参考にして、収集するデータが無駄にならないよう監視対象を決定します。
  
多くの場合、障害ログは正常な処理のログよりも情報量がかなり多くなります。通常、障害とはエラーの発生を意味するからです。たとえば、一般的に、ユーザーによるコンピュータへのログオン成功は通常動作であると見なされます。しかし、ユーザーがコンピュータにログオンしようして何度も失敗した場合、他のユーザーのアカウント資格情報を使用してコンピュータに侵入しようとしている可能性があります。イベント ログには、コンピュータで発生したイベントが記録されます。Microsoft Windows オペレーティング システムでは、アプリケーション、セキュリティ イベント、システム イベントのそれぞれに専用のイベント ログが存在します。セキュリティ ログには、監査イベントが記録されます。グループ ポリシーのイベント ログ コンテナは、アプリケーション、セキュリティ、およびシステムのイベント ログに関連する属性の定義に使用されます。この属性には、最大ログ サイズ、各ログのアクセス権利、保存の設定、保存方法などがあります。
  
監査ポリシーを実装する前に、組織ではデータを収集、編成、および分析する方法を決定する必要があります。監査データを大量に集めても、活用する予定がなければ価値はほとんどありません。また、コンピュータ ネットワークを監査すると、パフォーマンスが低下する可能性があります。特定の設定を組み合わせたときに生じる影響は、エンドユーザーのコンピュータでは無視できても、負荷の高いサーバーでは顕著に見られる場合もあります。したがって、新しい監査設定を運用環境に展開する前に、パフォーマンスへの影響をテストする必要があります。
  
次の表に、このガイドで定義している 3 種類のセキュリティ環境における、監査ポリシー設定の推奨値を示します。表からわかるように、ほとんどの設定値は 3 種類のセキュリティ環境でほぼ同じです。各設定に関する詳細情報については、表の後のサブセクションで説明します。
  
監査ポリシーの設定は、Windows Server 2003 SP1 では、グループ ポリシー オブジェクト エディタを使用して、次の場所で構成できます。
  
**コンピュータの構成\\Windows の設定\\セキュリティの設定\\ローカル ポリシー**  
**\\監査ポリシー**
  
ここで説明する規定の設定の概要については、このガイドのダウンロード バージョンに付属の Microsoft Excel ブック「Windows Server 2003 Security Guide Settings」を参照してください。以下で説明する各設定の既定値と詳細な説明については、[http://go.microsoft.com/fwlink/?LinkId=15159](https://technet.microsoft.com/ja-jp/library/75849e66-9f52-4ceb-874e-cace62110b09(v=TechNet.10)) の関連ガイド『[*脅威とその対策 : Windows Server 2003 と Windows XP のセキュリティ設定*](https://technet.microsoft.com/ja-jp/library/75849e66-9f52-4ceb-874e-cace62110b09(v=TechNet.10))』を参照してください。
  
**表 4.2 監査ポリシーの設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">アカウント ログオン イベントの監査</td>
<td style="border:1px solid black;">成功</td>
<td style="border:1px solid black;">成功</td>
<td style="border:1px solid black;">成功 失敗</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">アカウント管理の監査</td>
<td style="border:1px solid black;">成功</td>
<td style="border:1px solid black;">成功</td>
<td style="border:1px solid black;">成功 失敗</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">ログオン イベントの監査</td>
<td style="border:1px solid black;">成功</td>
<td style="border:1px solid black;">成功</td>
<td style="border:1px solid black;">成功 失敗</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">オブジェクト アクセスの監査</td>
<td style="border:1px solid black;">監査しない</td>
<td style="border:1px solid black;">監査しない</td>
<td style="border:1px solid black;">失敗</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">ポリシーの変更の監査</td>
<td style="border:1px solid black;">成功</td>
<td style="border:1px solid black;">成功</td>
<td style="border:1px solid black;">成功</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">特権使用の監査</td>
<td style="border:1px solid black;">監査しない</td>
<td style="border:1px solid black;">監査しない</td>
<td style="border:1px solid black;">失敗</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">プロセス追跡の監査</td>
<td style="border:1px solid black;">監査しない</td>
<td style="border:1px solid black;">監査しない</td>
<td style="border:1px solid black;">監査しない</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">システム イベントの監査</td>
<td style="border:1px solid black;">成功</td>
<td style="border:1px solid black;">成功</td>
<td style="border:1px solid black;">成功</td>
</tr>
</tbody>
</table>
  
### アカウント ログオン イベントの監査
  
このポリシー設定では、アカウントの妥当性を検査する他のコンピュータにユーザーがログオンするイベント、またはそのコンピュータからユーザーがログオフするイベントを監査するかどうかを決定します。ドメイン コントローラでドメイン ユーザー アカウントが認証されると、アカウント ログオン イベントが生成され、ドメイン コントローラのセキュリティ ログに記録されます。ローカル コンピュータ上でローカル ユーザーを認証すると、ログオン イベントが生成され、ローカルのセキュリティ ログに記録されます。アカウント ログオフ イベントは記録されません。
  
\[アカウント ログオン イベントの監査\] は、LC および EC のベースライン ポリシーでは**成功**値が記録されるように設定されており、SSLF ベースライン ポリシーでは**成功**イベントと**失敗**イベントが両方記録されるように設定されています。
  
次の表は、このポリシー設定によりセキュリティ ログに記録される重要なセキュリティ イベントを示しています。これらイベント ID は、Microsoft Operations Manager (MOM) などの任意のソフトウェア スイートを監視するときにカスタム警告を作成する場合に役立ちます。
  
**表 4.3 アカウント ログオン イベント**

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >イベント ID</th>
<th style="border:1px solid black;" >イベントの説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">672</td>
<td style="border:1px solid black;">認証サービス (AS) チケットが正常に発行され、検証されました。Windows Server2003 SP1 では、この種類のイベントは、要求が成功した場合には成功の監査になり、要求が失敗した場合には失敗の監査になります。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">673</td>
<td style="border:1px solid black;">チケット保証サービス (TGS) のチケットが許可されました。TGS は、Kerberos バージョン 5 TGS から発行されるチケットで、ドメイン内の特定のサービスに対するユーザー認証に使用されます。Windows Server2003 SP1 では、イベントの種類として成功と失敗が記録されます。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">674</td>
<td style="border:1px solid black;">セキュリティ プリンシパルが AS チケットまたは TGS チケットを更新しました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">675</td>
<td style="border:1px solid black;">事前認証が失敗しました。ユーザーが間違ったパスワードを入力すると、キー配布センター (KDC) でこのイベントが生成されます。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">676</td>
<td style="border:1px solid black;">認証チケット要求が失敗しました。Windows Server2003 SP1 では、このイベントは生成されません。Windows の他のバージョンでは、このイベントにより、不正な資格情報が原因ではない認証エラーが発生したことが示されます。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">677</td>
<td style="border:1px solid black;">TGS チケットが許可されませんでした。Windows Server2003 SP1 では、このイベントは生成されず、ID 672 の失敗監査イベントが使用されます。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">678</td>
<td style="border:1px solid black;">アカウントはドメイン アカウントに正常にマップされました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">681</td>
<td style="border:1px solid black;">ログオンの失敗。ドメイン アカウント ログオンが試行されました。このイベントを生成するのは、ドメイン コントローラだけです。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">682</td>
<td style="border:1px solid black;">ユーザーが、切断されたターミナル サーバー セッションに再接続しました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">683</td>
<td style="border:1px solid black;">ユーザーが、ログオフせずにターミナル サーバー セッションを切断しました。</td>
</tr>
</tbody>
</table>
  
### アカウント管理の監査
  
このポリシー設定では、コンピュータで発生するアカウント管理イベントを監査するかどうかを決定します。アカウント管理イベントの例を次に示します。
  
-   ユーザー アカウントまたはグループの作成、変更、削除
  
-   ユーザー アカウントの名前変更、無効化、有効化
  
-   パスワードの設定または変更
  
組織では、ドメイン アカウントとローカル アカウントのどちらについても、アカウントを作成、変更、または削除したユーザーを特定できるようにする必要があります。権限のない変更処理が行われた場合、組織のポリシーに従う方法を理解していない管理者が誤って変更したことが考えられますが、意図的な攻撃が発生した可能性もあります。
  
たとえば、アカウント管理失敗イベントは、多くの場合、下位レベルの管理者、または下位レベルの管理者のアカウントを見破った攻撃者が、自分の権利を格上げしようとしたことを示しています。ログを調べることにより、攻撃者が変更または作成したアカウントを確認できます。
  
\[アカウント管理の監査\] は、LC および EC のベースライン ポリシーでは**成功**値が記録されるように設定されており、SSLF のベースライン ポリシーでは**成功**イベントと**失敗**イベントが両方記録されるように設定されています。
  
次の表は、このポリシー設定によりセキュリティ ログに記録される重要なセキュリティ イベントを示しています。これらイベント ID は、MOM などの任意のソフトウェア スイートを監視するときにカスタム警告を作成する場合に役立ちます。多くの運用管理ソフトウェアでは、スクリプトを使用してカスタマイズして、これらのイベント ID に基づいてイベントをキャプチャまたはフラグ付けできます。
  
**表 4.4 アカウント管理イベント**

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >イベント ID</th>
<th style="border:1px solid black;" >イベントの説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">624</td>
<td style="border:1px solid black;">ユーザー アカウントが作成されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">627</td>
<td style="border:1px solid black;">ユーザー パスワードが変更されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">628</td>
<td style="border:1px solid black;">ユーザー パスワードが設定されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">630</td>
<td style="border:1px solid black;">ユーザー アカウントが削除されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">631</td>
<td style="border:1px solid black;">グローバル グループが作成されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">632</td>
<td style="border:1px solid black;">メンバがグローバル グループに追加されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">633</td>
<td style="border:1px solid black;">メンバがグローバル グループから削除されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">634</td>
<td style="border:1px solid black;">グローバル グループが削除されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">635</td>
<td style="border:1px solid black;">新しいローカル グループが作成されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">636</td>
<td style="border:1px solid black;">メンバがローカル グループに追加されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">637</td>
<td style="border:1px solid black;">メンバがローカル グループから削除されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">638</td>
<td style="border:1px solid black;">ローカル グループが削除されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">639</td>
<td style="border:1px solid black;">ローカル グループ アカウントが変更されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">641</td>
<td style="border:1px solid black;">グローバル グループ アカウントが変更されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">642</td>
<td style="border:1px solid black;">ユーザー アカウントが変更されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">643</td>
<td style="border:1px solid black;">ドメイン ポリシーが変更されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">644</td>
<td style="border:1px solid black;">ユーザー アカウントが自動的にロックされました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">645</td>
<td style="border:1px solid black;">コンピュータ アカウントが作成されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">646</td>
<td style="border:1px solid black;">コンピュータ アカウントが変更されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">647</td>
<td style="border:1px solid black;">コンピュータ アカウントが削除されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">648</td>
<td style="border:1px solid black;">セキュリティが無効なローカル セキュリティ グループが作成されました。
<strong>注</strong> :正式な名前での SECURITY_DISABLED は、アクセス チェックでアクセス許可を付与するときにこのグループを使用できないことを示します。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">649</td>
<td style="border:1px solid black;">セキュリティが無効なローカル セキュリティ グループが変更されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">650</td>
<td style="border:1px solid black;">セキュリティが無効なローカル セキュリティ グループにメンバが追加されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">651</td>
<td style="border:1px solid black;">セキュリティが無効なローカル セキュリティ グループからメンバが削除されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">652</td>
<td style="border:1px solid black;">セキュリティが無効なローカル グループが削除されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">653</td>
<td style="border:1px solid black;">セキュリティが無効なグローバル グループが作成されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">654</td>
<td style="border:1px solid black;">セキュリティが無効なグローバル グループが変更されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">655</td>
<td style="border:1px solid black;">セキュリティが無効なグローバル グループにメンバが追加されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">656</td>
<td style="border:1px solid black;">セキュリティが無効なグローバル グループからメンバが削除されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">657</td>
<td style="border:1px solid black;">セキュリティが無効なグローバル グループが削除されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">658</td>
<td style="border:1px solid black;">セキュリティが有効なユニバーサル グループが作成されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">659</td>
<td style="border:1px solid black;">セキュリティが有効なユニバーサル グループが変更されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">660</td>
<td style="border:1px solid black;">セキュリティが有効なユニバーサル グループにメンバが追加されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">661</td>
<td style="border:1px solid black;">セキュリティが有効なユニバーサル グループからメンバが削除されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">662</td>
<td style="border:1px solid black;">セキュリティが有効なユニバーサル グループが削除されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">663</td>
<td style="border:1px solid black;">セキュリティが無効なユニバーサル グループが作成されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">664</td>
<td style="border:1px solid black;">セキュリティが無効なユニバーサル グループが変更されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">665</td>
<td style="border:1px solid black;">セキュリティが無効なユニバーサル グループにメンバが追加されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">666</td>
<td style="border:1px solid black;">セキュリティが無効なユニバーサル グループからメンバが削除されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">667</td>
<td style="border:1px solid black;">セキュリティが無効なユニバーサル グループが削除されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">668</td>
<td style="border:1px solid black;">グループの種類が変更されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">684</td>
<td style="border:1px solid black;">管理グループ メンバのセキュリティ記述子を設定されました。
<strong>注</strong> :ドメイン コントローラでは 60 分ごとにバックグラウンド スレッドにより管理グループのすべてのメンバ (ドメイン、エンタープライズ、スキーマの管理者など) が検索され、固定セキュリティ記述子がこれらのメンバに適用されます。このイベントは記録されます。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">685</td>
<td style="border:1px solid black;">アカウントの名前が変更されました。</td>
</tr>
</tbody>
</table>
  
### ログオン イベントの監査
  
このポリシー設定では、ユーザーがコンピュータにログオンするたび、およびコンピュータからログオフするたびに監査するかどうかを指定します。\[ログオン イベントの監査\] を設定すると、ドメイン アカウント アクティビティを監視するドメイン コントローラに関する記録、およびローカル アカウント アクティビティを監視するローカル コンピュータに関する記録が生成されます。
  
\[ログオン イベントの監査\] を \[監査しない\] に設定すると、組織内のコンピュータにログオンしたユーザーやログオンしようとしたユーザーを特定することが困難、または不可能になります。ドメイン メンバで \[ログオン イベントの監査\] を \[成功\] に設定すると、ユーザーがネットワークにログオンするたびに、そのアカウントがネットワーク上のどこに存在するかに関係なく、イベントが生成されます。\[アカウント ログオン イベントの監査\] が \[有効\] になっている場合に、ユーザーがローカル アカウントでログオンすると 2 つのイベントが生成されます。
  
このポリシー設定の既定値を変更していない場合でも、セキュリティ上の問題が発生した際に分析に使用できる監査記録証拠は何もありません。\[ログオン イベントの監査\] は、LC および EC ベースライン ポリシーの場合は**成功**値が記録されるように設定され、SSLF ベースライン ポリシーの場合は**成功**値と**失敗**値が両方記録されるように設定されています。
  
次の表は、このポリシー設定によりセキュリティ ログに記録される重要なセキュリティ イベントを示しています。
  
**表 4.5 監査ログオン イベント**

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >イベント ID</th>
<th style="border:1px solid black;" >イベントの説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">528</td>
<td style="border:1px solid black;">ユーザーがコンピュータに正常にログオンしました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">529</td>
<td style="border:1px solid black;">ログオンの失敗。不明なユーザー名でログオンしようとしたか、または実在のユーザー名と無効なパスワードの組み合わせでログオンしようとしました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">530</td>
<td style="border:1px solid black;">ログオンの失敗。許可されていない時間にユーザー アカウントへログオンしようとしました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">531</td>
<td style="border:1px solid black;">ログオンの失敗。無効なアカウントを使用してログオンを試行しました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">532</td>
<td style="border:1px solid black;">ログオンの失敗。期限切れのアカウントを使用してログオンを試行しました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">533</td>
<td style="border:1px solid black;">ログオンの失敗。このコンピュータへのログオンが許可されていないユーザーがログオンしようとしました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">534</td>
<td style="border:1px solid black;">ログオンの失敗。許可されていない種類のログオンを使用してユーザーがログオンしようとしました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">535</td>
<td style="border:1px solid black;">ログオンの失敗。指定されたアカウントのパスワードの期限は切れています。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">536</td>
<td style="border:1px solid black;">ログオンの失敗。Net Logon サービスが有効ではありません。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">537</td>
<td style="border:1px solid black;">ログオンの失敗。その他の理由でログオンが失敗しました。
<strong>注</strong> :場合によっては、ログオン失敗の理由が不明なことがあります。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">538</td>
<td style="border:1px solid black;">ユーザーのログオフ処理が完了しました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">539</td>
<td style="border:1px solid black;">ログオンの失敗。ログオンが試行された時点でアカウントがロックアウトされていました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">540</td>
<td style="border:1px solid black;">ユーザーがネットワークへログオンしました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">541</td>
<td style="border:1px solid black;">ローカル コンピュータとピア ID の一覧との間で、メイン モードのインターネット キー交換 (IKE) 認証が完了した (セキュリティ アソシエーションが確立された) か、クイック モードによりデータ チャネルが確立されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">542</td>
<td style="border:1px solid black;">データ チャネルが終了しました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">543</td>
<td style="border:1px solid black;">メイン モードが終了しました。
<strong>注</strong> :このイベントは、セキュリティ アソシエーションの有効期限切れ (既定値は 8 時間)、ポリシーの変更、またはピアの終了により発生することがあります。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">544</td>
<td style="border:1px solid black;">ピアから有効な証明書が提供されなかったか、または署名が検証されなかったため、メイン モード認証が失敗しました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">545</td>
<td style="border:1px solid black;">Kerberos 認証プロトコル障害または無効なパスワードが原因で、メイン モード認証が失敗しました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">546</td>
<td style="border:1px solid black;">ピアから送信された提案が無効であるため、IKE セキュリティ アソシエーションを確立できませんでした。受信したパケットに、無効なデータが含まれていました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">547</td>
<td style="border:1px solid black;">IKE ハンドシェイク実行時に障害が発生しました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">548</td>
<td style="border:1px solid black;">ログオンの失敗。信頼される側のドメインのセキュリティ識別子 (SID) が、クライアントのアカウント ドメイン SID と一致しません。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">549</td>
<td style="border:1px solid black;">ログオンの失敗。信頼されていない名前空間に対応するすべての SID が、フォレスト間認証時にフィルタにより除外されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">550</td>
<td style="border:1px solid black;">サービス拒否 (denial-of-service) 攻撃の可能性を示す通知メッセージです。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">551</td>
<td style="border:1px solid black;">ユーザーがログオフ処理を開始しました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">552</td>
<td style="border:1px solid black;">既に別のユーザーとしてログオンしているユーザーが、明示的な資格情報を使用してコンピュータにログオンしました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">682</td>
<td style="border:1px solid black;">ユーザーが切断されたターミナル サーバー セッションに再接続しました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">683</td>
<td style="border:1px solid black;">ユーザーが、ログオフせずにターミナル サーバー セッションを切断しました。
<strong>注</strong> :ネットワーク上のターミナル サーバー セッションへユーザーが接続されると、このイベントが生成されます。このイベントは、ターミナル サーバー上に記録されます。</td>
</tr>
</tbody>
</table>
 

### オブジェクト アクセスの監査

\[オブジェクト アクセスの監査\] ポリシー設定を有効にしただけでは、どのイベントも監査されません。\[オブジェクト アクセスの監査\] では、固有のシステム アクセス制御リスト (SACL) が指定されているオブジェクト (ファイル、フォルダ、レジストリ キー、プリンタなど) にユーザーがアクセスした場合にイベントを監査するかどうかを設定します。

SACL は、アクセス制御エントリ (ACE) で構成されています。各 ACE には、次の 3 つの情報が含まれています。

-   監査対象のセキュリティ プリンシパル (ユーザー、コンピュータ、またはグループ)

-   監査対象のアクセス タイプ (これをアクセス マスクと呼びます)

-   監査対象のアクセス イベント (失敗したアクセス イベントのみ、成功したアクセス イベントのみ、または両方のアクセス イベント) を示すフラグ

\[オブジェクト アクセスの監査\] で**成功**値をログに記録するよう設定した場合、指定した SACL を持つオブジェクトにユーザーが正常にアクセスすると、監査エントリが生成されます。**失敗**値をログに記録するよう設定した場合、指定した SACL を持つオブジェクトにユーザーがアクセスできないと監査エントリが生成されます。

組織の SACL を構成する場合は、有効にするアクションのみを定義する必要があります。たとえば、実行可能ファイルで \[データの書き込み\] 監査設定および \[データの追加\] 監査設定を有効にして、実行可能ファイルの変更または置換の追跡を可能にする必要がある場合があります。これは、コンピュータ ウイルス、ワーム、およびトロイの木馬の攻撃対象が、通常、実行可能ファイルだからです。同様に、機密文書へのアクセスまたは機密文書の変更の追跡が必要になる場合もあります。

\[オブジェクト アクセスの監査\] は、LC 環境と EC 環境のベースライン ポリシーでは、既定値の \[監査しない\] に設定されています。SSLF 環境のベースライン ポリシーでは、**失敗**値をログに記録するように設定されています。

次の表は、このポリシー設定によりセキュリティ ログに記録される重要なセキュリティ イベントを示しています。

**表 4.6 オブジェクト アクセス イベント**

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >イベント ID</th>
<th style="border:1px solid black;" >イベントの説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">560</td>
<td style="border:1px solid black;">アクセスは、既存のオブジェクトに対して許可されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">562</td>
<td style="border:1px solid black;">オブジェクトへのハンドルが閉じられました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">563</td>
<td style="border:1px solid black;">オブジェクトを削除する目的で、オブジェクトを開こうとしました
<strong>注</strong> :Createfile() に FILE_DELETE_ON_CLOSE フラグが指定されているときに、ファイル システムによってこのイベントが使用されます。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">564</td>
<td style="border:1px solid black;">保護されたオブジェクトが削除されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">565</td>
<td style="border:1px solid black;">既存のオブジェクトの種類に対するアクセスが許可されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">567</td>
<td style="border:1px solid black;">ハンドルに関連付けられているアクセス許可が使用されました。
<strong>注</strong> :ハンドルは、所定のアクセス許可 (読み取り、書き込みなど) が与えられた状態で作成されます。ハンドルが使用されると、使用されたアクセス許可ごとに 1 つの監査が生成されます。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">568</td>
<td style="border:1px solid black;">監査対象ファイルへのハード リンクを作成しようとしました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">569</td>
<td style="border:1px solid black;">承認マネージャのリソース マネージャが、クライアント コンテキストを作成しようとしました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">570</td>
<td style="border:1px solid black;">クライアントがオブジェクトへアクセスしようとしました。
<strong>注</strong> :オブジェクトに対する操作が行われるたびに、イベントが生成されます。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">571</td>
<td style="border:1px solid black;">承認マネージャ アプリケーションによりクライアント コンテキストが削除されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">572</td>
<td style="border:1px solid black;">管理者によりアプリケーションが初期化されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">772</td>
<td style="border:1px solid black;">証明書マネージャにより保留中の証明書要求が拒否されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">773</td>
<td style="border:1px solid black;">証明書サービスは再送信された証明書要求を受信しました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">774</td>
<td style="border:1px solid black;">証明書サービスは証明書を失効化しました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">775</td>
<td style="border:1px solid black;">証明書サービスは、証明書失効リスト (CRL) を公開する要求を受信しました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">776</td>
<td style="border:1px solid black;">証明書サービスが証明書失効リスト (CRL) を公開しました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">777</td>
<td style="border:1px solid black;">証明書要求の拡張が作成されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">778</td>
<td style="border:1px solid black;">証明書の要求属性が変更されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">779</td>
<td style="border:1px solid black;">証明書サービスはシャットダウンの要求を受信しました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">780</td>
<td style="border:1px solid black;">証明書サービスのバックアップが開始されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">781</td>
<td style="border:1px solid black;">証明書サービスのバックアップを完了しました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">782</td>
<td style="border:1px solid black;">証明書サービスの復元が開始されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">783</td>
<td style="border:1px solid black;">証明書サービスの復元を完了しました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">784</td>
<td style="border:1px solid black;">証明書サービスは開始されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">785</td>
<td style="border:1px solid black;">証明書サービスは停止されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">786</td>
<td style="border:1px solid black;">証明書サービスのセキュリティのアクセス許可が変更されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">787</td>
<td style="border:1px solid black;">証明書サービスはアーカイブされたキーを取得しました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">788</td>
<td style="border:1px solid black;">証明書サービスは証明書をデータベースにインポートしました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">789</td>
<td style="border:1px solid black;">証明書サービスの監査フィルタが変更されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">790</td>
<td style="border:1px solid black;">証明書サービスは証明書の要求を受信しました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">791</td>
<td style="border:1px solid black;">証明書サービスは証明書の要求を許可し、証明書を発行しました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">792</td>
<td style="border:1px solid black;">証明書サービスは証明書の要求を拒否しました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">793</td>
<td style="border:1px solid black;">証明書サービスは証明書の要求の状態を保留に設定しました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">794</td>
<td style="border:1px solid black;">証明書サービスの証明書マネージャの設定が変更されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">795</td>
<td style="border:1px solid black;">証明書サービスの構成エントリが変更されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">796</td>
<td style="border:1px solid black;">証明書サービスのプロパティが変更されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">797</td>
<td style="border:1px solid black;">証明書サービスはキーをアーカイブしました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">798</td>
<td style="border:1px solid black;">証明書サービスはキーをインポートしてアーカイブしました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">799</td>
<td style="border:1px solid black;">証明書サービスは証明機関 (CA) 証明書を Active Directory に公開しました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">800</td>
<td style="border:1px solid black;">証明書データベースから 1 つ以上の行が削除されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">801</td>
<td style="border:1px solid black;">役割の分離は有効になっています。</td>
</tr>
</tbody>
</table>
  
### ポリシーの変更の監査
  
このポリシー設定では、ユーザー権利の割り当てポリシー、信頼ポリシー、または監査ポリシー自体に対する変更をその都度監査するかどうかを決定します。
  
\[ポリシーの変更の監査\] で**成功**値をログに記録するよう設定した場合、ユーザー権利の割り当てポリシー、信頼ポリシー、または監査ポリシーの変更が成功するたびに、監査エントリが生成されます。**失敗**値をログに記録するよう設定した場合、ユーザー権利の割り当てポリシー、信頼ポリシー、または監査ポリシーの変更が失敗するたびに、監査エントリが生成されます。
  
推奨設定を使用すると、攻撃者が**プログラムのデバッグ**特権や**ファイルとディレクトリのバックアップ**特権を追加するなどの方法で格上げを試みているアカウント特権を特定できます。
  
このガイドで定義している 3 種類の環境すべてのベースライン ポリシーでは、\[ポリシーの変更の監査\] は**成功**値をログに記録するように設定されています。現状では、\[失敗\] を記録するよう設定しても、意味のあるイベントは収集されません。
  
次の表は、このポリシー設定によりセキュリティ ログに記録される重要なセキュリティ イベントを示しています。
  
**表 4.7 ポリシー変更の監査のイベント**

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >イベント ID</th>
<th style="border:1px solid black;" >イベントの説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">608</td>
<td style="border:1px solid black;">ユーザー権限が割り当てられました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">609</td>
<td style="border:1px solid black;">ユーザー権限が削除されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">610</td>
<td style="border:1px solid black;">別のドメインとの信頼関係が作成されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">611</td>
<td style="border:1px solid black;">別のドメインとの信頼関係が削除されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">612</td>
<td style="border:1px solid black;">監査ポリシーが変更されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">613</td>
<td style="border:1px solid black;">インターネット プロトコル セキュリティ (IPsec) ポリシー エージェントが開始されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">614</td>
<td style="border:1px solid black;">IPsec ポリシー エージェントが無効になりました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">615</td>
<td style="border:1px solid black;">IPsec ポリシー エージェントが変更されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">616</td>
<td style="border:1px solid black;">IPsec ポリシー エージェントにより、重大である可能性のある障害が検出されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">617</td>
<td style="border:1px solid black;">Kerberos ポリシーが変更されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">618</td>
<td style="border:1px solid black;">暗号化されたデータの回復ポリシーが変更されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">620</td>
<td style="border:1px solid black;">他のドメインとの信頼関係が変更されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">621</td>
<td style="border:1px solid black;">アカウントに対してシステム アクセスが権限が与えられました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">622</td>
<td style="border:1px solid black;">アカウントからシステム アクセス権限が削除されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">623</td>
<td style="border:1px solid black;">ユーザーごとの監査ポリシーが設定されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">625</td>
<td style="border:1px solid black;">ユーザーごとの監査ポリシーが更新されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">768</td>
<td style="border:1px solid black;">あるフォレスト内の名前空間要素と別のフォレスト内の名前空間要素との間に競合が検知されました
<strong>注</strong> :あるフォレスト内の名前空間要素と別のフォレスト内の名前空間要素が重複している場合、名前空間要素の名前の解決があいまいになることがあります。このような重複も衝突と呼ばれます。それぞれのエントリの種類に対してすべてのパラメータが有効なわけではありません。たとえば、&quot;TopLevelName&quot; タイプのエントリには、DNS 名、NetBIOS 名、および SID などのフィールドは無効です。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">769</td>
<td style="border:1px solid black;">信頼されたフォレストの情報が追加されました。
<strong>注</strong> :フォレストの信頼情報が更新されエントリが追加されると、このイベント メッセージが生成されます。エントリが追加、削除、または変更されるたびにイベントメッセージが 1 つ生成されます。フォレスト信頼情報の 1 回の更新で複数のエントリが追加、削除、または変更されると、生成されるすべてのイベント メッセージには、操作 ID と呼ばれる一意の ID が割り当てられます。この機能より、1 回の操作で複数のイベント メッセージが生成されていることがわかります。それぞれのエントリの種類に対してすべてのパラメータが有効なわけではありません。たとえば、&quot;TopLevelName&quot; タイプのエントリには、DNS 名、NetBIOS 名、および SID などのパラメータは無効です。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">770</td>
<td style="border:1px solid black;">信頼されたフォレストの情報が削除されました。
<strong>注</strong> :イベント 769 の注を参照してください。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">771</td>
<td style="border:1px solid black;">信頼されたフォレストの情報が変更されました。
<strong>注</strong> :イベント 769 の注を参照してください。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">805</td>
<td style="border:1px solid black;">イベント ログ サービスによって、セッションのセキュリティ ログ構成が読み取られました。</td>
</tr>
</tbody>
</table>
  
### 特権使用の監査
  
このポリシー設定では、ユーザー権利が実行されるたびに監査するかどうかを指定します。\[特権使用の監査\] で**成功**値をログに記録するよう設定した場合、ユーザー権利の実行が成功するたびに監査エントリが生成されます。**失敗**値をログに記録するよう設定した場合、ユーザー権利の実行が失敗するたびに監査エントリが生成されます。
  
ただし、次のユーザー権利が実行された場合は、大量のイベントがセキュリティ ログに生成されるので、\[特権使用の監査\] を構成しても、監査エントリは生成されません。これらのユーザー権利が監査された場合、コンピュータの次のパフォーマンスに影響が出る可能性があります。
  
-   横断チェックのバイパス
  
-   プログラムのデバッグ
  
-   トークン オブジェクトの作成
  
-   プロセス レベル トークンの置き換え
  
-   セキュリティ監査の生成
  
-   ファイルとディレクトリのバックアップ
  
-   ファイルとディレクトリの復元
  
    **注** :上記のユーザー権利を監査するには、グループ ポリシーの \[監査: バックアップと復元の特権の使用を監査する\] セキュリティ オプションを有効にする必要があります。
  
\[特権使用の監査\] は、LC 環境と EC 環境のベースライン ポリシーでは、既定値の \[監査しない\] のままになっています。SSLF 環境のベースライン ポリシーでは、**失敗**値をログに記録するように設定されています。ユーザー権利の使用に失敗したということは、ネットワーク上で何か問題が発生したことを意味します。また、セキュリティ侵害が試みられたことを示す場合も数多くあります。組織で \[特権使用の監査\] を \[有効\] に設定するのは、業務上の特別な理由がある場合に限定してください。
  
次の表は、この設定によりセキュリティ ログに記録される重要なセキュリティ イベントを示しています。
  
**表 4.8 特権使用イベント**

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >イベント ID</th>
<th style="border:1px solid black;" >イベントの説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">576</td>
<td style="border:1px solid black;">ユーザー アクセス トークンに指定された特権が追加されました
<strong>注</strong> :ユーザーがログオンするとこのイベントが生成されます。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">577</td>
<td style="border:1px solid black;">ユーザーが特権の必要なシステム サービス操作を実行しようとしました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">578</td>
<td style="border:1px solid black;">既に開かれている保護オブジェクトへのハンドルで特権が使用されました。</td>
</tr>
</tbody>
</table>
  
### プロセス追跡の監査
  
このポリシー設定では、プログラムのアクティブ化、プロセスの終了、ハンドルの複製、および間接的オブジェクト アクセスなどの、イベントに関する詳細な追跡情報を監査するかどうかを設定します。このポリシー設定で**成功**値を記録するよう設定した場合、追跡対象の処理が成功するたびに監査エントリが生成されます。**失敗**値を記録するよう設定した場合、追跡対象のプロセスが失敗するたびに監査エントリが生成されます。
  
\[プロセス追跡の監査\] は大量のイベントを生成するので、通常は \[監査しない\] に設定されています。これは、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーでも同様です。ただし、セキュリティ上の問題が発生したときに、このポリシー設定が役に立つことがあります。起動されたプロセスの詳細なログ、および各プロセスの起動時刻を記録することができるからです。
  
次の表は、この設定によりセキュリティ ログに記録される重要なセキュリティ イベントを示しています。
  
**表 4.9 プロセス追跡イベント**

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >イベント ID</th>
<th style="border:1px solid black;" >イベントの説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">592</td>
<td style="border:1px solid black;">新しいプロセスが作成されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">593</td>
<td style="border:1px solid black;">プロセスが終了しました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">594</td>
<td style="border:1px solid black;">オブジェクトへのハンドルが複製されました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">595</td>
<td style="border:1px solid black;">オブジェクトへの間接アクセスが取得されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">596</td>
<td style="border:1px solid black;">データ保護マスタ キーのバックアップが作成されました。
<strong>注</strong> :マスタ キーは CryptProtectData ルーチン、CryptUnprotectData ルーチン、および暗号化ファイル システム (EFS) により使用されます。新しいマスタ キーが作成されるたびに、マスタ キーのバックアップが作成されます (既定の設定は 90 秒)。通常、キーのバックアップはドメイン コントローラに作成されます。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">597</td>
<td style="border:1px solid black;">データ保護マスタ キーが、回復サーバーから回復されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">598</td>
<td style="border:1px solid black;">監査対象データは保護されていました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">599</td>
<td style="border:1px solid black;">監査対象データは保護されていませんでした。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">600</td>
<td style="border:1px solid black;">プロセスにプライマリ トークンが割り当てられました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">601</td>
<td style="border:1px solid black;">ユーザーがサービスをインストールしようとしました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">602</td>
<td style="border:1px solid black;">スケジューラ ジョブが作成されました。</td>
</tr>
</tbody>
</table>
  
### システム イベントの監査
  
このポリシー設定では、ユーザーがコンピュータを再起動またはシャットダウンしたこと、あるいはコンピュータのセキュリティまたはセキュリティ ログに影響を及ぼすイベントが発生したことを、監査するかどうかを指定します。このポリシー設定で**成功**値を記録するように設定した場合、システム イベントの実行が成功するたびに監査エントリが生成されます。**失敗**イベントをログに記録するよう設定した場合、システム イベントを実行しようとして失敗するたびに監査エントリが生成されます。
  
次の表は、この設定で記録する成功のイベントのうち、最も有用なものを示しています。
  
**表 4.10 システム イベントの監査のシステム イベント メッセージ**

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >イベント ID</th>
<th style="border:1px solid black;" >イベントの説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">512</td>
<td style="border:1px solid black;">Windows が起動します。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">513</td>
<td style="border:1px solid black;">Windows がシャットダウンします。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">514</td>
<td style="border:1px solid black;">ローカル セキュリティ パッケージが、ローカル セキュリティ機関により読み込まれました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">515</td>
<td style="border:1px solid black;">信頼されたログオン プロセスが、ローカル セキュリティ機関に登録されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">516</td>
<td style="border:1px solid black;">セキュリティ イベント メッセージをキューに登録するために割り当てられた内部リソースがすべて消費され、一部のセキュリティ イベント メッセージが失われました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">517</td>
<td style="border:1px solid black;">監査ログが消去されました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">518</td>
<td style="border:1px solid black;">通知パッケージがセキュリティ アカウント マネージャにより読み込まれました。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">519</td>
<td style="border:1px solid black;">プロセスが無効なローカル プロシージャ コール (LPC) ポートを使用してクライアントを偽装しようとしたか、またはクライアント アドレス領域で読み取りまたは書き込みを実行しようとしました。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">520</td>
<td style="border:1px solid black;">システム時刻が変更されました。
<strong>注</strong> :この監査は通常 2 回表示されます。</td>
</tr>
</tbody>
</table>
 

[](#mainsection)[ページのトップへ](#mainsection)

ユーザー権利の割り当て
----------------------

ユーザー権利を割り当てられたユーザーとグループは、組織内のコンピュータに対するログオンの権限または特権を持ちます。ログオンの権限の例としては、コンピュータに対話的にログオンする権限があります。特権の例としては、コンピュータをシャット ダウンする権限があります。この 2 種類とも、管理者によって、コンピュータのセキュリティ設定の一部として、個々のユーザーまたはグループに割り当てられます。

**注** :ここの説明では、\[未定義\] はユーザーだけに適用されます。管理者には該当するユーザーの権利が与えられます。ローカルの管理者は、ローカルの \[ユーザー権利の割り当て\] ポリシーを変更できますが、ドメイン単位のグループ ポリシーが更新または再適用されると、そのグループ ポリシーが優先されます。

ユーザーの権利の割り当て設定は、Windows Server 2003 SP1 では、グループ ポリシー オブジェクト エディタの次の場所で構成できます。

**コンピュータの構成\\Windows の設定\\セキュリティの設定\\ローカル ポリシー**
**\\ユーザー権利の割り当て**

ユーザー権利の割り当ての既定値は、組織内のサーバーの種類によって異なります。たとえば、Windows Server 2003 によってビルトイン グループに割り当てられる権利は、メンバ サーバーとドメイン コントローラとで異なります (各種サーバー間におけるビルトイン グループの類似性は、次の一覧には記載されていません)。

-   **Member Servers**

    -   **Power Users**。一部制約はあるものの、管理に関するほとんどの権利があります。Power Users は、Windows Server 2003 SP1 または Windows XP で認定されているアプリケーションに加えて、レガシ アプリケーションを実行できます。

    -   **HelpServicesGroup**。これは、ヘルプとサポート センター用のグループです。このグループの既定のメンバは、Support\_388945a0 です。

    -   **TelnetClients**。このグループのメンバには、ネットワーク上の Telnet サーバーにアクセスする権利があります。

-   **Domain Controllers**

    -   **Server Operators**。このグループのメンバは、ドメイン サーバーを管理できます。

    -   **Terminal Server License Services**。このグループのメンバには、ネットワーク上のターミナル サーバー ライセンス サーバーにアクセスする権利があります。

    -   **Windows Authorization Access Group**。このグループのメンバには、ユーザー オブジェクトの計算済みの tokenGroupsGlobalAndUniversal 属性にアクセスする権利があります。

**Guests** グループ、Guest ユーザー アカウント、および Support\_388945a0 ユーザー アカウントは、ドメインごとに一意の SID を持っています。したがって、ユーザー権利の割り当てに関するグループ ポリシーは、特定のターゲット グループのみが存在するコンピュータでは変更する必要がある場合があります。また、ポリシー テンプレートを個別に修正して、.inf ファイルに適切なグループを追加することもできます。たとえば、テスト環境のドメイン コントローラ上で、ドメイン コントローラ グループ ポリシーを作成できます。

**注** :**Guests** グループのメンバ、Support\_388945a0、および Guest のメンバの間では SID は一意なので、サーバーのセキュリティ強化のために使用されている設定の一部は、このガイドに付属のセキュリティ テンプレートでは自動化できません。これらの設定については、この章で後述する「追加のセキュリティ設定」を参照してください。

ここでは、このガイドで定義している 3 種類の環境に対して規定された MSBP ユーザー権利の割り当て設定について詳しく説明します。ここで説明する規定の設定の概要については、このガイドのダウンロード バージョンに付属の Microsoft Excel ブック「Windows Server 2003 Security Guide Settings」を参照してください。ここで説明している既定の設定と各設定の詳細については、関連ガイド*『脅威とその対策 : Windows Server 2003 と Windows XP のセキュリティ設定』* を参照してください。

次の表に、このガイドで定義している 3 種類のセキュリティ環境に対する、ユーザー権利の割り当ての設定の推奨値を示します。各設定に関する詳細情報については、表の後のサブセクションで説明します。

**表 4.11 ユーザー権利の割り当てに関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">ネットワーク経由でコンピュータへアクセス</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators、Authenticated Users、ENTERPRISE DOMAIN CONTROLLERS</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">オペレーティング システムの一部として機能</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">なし</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">プロセスのメモリ クォータの増加</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators、NETWORK SERVICE、LOCAL SERVICE</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">ローカル ログオンを許可する</td>
<td style="border:1px solid black;">Administrators、Backup Operators、Power Users</td>
<td style="border:1px solid black;">Administrators、Backup Operators、Power Users</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">ターミナル サービスを使ったログオンを許可する</td>
<td style="border:1px solid black;">Administrators、Remote Desktop Users</td>
<td style="border:1px solid black;">Administrators、Remote Desktop Users</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">ファイルとディレクトリのバックアップ</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">横断チェックのバイパス</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Authenticated Users</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">システム時刻の変更</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">ページファイルの作成</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">トークン オブジェクトの作成</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">なし</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">グローバル オブジェクトの作成</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators、SERVICE</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">永続的共有オブジェクトの作成</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">なし</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">プログラムのデバッグ</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
<td style="border:1px solid black;">なし</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">ネットワーク経由でコンピュータへアクセスを拒否する</td>
<td style="border:1px solid black;">ANONOYMOUS LOGON、Guests、Support_388945a0、
すべての非オペレーティング システム サービス アカウント</td>
<td style="border:1px solid black;">ANONOYMOUS LOGON、Guests、Support_388945a0、
すべての非オペレーティング システム サービス アカウント</td>
<td style="border:1px solid black;">ANONOYMOUS LOGON、Guests、Support_388945a0、
すべての非オペレーティング システム サービス アカウント</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">バッチ ジョブとしてログオンを拒否する</td>
<td style="border:1px solid black;">Guests、Support_388945a0</td>
<td style="border:1px solid black;">Guests、Support_388945a0</td>
<td style="border:1px solid black;">Guests、Support_388945a0</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">サービスとしてログオンを拒否する</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">なし</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">ローカルでログオンを拒否する</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Guests、Support_388945a0</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">ターミナル サービスを通したログオンを拒否する</td>
<td style="border:1px solid black;">Guests</td>
<td style="border:1px solid black;">Guests</td>
<td style="border:1px solid black;">Guests</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">コンピュータとユーザー アカウントに委任時の信頼を付与</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">リモート コンピュータからの強制シャットダウン</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">セキュリティ監査の生成</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">NETWORK SERVICE、LOCAL SERVICE</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">認証後にクライアントを偽装</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators、SERVICE</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">スケジューリング優先順位の繰り上げ</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">デバイス ドライバのロードとアンロード</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">メモリ内のページのロック</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">なし</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">バッチ ジョブとしてログオン</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">サービスとしてログオン</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">NETWORK SERVICE</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">監査とセキュリティ ログの管理</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">ファームウェアの環境値の修正</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">ボリュームの保守タスクを実行</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">単一プロセス プロファイル</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">システム パフォーマンスのプロファイル</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">ドッキング ステーションからコンピュータを削除</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">プロセス レベル トークンを置き換える</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">LOCAL SERVICE、NETWORK SERVICE</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">ファイルとディレクトリの復元</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">システムのシャットダウン</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">ディレクトリ サービス データの同期化</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">なし</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">ファイルとその他のオブジェクトの所有権の取得</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
</tbody>
</table>
  
### ネットワーク経由でコンピュータへアクセス
  
このポリシー設定では、ネットワーク経由でコンピュータに接続できるユーザーとグループを指定します。この設定は、サーバー メッセージ ブロック (SMB) ベースのプロトコル、NetBIOS、共通インターネット ファイル システム (CIFS)、HTTP、Component Object Model Plus (COM+) など、数多くのネットワーク プロトコルで必要になります。
  
\[ネットワーク経由でコンピュータへアクセス\] は、LC 環境と EC 環境では \[未定義\] に設定されています。一方、Windows Server 2003 SP1 では、**Everyone** セキュリティ グループにアクセス権限が付与されていても、匿名ユーザーにはアクセス権限が付与されなくなりました。ただし、ゲスト用のグループとアカウントには、**Everyone** セキュリティ グループを介してアクセス権限が付与されます。この理由から、SSLF 環境では、**ネットワーク経由でコンピュータへアクセス** ユーザー権利は **Everyone** セキュリティ グループには付与されないため、ドメインに対するゲスト アクセスをねらった攻撃を防御することができます。SSLF 環境で、このユーザー権利が割り当てられるのは、**Administrators**、**Authenticated Users**、**ENTERPRISE DOMAIN CONTROLLERS** の各グループだけです。
  
### オペレーティング システムの一部として機能
  
このポリシー設定では、プロセスが、識別したユーザー ID を基に、そのユーザーにアクセスが承認されているリソースへのアクセスを取得できるかどうかを指定します。一般に、このユーザー権利を必要とするのは低レベルの認証サービスだけです。
  
\[オペレーティング システムの一部として機能\] ユーザー権利は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、NULL 値または空白に設定されています。これにより、このユーザー権利はどのセキュリティ グループおよびアカウントにも割り当てられません。
  
### プロセスのメモリ クォータの増加
  
このポリシー設定では、プロセスが使用できるメモリの最大容量をユーザーが調整できるかどうかを指定します。コンピュータのチューニングには便利ですが、悪用される可能性があります。攻撃者がユーザー権利を悪用して DoS 攻撃を仕掛ける可能性があります。
  
\[プロセスのメモリ クォータの増加\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Administrators** グループ、NETWORK SERVICE、および LOCAL SERVICE に割り当てます。
  
### ローカル ログオンを許可する
  
このポリシー設定では、指定したコンピュータに対話的にログオンできるユーザーを指定します。キーボードで **Ctrl** + **Alt** + **Del** キーを押してログオン画面を表示してログオンするには、このユーザー権利が必要です。このユーザー権利を持つアカウントは、コンピュータのローカル コンソールへのログオンに使用できます。
  
**ローカル ログオンを許可する** ユーザー権利は、LC 環境と EC 環境の場合、**Administrators**、**Backup Operators**、**Power Users** の各グループだけに割り当てます。こうすることで、承認されていないユーザーがログオンして、ユーザー権利を格上げしたり環境にウイルスを侵入させたりすることを防ぐことができます。SSLF 環境では **Administrators** グループだけに割り当てます。
  
### ターミナル サービスを使ったログオンを許可する
  
このポリシー設定では、ターミナル サービス クライアントとしてログオンできる権限を持つユーザーまたはグループを指定します。
  
**ターミナル サービスを使ったログオンを許可する**ユーザー権利は、LC 環境と EC 環境の場合は **Administrators** グループと **Remote Desktop Users** グループだけに付与します。SSLF 環境の場合、このユーザー権利を割り当てるのは **Administrators** グループのメンバのみです。
  
### ファイルとディレクトリのバックアップ
  
このポリシー設定では、ユーザーがファイルとディレクトリに関する権限とは無関係にコンピュータをバックアップできるかどうかを指定します。この権利は、アプリケーションが、NTBACKUP.EXE などのバックアップ ユーティリティを使用して、NTFS バックアップ アプリケーション プログラミング インターフェイス (API) を介したアクセスを試みる場合にのみ使用されます。このような場合に該当しないときは、通常のファイル権限とディレクトリ権限が適用されます。
  
\[ファイルとディレクトリのバックアップ\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Administrators** グループだけに割り当てられています。
  
### 横断チェックのバイパス
  
このポリシー設定では、ユーザーが NTFS ファイル システムまたはレジストリ内のオブジェクト パスを移動する際、「フォルダのスキャン」という特別なアクセス権限のチェックなしにフォルダ間を移動できるかどうかを指定します。このユーザー権利があっても、ユーザーはディレクトリをスキャンできるだけで、フォルダの内容を一覧表示することはできません。
  
\[横断チェックのバイパス\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Authenticated Users** グループのみに割り当てられます。
  
### システム時刻の変更
  
このポリシー設定では、コンピュータの内蔵クロックの時刻と日付を変更できるユーザーを指定します。イベント ログにはコンピュータの内蔵クロックに基づいてタイムスタンプが記録されるので、このユーザー権利が割り当てられたユーザーは、イベント ログの内容に影響を与えることが可能になります。コンピュータの時刻が変更された場合、イベントが実際に発生した実際の時刻がログに反映されなくなります。
  
\[システム時刻の変更\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Administrators** グループだけに割り当てられています。
  
**注** :ローカル コンピュータの時刻とドメイン コントローラの時刻がずれていると、Kerberos 認証プロトコルで問題が生じることがあります。この場合、ネットワークにログオンしていても、ドメインにログオンできなかったり、ドメイン リソースにアクセスするための認証を取得できなかったりすることがあります。
  
### ページファイルの作成
  
このポリシー設定では、ユーザーがページ ファイルを作成したり、そのサイズを変更したりできるかどうかを指定します。ページ ファイルのサイズを変更するには、\[システムのプロパティ\] ダイアログ ボックスの \[詳細設定\] タブにある \[パフォーマンス オプション\] ボックスで、特定のドライブに対するページ ファイルのサイズを指定します。
  
The\[ページファイルの作成\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Administrators** グループだけに割り当てられています。
  
### トークン オブジェクトの作成
  
このポリシー設定では、プロセスがトークンを作成できるかどうかを指定します。作成できる場合、プロセスは、NtCreateToken() などのトークン作成 API を使用する際に、作成したトークンを使用して任意のローカル リソースにアクセスできます。
  
\[トークン オブジェクトの作成\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このポリシー設定は NULL 値または空白に設定されています。つまり、このユーザー権利を持つセキュリティ グループまたはアカウントはありません。
  
### グローバル オブジェクトの作成
  
このポリシー設定では、すべてのセッションで使用できるグローバル オブジェクトの作成をユーザーに許可します。ただし、このユーザー権利が割り当てられていないユーザーも、そのユーザーのセッションに固有のオブジェクトは作成できます。
  
\[グローバル オブジェクトの作成\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利が割り当てられるのは **SERVICE** グループと **Administrators** グループのみです。
  
### 永続的共有オブジェクトの作成
  
このポリシー設定では、ユーザーがオブジェクト マネージャを使用してディレクトリ オブジェクトを作成できるかどうか、つまり共有フォルダやプリンタなどのオブジェクトを作成できるかどうかを指定します。このユーザー権利は、オブジェクトの名前空間を拡張するカーネル モード コンポーネントに付与されていると利便性が高いため、この種類のコンポーネントには最初から備わっています。したがって、このユーザー権利をユーザーに明示的に割り当てる必要は通常はありません。
  
\[永続的共有オブジェクトの作成\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このポリシー設定は NULL 値または空白に設定されています。つまり、このユーザー権利を持つセキュリティ グループまたはアカウントはありません。
  
### プログラムのデバッグ
  
このポリシー設定では、プロセスまたはカーネルにデバッガを接続できるユーザーを指定します。指定すると、取り扱いに慎重を要する、重要なオペレーティング システム コンポーネントにアクセスできます。特別な場合を除き、プログラムのデバッグを運用環境で行うことは避けてください。この特別な場合には、テスト環境では正確に評価できない基幹アプリケーションをトラブルシューティングする場合などが該当します。
  
\[プログラムのデバッグ\] は、LC 環境では \[未定義\] に設定されています。EC 環境では、このユーザー権利は **Administrators** グループだけに割り当てられています。SSLF 環境では、このポリシー設定は NULL 値または空白に設定されています。つまり、このユーザー権利を持つセキュリティ グループまたはアカウントはありません。
  
**注** :Windows Server 2003 SP1 では、**プログラムのデバッグ**ユーザー権利を削除すると、ユーザーが Windows Update サービスを使用できなくなる可能性があります。ただし、Windows Update を使用しなくても、更新プログラムは手動でダウンロードおよびインストールできます。また、このユーザー権利を削除すると、クラスタ サービスへの妨害になる可能性があります。詳細については、<http://support.microsoft.com/kb/891597> のマイクロソフト サポート技術情報「[Windows Server 2003 ベースのクラスタ サーバーに対して、より制限の厳しいセキュリティ設定を適用する方法](http://support.microsoft.com/kb/891597)」を参照してください。
  
### ネットワーク経由でコンピュータへアクセスを拒否する
  
**注** :ANONYMOUS LOGON、ビルトイン Administrator、Support\_388945a0、Guest、およびすべての非オペレーティング システム サービス アカウントは、.inf セキュリティ テンプレートに含まれていません。これらのアカウントおよびグループは、社内のドメインごとに一意の SID を持っています。このため、これらは手動で追加する必要があります。詳細については、この章の終わり近くにある「手動での強化処理」を参照してください。
  
このポリシー設定では、ネットワーク経由でコンピュータに接続できないユーザーを指定します。このポリシー設定により、SMB ベースのプロトコル、NetBIOS、CIFS、HTTP、COM+ など、数多くのネットワーク プロトコルが利用できなくなります。また、このポリシー設定と**ネットワーク経由でコンピュータへアクセス**ユーザー権利の両方の対象となっているユーザー アカウントでは、このポリシー設定が優先されます。
  
このガイドで定義している 3 種類の環境すべてについて、**ネットワーク経由でコンピュータへアクセスを拒否する**ユーザー権利は、**Guests** グループ、ANONOYMOUS LOGON、Support\_388945a0、およびオペレーティング システム以外のすべてのサービス アカウントに割り当てます。
  
このポリシー設定を他のグループに構成すると、ユーザー環境の特定の管理役割に割り当てられているユーザーの能力が制限されることがあります。委任されたタスクが悪影響を受けないことを確認してください。
  
### バッチ ジョブとしてログオンを拒否する
  
**注** :ANONYMOUS LOGON、ビルトイン Administrator、Support\_388945a0、Guest、およびすべての非オペレーティング システム サービス アカウントは、.inf セキュリティ テンプレートに含まれていません。これらのアカウントおよびグループは、社内のドメインごとに一意の SID を持っています。このため、これらは手動で追加する必要があります。詳細については、この章の終わり近くにある「手動での強化処理」を参照してください。
  
このポリシー設定では、バッチ ジョブとしてコンピュータにログオンできないアカウントを指定します。バッチ ジョブとは、バッチ ファイル (.bat) のことではなく、バッチ キュー機能のことです。タスク スケジューラを使用してジョブをスケジュールするアカウントには、このユーザー権利が必要です。
  
**バッチ ジョブとしてログオンを拒否する**ユーザー権利は、**バッチ ジョブとしてログオン** ユーザー権利よりも優先されるため、システム リソースを大量消費するジョブのスケジュールをアカウントに許可するのに使用される可能性があります。このような操作をされると、DoS 状態が発生することがあります。この理由から、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、**バッチ ジョブとしてログオンを拒否する**ユーザー権利は **Guests** グループと Support\_388945a0 ユーザー アカウントに割り当てます。このユーザー権利を推奨アカウントに割り当てておかないと、セキュリティ リスクになる可能性があります。
  
### サービスとしてログオンを拒否する
  
このポリシー設定では、指定アカウントのコンテキストでサービスを起動できるかどうかを指定します。
  
\[サービスとしてログオンを拒否する\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このポリシー設定は NULL 値または空白に設定されています。つまり、このユーザー権利を持つセキュリティ グループまたはアカウントはありません。
  
### ローカルでログオンを拒否する
  
このポリシー設定では、ユーザーがコンピュータのキーボードから直接ログオンできるかどうかを指定します。
  
\[ローカルでログオンを拒否する\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Guests** グループと Support\_388945a0 ユーザー アカウントだけに割り当てられています。このユーザー権利を推奨アカウントに割り当てておかないと、セキュリティ リスクになる可能性があります。
  
### ターミナル サービスを使ったログオンを拒否する
  
**注** :ANONYMOUS LOGON、ビルトイン Administrator、Support\_388945a0、Guest、およびすべての非オペレーティング システム サービス アカウントは、.inf セキュリティ テンプレートに含まれていません。これらのアカウントおよびグループは、社内のドメインごとに一意の SID を持っています。このため、これらは手動で追加する必要があります。詳細については、この章の終わり近くにある「手動での強化処理」を参照してください。
  
このポリシー設定では、ユーザーがターミナル サービス クライアントとしてログオンできるかどうかを指定します。ベースライン メンバ サーバーをドメイン環境に参加させた後に、ローカル アカウントを使用してネットワークからサーバーにアクセスする必要はありません。ドメイン アカウントを使用することで、サーバーにアクセスして管理作業やエンドユーザー作業を行うことができます。
  
このガイドで定義している 3 つの環境のすべてで、**Guests** グループに**ターミナル サービスを使ったログオンを拒否する**ユーザー権利を割り当てて、ターミナル サービス経由ではログオンできないようにします。
  
### コンピュータとユーザー アカウントに委任時の信頼を付与
  
このポリシー設定では、ユーザーが Active Directory 内のユーザー オブジェクトまたはコンピュータ オブジェクトの **委任に対する信頼**の設定を変更できるかどうかを指定します。このユーザー権利が割り当てられたユーザーまたはコンピュータには、オブジェクトのアカウント制御フラグに対する書き込みアクセス権が必要です。このユーザー権利が誤用されると、承認されていないユーザーがネットワーク上の他のユーザーになりすますおそれがあります。
  
\[コンピュータとユーザー アカウントに委任時の信頼を付与\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Administrators** グループだけに割り当てられています。
  
### リモート コンピュータからの強制シャットダウン
  
このポリシー設定では、ユーザーがネットワーク上のリモートからコンピュータをシャットダウンできるかどうかを指定します。コンピュータをシャットダウンできるユーザーが存在すると、DoS 状態の発生の原因になる可能性があります。したがって、このユーザー権利は厳しく制限する必要があります。
  
\[リモート コンピュータからの強制シャットダウン\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Administrators** グループだけに割り当てられています。
  
### セキュリティ監査の生成
  
このポリシー設定では、プロセスがセキュリティ ログに監査レコードを生成できるかどうかを指定します。セキュリティ ログは不正なアクセスの追跡に使用されることがあることから、攻撃者がセキュリティ ログへの書き込みが可能なアカウントを使用して、セキュリティ ログを無意味なイベントでいっぱいにすることがあります。必要に応じてイベントを上書きするようにコンピュータが構成されている場合、攻撃者はこの機能を悪用して、許可されていないアクティビティの証拠を削除できます。セキュリティ ログに書き込むことができない場合にコンピュータがシャットダウンされるように構成されていると、この方法を使用して DoS 状態にされることがあります。
  
\[セキュリティ監査の生成\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は NETWORK SERVICE および LOCAL SERVICE だけに割り当てられています。
  
### 認証後にクライアントを偽装
  
このポリシー設定では、認証されたユーザーに代わって実行されるアプリケーションが、クライアントを偽装できるかどうかを指定します。このような偽装にこのユーザー権利が必要な場合には、認証されていないユーザーがクライアントを誘導して、リモート プロシージャ コール (RPC) や名前付きパイプなどにより、認証されていないユーザーがクライアントを偽装するために作成したサービスにクライアントを接続させることはできません。クライアントを偽装できる場合、認証されていないユーザーが権限を管理レベルやシステム レベルに格上げすることが可能になります。
  
\[認証後にクライアントを偽装\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Administrators** グループと SERVICE だけに割り当てられています。
  
### スケジューリング優先順位の繰り上げ
  
このポリシー設定では、ユーザーがプロセスの基本優先順位のクラスを繰り上げることができるかどうかを指定します。優先順位クラスにおける相対的な優先順位の繰り上げは、特権が与えられた操作ではありません。このユーザー権利は、オペレーティング システムの管理ツールでは必要ありませんが、ソフトウェア開発ツールでは必要になることがあります。このユーザー権利が割り当てられたユーザーは、プロセスのスケジューリング優先順位を \[リアルタイム\] に繰り上げることができます。ただしこの場合、他のすべてのプロセスに割り当て可能な処理時間が少なくなるので、DoS 状態の原因になる可能性があります。
  
\[スケジューリング優先順位の繰り上げ\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Administrators** グループだけに割り当てられています。
  
### デバイス ドライバのロードとアンロード
  
このポリシー設定では、デバイス ドライバを動的にロードおよびアンロードできるユーザーを指定します。このユーザー権利は、新しいハードウェアの署名済みドライバが、コンピュータ上の Driver.cab ファイル内に既に存在する場合は不要です。デバイス ドライバは、高度な特権が与えられたコードとして実行されます。**デバイス ドライバのロードとアンロード** ユーザー権利が割り当てられたユーザーは、デバイス ドライバに見せかけた悪質なコードを誤ってまたは意図的にインストールすることが可能です(管理者は検証済みのデジタル署名付きのドライバのみがインストールされるように十分注意する必要があります)。
  
\[デバイス ドライバのロードとアンロード\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Administrators** グループだけに割り当てられています。
  
### メモリ内のページのロック
  
このポリシー設定では、プロセスが物理メモリにデータを保持できるかどうかを指定します。指定すると、コンピュータがデータをディスク上の仮想メモリにページングできなくなります。このような状態になると、パフォーマンスが大幅に低下します。このユーザー権利が割り当てられたユーザーは、物理メモリを複数のプロセスに割り当てることで、他のプロセスに割り当て可能なランダム アクセス メモリ (RAM) の容量をゼロに近い状態にするか、またはゼロにすることが可能になります。この場合は、DoS 状態の原因となる可能性があります。
  
\[メモリ内のページのロック\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このポリシー設定は NULL 値または空白に設定されています。つまり、このユーザー権利を持つセキュリティ グループまたはアカウントはありません。
  
### サービスとしてログオン
  
このポリシー設定では、セキュリティ プリンシパルがサービスとしてログオンできるかどうかを指定します。サービスは、サービスとしてログオンするビルトイン権利を持つ Local System、Local Service、または Network Service のアカウントで実行するように構成できます。別のユーザー アカウントで実行されるサービスには、このユーザー権利を割り当てる必要があります。
  
\[サービスとしてログオン\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は Network Service アカウントだけに割り当てられています。
  
### 監査とセキュリティ ログの管理
  
このポリシー設定では、ファイル、Active Directory オブジェクト、レジストリ キーなどの個々のリソースのオブジェクト アクセス監査オプションをユーザーが指定できるかどうかを指定します。このユーザー権利は影響力が強いので、厳重な保護が必要です。このユーザー権利を持つユーザーは、セキュリティ ログをクリアできます。つまり、不正なアクティビティの重要証拠を消すことができます。
  
\[監査とセキュリティ ログの管理\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Administrators** だけに割り当てられています。
  
**重要 :** Microsoft Exchange Server 2003 では、既定のドメイン コントローラ ポリシーのこのユーザー権利はインストール処理中に変更されます。詳細については、[http://www.microsoft.com/technet/prodtechnol/exchange/guides/E2k3ADPerm/110e37bf-a68c-47bb-b4d5-1cfd539d9cba.mspx](http://www.microsoft.com/technet/prodtechnol/exchange/guides/e2k3adperm/110e37bf-a68c-47bb-b4d5-1cfd539d9cba.mspx) の「[Exchange Server 2003 Deployment](http://www.microsoft.com/technet/prodtechnol/exchange/guides/e2k3adperm/110e37bf-a68c-47bb-b4d5-1cfd539d9cba.mspx)」(英語情報) を参照してください。このユーザー権利が Administrators グループに限定されている場合、Exchange によりエラー メッセージが頻繁にアプリケーション イベント ログに記録されます。Exchange Server 2003 を使用する場合、ドメイン コントローラでこの設定の値を調整する必要があります。このガイドのすべての推奨設定と同様に、組織のアプリケーションを正常に動作させるために何らかの調整が必要になる場合があります。
  
### ファームウェアの環境値の修正
  
このポリシー設定では、プロセスが API を使用して、またはユーザーが \[システムのプロパティ\] を使用して、コンピュータの環境変数を変更できるかどうかを指定します。このユーザー権利が割り当てられたユーザーは、ハードウェア コンポーネントの設定値を構成できますが、構成した結果、ハードウェアに不具合が発生する可能性もあります。この場合、データが破損したり DoS 状態が発生するおそれがあります。
  
\[ファームウェアの環境値の修正\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Administrators** グループだけに割り当てられています。
  
### ボリュームの保守タスクを実行
  
このポリシー設定では、管理者でないユーザーまたはリモート ユーザーがボリュームまたはディスクを管理できるかどうかを指定します。このユーザー権利が割り当てられたユーザーはボリュームを削除でき、それによりデータが失われたり、DoS 状態が発生するおそれがあります。
  
\[ボリュームの保守タスクを実行\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Administrators** グループだけに割り当てられています。
  
### 単一プロセス プロファイル
  
このポリシー設定では、システム プロセス以外のプロセスのパフォーマンスをパフォーマンス監視ツールで監視できるユーザーを指定します。このユーザー権利の脆弱性は、中程度です。このユーザー権利を使用できる攻撃者は、コンピュータのパフォーマンスを監視して、直接の攻撃目標である重要なプロセスを識別することが可能です。また、コンピュータ上で動作しているプロセスを調べて、ウイルス対策ソフトウェア、侵入検知プログラムなどのセキュリティ対策を特定して回避するか、またはコンピュータにログオンしている他のユーザーなどを特定することが可能です。
  
\[単一プロセス プロファイル\] は、LC 環境と EC 環境では \[未定義\] に設定されています。セキュリティを強化するため、SSLF 環境では、Power Users グループにこのユーザー権利が割り当てられていないことを確認します。SSLF 環境では、この権利を割り当てるのは **Administrators** グループのメンバだけに限定してください。
  
### システム パフォーマンスのプロファイル
  
このポリシー設定は、前述の設定に似ています。このポリシー設定では、ユーザーがシステム プロセスのパフォーマンスを監視できるかどうかを指定します。このユーザー権利の脆弱性は、中程度です。このユーザー権利を使用できる攻撃者は、コンピュータのパフォーマンスを監視して、直接の攻撃目標である重要なプロセスを識別することが可能です。また、コンピュータ上で動作しているプロセスを調べて、ウイルス対策ソフトウェアや侵入検知プログラムなどを特定して回避することも可能です。
  
\[システム パフォーマンスのプロファイル\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Administrators** グループだけに割り当てられています。
  
### ドッキング ステーションからコンピュータを削除
  
このポリシー設定では、ポータブル コンピュータのユーザーが \[スタート\] メニューの \[PC の取り外し\] をクリックしてコンピュータのドッキングを解除できるかどうかを指定します。このユーザー権利が割り当てられたユーザーは、ドッキング ステーションからポータブル コンピュータを取り外すことができます。
  
\[ドッキング ステーションからコンピュータを削除\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Administrators** グループだけに割り当てられています。
  
### プロセス レベル トークンを置き換える
  
このポリシー設定では、子プロセスに関連付けられているアクセス トークンを親プロセスが置換できるかどうかを指定します。
  
\[プロセス レベル トークンを置き換える\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は LOCAL SERVICE と NETWORK SERVICE だけに割り当てられています。
  
### ファイルとディレクトリの復元
  
このポリシー設定では、パックアップしたファイルやディレクトリの復元時にファイル、ディレクトリ、レジストリなどの永続的なオブジェクトをバイパスできるユーザーを指定します。また、有効なセキュリティ プリンシパルをオブジェクトの所有者として設定する権限を持つ、ユーザーも設定します。
  
\[ファイルとディレクトリの復元\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Administrators** グループだけに割り当てられています。ファイルの復元作業は、通常、管理者または特別に委任された他のセキュリティ グループのメンバが実行します。機密性の高いサーバーやドメイン コントローラの場合は、特にそのようになります。
  
### システムのシャットダウン
  
このポリシー設定では、**シャットダウン** コマンドを使用してオペレーティング システムをシャットダウンできる、ローカルにログオンしたユーザーを指定します。この機能の誤用すると、DoS 状態が発生することがあるので、ドメイン コントローラをシャットダウンの実行者は、信頼できるごく少数の管理者に限定する必要があります。システムをシャットダウンするためにはサーバーにログオンできる必要がありますが、ドメイン コントローラのシャットダウンを許可するアカウントやグループについては慎重に決定しなければなりません。
  
\[システムのシャットダウン\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利は **Administrators** グループだけに割り当てられています。
  
### ディレクトリ サービス データの同期化
  
このポリシー設定では、オブジェクトとプロパティに対する保護に関係なく、プロセスがディレクトリ内のすべてのオブジェクトやプロパティを読み取ることができるかどうかを指定します。このユーザー権利は、LDAP ディレクトリ同期 (Dirsync) サービスを使用するために必要です。
  
\[ディレクトリ サービス データの同期化\] の既定値は \[未定義\] で、LC 環境と EC 環境にはこれで十分です。SSLF 環境では、このポリシー設定は NULL 値または空白に設定されています。つまり、このユーザー権利を持つセキュリティ グループまたはアカウントはありません。
  
### ファイルとその他のオブジェクトの所有権の取得
  
このポリシー設定では、Active Directory オブジェクト、NTFS ファイル システム (NTFS) のファイルとフォルダ、プリンタ、レジストリ キー、プロセス、スレッドなど、ネットワーク内のセキュリティ保護可能なオブジェクトの所有権をユーザーが取得できるかどうかを指定します。
  
\[ファイルとその他のオブジェクトの所有権の取得\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境では、このユーザー権利はローカルの **Administrators** グループだけに割り当てられています。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
セキュリティ オプション  
-----------------------
  
グループ ポリシーのセキュリティ オプション セクションのポリシー設定では、フロッピー ディスク ドライブへのアクセス、CD-ROM ドライブへのアクセス、ログオン プロンプトなどの機能を有効にするのか、または無効にするのかを指定します。また、これらのポリシー設定は、データのデジタル署名、管理者およびゲストのアカウント名、ドライバ インストールの動作など、その他の各種設定の構成にも使用します。
  
セキュリティ オプションの設定は、Windows Server 2003 SP1 では、グループ ポリシー オブジェクト エディタを使用して、次の場所で構成できます。
  
**コンピュータの構成\\Windows の設定\\セキュリティの設定\\ローカル ポリシー**  
**\\セキュリティ オプション**
  
ここで説明している設定は、すべての種類のコンピュータに存在するわけではありません。このため、グループ ポリシーのセキュリティ オプション部分の設定のうち、ここで定義されているものを完全に運用可能にするには、それらが存在するコンピュータで設定を手動で変更する必要があります。
  
ここでは、このガイドで定義している 3 種類の環境について規定された MSBP セキュリティ オプション設定について詳しく説明します。規定の設定の概要については、このガイドのダウンロード バージョンに付属の Microsoft Excel ブック「Windows Server 2003 Security Guide Settings」を参照してください。既定の設定と各設定の詳細については、関連ガイド*『脅威とその対策 : WindowsServer 2003 と Windows XP のセキュリティ設定』*を参照してください。
  
以下のそれぞれの項の表では、各種のセキュリティ オプション設定の推奨設定をまとめています。各設定に関する詳細情報については、それぞれの表の後のサブセクションで説明します。
  
### アカウントの設定
  
**表 4.12 セキュリティ オプション: アカウントに関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">Administrator アカウントの状態</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Guest アカウントの状態</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">ローカル アカウントの空のパスワードの使用をコンソール ログオンのみに制限する</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
</tbody>
</table>
  
#### アカウント:Administrator アカウントの状態
  
このポリシー設定では、通常の操作時に Administrator アカウントを有効にするのか、または無効にするのかを指定します。コンピュータをセーフ モードで起動した場合は、この設定に関係なく、Administrator アカウントは常に有効です。
  
\[アカウント: Administrator アカウントの状態\] は、LC 環境と EC 環境では \[未定義\] に設定されており、SSLF 環境では \[有効\] に設定されています。
  
#### アカウント:Guest アカウントの状態
  
このポリシー設定では、Guest アカウントが有効か無効かを指定します。Guest アカウントを有効にすると、承認されていないネットワーク ユーザーが、Guest アカウントでログオンしてコンピュータにアクセスできます。
  
\[アカウント: Guest アカウントの状態\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで \[無効\] に設定されています。
  
#### アカウント:ローカル アカウントの空のパスワードの使用をコンソール ログオンのみに制限する
  
このポリシー設定では、パスワード保護されていないローカル アカウントを使用して、物理コンピュータのコンソール以外の場所からログオンできるかどうかを指定します。このポリシー設定が有効の場合、パスワードが空白でないローカル アカウントを使用してリモート クライアントからネットワークにログオンすることはできません。また、パスワード保護されていないローカル アカウントを使用する場合、そのコンピュータに物理的に接続されたキーボードから直接ログオンすることだけが可能です。
  
このガイドで定義している 3 つの環境すべてのベースライン ポリシーでは、\[アカウント: ローカル アカウントの空のパスワードの使用をコンソール ログオンのみに制限する\] は \[有効\] に設定されています。
  
### 監査の設定
  
**表 4.13 セキュリティ オプション :監査に関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">グローバル システム オブジェクトへのアクセスを監査する</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">バックアップと復元の特権の使用を監査する</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">セキュリティ監査のログを記録できない場合は直ちにシステムをシャットダウンする</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">有効</td>
</tr>
</tbody>
</table>
  
#### 監査:グローバル システム オブジェクトへのアクセスを監査する
  
このポリシー設定が有効な場合、グローバル システム オブジェクトへのアクセスが監査されます。\[監査: グローバル システム オブジェクトへのアクセスを監査する\] と \[オブジェクト アクセスの監査\] の監査ポリシーの両方を有効にした場合、大量の監査イベントが生成されます。
  
\[監査: グローバル システム オブジェクトへのアクセスを監査する\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、既定値である \[無効\] に設定されています。
  
**注** :このポリシー設定の設定内容を変更した場合、Windows Server 2003 を再起動するまで、変更結果は反映されません。
  
#### 監査:バックアップと復元の特権の使用を監査する
  
このポリシー設定では、\[特権使用の監査\] の有効時に、バックアップと復元を含むすべてのユーザー特権の使用を監査するかどうかを指定します。このポリシー設定を有効にすると、大量のセキュリティ イベントが生成される可能性があります。これにより、サーバーの応答が遅くなったり、セキュリティ ログに重要ではない数多くのイベントが記録されることがあります。
  
このため、\[監査: バックアップと復元の特権の使用を監査する\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、既定値である \[無効\] に設定されています。
  
**注** :このポリシー設定の設定内容を変更した場合、Windows Server 2003 を再起動するまで、変更結果は反映されません。
  
#### 監査:セキュリティ監査のログを記録できない場合は直ちにシステムをシャットダウンする
  
このポリシー設定では、セキュリティ イベントをログに記録できない場合にコンピュータを直ちにシャットダウンするかどうかを指定します。
  
LC 環境と EC 環境では、\[監査: セキュリティ監査のログを記録できない場合は直ちにシステムをシャットダウンする\] を有効にすると、必要な管理作業の負担が大きくなります。したがって、このポリシー設定は、これらの環境のベースライン ポリシーでは \[無効\] に設定されています。SSLF 環境のベースライン ポリシーでは \[有効\] に設定されています。これは、管理者が特に別の値を選択しない限り、セキュリティ ログからのイベントの削除を防ぐために管理作業の負担が大きくなってもやむを得ないと考えられるからです。
  
### デバイスの設定
  
**表 4.14 セキュリティ オプション :デバイスに関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">ログオンなしの装着解除を許可する</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">リムーバブル メディアを取り出すのを許可する</td>
<td style="border:1px solid black;">Administrators</td>
<td style="border:1px solid black;">Administrators</td>
<td style="border:1px solid black;">Administrators</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">ユーザーがプリンタ ドライバをインストールできないようにする</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">CD-ROM へのアクセスを、ローカル ログオン ユーザーだけに制限する</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">無効</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">フロッピーへのアクセスを、ローカル ログオン ユーザーだけに制限する</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">無効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">署名されていないドライバのインストール時の動作</td>
<td style="border:1px solid black;">警告するがインストールは許可する</td>
<td style="border:1px solid black;">警告するがインストールは許可する</td>
<td style="border:1px solid black;">警告するがインストールは許可する</td>
</tr>
</tbody>
</table>
  
#### デバイス:ログオンなしの装着解除を許可する
  
このポリシー設定では、ユーザーがコンピュータにログオンしなくてもポータブル コンピュータのドッキングを解除できるかどうかを指定します。このポリシー設定を有効にした場合、ログオン操作が不要になり、外部ハードウェアの取り外しボタンを押してコンピュータをドッキング ステーションから取り外すことができます。このポリシー設定を無効にする場合、ログオンしないユーザーに**ドッキング ステーションからコンピュータを削除**ユーザー権利を割り当てる必要があります。
  
\[デバイス: ログオンなしの装着解除を許可する\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで \[無効\] に設定されています。
  
#### デバイス:リムーバブル メディアを取り出すのを許可する
  
このポリシー設定では、リムーバブル メディアのフォーマットおよび取り出しを実行できるユーザーを指定します。サーバーのリムーバブル メディアを取り出す権限は、管理者にのみ付与すべきです。
  
このため、\[デバイス: リムーバブル メディアを取り出すのを許可する\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、既定値である \[無効\] に設定されています。
  
#### デバイス:ユーザーがプリンタ ドライバをインストールできないようにする
  
あるコンピュータ上でネットワーク プリンタに印刷するには、そのネットワークプリンタ用ドライバがそのコンピュータにインストールされている必要があります。\[デバイス: ユーザーがプリンタ ドライバをインストールできないようにする\] を有効にすると、**Administrators** グループのユーザー、**Power Users** グループのユーザー、または Server Operator 権限を持つユーザーのみが、プリンタ ドライバをインストールしてネットワーク プリンタを追加できるようになります。このポリシー設定を無効にすると、ユーザーはプリンタ ドライバをインストールできるようになります。
  
\[デバイス: ユーザーがプリンタ ドライバをインストールできないようにする\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、既定値である \[有効\] に設定されています。
  
#### デバイス:CD-ROM へのアクセスを、ローカル ログオン ユーザーだけに制限する
  
このポリシー設定では、ローカル ユーザーとリモート ユーザーの両方が同時に CD-ROM にアクセスできるようにするかどうかを設定します。このポリシー設定を有効にすると、対話型でログオンしたユーザーに対してのみ、リムーバル CD-ROM メディアへのアクセスが許可されます。このポリシー設定が有効でも、対話的にログオンしているユーザーがいない場合は、ネットワーク経由で CD-ROM にアクセスできます。
  
\[デバイス: CD-ROM へのアクセスを、ローカル ログオン ユーザーだけに制限する\] は、LC 環境と EC 環境のベースライン ポリシーでは \[未定義\] に設定されています。SSLF 環境のベースライン ポリシーでは、このポリシー設定は \[無効\] に設定されています。
  
#### デバイス:フロッピーへのアクセスを、ローカル ログオン ユーザーだけに制限する
  
このポリシー設定では、ローカル ユーザーとリモート ユーザーの両方が同時にリムーバブル フロッピー メディアにアクセスできるようにするかどうかを指定します。このポリシー設定を有効にすると、対話型でログオンしたユーザーに対してのみ、リムーバル フロッピー メディアへのアクセスが許可されます。このポリシー設定が有効でも、対話的にログオンしているユーザーがいない場合は、ネットワーク経由でフロッピー ディスク メディアにアクセスできます。
  
\[デバイス: フロッピーへのアクセスを、ローカル ログオン ユーザーだけに制限する\] は、LC 環境と EC 環境のベースライン ポリシーでは \[未定義\] に設定されています。SSLF 環境のベースライン ポリシーでは、このポリシー設定は \[無効\] に設定されています。
  
#### デバイス:署名されていないドライバのインストール時の動作
  
このポリシー設定では、Windows Hardware Quality Lab (WHQL) による承認と署名がないデバイス ドライバが (Setup API を介して) インストールされようとしたときの動作を指定します。このポリシー設定の指定に応じて、署名のないドライバのインストールが中止されるか、または、署名のないドライバがインストールされようとしている旨の警告が管理者に通知されます。
  
\[デバイス: 署名されないドライバのインストール時の動作\] 設定は、Windows Server2003 SP1 での実行が認証されていないドライバのインストール防止に使用できます。ただし、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、このポリシー設定は \[警告するがインストールは許可する\] に設定されています。この指定の潜在的な問題の 1 つは、無人インストール スクリプトで署名のないドライバをインストールしようとするとスクリプトが失敗することです。
  
### ドメイン メンバの設定
  
**表 4.15 セキュリティ オプション :ドメイン メンバに関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">常にセキュリティ チャネルのデータをデジタル的に暗号化または署名する</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">可能な場合、セキュリティ チャネルのデータをデジタル的に暗号化する</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">可能な場合、セキュリティ チャネルのデータをデジタル的に署名する</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">コンピュータ アカウント パスワード: 定期的な変更を無効にする</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">最大コンピュータ アカウントのパスワードの有効期間</td>
<td style="border:1px solid black;">30 日間</td>
<td style="border:1px solid black;">30 日間</td>
<td style="border:1px solid black;">30 日間</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">強力な (Windows 2000、Windows XP、または Windows Server 2003) セッション キーを必要とする</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
</tbody>
</table>
  
#### ドメイン メンバ:常にセキュリティ チャネルのデータをデジタル的に暗号化または署名する
  
このポリシー設定では、ドメイン メンバから送信されたすべてのセキュリティ チャネル トラフィックが署名または暗号化される必要があるかどうかを指定します。セキュリティ チャネルのデータが常に暗号化または署名される設定のコンピュータは、すべてのセキュリティ チャネル トラフィックを署名または暗号化できないドメイン コントローラとはセキュリティ チャネルを確立できません。
  
\[ドメイン メンバ: 常にセキュリティ チャネルのデータをデジタル的に暗号化または署名する\] は、LC 環境のベースライン ポリシーでは \[無効\] に設定されており、EC 環境と SSLF 環境の場合には \[有効\] に設定されています。
  
**注** :メンバ ワークステーションとサーバーでこの設定を活用するには、メンバのドメインを構成するすべてのドメイン コントローラで、Windows NT 4.0 Service Pack 6a またはそれ以降のバージョンの Windows を実行している必要があります。また、Dsclient がインストールされていない Windows 98 Second Edition クライアントでは、このポリシー設定はサポートされません。
  
#### ドメイン メンバ:可能な場合、セキュリティ チャネルのデータをデジタル的に暗号化する
  
このポリシー設定では、ドメイン メンバから送信される、すべてのセキュリティ チャネル トラフィックに対して、ドメイン メンバが暗号化のネゴシエートを試行できるかどうかを指定します。このポリシー設定を有効にすると、ドメイン メンバはセキュリティ保護されたチャネルのすべてのトラフィックを暗号化するように要求します。無効にすると、ドメイン メンバはセキュリティ チャネル暗号化のネゴシエートを許可しません。
  
このため、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、\[ドメイン メンバ: 可能な場合、セキュリティ チャネルのデータをデジタル的に暗号化する\] は \[有効\] に設定されています。
  
#### ドメイン メンバ:可能な場合、セキュリティ チャネルのデータをデジタル的に署名する
  
このポリシー設定では、ドメイン メンバから送信される、すべてのセキュリティ チャネル トラフィックに対して、ドメイン メンバが署名のネゴシエートを試行できるかどうかを指定します。署名を必須にすることにより、データの取得が可能なユーザーによってトラフィックが変更されないようにします。
  
このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、\[ドメイン メンバ: 可能な場合、セキュリティ チャネルのデータをデジタル的に署名する\] は \[有効\] に設定されています。
  
#### ドメイン メンバ:コンピュータ アカウント パスワード: 定期的な変更を無効にする
  
このポリシー設定では、ドメイン メンバがそのコンピュータ アカウント パスワードを定期的に変更できるかどうかを指定します。このポリシー設定を有効にすると、ドメイン メンバはそのコンピュータ アカウント パスワードを変更できません。無効にすると、ドメイン メンバは、\[ドメイン メンバ: 最大コンピュータ アカウントのパスワードの有効期間\] で指定された間隔 (既定値は 30 日) で、そのコンピュータのアカウントのパスワードを変更できます。
  
コンピュータのアカウント パスワードが自動的に変更されない場合は、そのコンピュータのドメイン アカウントのパスワードが攻撃者に特定されると、攻撃を受ける可能性があります。このため、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、\[ドメイン メンバ: コンピュータ アカウント パスワード: 定期的な変更を無効にする\] は \[無効\] に設定されています。
  
#### ドメイン メンバ:最大コンピュータ アカウントのパスワードの有効期間
  
このポリシー設定では、コンピュータ アカウント パスワードの有効期間の上限を指定します。このポリシー設定は、Windows 2000 を実行しているコンピュータでもサポートされていますが、Windows 2000 マシンの Security Configuration Manager ツールでこの設定を指定することはできません。既定では、各ドメイン メンバはそのドメイン パスワードを 30 日ごとに自動変更します。この間隔を大幅に延ばすか、またはこの設定を 0 にしてコンピュータがパスワードを変更しないようにすると、攻撃者がブルート フォース攻撃を仕掛けて 1 つまたは複数のコンピュータ アカウントのパスワードを推測するのにかける時間が長くなります。
  
このため、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーでは、\[ドメイン メンバ: 最大コンピュータ アカウントのパスワードの有効期間\] は \[30 日\] に設定されています。
  
#### ドメイン メンバ:強力な (Windows 2000 かそれ以降のバージョン) セッション キーを必要とする
  
このポリシー設定では、暗号化されたセキュリティ チャネルのデータに 128 ビット キー強度が必要かどうかを指定します。このポリシー設定を有効にすると、セキュリティ チャネルは 128 ビット暗号化が使用されない限り確立されません。無効にすると、ドメイン メンバはドメイン コントローラ間でキーの長さをネゴシエートする必要があります。ドメイン コントローラとメンバ コンピュータ間でセキュリティで保護されたチャネル通信を確立するために使用されるセッション キーの強度が、Windows 2000 では以前の Microsoft オペレーティング システムのセッション キーより高くなっています。
  
このガイドで定義している 3 種類のセキュリティ環境には Windows 2000 以降のドメイン コントローラが必ず含まれているので、3 種類のセキュリティ環境すべてのベースライン ポリシーで、\[ドメイン メンバ: 強力な (Windows 2000 かそれ以降のバージョン) セッション キーを必要とする\] は \[有効\] に設定されています。
  
**注** :このポリシー設定を有効にすると、Windows 2000 を実行しているコンピュータを Windows NT 4.0 ドメインに参加させることができなくなります。
  
### 対話型ログオンの設定
  
**表 4.16 セキュリティ オプション :対話型ログオンに関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">セッションがロックされているときにユーザーの情報を表示する</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">ユーザー表示名、ドメインおよびユーザー名</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">最後のユーザー名を表示しない</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Ctrl+Alt+Del を必要としない</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">ログオン時のユーザーへのメッセージのテキスト</td>
<td style="border:1px solid black;">(組織の担当者に相談のこと)</td>
<td style="border:1px solid black;">(組織の担当者に相談のこと)</td>
<td style="border:1px solid black;">(組織の担当者に相談のこと)</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">ログオン時のユーザーへのメッセージのタイトル</td>
<td style="border:1px solid black;">(組織の担当者に相談のこと)</td>
<td style="border:1px solid black;">(組織の担当者に相談のこと)</td>
<td style="border:1px solid black;">(組織の担当者に相談のこと)</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">ドメイン コントローラが利用できない場合に使用する、前回ログオンのキャッシュ数</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">0</td>
<td style="border:1px solid black;">0</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">パスワードが無効になる前にユーザーに変更を促す</td>
<td style="border:1px solid black;">14 日</td>
<td style="border:1px solid black;">14 日</td>
<td style="border:1px solid black;">14 日</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">workstation のロック解除にドメイン コントローラの認証を必要とする</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">スマート カードが必要</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">無効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">スマート カード取り出し時の動作</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">ワークステーションをロックする</td>
<td style="border:1px solid black;">ワークステーションをロックする</td>
</tr>
</tbody>
</table>
  
#### 対話型ログオン:セッションがロックされているときにユーザーの情報を表示する
  
このポリシー設定では、組織内のクライアント コンピュータに最後にログオンしたユーザーのアカウント名を各コンピュータの Windows ログオン画面に表示するかどうかを指定します。このポリシー設定を有効にすると、侵入者が組織内のデスクトップまたはラップトップ コンピュータの画面を見てアカウント名を収集することができません。
  
\[対話型ログオン: セッションがロックされているときにユーザーの情報を表示する\] は、LC 環境と EC 環境では \[未定義\] に設定されています。SSLF 環境のベースライン サーバー ポリシーでは \[ユーザーの表示名、ドメインおよびユーザー名\] に設定されています。
  
#### 対話型ログオン:最後のユーザー名を表示しない
  
このポリシー設定では、コンピュータに最後にログインしたユーザーの名前を Windows ログオン画面に表示するかどうかを指定します。このポリシー設定を有効にすると、最後にログオンしたユーザーの名前は \[Windows へログオン\] ダイアログ ボックスに表示されません。
  
\[対話型ログオン: 最後のユーザー名を表示しない\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで \[有効\] に設定されています。
  
#### 対話型ログオン:Ctrl+Alt+Del を必要としない
  
このポリシー設定では、ユーザーがログオンする前に **Ctrl** + **Alt** + **Del** キーを押す必要があるかどうかを指定します。このポリシー設定を無効にすると、ユーザーは Windows にログオンする前に必ず **Ctrl** + **Alt** + **Del** キーを押す必要があります (スマート カードを使用して Windows にログオンする場合を除く)。
  
このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、\[対話型ログオン: Ctrl+Alt+Del を必要としない\] は \[無効\] に設定されています。こうすることで、攻撃者がトロイの木馬プログラムを使用してユーザー パスワードを傍受する可能性を低減させることができます。
  
#### 対話型ログオン:ログオン時のユーザーへのメッセージのテキスト
  
このポリシー設定では、ユーザーがログオンするときに表示されるテキスト メッセージを指定します。多くの場合、このテキストは法的な理由で使用されます。たとえば、アクセスに権限がない場合、または企業情報を誤用した場合には悪い影響が及ぶこと、あるいはユーザーのアクションが監査されていることについてユーザーに警告するためなどに使用されます。
  
\[対話型ログオン: ログオン時のユーザーへのメッセージのテキスト\] セキュリティ オプションを使用することをお勧めします。このテキストの文言については、組織内の関係者と相談してください。
  
**注** :\[対話型ログオン: ログオン時のユーザーへのメッセージのテキスト\] と \[対話型ログオン: ログオン時のユーザーへのメッセージのタイトル\] のいずれかを正しく機能させるときには、両方とも有効にする必要があります。
  
#### 対話型ログオン:ログオン時のユーザーへのメッセージのタイトル
  
このポリシー設定では、ユーザーがコンピュータにログオンするときに表示される対話型のログオン ダイアログ ボックスのタイトル バーのタイトルを指定できます。このポリシーを設定する目的は、\[ログオン時のユーザーへのメッセージのテキスト\] 設定と同じです。
  
このため、\[対話型ログオン: ログオン時のユーザーへのメッセージのテキスト\] 設定を使用することをお勧めします。このテキストの文言については、組織内の関係者と相談してください。
  
**注** :\[対話型ログオン: ログオン時のユーザーへのメッセージのテキスト\] と \[対話型ログオン: ログオン時のユーザーへのメッセージのタイトル\] のいずれかを正しく機能させるときには、両方とも有効にする必要があります。
  
#### 対話型ログオン:ドメイン コントローラが利用できない場合に使用する、前回ログオンのキャッシュ数
  
このポリシー設定では、ユーザーが、キャッシュされたアカウント情報により、Windows ドメインにログオンできるかどうかを指定します。ドメイン アカウントのログオン情報はローカルにキャッシュされるので、その直後のログオン時にはドメイン コントローラに接続できなくてもユーザーはログオンできます。この機能が有効の場合、ワークステーションはドメイン コントローラに接続しないので、アカウントが無効になったり削除されたりした後でもユーザーはログオンできる場合があります。このポリシー設定では、何人分のユーザーのログオン情報をローカルのキャッシュに格納するかを指定します。この設定を 0 にした場合には、ログオン キャッシュは無効になります。
  
EC 環境と SSLF 環境のベースライン ポリシーでは、\[対話型ログオン: ドメイン コントローラが利用できない場合に使用する、前回ログオンのキャッシュ数\] は **0** に設定されています。LC 環境では **1** に設定されており、ドメイン コントローラに接続できない正当なクライアントにアクセスが許可されます。
  
#### 対話型ログオン:パスワードが無効になる前にユーザーに変更を促す
  
このポリシー設定は、パスワードの有効期限が切れる何日前からユーザーに警告するかを指定します。第 3 章の「アカウント ポリシー」セクションでは、ユーザー パスワードが定期的に期限切れになるように設定することを推奨しています。パスワードの期限がいつ切れるかをユーザーに通知しないと、ユーザーは、パスワードの有効期限が実際に切れるまでそのことに気付かない可能性があります。これは、パスワードの変更方法を理解していないローカル ユーザーが混乱する原因になる可能性があります。また、パスワードの有効期限が切れることを知らずにそのパスワードが無効になった場合には、リモート ユーザーはダイヤルアップまたは仮想プライベート ネットワーク (VPN) 接続を介してログオンできなくなります。
  
このため、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーでは、\[対話型ログオン: パスワードが無効になる前にユーザーに変更を促す\] は、既定の設定である 14 日間に設定されています。
  
#### 対話型ログオン:workstation のロック解除にドメイン コントローラの認証を必要とする
  
ドメイン アカウントの場合、このポリシー設定では、コンピュータのロックを解除するためにドメイン コントローラへの接続が必要かどうかを指定します。このポリシー設定は、\[対話型ログオン: ドメイン コントローラが利用できない場合に使用する、前回ログオンのキャッシュ数\] 設定と同様の潜在的な脆弱性に対処します。ユーザーは、サーバーのネットワーク ケーブルを外すこと、古いパスワードを使用してサーバーをロック解除すること、および認証なしにサーバーをロック解除することが可能です。
  
このような事態の発生を防ぐため、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーでは、\[対話型ログオン: workstation のロック解除にドメイン コントローラの認証を必要とする\] は、\[有効\] に設定されています。
  
**重要** :このポリシー設定は、Windows 2000、Windows XP、および Windows Server 2003 を実行しているコンピュータに適用されます。ただし、Windows 2000 を実行しているコンピュータで、Security Configuration Manager ツールを使用してこれを指定することはできません。
  
#### 対話型ログオン:スマート カードが必要
  
このポリシー設定では、スマート カードを使用してコンピュータにログオンするようにユーザーに要求します。ユーザー認証に長くて複雑なパスワードを使用すると、セキュリティが向上します。パスワードの定期的な変更を義務付けると、さらにセキュリティが向上します。このような対策を実施することにより、攻撃者がブルート フォース攻撃を使用してユーザーのパスワードを特定できる可能性は低くなります。反面、ユーザーに強力なパスワードを選択するよう強制するのは難しく、また、強力なパスワードを設定してもブルート フォース攻撃に対しては脆弱です。
  
認証にパスワードではなくスマート カードを使用すると、セキュリティが大幅に向上します。これは、現状のテクノロジでは攻撃者が別のユーザーになりすますことがほぼ不可能であるからです。暗証番号 (PIN) を必要とするスマート カードでは、2 要素 (ユーザーがスマート カードを所持している必要があること、PIN を知っている必要があること) の認証が実現されます。攻撃者が、ユーザーのコンピュータとドメイン コントローラとの間の認証トラフィックを取得したとしても、トラフィックの解読は非常に困難になります。トラフィックが解読できたとしても、ユーザーが次回ネットワークにログオンするときには、新しいセッション キーが生成されて、ユーザーとドメイン コントローラとの間のトラフィックの暗号化に使用されます。
  
Microsoft は、スマート カードまたはその他の強力な認証テクノロジを組織に導入することをお勧めします。スマート カードが導入済みの場合は、\[対話型ログオン: スマート カードが必要\] 設定だけを有効にする必要があります。この理由から、LC 環境と EC 環境のベースライン ポリシーでは、このポリシー設定は \[未定義\] に設定されています。SSLF 環境のベースライン ポリシーでは \[無効\] に設定されています。
  
#### 対話型ログオン:スマート カード取り出し時の動作
  
このポリシー設定では、ログオンしたユーザーのスマート カードがスマート カード読み取り装置から取り出されたときの動作を指定します。この設定を \[ワークステーションをロックする\] に設定すると、スマート カードが取り出されたときにワークステーションがロックされます。つまり、ユーザーは自分のスマート カードを持って席をはずすことができます。この設定を \[ログオフを強制する\] に設定すると、スマート カードが取り出されたときにユーザーは自動的にログオフされます。
  
\[対話型ログオン: スマート カード取り出し時の動作\] は、LC 環境のベースライン ポリシー設定では \[未定義\] に設定されており、EC 環境と SSLF 環境のベースライン ポリシーでは \[ワークステーションをロックする\] に設定されています。
  
### Microsoft ネットワーク クライアントの設定
  
**表 4.17 セキュリティ オプション :Microsoft ネットワーク クライアントに関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">常に通信にデジタル署名を行う</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">サーバーが同意すれば、通信にデジタル署名を行う</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">サード パーティ製の SMB サーバーへのパスワードを、暗号化しないで送信する</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
</tr>
</tbody>
</table>
  
#### Microsoft ネットワーク クライアント:常に通信にデジタル署名を行う
  
このポリシー設定では、パケット署名が SMB クライアント コンポーネントによって要求されるかどうかを指定します。この設定を有効にすると、Microsoft ネットワーク サーバーが SMB パケット署名の実行に同意しない場合には、Microsoft ネットワーク クライアントは Microsoft ネットワーク サーバーと通信できなくなります。レガシ クライアントが混在する環境では、このオプションを \[無効\] に設定してください。レガシ クライアントは、ドメイン コントローラを認証したり、ドメイン コントローラにアクセスしたりできないからです。ただし、Windows 2000、Windows XP、および Windows Server 2003 を実行している環境では、この設定を使用できます。このガイドで定義している EC 環境と SSLF 環境には、これらのオペレーティング システムを実行しているコンピュータだけが存在し、そのどれもがデジタル署名をサポートしています。
  
したがって、環境内のコンピュータ間の通信セキュリティを向上させるため、EC 環境と SSLF 環境のベースライン ポリシーでは、\[Microsoft ネットワーク クライアント: 常に通信にデジタル署名を行う\] は \[有効\] に設定されています。
  
#### Microsoft ネットワーク クライアント:サーバーが同意すれば、通信にデジタル署名を行う
  
このポリシー設定は、SMB クライアントが SMB パケット署名のネゴシエートを試行するかどうかを指定します。Windows ネットワークにデジタル署名を実装することで、セッションの乗っ取りを防ぐことができます。このポリシー設定を有効にすると、メンバ サーバー上の Microsoft ネットワーク クライアントは、通信相手のサーバーがデジタル署名された通信を受け入れる場合にのみ、署名を要求します。
  
このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、\[Microsoft ネットワーク クライアント: サーバーが同意すれば、通信にデジタル署名を行う\] は \[有効\] に設定されています。
  
#### Microsoft ネットワーク クライアント:サード パーティ製の SMB サーバーへのパスワードを、暗号化しないで送信する
  
このポリシー設定を有効にすると、SMB リダイレクタは、認証時のパスワード暗号化をサポートしていない Microsoft 以外の SMB サーバーに、プレーンテキストのパスワードを送信できるようになります。
  
\[Microsoft ネットワーク クライアント: サーバーへのパスワードを、暗号化しないで送信する\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、既定値である \[無効\] に設定されています。ただし、パスワードの機密性を確保することよりもアプリケーションの要件の方が優先される場合は、この限りではありません。
  
### Microsoft ネットワーク サーバーの設定
  
**表 4.18 セキュリティ オプション :Microsoft ネットワーク サーバーに関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">セッションを中断する前に、ある一定のアイドル時間を必要とする</td>
<td style="border:1px solid black;">15 分</td>
<td style="border:1px solid black;">15 分</td>
<td style="border:1px solid black;">15 分</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">常に通信にデジタル署名を行う</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">クライアントが同意すれば、通信にデジタル署名を行う</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">ログオン時間の有効期間が切れるとクライアントを切断する</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
</tbody>
</table>
  
#### Microsoft ネットワーク サーバー:セッションを中断する前に、ある一定のアイドル時間を必要とする
  
このポリシー設定では、非アクティブ状態が原因でセッションを中断する場合に、SMB セッションで経過している必要がある連続アイドル時間を指定します。管理者はこのポリシー設定を使用して、コンピュータが非アクティブな SMB セッションを中断するタイミングを制御できます。クライアント アクティビティが再開すると、セッションは自動的に再確立されます。
  
このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、\[Microsoft ネットワーク サーバー: セッションを中断する前に、ある一定のアイドル時間を必要とする\] は \[15 分\] に設定されています。
  
#### Microsoft ネットワーク サーバー:常に通信にデジタル署名を行う
  
このポリシー設定では、SMB クライアントとのその後の通信を許可する前に、SMB パケット サーバー コンポーネントにパケット署名が必要かどうかを指定します。Windows 2000 Server、Windows 2000 Professional、Windows Server 2003、および Windows XP Professional には、相互認証をサポートする SMB バージョンが含まれています。これにより、セッションの乗っ取りが防止され、仲介者攻撃を防ぐメッセージ認証がサポートされます。SMB 署名では、各 SMB パケットにデジタル署名することによってこの認証を行います。各パケットは、クライアントとサーバーの両方によって検証されます。コンピュータが、署名のない SMB 通信をすべて無視するように構成されている場合、レガシ アプリケーションおよびレガシ オペレーティング システムは接続できません。すべての SMB 署名が完全に無効になっている場合、コンピュータは通信セッションを乗っ取ろうとする攻撃に対して脆弱です。
  
\[Microsoft ネットワーク サーバー: 常に通信にデジタル署名を行う\] 設定は、LC 環境のベースライン ポリシーでは \[無効\] に設定されており、EC 環境と SSLF 環境では \[有効\] に設定されています。
  
#### Microsoft ネットワーク サーバー:クライアントが同意すれば、通信にデジタル署名を行う
  
このポリシー設定では、SMB サーバーが SMB パケット署名と、SMB パケット署名を要求するクライアントをネゴシエートするかどうかを指定します。Windows 2000 Server、Windows 2000 Professional、Windows Server 2003、および Windows XP Professional には、相互認証をサポートする SMB バージョンが含まれています。これにより、セッションの乗っ取りが防止され、仲介者攻撃を防ぐメッセージ認証がサポートされます。SMB 署名では、各 SMB パケットにデジタル署名することによってこの認証を行います。各パケットは、クライアントとサーバーの両方によって検証されます。コンピュータが、署名のない SMB 通信をすべて無視するように構成されている場合、レガシ アプリケーションおよびレガシ オペレーティング システムは接続できません。すべての SMB 署名が完全に無効になっている場合、コンピュータは通信セッションを乗っ取ろうとする攻撃に対して脆弱です。
  
このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、\[Microsoft ネットワーク サーバー: クライアントが同意すれば、通信にデジタル署名を行う\] は \[有効\] に設定されています。
  
#### Microsoft ネットワーク サーバー:ログオン時間の有効期間が切れるとクライアントを切断する
  
このポリシー設定では、使用しているユーザー アカウントに有効なログオン時間外にネットワーク コンピュータに接続しているユーザーを切断するかどうかを指定します。このポリシー設定は SMB コンポーネントに影響します。組織でユーザーのログオン時間が決められている場合には、このポリシー設定を有効にします。この設定を無効にする場合、ユーザーがログオン時間以外の時間にネットワーク リソースにアクセスすることを禁止する必要があります。そうしないと、アクセスを許可された時間内に確立されたセッションを通じてネットワーク リソースを引き続き使用できることになります。
  
このガイドで定義している 3 種類の環境すべてのベースライン ポリシーでは、\[Microsoft ネットワーク サーバー: ログオン時間の有効期間が切れるとクライアントを切断する\] は \[有効\] に設定されています。
  
### ネットワーク アクセスの設定
  
**表 4.19 セキュリティ オプション :ネットワーク アクセスに関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">匿名の SID と名前の変換を許可する</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">無効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">SAM アカウントの匿名の列挙を許可しない</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">SAM アカウントおよび共有の匿名の列挙を許可しない</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">ネットワーク認証のために資格情報または .NET Passport を保存することを許可しない</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Everyone のアクセス許可を匿名ユーザーに適用する</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">リモートからアクセスできる名前付きパイプ</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">COMNAP、COMNODE、SQL\QUERY、SPOOLSS、LLSRPC、netlogon、lsarpc、samr、browser</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">リモートからアクセスできるレジストリのパス</td>
<td style="border:1px solid black;">System\CurrentControlSet\Control\Product Options;
System\CurrentControlSet\Control\
Server Applications;
Software\Microsoft\
Windows NT\Current
バージョン</td>
<td style="border:1px solid black;">System\CurrentControlSet\Control\Product Options;
System\CurrentControlSet\Control\
Server Applications;
Software\Microsoft\
Windows NT\Current
バージョン</td>
<td style="border:1px solid black;">System\CurrentControlSet\Control\Product Options;
System\CurrentControlSet\Control\
Server Applications;
Software\Microsoft\
Windows NT\Current
バージョン</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">リモートからアクセスできるレジストリのパスおよびサブパス</td>
<td style="border:1px solid black;">(設定情報については後述のサブセクションを参照)</td>
<td style="border:1px solid black;">(設定情報については後述のサブセクションを参照)</td>
<td style="border:1px solid black;">(設定情報については後述のサブセクションを参照)</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">名前付きパイプと共有への匿名のアクセスを制限する</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">匿名でアクセスできる共有</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">なし</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">ローカル アカウントの共有とセキュリティ モデル</td>
<td style="border:1px solid black;">クラシック - ローカル ユーザーがローカル ユーザーとして認証する</td>
<td style="border:1px solid black;">クラシック - ローカル ユーザーがローカル ユーザーとして認証する</td>
<td style="border:1px solid black;">クラシック - ローカル ユーザーがローカル ユーザーとして認証する</td>
</tr>
</tbody>
</table>
  
#### ネットワーク アクセス:匿名の SID と名前の変換を許可する
  
このポリシー設定では、匿名ユーザーが別のユーザーの SID 属性を要求できるかどうかを指定します。このポリシー設定が有効の場合、ローカル アクセス権限を持つユーザーは、一般的な Administrators SID を使用して、アカウントの名前が変更されている場合も含めて、ビルトイン Administrator アカウントの本当の名前を取得できます。さらに、取得したアカウント名を使用してパスワード推測攻撃を開始することが可能です。
  
\[ネットワーク アクセス: 匿名の SID と名前の変換を許可する\] は、LC 環境と EC 環境のベースライン ポリシーでは \[未定義\] に設定されています。SSLF 環境のベースライン ポリシーでは \[無効\] に設定されています。
  
#### ネットワーク アクセス:SAM アカウントの匿名の列挙を許可しない
  
このポリシー設定では、コンピュータに匿名で接続する際に付与する追加権限を指定します。Windows では、匿名のユーザーは、ドメイン アカウントの名前の列挙など、一定のアクティビティを実行できます。この機能は、相互信頼のない信頼されたドメインでユーザーにアクセスを付与する場合などに便利です。ただし、この設定が有効になっている場合でも、匿名ユーザーが、特殊ビルトイン グループ **ANONYMOUS LOGON** を明示的に含むアクセス許可を持つリソースにアクセスすることは可能です。
  
\[ネットワーク アクセス: SAM アカウントの匿名の列挙を許可しない\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーでは \[有効\] に設定されています。
  
#### ネットワーク アクセス:SAM アカウントおよび共有の匿名の列挙を許可しない
  
このポリシー設定では、SAM アカウントと共有の匿名の列挙を許可するかどうかを指定します。
  
\[ネットワーク アクセス: SAM アカウントおよび共有の匿名の列挙を許可しない\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーでは \[有効\] に設定されています。
  
#### ネットワーク アクセス:ネットワーク認証のために資格情報または .NET Passport を保存することを許可しない
  
このポリシー設定では、ドメイン認証の終了後に、パスワード、資格情報、または Microsoft .Net Passport を後で使用できるように**ユーザー名およびパスワードの保存**設定で保存するかどうかを指定します。
  
\[ネットワーク アクセス: ネットワーク認証のために資格情報または .NET Passport を保存することを許可しない\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで \[有効\] に設定されています。
  
**注** :このポリシー設定の設定内容を変更した場合、その変更は Windows を再起動するまで反映されません。
  
#### ネットワーク アクセス:Everyone のアクセス許可を匿名ユーザーに適用する
  
このポリシー設定では、コンピュータに匿名で接続する際に付与する追加権限を指定します。このポリシー設定を有効にすると、匿名の Windows ユーザーは、ドメイン アカウント名やネットワーク共有名の列挙など、特定の操作の実行が可能になります。つまり、権限のないユーザーでも、匿名で接続してアカウント名と共有リソース名を列挙し、その情報を利用して、パスワードを推測したりソーシャル エンジニアリング攻撃 (心理的方法でユーザーをだまして重要データを収集する行為) を仕掛けることができます。
  
このため、\[ネットワーク アクセス: Everyone のアクセス許可を匿名ユーザーに適用する\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで \[無効\] に設定されています。
  
**注** :このポリシー設定が有効になっているドメインは、Windows NT 4.0 ドメインまたは Windows NT 4.0 を実行しているドメイン コントローラとの間で、信頼関係を確立することや維持することができません。
  
#### ネットワーク アクセス:リモートからアクセスできる名前付きパイプ
  
このポリシー設定では、匿名でアクセスできる属性および許可を持つ通信セッション (名前付きパイプ) を指定します。
  
SSLF 環境では、\[ネットワーク アクセス: リモートからアクセスできる名前付きパイプ\] を既定値に設定するように義務付ける必要があります。既定値は、次の名前付きパイプで構成されます。
  
-   COMNAP SNA セッション アクセス
  
-   COMNODE SNA セッション アクセス
  
-   SQL\\QUERY SQL インスタンス アクセス
  
-   SPOOLSS スプーラ サービス
  
-   LLSRPC License Logging サービス
  
-   Netlogon Net Logon サービス
  
-   Lsarpc LSA アクセス
  
-   Samr SAM アクセス
  
-   browser Computer Browser サービス
  
    **重要** :このポリシー設定を有効にする必要がある場合は、必ず、社内環境のアプリケーションに必要な名前付きパイプだけを追加してください。このガイドのその他のすべての推奨設定と同様に、このポリシー設定も運用環境に展開する前に入念にテストする必要があります。
  
#### ネットワーク アクセス:リモートからアクセスできるレジストリのパス
  
このポリシー設定では、ネットワーク経由でアクセスできるレジストリ パスを指定します。
  
\[ネットワーク アクセス: リモートからアクセスできるレジストリのパス\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、既定値に設定されています。
  
**注** :このポリシーを設定した場合でも、権限のあるユーザーがネットワーク経由でレジストリにアクセスできるようにするには、Remote Registry システム サービスを起動しておく必要があります。
  
#### ネットワーク アクセス:リモートからアクセスできるレジストリのパスおよびサブパス
  
このポリシー設定では、ネットワーク経由でアクセスできるレジストリ パスとサブパスを指定します。
  
\[ネットワーク アクセス: リモートからアクセスできるレジストリのパスおよびサブパス\] の既定値は、このガイドで定義している 3 種類の環境すべてのベースライン セキュリティ テンプレートに適用されます。既定値は、次のパスとサブパスで構成されます。
  
-   System\\CurrentControlSet\\Control\\Print\\Printers
  
-   System\\CurrentControlSet\\Services\\Eventlog
  
-   Software\\Microsoft\\OLAP Server
  
-   Software\\Microsoft\\Windows NT\\CurrentVersion\\Print
  
-   Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows
  
-   System\\CurrentControlSet\\Control\\ContentIndex
  
-   System\\CurrentControlSet\\Control\\Terminal Server
  
-   System\\CurrentControlSet\\Control\\Terminal Server\\UserConfig
  
-   System\\CurrentControlSet\\Control\\Terminal Server\\DefaultUserConfiguration
  
-   Software\\Microsoft\\Windows NT\\CurrentVersion\\Perflib
  
-   System\\CurrentControlSet\\Services\\SysmonLog
  
#### ネットワーク アクセス:名前付きパイプと共有への匿名のアクセスを制限する
  
このポリシー設定は、匿名による共有と名前付きパイプへのアクセスを制限するために、次の設定で使用されます。
  
-   **ネットワーク アクセス: リモートからアクセスできる名前付きパイプ**
  
-   **ネットワーク アクセス: 匿名でアクセスできる共有**
  
\[ネットワーク アクセス: 名前付きパイプと共有への匿名のアクセスを制限する\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで \[有効\] に設定されています。
  
#### ネットワーク アクセス:匿名でアクセスできる共有
  
このポリシー設定では、匿名ユーザーがアクセスできるネットワーク共有を指定します。この設定は、既定値のままでもほとんど影響を及ぼしません。ユーザーがサーバー上の共有リソースにアクセスするには、必ず事前に認証を受ける必要があるからです。
  
\[ネットワーク アクセス: 匿名でアクセスできる共有\] は、LC 環境と EC 環境では \[未定義\] に設定されており、SSLF 環境では \[なし\] に設定されています。
  
**注** :このポリシー設定には危険性があります。表示されるすべての共有に、すべてのネットワークユーザーがアクセスできるからです。このポリシー設定が有効になっていると、機密データが流出したり壊されたりする可能性があります。
  
#### ネットワーク アクセス:ローカル アカウントの共有とセキュリティ モデル
  
このポリシー設定では、ローカル アカウントを使用するネットワーク ログオンの認証方法を指定します。\[クラシック\] 設定を使用すると、リソースに対するアクセスを微調整することができるため、同じリソースに対してさまざまなユーザーに異なる種類のアクセスを許可できます。\[Guest のみ\] 設定を使用すると、すべてのユーザーを同等に扱うことができます。これに関連して、\[Guest のみ\] として認証されるすべてのユーザーは、特定のリソースへの同じアクセス レベルを取得します。
  
\[ネットワーク アクセス: ローカル アカウントの共有とセキュリティ モデル\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、既定値である \[クラシック\] に設定されています。
  
### ネットワーク セキュリティの設定
  
**表 4.20 セキュリティ オプション :ネットワーク セキュリティに関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">次のパスワードの変更で LAN Manager のハッシュの値を保存しない</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">LAN Manager 認証レベル</td>
<td style="border:1px solid black;">NTLMv2 応答のみ送信する</td>
<td style="border:1px solid black;">NTLMv2 応答のみ送信\LM を拒否する</td>
<td style="border:1px solid black;">NTLMv2 応答のみ送信\LM と NTLM を拒否する</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">必須の署名をしている LDAP クライアント</td>
<td style="border:1px solid black;">ネゴシエーション署名</td>
<td style="border:1px solid black;">ネゴシエーション署名</td>
<td style="border:1px solid black;">ネゴシエーション署名</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">セキュア RPC を含む NTLM SSP ベースのクライアントの最小のセッション セキュリティ</td>
<td style="border:1px solid black;">最小なし</td>
<td style="border:1px solid black;">すべて有効</td>
<td style="border:1px solid black;">すべて有効</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">セキュア RPC を含む NTLM SSP ベースのサーバーの最小のセッション セキュリティ</td>
<td style="border:1px solid black;">最小なし</td>
<td style="border:1px solid black;">すべて有効</td>
<td style="border:1px solid black;">すべて有効</td>
</tr>
</tbody>
</table>
  
#### ネットワーク セキュリティ:次のパスワードの変更で LAN Manager のハッシュの値を保存しない
  
このポリシー設定では、パスワードの変更時に新しいパスワードの LAN Manager (LM) ハッシュ値を保存するかどうかを指定します。暗号強度の高い Windows NT ハッシュに比べて、LM ハッシュは比較的弱く攻撃を受けやすくなっています。
  
このことから、\[ネットワーク セキュリティ: 次のパスワードの変更で LAN Manager のハッシュの値を保存しない\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで \[有効\] に設定されています。
  
**注** :このポリシー設定が有効の場合、非常に古いレガシ オペレーティング システムと一部のアプリケーションでエラーが発生する可能性があります。また、このポリシー設定を有効にした後には、すべてのアカウントのパスワードを変更する必要があります。
  
#### ネットワーク セキュリティ:LAN Manager 認証レベル
  
このポリシー設定では、ネットワーク ログオンに使用するチャレンジ/レスポンス認証プロトコルを指定します。この選択は、以下に示すように、クライアント コンピュータが使用する認証プロトコルのレベル、ネゴシエートするセキュリティのレベル、およびサーバーが受け付ける認証のレベルに影響します。以下の表の数値は、**LMCompatibilityLevel** レジストリ値に対する実際の設定値です。
  
**表 4.21 LMCompatibilityLevel レジストリ値の設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >値</th>
<th style="border:1px solid black;" >プロトコル</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">0</td>
<td style="border:1px solid black;">クライアントは LAN Manager および NTLM の認証を使用しますが、NTLMv2 セッション セキュリティは決して使用しません。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">クライアントは LAN Manager と NTLM 認証を使用します。サーバーがサポートする場合は、NTLMv2 セッション セキュリティを使用します。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">2</td>
<td style="border:1px solid black;">クライアントは NTLM 認証のみを使用します。サーバーがサポートする場合は、NTLMv2 セッション セキュリティを使用します。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">3</td>
<td style="border:1px solid black;">クライアントは NTLMv2 認証のみを使用します。サーバーがサポートする場合は、NTLMv2 セッション セキュリティを使用します。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">4</td>
<td style="border:1px solid black;">クライアントは NTLM 認証のみを使用します。サーバーがサポートする場合は、NTLMv2 セッション セキュリティを使用します。ドメイン コントローラは、LAN Manager 認証を拒否します。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">5</td>
<td style="border:1px solid black;">クライアントは NTLMv2 認証のみを使用します。サーバーがサポートする場合は、NTLMv2 セッション セキュリティを使用します。ドメイン コントローラは、LAN Manager と NTLM 認証を拒否し、NTLMv2 だけを受け付けます。</td>
</tr>
</tbody>
</table>
  
このポリシー設定は、以下のガイドラインに従って、環境で許容される最高レベルに設定する必要があります。
  
Windows NT 4.0 SP4、Windows 2000、および Windows XP Professional のみが存在する環境では、このポリシー設定をすべてのクライアントを \[NTLMv2 応答のみ送信 (LM と NTLM を拒否する)\] に設定し、すべてのクライアントの設定が終わったら、すべてのサーバーを \[NTLMv2 応答のみ送信 (LM と NTLM を拒否する)\] に設定します。この推奨設定には例外があります。Windows 2003 のルーティングとリモート アクセス サーバーで、この設定を \[NTLMv2 応答のみ送信 (LM を拒否する)\] より高いレベルに設定すると、正しく機能しなくなります。
  
EC 環境では、ルーティングとリモート アクセス サーバーが必要な場合があります。このため、EC 環境の \[ネットワーク セキュリティ: LAN Manager 認証レベル\] は、ベースライン ポリシーで \[NTLMv2 応答のみ送信 (LM を拒否する)\] に設定されています。ルーティングとリモート アクセス サーバーは SSLF 環境ではサポートされていないので、SSLF 環境では、このポリシー設定は \[NTLMv2 応答のみ送信 (LM と NTLM を拒否する)\] に設定されています。
  
DSClient のインストールが可能な Windows 9x クライアントがある場合、Windows NT (Windows NT、Windows 2000、および Windows XP Professional) を実行しているコンピュータで、このポリシー設定を \[NTLMv2 応答のみ送信 (LM と NTLM を拒否する)\] に設定します。それ以外の場合は、Windows 9x を実行していないコンピュータのベースライン ポリシーで、このポリシー設定を \[NTLMv2 応答のみ送信する\] かそれより低いままにしておく必要があります。これは、LC 環境における設定内容です。
  
このポリシー設定を有効にすると正しく動作しないアプリケーションが見つかった場合、設定を 1 つずつ前の状態に戻し、原因を突き止めます。最低でも、すべてのコンピュータのベースライン ポリシーで、このポリシーを \[LM と NTLM を送信する - ネゴシエーションの場合、NTLMv2 セッション セキュリティを使う\] に設定する必要があります。通常、環境内のすべてのコンピュータを \[NTLMv2 応答のみ送信する\] に設定できます。
  
#### ネットワーク セキュリティ:必須の署名をしている LDAP クライアント
  
このポリシー設定では、LDAP BIND 要求を発行するクライアントに代わって要求するデータ署名のレベルを指定します。署名のないネットワーク トラフィックは、仲介者攻撃を受けやすくなります。LDAP サーバーに対して、攻撃者が LDAP クライアントから不正なクエリを送信すると、このサーバーはそのクエリに基づいて誤った処理を行う可能性があります。
  
このため、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、\[ネットワーク セキュリティ: 必須の署名をしている LDAP クライアント\] は \[ネゴシエーション署名\] に設定されています。
  
#### ネットワーク セキュリティ:セキュア RPC を含む NTLM SSP ベースのクライアントの最小のセッション セキュリティ
  
このポリシー設定を使用すると、メッセージの機密性 (暗号化)、メッセージの署名、128 ビット暗号化、または NTLM バージョン 2 (NTLMv2) セッション セキュリティのネゴシエーションがクライアントに必須になります。このポリシー設定は、できるだけ高いレベルに設定してください。ただし、アプリケーションがネットワークで正常に動作することを確認してください。このポリシー設定を適切に設定することで、NTLM SSP ベースのサーバーからのネットワーク トラフィックを、仲介者攻撃とデータの漏洩から保護することができます。
  
LC 環境のベースライン ポリシーでは、\[ネットワーク セキュリティ: セキュア RPC を含む NTLM SSP ベースのクライアントの最小のセッション セキュリティ\] は \[最小なし\] に設定されています。EC 環境と SSLF 環境では、すべて有効に設定されています。
  
#### ネットワーク セキュリティ:セキュア RPC を含む NTLM SSP ベースのサーバーの最小のセッション セキュリティ
  
このポリシー設定を使用すると、メッセージの機密性 (暗号化)、メッセージの整合性、128 ビット暗号化、または NTLMv2 セッション セキュリティのネゴシエーションがサーバーに必須になります。このポリシー設定は、できるだけ高いレベルに設定してください。ただし、アプリケーションがネットワークで正常に動作することを確認してください。前述のポリシー設定と同様、このポリシーを適切に設定することで、NTLM SSP ベースのクライアントからのネットワーク トラフィックを、仲介者攻撃とデータの漏洩から保護することができます。
  
LC 環境のベースライン ポリシーでは、\[ネットワーク セキュリティ: セキュア RPC を含む NTLM SSP ベースのサーバーの最小のセッション セキュリティ\] は \[最小なし\] に設定されています。EC 環境と SSLF 環境では、すべて有効に設定されています。
  
### 回復コンソールの設定
  
**表 4.22 セキュリティ オプション :回復コンソールの推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">自動管理ログオンを許可する</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">すべてのドライブとフォルダに、フロッピーのコピーとアクセスを許可する</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">無効</td>
</tr>
</tbody>
</table>
  
#### 回復コンソール:自動管理ログオンを許可する
  
このポリシー設定では、コンピュータへのアクセスを許可する前に Administrator アカウントのパスワード入力を必須にするかどうかを指定します。このポリシー設定が有効になっている場合、回復コンソールでパスワードを入力する必要はなく、コンピュータに自動的にログオンできます。回復コンソールは、起動に問題があるコンピュータに対処する必要がある場合に、役に立つことがあります。ただし、この設定を有効にすると問題が生じることもあります。サーバーの設置場所に行き、サーバーの電源を落としてシャットダウンし、再起動してから、\[再起動\] メニューから \[回復コンソール\] を選択することで、だれでもサーバーを完全に制御することが可能だからです。
  
このため、\[回復コンソール: 自動管理ログオンを許可する\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、既定の設定である \[無効\] に設定されています。この設定が無効な場合に、回復コンソールを使用するには、ユーザー名とパスワードを入力して、回復コンソールのアカウントを入手する必要があります。
  
#### 回復コンソール:すべてのドライブとフォルダに、フロッピーのコピーとアクセスを許可する
  
このポリシー設定を有効にすると、回復コンソールの **SET** コマンドが使用可能になり、このコマンドで次の回復コンソール環境変数の設定が可能になります。
  
-   **AllowWildCards**。コマンドの一部 (DEL コマンドなど) でワイルドカード サポートを有効にする。
  
-   **AllowAllPaths**。コンピュータ上のすべてのファイルとフォルダへのアクセスを許可する。
  
-   **AllowRemovableMedia**。ファイルを、フロッピー ディスクなどのリムーバブル メディアにコピーすることを許可する。
  
-   **NoCopyPrompt**。既存ファイルを上書きするときに、通知を行わないようにする。
  
SSLF 環境のベースライン ポリシーでは、最高レベルのセキュリティを確保するために、\[回復コンソール: すべてのドライブとフォルダに、フロッピーのコピーとアクセスを許可する\] は \[無効\] に設定されています。LC 環境と EC 環境では、\[有効\] に設定されています。
  
### シャットダウンの設定
  
**表 4.23 セキュリティ オプション :シャットダウンに関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">システムをシャットダウンするのにログオンを必要としない</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">仮想メモリのページ ファイルをクリアする</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
</tr>
</tbody>
</table>
  
#### シャットダウン:システムをシャットダウンするのにログオンを必要としない
  
このポリシー設定では、Windows オペレーティング システムへのログオンが要求されないユーザーがコンピュータをシャットダウンできるかどうかを指定します。コンソールにアクセスできるユーザーであれば、コンピュータをシャットダウンできます。これにより、攻撃者または操作を誤ったユーザーが、ID 情報を与えることなく、ターミナル サービスからサーバーに接続し、シャットダウンまたは再起動する可能性が生じます。
  
このため、\[シャットダウン: システムをシャットダウンするのにログオンを必要としない\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、既定の設定である \[無効\] に設定されています。
  
#### シャットダウン:仮想メモリのページ ファイルをクリアする
  
このポリシー設定では、コンピュータのシャットダウン時に仮想メモリのページファイルをクリアするかどうかを指定します。このポリシー設定が有効担っている場合には、コンピュータがシャットダウンされるたびに、システムの ページファイルがクリアされます。また、このポリシー設定が有効で、かつ、ポータブル コンピュータ上で休止状態が無効になっている場合は、休止状態ファイル (hiberfil.sys) もクリアされます。サーバーのシャットダウンと再起動に時間がかかるようになり、大きなページ ファイルを持つサーバーでは特にそれが顕著になります。
  
このため、このガイドで定義している 3 種類の環境すべてで、\[シャットダウン: 仮想メモリのページ ファイルをクリアする\] は \[無効\] に設定されています。
  
**注** :サーバーに物理的にアクセスできる攻撃者は、サーバーの電源を切断するだけで、この対応策を回避できます。
  
### システム暗号化の設定
  
**表 4.24 セキュリティ オプション :システム暗号化に関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">コンピュータに保存されているユーザー キーに強力なキー保護を強制する</td>
<td style="border:1px solid black;">最初にキーが使用されるときには、ユーザーに要求する</td>
<td style="border:1px solid black;">最初にキーが使用されるときには、ユーザーに要求する</td>
<td style="border:1px solid black;">ユーザーがキーを使うときにはパスワードの入力が必要</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">暗号化、ハッシュ、署名のための FIPS 準拠アルゴリズムを使う</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">有効</td>
</tr>
</tbody>
</table>
  
#### システム暗号化:コンピュータに保存されているユーザー キーに強力なキー保護を強制する
  
このポリシー設定では、ユーザーの秘密キー (S-MIME キーなど) の使用時にパスワードの使用を必須にするかどうかを指定します。ユーザーがキーを使用するたびにドメイン パスワードとは異なるパスワードの入力を要求するようにこのポリシーを設定すると、攻撃者がローカルに保存されているキーにアクセスすることが、ログオン パスワードが解読済みであっても難しくなります。
  
LC 環境と EC 環境のベースライン ポリシーの場合、可用性の要件から、\[システム暗号化: コンピュータに保存されているユーザー キーに強力なキー保護を強制する\] は \[最初にキーが使用されるときには、ユーザーに要求する\] に設定されています。SSLF 環境では、セキュリティを向上させるため、\[ユーザーがキーを使うときにはパスワードの入力が必要\] に設定されています。
  
#### システム暗号化:暗号化、ハッシュ、署名のための FIPS 準拠アルゴリズムを使う
  
このポリシー設定では、TLS/SSL (Transport Layer Security/Secure Sockets Layer) セキュリティ プロバイダが TLS\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA 暗号スイートだけをサポートするかどうかを指定します。このポリシー設定によりセキュリティは向上しますが、このアルゴリズムは TLS または SSL でセキュリティ保護された公開 Web サイトのほとんどでサポートされていません。また、多くのクライアント コンピュータも、これらのアルゴリズムをサポートするようには構成されていません。
  
このため、LC 環境と EC 環境のベースライン ポリシーでは、\[システム暗号化: 暗号化、ハッシュ、署名のための FIPS 準拠アルゴリズムを使う\] は \[無効\] に設定されています。SSLF 環境では、\[有効\] に設定されています。
  
### システム オブジェクトの設定
  
**表 4.25 セキュリティ オプション :システム オブジェクトに関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">Administrators グループのメンバによって作成されたオブジェクトの既定の所有者</td>
<td style="border:1px solid black;">Object creator</td>
<td style="border:1px solid black;">Object creator</td>
<td style="border:1px solid black;">Object creator</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Windows システムではないサブシステムのための大文字と小文字の区別をしないことが必須</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">内部のシステム オブジェクトの既定のアクセス許可を強化する (例: シンボリック リンク)</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
</tbody>
</table>
  
#### システム オブジェクト:Administrators グループのメンバによって作成されたオブジェクトの既定の所有者
  
このポリシー設定では、**Administrators** グループまたはオブジェクト作成者が、作成された任意のシステム オブジェクトの既定の所有者であるかどうかを指定します。システム オブジェクトが作成されると、所有権には、一般的な **Administrators** グループではなく、オブジェクトを作成したアカウントが反映されます。
  
このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、\[システム オブジェクト: Administrators グループのメンバによって作成されたオブジェクトの既定の所有者\] は \[Object creator\] に設定されています。
  
#### システム オブジェクト:Windows システムではないサブシステムのための大文字と小文字の区別をしないことが必須
  
このポリシー設定は、すべてのサブシステムで大文字と小文字を区別するかどうかを指定します。Microsoft Win32 サブシステムでは、大文字と小文字を区別しません。ただし、このカーネルでは、POSIX (Portable Operating System Interface for UNIX) などの他のサブシステムに対して大文字と小文字を区別します。Windows では大文字と小文字を区別しませんが、POSIX サブシステムでは大文字と小文字を区別するので、この設定を適用しなかった場合には、POSIX ユーザーは、大文字と小文字が混在した名前をファイルに付けることで、同じ名前のファイルを作成することができます。この状況になると、使用できるファイルは 1 つだけなので、別のユーザーは標準的な Win32 ツールから、名前の重複したファイルにアクセスすることが不可能になる場合があります。
  
ファイル名の整合性を保証するため、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、\[システム オブジェクト: システムではないサブシステムのための大文字と小文字の区別をしないことが必須\] は \[有効\] に設定されています。
  
#### システム オブジェクト:内部のシステム オブジェクトの既定のアクセス許可を強化する (例: シンボリック リンク)
  
このポリシー設定では、オブジェクトの随意アクセス制御リスト (DACL) の既定の強度を指定します。この設定を有効にすると、複数のプロセスによりアクセスおよび共有されるオブジェクトのセキュリティを保護することができます。DACL の強度を高めるために、既定値である \[有効\] を使用します。これにより、管理者ではないユーザーによる共有オブジェクトの読み込みが許可されますが、自分が作成していない任意の共有オブジェクトの変更は許可されません。
  
\[システム オブジェクト: 内部のシステム オブジェクトの既定のアクセス許可を強化する (例: シンボリック リンク)\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、既定値である \[有効\] に設定されています。
  
### システム設定
  
**表 4.26 セキュリティ オプション :システムに関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">システム設定:オプション サブシステム</td>
<td style="border:1px solid black;">なし</td>
<td style="border:1px solid black;">なし</td>
<td style="border:1px solid black;">なし</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">システム設定:ソフトウェア制限のポリシーのために Windows 実行可能ファイルに対して証明書の規則を使用する</td>
<td style="border:1px solid black;">未定義</td>
<td style="border:1px solid black;">無効</td>
<td style="border:1px solid black;">有効</td>
</tr>
</tbody>
</table>
  
#### システム設定:オプション サブシステム
  
このポリシー設定では、それぞれの環境でアプリケーションのサポートに使用されるサブシステムを指定します。Windows Server 2003 におけるこのポリシー設定の既定値は \[POSIX\] です。
  
POSIX サブシステムを無効にするために、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、\[システム設定: オプション サブシステム\] は \[無効\] に設定されています。
  
#### システム設定:ソフトウェア制限のポリシーのために Windows 実行可能ファイルに対して証明書の規則を使用する
  
このポリシー設定では、ソフトウェアの制限のポリシーが有効になっているときに、ファイル拡張子が .exe であるソフトウェアをユーザーまたはプロセスが実行しようとした場合に、デジタル証明書を処理するかどうかを指定します。このポリシー設定では、証明書のルール (ソフトウェアの制限のポリシー ルールの一種) を有効または無効にします。ソフトウェアの制限のポリシーを使用すると、Authenticode 署名付きソフトウェアの実行を許可または禁止する証明書ルールを、そのソフトウェアに関連付けられているデジタル証明書に基づいて作成できます。ソフトウェアの制限のポリシーで証明書のルールを有効にするには、このポリシー設定を有効にする必要があります。
  
SSLF 環境では、\[システム設定: ソフトウェア制限のポリシーのために Windows 実行可能ファイルに対して証明書の規則を使用する\] は \[無効\] に設定されています。パフォーマンスに対する潜在的な影響を回避するため、EC 環境では \[無効\] に設定されており、LC 環境では \[未定義\] に設定されています。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
イベント ログ  
-------------
  
イベント ログにはコンピュータのイベントが記録され、セキュリティ ログには監査イベントが記録されます。グループ ポリシーのイベント ログ コンテナは、アプリケーション、セキュリティ、およびシステムのイベント ログの属性の定義に使用されます。この属性には、最大ログ サイズ、各ログのアクセス権利、保存の設定、保存方法などが該当します。アプリケーション、セキュリティ、およびシステムのイベント ログは MSBP で設定し、この設定はドメイン内のすべてのメンバ サーバーに適用されます。
  
Windows Server 2003 SP1 の場合、イベント ログの設定は、グループ ポリシー オブジェクト エディタを使用して、次の場所で構成できます。
  
**コンピュータの構成\\Windows の設定\\セキュリティの設定\\イベント ログ**
  
ここでは、このガイドで定義している 3 種類の環境に対して規定された MSBP イベント ログ設定について詳しく説明します。ここで説明する規定の設定の概要については、このガイドのダウンロード バージョンに付属の Microsoft Excel ブック「Windows Server 2003 Security Guide Settings」を参照してください。すべての既定値と各設定の詳細については、[http://go.microsoft.com/fwlink/?LinkId=15159](https://technet.microsoft.com/ja-jp/library/75849e66-9f52-4ceb-874e-cace62110b09(v=TechNet.10)) の関連ガイド *『脅威とその対策 : WindowsServer2003 と WindowsXP のセキュリティ設定』*を参照してください。
  
次の表に、このガイドで定義している 3 つの環境に対するイベント ログの推奨設定をまとめています。各設定に関する詳細情報については、表の後のサブセクションで説明します。
  
**表 4.27 イベント ログに関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">アプリケーション ログの最大サイズ</td>
<td style="border:1px solid black;">16,384 KB</td>
<td style="border:1px solid black;">16,384 KB</td>
<td style="border:1px solid black;">16,384 KB</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">セキュリティ ログの最大サイズ</td>
<td style="border:1px solid black;">81,920 KB</td>
<td style="border:1px solid black;">81,920 KB</td>
<td style="border:1px solid black;">81,920 KB</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">システム ログの最大サイズ</td>
<td style="border:1px solid black;">16,384 KB</td>
<td style="border:1px solid black;">16,384 KB</td>
<td style="border:1px solid black;">16,384 KB</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">ゲストによるアプリケーション ログへのアクセスを許可しない</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">ゲストによるセキュリティ ログへのアクセスを許可しない</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">ゲストによるシステム ログへのアクセスを許可しない</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">アプリケーション ログの保存方法</td>
<td style="border:1px solid black;">必要時</td>
<td style="border:1px solid black;">必要時</td>
<td style="border:1px solid black;">必要時</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">セキュリティ ログの保管方法</td>
<td style="border:1px solid black;">必要時</td>
<td style="border:1px solid black;">必要時</td>
<td style="border:1px solid black;">必要時</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">システム ログの保存方法</td>
<td style="border:1px solid black;">必要時</td>
<td style="border:1px solid black;">必要時</td>
<td style="border:1px solid black;">必要時</td>
</tr>
</tbody>
</table>
  
### アプリケーション ログの最大サイズ
  
このポリシー設定では、アプリケーション イベント ログの最大サイズを指定します。このログの最大容量は 4 GB です。ただし、このサイズを設定すると、メモリが断片化する危険性があり、パフォーマンスが低下したり、イベント ログの記録が不安定になったりする可能性があるため、このサイズはお勧めしません。アプリケーション ログ サイズの要件は、プラットフォームの機能とアプリケーション関連イベントの履歴記録の必要条件によって異なります。
  
\[アプリケーション ログの最大サイズ\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーでは、既定値である **16,384 KB** に設定されています。
  
### セキュリティ ログの最大サイズ
  
このポリシー設定では、セキュリティ イベント ログの最大サイズを指定します。このログの最大容量は 4 GB です。ドメイン コントローラとスタンドアロン サーバーでは、セキュリティ ログを 80 MB 以上に設定してください。これにより、監査に十分な情報が適切に保存されます。他のコンピュータに対するこのポリシー設定は、ログの確認頻度、使用可能なディスク領域などの要因に基づいて指定します。
  
\[セキュリティ ログの最大サイズ\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーでは **81,920 KB** に設定されています。
  
### システム ログの最大サイズ
  
このポリシー設定では、システム イベント ログの最大サイズを指定します。このログの最大容量は 4 GB です。ただし、このサイズを設定すると、メモリが断片化する危険性があり、パフォーマンスが低下したり、イベント ログの記録が不安定になったりする可能性があるため、このサイズはお勧めしません。システム ログ サイズの要件は、プラットフォームの機能と履歴記録の必要条件によって異なります。
  
\[システム ログの最大サイズ\] は、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーでは、既定値である **16,384 KB** に設定されています。
  
### ゲストによるアプリケーション ログへのアクセスを許可しない
  
このポリシー設定では、ゲストによるアプリケーション イベント ログへのアクセスを拒否するかどうかを指定します。Windows Server 2003 SP1 の既定では、ゲスト アクセスはすべてのコンピュータで禁止されています。したがって、このポリシー設定の設定値が何であっても、既定の構成のコンピュータに実際には何の影響もありません。
  
ただし、この構成は他に悪い影響を与えることのない多層防御手段と考えられるので、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーでは、\[ゲストによるアプリケーション ログへのアクセスを許可しない\] は \[有効\] に設定されています。
  
**注** :この設定は、ローカル コンピュータ ポリシー オブジェクトでは表示されません。
  
### ゲストによるセキュリティ ログへのアクセスを許可しない
  
このポリシー設定では、ゲストによるセキュリティ イベント ログへのアクセスを拒否するかどうかを指定します。セキュリティ ログにアクセスするユーザーには、**監査とセキュリティ ログの管理**ユーザー権利 (このガイドでは定義していない) が割り当てられている必要があります。したがって、このポリシー設定の設定値が何であっても、既定の構成のコンピュータに実際には何の影響もありません。
  
ただし、この構成は他に悪い影響を与えることのない多層防御手段と考えられるので、このガイドで定義している 3 種類の環境すべてのベースライン ポリシーでは、\[ゲストによるセキュリティ ログへのアクセスを許可しない\] は **\[有効\]** に設定されています。
  
**注** :この設定は、ローカル コンピュータ ポリシー オブジェクトでは表示されません。
  
### ゲストによるシステム ログへのアクセスを許可しない
  
このポリシー設定は、ゲストによるシステム イベント ログへのアクセスを拒否するかどうかを指定します。Windows Server 2003 SP1 の既定では、ゲスト アクセスはすべてのコンピュータで禁止されています。したがって、このポリシー設定の設定値が何であっても、既定の構成のコンピュータに実際には何の影響もありません。
  
ただし、side effectこのガイドで定義している 3 種類の環境すべてのベースライン ポリシーで、\[ゲストによるシステム ログへのアクセスを許可しない\] **は \[有効\]** に設定されています。
  
**注** :この設定は、ローカル コンピュータ ポリシー オブジェクトでは表示されません。
  
### アプリケーション ログの保存方法
  
このポリシー設定では、アプリケーション ログの保存方法を指定します。不正なアクティビティの調査またはトラブルシューティングを行うために履歴イベントが必要な場合は、アプリケーション ログを定期的にアーカイブする必要があります。必要に応じてイベントが上書きされる場合、履歴データが失われる可能性がありますが、ログには常に最新のイベントが記録されます。
  
このガイドで定義している 3 種類の環境すべてのベースライン ポリシーでは、\[アプリケーション ログの保存方法\] は **\[必要時\]** に設定されています。
  
### セキュリティ ログの保管方法
  
このポリシー設定では、セキュリティ ログの保存方法を指定します。不正なアクティビティの調査またはトラブルシューティングを行うために履歴イベントが必要な場合は、セキュリティ ログを定期的にアーカイブする必要があります。必要に応じてイベントが上書きされる場合、履歴データが失われる可能性がありますが、ログには常に最新のイベントが記録されます。
  
このガイドで定義している 3 種類の環境すべてのベースライン ポリシーでは、\[セキュリティ ログの保存方法\] は \[必要時\] に設定されています。
  
### システム ログの保存方法
  
このポリシー設定では、システム ログの保存方法を指定します。不正なアクティビティの調査またはトラブルシューティングを行うために履歴イベントが必要な場合は、ログを定期的にアーカイブする必要があります。必要に応じてイベントが上書きされる場合、履歴データが失われる可能性がありますが、ログには常に最新のイベントが記録されます。
  
このガイドで定義している 3 種類の環境すべてのベースライン ポリシーでは、\[システム ログの保存方法\] は \[必要時\] に設定されています。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
追加のレジストリ エントリ  
-------------------------
  
追加のレジストリ エントリ (*レジストリ値*とも呼ばれる) は、このガイドで定義している 3 種類のセキュリティ環境向けの、既定の管理用テンプレート (.adm) ファイルでは定義されていないベースライン セキュリティ テンプレート ファイルを対象に作成されています。.adm ファイルには、Windows Server 2003 のデスクトップ、シェル、およびセキュリティのポリシーと制限が定義されています。
  
これらのレジストリ エントリは、セキュリティ テンプレート ("Security Options" セクション) に埋め込まれ、変更が自動で行われます。ポリシーを削除しても、これらのレジストリ エントリは自動的には削除されないため、Regedt32.exe などのレジストリ編集ツールを使用して手動で変更する必要があります。3 つの環境すべてに、同じレジストリ値が適用されます。
  
このガイドには、セキュリティ構成エディタ (SCE) に追加されている追加レジストリ エントリも含まれています。これらのレジストリ エントリを追加するには、**%windir%\\inf** フォルダにある Sceregvl.inf ファイルを変更し、Scecli.dll ファイルを再登録する必要があります。元のセキュリティ エントリおよび追加エントリは、この章で前述したスナップインとツールの**ローカルポリシー\\セキュリティ**の配下に存在します。このガイドに付属のセキュリティ テンプレートとグループ ポリシーの編集を行うコンピュータで、Sceregvl.inf ファイルを更新し、Scecli.dll ファイルを再登録する必要があります。これらのファイルの更新方法の詳細については、[http://go.microsoft.com/fwlink/?LinkId=15159](https://technet.microsoft.com/ja-jp/library/75849e66-9f52-4ceb-874e-cace62110b09(v=TechNet.10)) の関連ガイド『[*脅威とその対策 : Windows Server 2003 と Windows XP のセキュリティ設定*](https://technet.microsoft.com/ja-jp/library/75849e66-9f52-4ceb-874e-cace62110b09(v=TechNet.10))』を参照してください。
  
ここでは、追加のレジストリ エントリの概要のみについて説明します。詳細については、関連ガイドを参照してください。ここで説明している既定の設定と各設定の詳細については、*『脅威とその対策 : Windows Server 2003 と Windows XP のセキュリティ設定』* を参照してください。
  
### ネットワーク攻撃に対するセキュリティの考慮事項
  
サービス拒否 (DoS) 攻撃とは、ネットワーク ユーザーがコンピュータまたはコンピュータの特定サービスを使用できなくなるように、ネットワーク攻撃を受けることです。DoS 攻撃を防御するのは困難です。
  
DoS 攻撃を防ぐには、最新のセキュリティ修正プログラムでコンピュータを更新された状態に保ち、Windows Server 2003 SP1 を実行しているコンピュータと潜在的な攻撃者の危険にさらされているコンピュータの TCP/IP プロトコル スタックを強化する必要があります。既定の TCP/IP スタック設定は、標準的なイントラネット トラフィックを処理するように調整されています。コンピュータをインターネットに直接接続する場合は、DoS 攻撃に対して TCP/IP スタックを強化することをお勧めします。
  
以下の表に記載されている、テンプレート ファイルのレジストリ値は、
  
**KEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters\\**
  
サブキーに追加できます。
  
**表 4.28 TCP/IP レジストリ エントリの推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >レジストリ エントリ</th>
<th style="border:1px solid black;" >形式</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">EnableICMPRedirect</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">0</td>
<td style="border:1px solid black;">0</td>
<td style="border:1px solid black;">0</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">SynAttackProtect</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">1</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">EnableDeadGWDetect</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">0</td>
<td style="border:1px solid black;">0</td>
<td style="border:1px solid black;">0</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">KeepAliveTime</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">300,000</td>
<td style="border:1px solid black;">300,000</td>
<td style="border:1px solid black;">300,000</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">DisableIPSourceRouting</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">2</td>
<td style="border:1px solid black;">2</td>
<td style="border:1px solid black;">2</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">TcpMaxConnectResponseRetransmissions</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">2</td>
<td style="border:1px solid black;">2</td>
<td style="border:1px solid black;">2</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">TcpMaxDataRetransmissions</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">3</td>
<td style="border:1px solid black;">3</td>
<td style="border:1px solid black;">3</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">PerformRouterDiscovery</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">0</td>
<td style="border:1px solid black;">0</td>
<td style="border:1px solid black;">0</td>
</tr>
</tbody>
</table>
  
### その他のレジストリ エントリ
  
TCP/IP に固有ではないその他のレジストリ エントリの推奨設定を、次の表に示します。各エントリに関する詳細情報については、表の後のサブセクションで説明します。
  
**表 4.29 その他のレジストリ エントリの推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >レジストリ エントリ</th>
<th style="border:1px solid black;" >形式</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">MSS: (NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">1</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">MSS: (NtfsDisable8dot3NameCreation) Enable the computer to stop generating 8.3 style filenames (recommended)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">0</td>
<td style="border:1px solid black;">0</td>
<td style="border:1px solid black;">1</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">MSS: (NoDriveTypeAutoRun) Disable Autorun for all drives (recommended)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">0xFF</td>
<td style="border:1px solid black;">0xFF</td>
<td style="border:1px solid black;">0xFF</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">MSS:(ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires (0 recommended)</td>
<td style="border:1px solid black;">String</td>
<td style="border:1px solid black;">0</td>
<td style="border:1px solid black;">0</td>
<td style="border:1px solid black;">0</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">MSS: (WarningLevel) Percentage threshold for the security event log at which the system will generate a warning</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">90</td>
<td style="border:1px solid black;">90</td>
<td style="border:1px solid black;">90</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">MSS: (SafeDllSearchMode) Enable Safe DLL search mode (recommended)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">1</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">MSS: (AutoReboot) Allow Windows to automatically restart after a system crash (recommended except for highly secure environments)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">0</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">MSS: (AutoAdminLogon) Enable Automatic Logon (not recommended)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">0</td>
<td style="border:1px solid black;">0</td>
<td style="border:1px solid black;">0</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">MSS: (AutoShareWks) Enable Administrative Shares (recommended except for highly secure environments)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">0</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">MSS: (DisableSavePassword) Prevent the dial-up password from being saved (recommended)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">1</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">MSS: (NoDefaultExempt) Enable NoDefaultExempt for IPSec Filtering (recommended)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">3</td>
<td style="border:1px solid black;">3</td>
<td style="border:1px solid black;">3</td>
</tr>
</tbody>
</table>
  
#### Configure NetBIOS Name Release Security:Allow the computer to ignore NetBIOS name release requests except from WINS servers
  
このエントリは、SCE に \[MSS: (NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers\] と表示されます。
  
NetBIOS over TCP/IP は、Windows ベースのコンピュータに登録された NetBIOS 名を各コンピュータに設定されている IP アドレスに簡単に解決できるネットワーク プロトコルです。この値では、コンピュータが名前解放要求を受信したときに、その NetBIOS 名を解放するかどうかを指定します。
  
テンプレート ファイルのこのレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Services\\Netbt\\Parameters\\**
  
サブキーに追加できます。
  
#### Disable Auto Generation of 8.3 File Names:Enable the computer to stop generating 8.3 style filenames
  
このエントリは、SCE に \[MSS: (NtfsDisable8dot3NameCreation) Enable the computer to stop generating 8.3 style filenames (recommended)\] と表示されます。
  
Windows Server 2003 SP1 は、16 ビット アプリケーションとの下位互換を保つために 8.3 フォーマットのファイル名をサポートしています。8.3 フォーマットのファイルの命名規則では、ファイルに 8 文字以下の名前を付けることができます。
  
テンプレート ファイルのこのレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\FileSystem\\**
  
サブキーに追加できます。
  
#### Disable Autorun:Disable Autorun for all drives
  
このエントリは、SCE に \[MSS:(NoDriveTypeAutoRun) Disable Autorun for all drives (recommended)\] と表示されます。
  
自動実行は、メディアがコンピュータに挿入されると、すぐにコンピュータのドライブから読み込みを開始する機能です。それにより、プログラムのセットアップ ファイルの実行やオーディオ コンテンツの音声の再生がすぐに開始します。
  
テンプレート ファイルのこのレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\**
  
サブキーに追加できます。
  
#### Make Screensaver Password Protection Immediate:The time in seconds before the screen saver grace period expires (0 recommended)
  
このエントリは、SCE に \[MSS:(ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires (0 recommended)\] と表示されます。
  
Windows では、スクリーン セーバー ロックを有効にしている場合、スクリーン セーバーが起動されてからコンソールが実際に自動ロックされるまでには猶予期間があります。
  
テンプレート ファイルのこのレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\**  
**Winlogon\\**
  
サブキーに追加できます。
  
#### Security Log Near Capacity Warning:Percentage threshold for the security event log at which the system will generate a warning
  
このエントリは、SCE に \[MSS:(WarningLevel) Percentage threshold for the security event log at which the system will generate a warning\] と表示されます。
  
このオプションは、Windows 2000 SP3 で導入されたもので、セキュリティ ログのサイズがユーザー定義のしきい値に達すると、セキュリティ ログにセキュリティ監査が生成されます。たとえば、このレジストリ エントリの値を 90 に設定した場合、セキュリティ ログが容量の 90% に達すると、eventID が 523 のエントリ ("The security event log is 90 percent full") が 1 回記録されます。
  
**注** :ログ設定が \[必要に応じてイベントを上書きする\] または \[指定した日数を過ぎたらイベントを上書きする\] に設定されている場合、このイベントは生成されません。
  
テンプレート ファイルのこのレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\ SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security\\**
  
サブキーに追加できます。
  
#### Enable Safe DLL Search Order:Enable Safe DLL search mode (recommended)
  
このエントリは、SCE に \[MSS:(SafeDllSearchMode) Enable Safe DLL search mode (recommended)\] と表示されます。
  
実行中のプロセスから要求された DLL を検索するときに、DLL の検索順序を次のいずれの方法にするのかを設定できます。
  
-   まずシステム パスに指定されているフォルダが検索され、次に現在の作業フォルダが検索されます。
  
-   まず現在の作業フォルダが検索され、次にシステム パスに指定されているフォルダが検索されます。
  
レジストリ値は 1 に設定されています。これにより、まずシステム パスに指定されているフォルダが検索され、次に現在の作業フォルダが検索されます。このエントリを 0 に設定すると、まず現在の作業フォルダが検索され、次にシステム パスに指定されているフォルダが検索されます。
  
テンプレート ファイルのこのレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\ SYSTEM\\CurrentControlSet\\Control\\Session Manager\\**
  
サブキーに追加できます。
  
#### Automatic Reboot:Allow Windows to automatically restart after a system crash
  
このエントリは、SCE に \[MSS: (AutoReboot) Allow Windows to automatically restart after a system crash (recommended except for highly secure environments)\] と表示されます。
  
このエントリが有効な場合には、サーバーは致命的なクラッシュが発生した後に、自動的に再起動します。既定では有効になっていますが、高セキュリティ サーバーには適切でない設定です。
  
テンプレート ファイルのこのレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\CrashControl\\**
  
サブキーに追加できます。
  
#### Automatic Logon:Enable Automatic Logon
  
このエントリは、SCE に \[MSS:(AutoAdminLogon) Enable Automatic Logon (not recommended)\] と表示されます。既定ではこのエントリは無効であり、このエントリをサーバーで使用することは実質的にはありません。
  
詳細については、<http://support.microsoft.com/default.aspx?kbid=315231> のマイクロソフト サポート技術情報「[Windows XP で自動ログオンを有効にする方法](http://support.microsoft.com/default.aspx?kbid=315231)」を参照してください。
  
テンプレート ファイルのこのレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\**  
**Winlogon\\**
  
サブキーに追加できます。
  
#### Administrative Shares:Enable Administrative Shares
  
このエントリは、SCE に \[MSS: (AutoShareWks) Enable Administrative Shares (recommended except for highly secure environments)\] と表示されます。既定では、Windows ネットワークがサーバーでアクティブな場合、Windows により非表示の管理用の隠し共有が作成されます。この動作は、高セキュリティ サーバーでは適切ではありません。
  
テンプレート ファイルのこのレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Services\\RasMan\\Parameters\\**
  
サブキーに追加できます。
  
#### Disable Saved Passwords:Prevent the dial-up password from being saved
  
このエントリは、SCE に \[MSS: (DisableSavePassword) Prevent the dial-up password from being saved (recommended)\] と表示されます。既定では、Windows のオプションはダイヤルアップ接続と VPN 接続のパスワードを保存するようになっていますが、これはサーバーには適切ではありません。
  
テンプレート ファイルのこのレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Services\\LanmanServer\\**  
**Parameters\\**
  
サブキーに追加できます。
  
#### Enable IPSec to protect Kerberos RSVP Traffic:Enable NoDefaultExempt for IPSec Filtering
  
このエントリは、SCE に \[MSS: (NoDefaultExempt) Enable NoDefaultExempt for IPSec Filtering (recommended)\] と表示されます。IPsec ポリシー フィルタの既定の適用除外については、Microsoft Windows Server 2003 オンライン ヘルプに記載されています。これらのフィルタを使用すると、インターネット キー交換 (IKE) と Kerberos 認証プロトコルが機能します。また、データ トラフィックが IPsec によって保護されている場合と、トラフィックが IPsec で保護されていない可能性がある場合 (マルチキャスト トラフィックやブロードキャスト トラフィックなど) に、ネットワークのサービス品質 (QoS) を通知できます (RSVP)。
  
テンプレート ファイルのこのレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Services\\IPSEC\\**
  
サブキーに追加できます。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
制限されたグループ  
------------------
  
"制限されたグループ" 機能を使用すると、グループ メンバシップをポリシー メカニズムを使用して管理し、強力なユーザー権利を持つグループによる意図的な、または不注意による誤用を防ぐことができます。制限するグループを決定するには、まず組織のニーズを確認する必要があります。
  
このガイドで定義している 3 種類の環境では、**Backup Operators** グループと **Power Users** グループは制限されています。**Backup Operators** グループと **Power Users** グループのメンバが持つアクセス許可は、**Administrators** グループのメンバよりは低いですが、それでもその権限は強力です。
  
**注 :** 組織で上記のグループを使用する場合は、各グループのメンバシップを慎重に管理し、\[制限されたグループ\] 設定のガイドは実装しないでください。組織で Power Users グループにユーザーを追加する場合、次項の「ファイル システムのセキュリティ保護」で説明するオプション ファイル システム権限を実装してください。
  
\[制限されたグループ\] 設定は、Windows Server 2003 SP1 の場合、グループ ポリシー オブジェクト エディタを使用して、次の場所で構成できます。
  
**コンピュータの構成\\Windows の設定\\セキュリティの設定\\制限されたグループ\\**
  
管理者は、目的のグループを MSBP に直接追加することにより、制限されたグループを構成できます。制限されたグループには、そのグループに属するメンバおよび他のグループを定義できます。グループ メンバを指定しない場合には、グループは完全に制限されたままになります。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
ファイル システムを保護する  
---------------------------
  
Microsoft Windows のバージョンが新しくなるたび、NTFS ファイル システムは改善されており、ほとんどの組織では NTFS の既定のアクセス許可で十分です。ここで説明している設定は、制限されたグルーブを使用せずに、サーバーのセキュリティをできるだけ高めようとする組織向けのオプションとして説明しています。
  
ファイル システムのセキュリティ設定は、グループ ポリシー オブジェクト エディタを使用して、次の場所で構成できます。
  
**コンピュータの構成\\Windows の設定\\セキュリティの設定\\ファイル システム**
  
**注** :大規模な組織の場合、既定のファイル システムのセキュリティ設定を変更するときは、展開する前にラボ環境で徹底的にテストしてください。ファイルへのアクセス許可を変更したために、影響を受けるコンピュータを完全に再構築する必要が生じた事例が存在します。
  
ほとんど場合、Windows Server2003 SP1 のファイルへのアクセス許可は既定の値で十分です。ただし、**Power Users** グループのメンバシップを "制限されたグループ" 機能を使用してブロックする予定がない場合、または \[ネットワーク アクセス: Everyone のアクセス許可を匿名ユーザーに適用する\] を有効にする予定がない場合は、以降で説明するオプションのアクセス許可を適用することを検討してください。これらのオプションのアクセス許可は非常に専門的な内容であり、高い権限を持つ悪意のあるユーザーがコンピュータまたはネットワークに不正にアクセスするために使用する可能性がある、特定の実行可能形式ツールに追加で制限を適用することができます。
  
これらのオプションを変更しても、システム ボリュームの複数フォルダまたはルートには反映されません。この方法でアクセス許可を変更することは危険性が高く、変更するとコンピュータの動作が不安定になる可能性があります。以下のファイルはすべて **%SystemRoot%\\System32\\** フォルダに存在しており、どれにも **Administrators:Full Control** **と** **System:Full Control** の両アクセス権限が付与されています。
  
-   regedit.exe
  
-   arp.exe
  
-   at.exe
  
-   attrib.exe
  
-   cacls.exe
  
-   debug.exe
  
-   edlin.exe
  
-   eventcreate.exe
  
-   eventtriggers.exe
  
-   ftp.exe
  
-   nbtstat.exe
  
-   net.exe
  
-   net1.exe
  
-   netsh.exe
  
-   netstat.exe
  
-   nslookup.exe
  
-   ntbackup.exe
  
-   rcp.exe
  
-   reg.exe
  
-   regedt32.exe
  
-   regini.exe
  
-   regsvr32.exe
  
-   rexec.exe
  
-   route.exe
  
-   rsh.exe
  
-   sc.exe
  
-   secedit.exe
  
-   subst.exe
  
-   systeminfo.exe
  
-   telnet.exe
  
-   tftp.exe
  
-   tlntsvr.exe
  
これらのオプションのアクセス許可は、すぐに使用できるように、**Optional-File-Permissions.inf** という名前のセキュリティ テンプレートで既に構成済みで、このガイドのダウンロード バージョンに付属しています。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
追加のセキュリティ設定  
----------------------
  
このガイドのベースライン サーバーのセキュリティ強化に使用されているほとんどの対策は、グループ ポリシーを使用して適用されていますが、グループ ポリシーによる適用が困難または不可能な追加設定があります。ここで説明している各対策の詳細については、[http://go.microsoft.com/fwlink/?LinkId=15159](https://technet.microsoft.com/ja-jp/library/75849e66-9f52-4ceb-874e-cace62110b09(v=TechNet.10)) の関連ガイド『[*脅威とその対策 : Windows Server 2003 と Windows XP のセキュリティ設定*](https://technet.microsoft.com/ja-jp/library/75849e66-9f52-4ceb-874e-cace62110b09(v=TechNet.10))』を参照してください。
  
### 手動での強化処理
  
ここでは、このガイドで定義している各セキュリティ環境で、追加の対策 (アカウントのセキュリティ保護など) として手動で実装する方法について説明します。
  
#### ユーザー権利の割り当てに独自のセキュリティ グループを手動で追加する
  
ユーザー権利の割り当てに関する推奨セキュリティ グループのほとんどは、このガイドに付属のセキュリティ テンプレートに構成済みです。しかし、特定のセキュリティ グループの SID は異なる Windows Server 2003 ドメイン間で固有であるため、いくつかの権利はセキュリティ テンプレートに含まれていません。問題は、SID の一部である RID (相対 ID) が固有であることです。次の表は、該当する権利についてまとめたものです。
  
**警告** :以下の表には、ビルトイン Administrator 用の値が記載されています。ビルトイン Administrator は、ビルトイン ユーザー アカウントであり、セキュリティ グループ **Administrators** では*ありません*。以下のアクセス拒否のユーザー権利のいずれかに **Administrators** セキュリティ グループを追加した場合、ローカルにログオンしてその間違いを修正する必要があります。
  
また、このガイドの前述の推奨事項に従っている場合は、ビルトイン Administrator アカウント名が新しくなっている場合があります。このアカウントをアクセス拒否のユーザー権利のいずれかに追加した場合、名前が新しく変更された管理者アカウントを選択していることを確認してください。
  
**表 4.30 手動で追加されるユーザー権利の割り当て**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >UI に表示される設定名</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">ネットワーク経由でコンピュータへアクセスを拒否する
</td>
<td style="border:1px solid black;">ビルトイン Administrator、Support_388945a0、
Guest、すべての非オペレーティング システム サービス アカウント</td>
<td style="border:1px solid black;">ビルトイン Administrator、Support_388945a0、
Guest、すべての非オペレーティング システム サービス アカウント</td>
<td style="border:1px solid black;">ビルトイン Administrator、Support_388945a0、
Guest、すべての非オペレーティング システム サービス アカウント</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">バッチ ジョブとしてログオンを拒否する</td>
<td style="border:1px solid black;">Support_388945a0 および Guest</td>
<td style="border:1px solid black;">Support_388945a0 および Guest</td>
<td style="border:1px solid black;">Support_388945a0 および Guest</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">ターミナル サービスを使ったログオンを拒否する</td>
<td style="border:1px solid black;">ビルトイン Administrator、Guests、Support_388945a0、Guest、すべての非オペレーティング システム サービス アカウント</td>
<td style="border:1px solid black;">ビルトイン Administrator、Guests、Support_388945a0、Guest、すべての非オペレーティング システム サービス アカウント</td>
<td style="border:1px solid black;">ビルトイン Administrator、Guests、Support_388945a0、Guest、すべての非オペレーティング システム サービス アカウント</td>
</tr>
</tbody>
</table>
  
**重要** :すべての非オペレーティング システム サービス アカウントは、それぞれの企業における特定のアプリケーションに対するサービス アカウントです。これらのアカウントには、オペレーティング システムのビルトイン (組み込み) アカウントである LOCAL SYSTEM、LOCAL SERVICE、NETWORK SERVICE の各アカウントは含まれません。
  
リストされているセキュリティ グループを Enterprise Client - Member Server Baseline Policy に手動で追加するには、次の手順を実行します。
  
**セキュリティ グループをユーザー権利の割り当てに追加するには**
  
1.  \[Active Directory ユーザーとコンピュータ\] で、メンバ サーバー OU を右クリックし、\[プロパティ\] をクリックします。
  
2.  \[グループ ポリシー\] タブで、\[Enterprise Client Member Server Baseline Policy\] を選択し、リンク先の GPO を編集します。
  
3.  \[Enterprise Client Member Server Baseline Policy\] を選択し、\[編集\] をクリックします。
  
4.  \[グループ ポリシー\] ウィンドウで、\[コンピュータの構成\\Windows の設定\\セキュリティ設定\\ローカル ポリシー\\ユーザー権利の割り当て\] をクリックして、上記の表の各権利から固有のセキュリティ グループを追加します。
  
5.  変更したグループ ポリシーを閉じます。
  
6.  \[メンバ サーバー OU\] の \[プロパティ\] ウィンドウを閉じます。
  
7.  次の手順を実行して、ドメイン コントローラ間で複製を強制実行して、すべてのドメイン コントローラに同じポリシーを適用します。
  
    1.  コマンド プロンプトを開き、**「gpupdate/Force」** と入力し、**Enter** キーを押して、ポリシーを強制的に更新します。
  
    2.  サーバーを再起動します。
  
8.  イベント ログを参照して、グループ ポリシーが正常にダウンロードされたこと、およびサーバーがドメイン内の他のドメイン コントローラと通信できることを確認してください。
  
#### 既知のアカウントを保護する
  
Windows Server 2003 SP1 には、削除できず、名前だけ変更できるビルトイン ユーザー アカウントがいくつかあります。Windows Server 2003 の最もよく知られているビルトイン アカウントは、Guest と Administrator です。
  
既定では、Guest アカウントはメンバ サーバーとドメイン コントローラでは無効になっています。この設定は変更しないでください。悪意のあるコードの多くは、サーバーへの侵入で最初の試みとしてビルトイン Administrator アカウントを使用します。このため、ビルトイン Administrator アカウントの名前は変更され、説明も変更されて、攻撃者がよく知られているアカウントを使用してリモート サーバーへ侵入するのを防止しています。
  
ビルトイン Administrator アカウントの SID (セキュリティ識別子) を指定し、その本当の名前を調べてサーバーに侵入しようとする攻撃ツールが出現して以来、この設定を変更することの効果はここ数年間で減少しています。SID は、各ユーザー、グループ、コンピュータ アカウント、およびネットワークのログオン セッションをそれぞれ識別する値です。このビルトイン アカウントの SID を変更することはできません。ただし、Administrator アカウント名を一意の名前に変更すると、運用グループが Administrator アカウントに対する攻撃を簡単に監視できるようになります。
  
ドメインおよびサーバーのよく知られたアカウントをセキュリティで保護するには、以下の手順を実行します。
  
-   すべてのドメインやサーバーで、Administrator アカウントと Guest アカウントの名前を変更し、パスワードを長く複雑な値に変更します。
  
-   各サーバーで異なる名前とパスワードを使用します。すべてのドメインおよびサーバーで同じアカウント名とパスワードを使用すると、1 台のメンバ サーバーへのアクセスに成功した攻撃者は、同じアカウント名とパスワードを使用して他のすべてのサーバーにもアクセスできるようになります。
  
-   アカウントを容易に識別できないように、アカウントの説明を既定以外に変更します。
  
-   変更した内容を安全な場所に記録します。
  
    **注** :ビルトイン Administrator アカウントは、グループポリシーを使用して変更できます。各組織がこのアカウント用に固有の名前を選択する必要があるため、この設定はベースライン ポリシーには実装されていません。ただし、このガイドで定義している 3 種類の環境すべてでは、\[アカウント: Administrator アカウント名の変更\] 設定を使用して、Administrator アカウント名を変更できます。このポリシー設定は、GPO のセキュリティ オプション設定に含まれています。
  
#### サービス アカウントをセキュリティ保護する
  
避けられない場合を除いて、ドメイン アカウントのセキュリティ コンテキストでサービスを実行するようには構成しないでください。サーバーに物理的にアクセスされた場合、LSA シークレットをダンプすることで、ドメイン アカウントのパスワードが容易に取得されます。サービス アカウントのセキュリティを保護する方法の詳細については、<http://www.microsoft.com/japan/technet/security/topics/serversecurity/serviceaccount/default.mspx> の「[サービスおよびサービス アカウントのセキュリティ計画ガイド](http://www.microsoft.com/japan/technet/security/topics/serversecurity/serviceaccount/default.mspx)」を参照してください。
  
#### NTFS
  
NTFS パーティションは、ファイルやフォルダのレベルでの ACL をサポートしています。ただしこの ACL は、ファイル アロケーション テーブル (FAT) ファイル システムまたは FAT32 ファイル システムでは使用できません。FAT32 は、FAT ファイル システムのバージョンの 1 つで、既定のクラスタ サイズを大幅に小さくし、最大 2 テラバイトのハード ディスク サイズをサポートするように更新されたものです。FAT32 は、Windows 95 OSR2、Windows 98、Microsoft Windows Me、Windows 2000、Windows XP Professional、および Windows Server 2003 に導入されています。
  
NTFS を使用している各サーバー上のすべてのパーティションをフォーマットします。変換ユーティリティを使用して FAT パーティションを NTFS に慎重に変換してください。ここで、変換ユーティリティにより、変換対象ドライブの ACL が **Everyone: Full Control** に設定されることに留意してください。
  
Windows Server 2003 SP1 を実行するコンピュータの場合、次の 2 つのセキュリティ テンプレートをローカルで適用して、メンバ サーバーとドメイン コントローラそれぞれに、既定のファイル システム ACL を設定します。
  
-   **: %windir%\\inf\\defltsv.inf**
  
-   **: %windir%\\inf\\defltdc.inf**
  
    **注** :既定のドメイン コントローラのセキュリティ設定は、サーバーのドメイン コントローラへの昇格中に適用されます。
  
このガイドで定義している 3 種類の環境すべてのサーバー上のパーティションはすべて NTFS パーティションでフォーマットされ、ACL を使用してファイルとディレクトリのセキュリティを管理できるようにされます。
  
#### ターミナル サービスの設定
  
\[クライアント接続の暗号化レベルを設定する\] では、環境内のターミナル サービス クライアント接続の暗号化のレベルを決定します。128 ビットの暗号化を使用する \[高レベル\] 設定オプションは、ターミナル サービス セッションがパケット アナライザを使用する攻撃者により盗聴されることを防ぎます。古いバージョンのターミナル サービス クライアントには、この高レベルの暗号化をサポートしていないものがあります。ネットワークにそのようなクライアントがある場合は、そのクライアントでサポートされている最高レベルの暗号化でデータを送受信するように接続の暗号化レベルを設定します。
  
この設定は、グループ ポリシーの次の場所で構成できます。
  
**コンピュータの構成\\管理用テンプレート\\Windows コンポーネント\\**  
**ターミナル サービス\\暗号化とセキュリティ**
  
**表 4.31 クライアント接続暗号化レベルに関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >UI に表示される設定名</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">クライアント接続の暗号化レベルを設定する</td>
<td style="border:1px solid black;">高</td>
<td style="border:1px solid black;">高</td>
<td style="border:1px solid black;">高</td>
</tr>
</tbody>
</table>
  
暗号化で利用可能な 3 つのレベルを、次の表に示します。
  
**表 4.32 ターミナル サービスの暗号化レベル**

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >暗号化レベル</th>
<th style="border:1px solid black;" >説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">高レベル</td>
<td style="border:1px solid black;">クライアントとサーバーとの間で送信されるデータが、強力な 128 ビット暗号化を使用して暗号化されます。このレベルは、128 ビット クライアント (リモート デスクトップ接続クライアントなど) のみが存在する環境でターミナル サーバーを実行している場合に使用してください。このレベルの暗号化をサポートしていないクライアントは接続できません。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">クライアント互換</td>
<td style="border:1px solid black;">クライアントとサーバーとの間で送信されるデータが、そのクライアントでサポートされている最強のキーで暗号化されます。このレベルは、異なる種類のクライアントが混在している環境、またはレガシ クライアントが存在する環境でターミナル サーバーを実行している場合に使用してください。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">低レベル</td>
<td style="border:1px solid black;">クライアントからサーバーに送信されるデータが 56 ビット暗号化を使用して暗号化されます。
<strong>重要</strong> :サーバーからクライアントに送信されるデータは暗号化されません。</td>
</tr>
</tbody>
</table>
 

### エラー報告

**表 4.33 エラー報告に関する推奨設定**

 
<table style="border:1px solid black;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >設定</th>
<th style="border:1px solid black;" >レガシ クライアント環境</th>
<th style="border:1px solid black;" >エンタープライズ クライアント環境</th>
<th style="border:1px solid black;" >セキュリティ強化 - 機能制限環境</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">Windows エラーの報告をオフにする</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
<td style="border:1px solid black;">有効</td>
</tr>
</tbody>
</table>
  
このサービスは、Microsoft がエラーを追跡して対処するのに役立ちます。このサービスは、オペレーティング システム エラー、Windows コンポーネント エラー、またはプログラム エラーの報告を生成するように構成できます。このサービスは、Windows XP Professional および Windows Server 2003 でのみ使用できます。
  
**エラー報告**サービスを使用すると、このようなエラーをインターネット経由で Microsoft に報告したり、社内のファイル共有に報告したりできます。エラー報告に重要なデータまたは機密データが格納される可能性がありますが、Microsoft はエラー報告に関するプライバシー ポリシーに従って、そのようなデータを不正に使用しないことを保証します。ただし、データはプレーンテキスト HTTP で転送されるので、第三者によってインターネット上で傍受され、解読される可能性があります。
  
\[Windows エラーの報告をオフにする\] 設定は、エラー報告サービスがデータを送信するかどうかを制御します。
  
このポリシー設定は、Windows Server 2003 の場合、グループ ポリシー オブジェクト エディタを使用して、次の場所で指定できます。
  
**コンピュータの構成\\管理用テンプレート\\システム\\インターネット通信の管理\\インターネット通信の設定**
  
このガイドで定義している 3 種類の環境すべての DCBP で、\[Windows エラーの報告をオフにする\] は \[有効\] に設定します。
  
#### 手動メモリ ダンプを有効にする
  
Windows Server 2003 SP1 には、コンピュータを停止して Memory.dmp ファイルを生成するために使用できる機能が用意されています。この機能は明示的に有効にする必要があります。また、この機能の使用に適していないサーバーが組織内に存在する場合があります。サーバーのメモリ ダンプを取得する必要があると判断した場合は、<http://support.microsoft.com/default.aspx?kbid=244139> の「[Windows の機能により、キーボード操作で Memory.dmp ファイルを作成できる](http://support.microsoft.com/default.aspx?kbid=244139)」を参照してください。
  
**重要 :** 上記の参考文書で説明されているとおりにメモリがディスクにコピーされた場合、機密情報が Memory.dmp ファイルに含まれる可能性があります。すべてのサーバーが承認されていない物理アクセスから保護されていることが理想的です。物理的にアクセスされる危険性があるサーバーにメモリ ダンプ ファイルを生成する場合は、トラブルシューティングの終了後にダンプ ファイルを削除してください。
  
### ベースライン ポリシーを SCW を使用して作成する
  
必要なセキュリティ設定を展開するには、まずメンバ サーバー ベースライン ポリシー (MSBP) 作成する必要があります。このポリシーを作成するには、SCW (セキュリティの構成ウィザード ツール) とこのガイドのダウンロード バージョンに付属しているセキュリティ テンプレートを使用する必要があります。
  
独自のポリシーを作成する場合は、\[レジストリ設定\] セクションと \[監査ポリシー\] セクションをスキップします。これらの設定は、選択した環境のセキュリティ テンプレートで提供されます。この方法は、テンプレートのポリシー要素が SCW によって構成されるポリシー要素より優先されるようにするために必要です。
  
構成作業を始める際には、オペレーティング システムの新規インストールを使用することをお勧めします。こうすることにより、以前の構成の古い設定やソフトウェアが残っていないことが保証されます。可能であれば、展開に使用するものと同様のハードウェアを使用することをお勧めします。これにより、互換性が向上します。このような新規インストールを*参照コンピュータ*と呼びます。
  
MSBP の作成手順で、検出された役割の一覧からファイル サーバーの役割を削除することに注意してください。この役割は、それを必要としないサーバーに構成されていることが多く、セキュリティ リスクになる可能性があります。ファイル サーバーの役割が必要なサーバーでそれを有効にするには、このプロセスの後半で別のポリシーを適用します。
  
**メンバ サーバー ベースライン ポリシーを作成するには**
  
1.  Windows Server 2003 SP1 の新しいインストールを新しい参照コンピュータに作成します。
  
2.  \[コントロール パネル\]、\[アプリケーションの追加と削除\]、\[Windows コンポーネントの追加と削除\] の順に選択して、セキュリティの構成ウィザードのコンポーネントをコンピュータにインストールします。
  
3.  コンピュータをドメインに参加させます。
  
4.  環境のすべてのサーバーに必要な必須アプリケーションのみをインストールし、構成します。たとえば、ソフトウェア エージェント、管理エージェント、テープ バックアップ エージェント、ウイルス対策ユーティリティ、スパイウェア対策ユーティリティなどが該当します。
  
5.  SCW GUI を起動し、\[新しいセキュリティ ポリシーの作成\] を選択して、参照コンピュータを指定します。
  
6.  検出された役割の一覧からファイル サーバーの役割を削除します。
  
7.  検出されたサーバーの役割が環境に適していることを確認します。
  
8.  検出されたクライアント機能が環境に適していることを確認します。
  
9.  検出された管理オプションが環境に適していることを確認します。
  
10. ベースラインに必要な追加サービス、たとえばバックアップ エージェントやウイルス対策ソフトウェアが検出されていることを確認します。
  
11. 環境で指定されていないサービスの扱いを決定します。セキュリティをさらに向上させるため、この設定を \[無効\] にします。この設定は、運用ネットワークに展開する前にテストしてください。運用サーバーが、参照コンピュータに複製されていない追加サービスを実行する場合に、問題が発生することがあります。
  
12. \[ネットワーク セキュリティ\] セクションで \[このセクションをスキップする\] チェック ボックスがオフであることをオフであることを確認し、\[次へ\] をクリックします。前の手順で特定した適切なポートとアプリケーションが、Windows ファイアウォールの例外として構成されます。
  
13. \[レジストリの設定\] セクションで、\[このセクションをスキップする\] チェック ボックスをオンにし、\[次へ\] をクリックします。これらのポリシー設定は、付属の INF ファイルからインポートされます。
  
14. \[監査ポリシー\] セクションで、\[このセクションをスキップする\] チェック ボックスをオンにし、\[次へ\] をクリックします。これらのポリシー設定は、付属の INF ファイルからインポートされます。
  
15. 適切なセキュリティ テンプレート (EC-Member Server Baseline.inf など) を指定します。
  
16. ポリシーを適切な名前 (Member Server Baseline.xml など) で保存します。
  
### SCW を使用してポリシーをテストする
  
ポリシーを作成して保存したら、テスト環境に展開することを強くお勧めします。テスト サーバーが運用サーバーと同じハードウェアおよびソフトウェア構成であることが理想的です。こうすることで、特定のハードウェア デバイスに予期しないサービスが必要になった場合などの、潜在的な問題を検出して解決できるようになります。
  
ポリシーのテストには、2 つの方法があります。SCW の展開機能を使用する方法と、GPO を使用してポリシーを展開する方法です。
  
ポリシーの作成をこれから始める場合には、SCW の展開機能を使用することを検討してください。SCW を使用して、ポリシーをサーバーごとにプッシュするか、Scwcmd を使用してポリシーをサーバーのグループにプッシュします。この展開方法には、SCW から展開したポリシーを簡単にロールバックできるという利点があります。この機能は、テスト プロセスでポリシーの変更を複数行う場合に便利です。
  
ポリシーをテストする目的は、そのポリシーを対象サーバーに適用しても重要な機能に悪影響が及ばないことを確認することです。構成の変更を適用したら、コンピュータの主要な機能を検証する必要があります。たとえば、証明機関 (CA) として構成されているサーバーの場合は、クライアントが証明書を要求して取得できること、証明書失効リストをダウンロードできることなどを確認します。
  
ポリシーの構成に問題がないことを確認したら、次に示す手順に従って、Scwcmd を使用して、ポリシーを GPO に変換します。
  
SCW ポリシーのテスト方法の詳細については、[http://technet2.microsoft.com/WindowsServer/ja/Library/5254f8cd-143e-4559-a299-9c723b3669461041.mspx?mfr=true](http://technet2.microsoft.com/windowsserver/ja/library/5254f8cd-143e-4559-a299-9c723b3669461041.mspx?mfr=true) の「[セキュリティの構成ウィザードの展開ガイド](http://technet2.microsoft.com/windowsserver/ja/library/5254f8cd-143e-4559-a299-9c723b3669461041.mspx?mfr=true)」および <http://go.microsoft.com/fwlink/?linkid=43450> の「[Security Configuration Wizard Documentation](http://go.microsoft.com/fwlink/?linkid=43450)」(英語情報) を参照してください。
  
### ポリシーを変換して展開する
  
ポリシーを徹底的にテストした後、次の手順を実行して、ポリシーを GPO に変換して、展開します。
  
1.  コマンド プロンプトで、次のコマンドを入力します。
  
    <codesnippet language displaylanguage containsmarkup="false">scwcmd transform /p:&lt;PathToPolicy.xml&gt; /g:&lt;GPODisplayName&gt;  

    `scwcmd transform /p:<PathToPolicy.xml> /g:<GPODisplayName>`
  
    **Enter** キーを押します。次にその例を示します。
  
    `scwcmd transform /p:"C:\Windows\Security\msscw\Policies\Member Server Baseline.xml" /g:"Member Server Baseline Policy"
`   

  
    **注** :コマンド プロンプトに入力する情報が、表示の制限により複数行にわたって表示されることがあります。この情報は、すべて 1 行に入力してください。
  
2.  グループ ポリシー管理コンソールを使用して、新しく作成した GPO を適切な OU にリンクします。
  
SCW セキュリティ ポリシー ファイルに Windows ファイアウォールの設定が含まれている場合、この手順を正常に完了するには、ローカル コンピュータで Windows ファイアウォールが有効になっている必要があります。Windows ファイアウォールが有効であることを確認するには、\[コントロール パネル\] を開き、\[Windows ファイアウォール\] をダブルクリックします。
  
次に、最後のテストを実行して、GPO により意図した設定が適用されることを確認します。この手順を完了させるために、設定が適切であること、機能がその影響を受けないことを確認します。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
まとめ  
------
  
この章では、このガイドで定義している 3 種類のセキュリティ環境すべてで、Windows Server 2003 SP1 を実行しているサーバーに初期状態で適用されるセキュリティ強化処理について説明しました。この処理のほとんどで、セキュリティ環境ごとに固有のセキュリティ テンプレートを作成し、それをメンバ サーバーの親 OU にリンクされた GPO にインポートすることによって、対象レベルのセキュリティを実現しています。
  
ただし強化処理の一部は、グループ ポリシーを使用して適用することはできません。これらの設定を手動で構成する方法についても説明しました。個々のサーバーの役割が、できるだけセキュリティが高い状態で、その役割の範囲内で機能できるよう、処理が追加されました。
  
サーバーの役割に固有の処理には、追加のセキュリティ強化処理、およびベースライン セキュリティ ポリシーのセキュリティ設定を削減する処理などがあります。これらの変更については、このガイドの以降の章で詳しく説明しています。
  
### 関連情報
  
Windows Server 2003 SP1 を実行するサーバーのセキュリティ強化に関する詳細情報は、以下のリンクから参照できます。
  
-   Windows Server 2003 のセキュリティ設定の詳細については、[http://technet2.microsoft.com/WindowsServer/ja/library/dd980ca3-f686-4ffc-a617-50c6240f55821041.mspx](http://technet2.microsoft.com/windowsserver/ja/library/dd980ca3-f686-4ffc-a617-50c6240f55821041.mspx%20) の「[セキュリティの設定の説明](http://technet2.microsoft.com/windowsserver/ja/library/dd980ca3-f686-4ffc-a617-50c6240f55821041.mspx%20)」ページを参照してください。
  
-   Windows Server 2003 のセキュリティの詳細については、<http://www.microsoft.com/japan/technet/security/prodtech/windowsserver2003.mspx> の「[Windows Server 2003](http://www.microsoft.com/japan/technet/security/prodtech/windowsserver2003.mspx)」を参照してください。
  
-   Windows Server 2003 の監査ポリシーの詳細については、<http://technet.microsoft.com/ja-jp/library/cc779526.aspx> の「[監査ポリシー](http://technet.microsoft.com/ja-jp/library/cc779526.aspx)」ページを参照してください。
  
-   Microsoft Operations Manger (MOM) の詳細については、<http://www.microsoft.com/japan/mom/default.mspx> の「[Microsoft Operations Manager](http://www.microsoft.com/japan/mom/default.mspx)」ページを参照してください。
  
-   Windows Server 2003 のユーザー権利の詳細については、<http://technet.microsoft.com/ja-jp/library/cc778337.aspx> の「[ユーザーの権利](http://technet.microsoft.com/ja-jp/library/cc778337.aspx)」ページを参照してください。
  
-   Windows Server 2003 の既定のセキュリティ設定の詳細については、<http://technet.microsoft.com/ja-jp/library/cc772745.aspx> の「[既定のセキュリティ設定の違い](http://technet.microsoft.com/ja-jp/library/cc772745.aspx)」ページを参照してください。
  
-   Windows 2000 ターミナル サービスをセキュリティ保護する方法の詳細については、<http://www.microsoft.com/technet/prodtechnol/win2kts/maintain/optimize/secw2kts.mspx> の「[Securing Windows 2000 Terminal Services](http://www.microsoft.com/technet/prodtechnol/win2kts/maintain/optimize/secw2kts.mspx)」(英語情報) を参照してください。
  
-   Windows Server 2003 TCP/IP スタックのセキュリティを保護する方法の詳細については、<http://support.microsoft.com/?kbid=324270> のマイクロソフト サポート技術情報「[Windows Server 2003 で DoS 攻撃に対して TCP/IP スタックを強化する方法](http://support.microsoft.com/?kbid=324270)」を参照してください。
  
-   Windows Sockets アプリケーションの設定をセキュリティ強化する方法の詳細については、<http://support.microsoft.com/?kbid=142641> のマイクロソフト サポート技術情報「[悪質な SYN 攻撃のため、使用できないインターネット サーバー](http://support.microsoft.com/?kbid=142641)」を参照してください。
  
-   .adm ファイルの場所については、<http://support.microsoft.com/?kbid=228460> のマイクロソフト サポート技術情報「[Location of ADM (Administrative Template) Files in Windows](http://support.microsoft.com/?kbid=228460)」(英語情報) を参照してください。
  
-   セキュリティ構成エディタのユーザー インターフェイスのカスタマイズ方法の詳細については、<http://support.microsoft.com/?kbid=214752> のマイクロソフト サポート技術情報「[カスタム レジストリ設定をセキュリティ構成エディタに追加する方法](http://support.microsoft.com/?kbid=214752)」を参照してください。
  
-   Windows でカスタム管理用テンプレート ファイルを作成する方法の詳細については、<http://support.microsoft.com/?kbid=323639> のマイクロソフト サポート技術情報「[Windows 2000 でカスタム管理用テンプレートを作成する方法](http://support.microsoft.com/?kbid=323639)」を参照してください。また、<http://www.microsoft.com/technet/prodtechnol/windows2000serv/howto/default.mspx> のホワイト ペーパー「[Implementing Registry-Based Group Policy](http://www.microsoft.com/technet/prodtechnol/windows2000serv/howto/default.mspx)」(英語情報) も参照してください。
  
-   Windows 2000 コンピュータと Windows NT 4.0 コンピュータが混在するネットワークで LAN Manager の認証レベル設定のセキュリティを向上させる方法については、<http://support.microsoft.com/?kbid=305379> のマイクロソフト サポート技術情報「[Windows NT 4.0 のドメインで NTLM 2 のレベル 2 より上を使用する Windows 2000 の認証問題](http://support.microsoft.com/?kbid=305379)」を参照してください。
  
-   NTLMv2 認証の詳細については、<http://support.microsoft.com/?kbid=239869> のマイクロソフト サポート技術情報「[NTLM 2 認証を有効にする方法](http://support.microsoft.com/?kbid=239869)」を参照してください。
  
-   Windows Server 2003 で使用可能なサービスの既定の設定については、<http://technet.microsoft.com/ja-jp/library/cc785922.aspx> の「[サービスの既定の設定](http://technet.microsoft.com/ja-jp/library/cc785922.aspx)」ページを参照してください。
  
-   スマート カードの展開の詳細については、<http://www.microsoft.com/japan/technet/technetmag/issues/2005/01/smartcards/default.mspx> の「[スマートで行こう！スマート カードによるネットワークの IQ の向上](http://www.microsoft.com/japan/technet/technetmag/issues/2005/01/smartcards/default.mspx)」を参照してください。
  
-   "Restrict Anonymous" レジストリ値と Windows 2000 の詳細については、<http://support.microsoft.com/?kbid=296405> のマイクロソフト サポート技術情報「[「RestrictAnonymous」レジストリ値と、信頼が Windows 2000 ドメインに解除できます。](http://support.microsoft.com/?kbid=296405)」を参照してください。
  
-   エラー報告の詳細については、<http://www.microsoft.com/japan/licensing/sa/cer.mspx> の「[企業内エラー報告](http://www.microsoft.com/japan/licensing/sa/cer.mspx)」ページを参照してください。
  
-   Microsoft アプリケーションが使用するネットワーク ポートの詳細については、<http://support.microsoft.com/kb/832017> のマイクロソフト サポート技術情報「[Microsoft Windows サーバー システムのポート要件](http://support.microsoft.com/kb/832017)」を参照してください。
  
[](#mainsection)[ページのトップへ](#mainsection)

 
<table style="border:1px solid black;">
<colgroup>
<col width="100%" />
</colgroup>
<tbody>
<tr class="odd">
<td style="border:1px solid black;"><h5 id="目次">目次</h5>
<ul>
<li><a href="https://technet.microsoft.com/ja-jp/library/9911b568-c474-465f-998f-4f0fa31bebc6(v=TechNet.10)">概要</a></li>
<li><a href="https://technet.microsoft.com/ja-jp/library/8a6cda2e-32c2-4945-897f-0353cd6e908a(v=TechNet.10)">第 1 章 :Windows Server 2003 セキュリティ ガイドの概要</a></li>
<li><a href="https://technet.microsoft.com/ja-jp/library/7cc50ea6-80d8-4ef6-81de-f47a60ebf8fa(v=TechNet.10)">第 2 章 :Windows Server 2003 のセキュリティ強化メカニズム</a></li>
<li><a href="https://technet.microsoft.com/ja-jp/library/833fddab-0361-4209-bef6-ee3b14acd18d(v=TechNet.10)">第 3 章 :ドメイン ポリシー</a></li>
<li>第 4 章 :メンバ サーバー ベースライン ポリシー</li>
<li><a href="https://technet.microsoft.com/ja-jp/library/4247b4ee-4805-4ac4-8962-9f73c91bb80f(v=TechNet.10)">第 5 章 :ドメイン コントローラ ベースライン ポリシー</a></li>
<li><a href="https://technet.microsoft.com/ja-jp/library/ed0c9484-c1e8-4399-8da1-488342ca6503(v=TechNet.10)">第 6 章 :インフラストラクチャ サーバーの役割</a></li>
<li><a href="https://technet.microsoft.com/ja-jp/library/e4da3b65-69ce-44a2-8c77-dcd42da508b8(v=TechNet.10)">第 7 章 :ファイル サーバーの役割</a></li>
<li><a href="https://technet.microsoft.com/ja-jp/library/897b32c2-f09c-4b08-b10c-37f73aa516df(v=TechNet.10)">第 8 章 :プリント サーバーの役割</a></li>
<li><a href="https://technet.microsoft.com/ja-jp/library/ae41b3f3-b46f-4818-ae75-3aaf23075b56(v=TechNet.10)">第 9 章 :Web サーバーの役割</a></li>
<li><a href="https://technet.microsoft.com/ja-jp/library/edd5e9dd-fda5-41a5-8b71-80ce960bc394(v=TechNet.10)">第 10 章 :IAS サーバーの役割</a></li>
<li><a href="https://technet.microsoft.com/ja-jp/library/a4238f44-28fc-4931-b1d5-a37d2a173284(v=TechNet.10)">第 11 章 :証明書サービス サーバーの役割</a></li>
<li><a href="https://technet.microsoft.com/ja-jp/library/c663fb69-d017-4f65-b812-01882f39a34b(v=TechNet.10)">第 12 章 :要塞ホストの役割</a></li>
<li><a href="https://technet.microsoft.com/ja-jp/library/90522937-7ccc-49fe-943b-a7b95cdcd8e9(v=TechNet.10)">第 13 章 :結論</a></li>
<li><a href="https://technet.microsoft.com/ja-jp/library/bb480ff2-c590-4af4-8f5d-b8d09bb272bf(v=TechNet.10)">付録 A:セキュリティ ツールと形式</a></li>
<li><a href="https://technet.microsoft.com/ja-jp/library/22b7ca9a-8713-4a2a-8255-3666a82da9ee(v=TechNet.10)">付録 B:検討が必要な重要な設定</a></li>
<li><a href="https://technet.microsoft.com/ja-jp/library/80d2b596-9608-4ae0-8095-81238a707002(v=TechNet.10)">付録 C:セキュリティ テンプレートの設定の概要</a></li>
<li><a href="https://technet.microsoft.com/ja-jp/library/6aec7740-ad4a-4bbb-916c-16b8da021179(v=TechNet.10)">付録 D:Windows Server 2003 セキュリティ ガイドのテスト</a></li>
<li><a href="https://technet.microsoft.com/ja-jp/library/d43f2ace-bc5d-46b1-92ff-9468ae0c73ac(v=TechNet.10)">謝辞</a></li>
</ul></td>
</tr>
</tbody>
</table>
 

[](#mainsection)[ページのトップへ](#mainsection)
