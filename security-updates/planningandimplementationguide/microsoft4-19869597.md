---
TOCTitle: 'Microsoft 仮想プライベート ネットワークでの検疫サービスの実装計画ガイド - 第 4 章'
Title: 'Microsoft 仮想プライベート ネットワークでの検疫サービスの実装計画ガイド - 第 4 章'
ms:assetid: '7e20ac7b-c15a-4cab-9ca2-91f155b818ab'
ms:contentKeyID: 19869597
ms:mtpsurl: 'https://technet.microsoft.com/ja-jp/library/Cc163112(v=TechNet.10)'
---

Microsoft 仮想プライベート ネットワークでの検疫サービスの実装計画ガイド
=======================================================================

### 第 4 章 - ソリューションの設計

最終更新日: 2006年7月18日

##### ダウンロード

[![](images/Cc163112.icon_exe(ja-jp,TechNet.10).gif)Microsoft 仮想プライベート ネットワークでの検疫サービスの実装計画ガイド (英語情報)](http://go.microsoft.com/fwlink/?linkid=41308)

##### トピック

[](#eeaa)[はじめに](#eeaa)
[](#edaa)[在宅勤務者のための VPN アクセスの実装](#edaa)
[](#ecaa)[その他の考慮事項](#ecaa)
[](#ebaa)[監視と管理の実装](#ebaa)
[](#eaaa)[要約](#eaaa)

### はじめに

ここまで、仮想プライベート ネットワーク (VPN) ソリューションが取り組むべき要素について説明してきましたが、この章では、ソリューションの設計プロセスについて説明します。この設計プロセスでは、基本となる計画要素の特定、およびソリューション要件の論理的な分析を行います。

Woodgrove National Bank では、ソリューションが取り組むべきビジネス、技術、およびセキュリティ上の問題点の評価を実施してきました。この章では、システム設計者が考慮した計画上の問題点、到達した結論、および選択したソリューションを構築する際に行った意思決定について説明します。

[](#mainsection)[ページのトップへ](#mainsection)

### 在宅勤務者のための VPN アクセスの実装

離れた場所で仕事に従事している Woodgrove National Bank の在宅勤務者は、一貫した信頼性の高い企業ネットワークへの接続を必要としています。接続が困難であったり、接続時に過度な遅延が発生したりするようでは、不満の原因になったり、サービスの信用が失われます。VPN 検疫を実装したことにより、ネットワークへの接続にさらに時間がかかってしまうと、ユーザーの不満はますます高まります。Woodgrove National Bankの IT 部門では、接続時の遅延を監視し、遅延を最小限に抑える措置を講じる必要があります。接続スクリプトを使用すると、接続プロセスの各段階で、ユーザーに接続状態を通知することができます。

ネットワーク管理者は、リモート アクセス コンピュータがネットワーク リソースにアクセスする前に、ネットワーク アクセス ポリシーに従うことを義務付ける必要があります。企業ネットワークを保護する最良の方法は、リモート アクセス コンピュータを隔離し、コンピュータがネットワーク セキュリティ ポリシーを満たしていることを確認してから、ネットワーク リソースにアクセスできるようにすることです。

#### ソリューションの概念

ソリューションは、接続前スクリプト、クラインアント エージェント、Microsoft® Windows Server™ 2003 Service Pack 1 (SP1) コンポーネントを組み合わせて使用します。クライアント コンピュータは、カスタムの接続マネージャ プロファイルを使用して、VPN 接続を開始します。接続マネージャ プロファイルは、接続マネージャ管理キット (CMAK) を使用して作成された自己解凍型の実行可能ファイルで、スクリプトおよび設定を保存しています。トンネル前の動作スクリプトは、クライアントが VPN 接続を確立する前に、セキュリティ更新プログラムの更新を要求します。リモート アクセス コンピュータは、これらの更新プログラムを、Woodgrove National Bank が管理するインターネットに接続されたサーバー、ウイルス対策ソフトウェア ベンダ、および Windows Update の Web サイトから入手します。

クライアント コンピュータは、必要な更新プログラムを取得し、インターネット認証サービス (IAS) を使用して Active Directory® ディレクトリ サービスと照合して、ユーザーの資格情報を認証してから、VPN 接続を確立します。リモート アクセス サーバーは、リソースへの制限付きアクセスのみを許可する検疫パケット フィルタを使用して、着信接続を制限します。クライアント コンピュータが必要なセキュリティ要件を満たしていることをクライアント エージェントが確認すると、リモート アクセス サーバーは検疫の制限を解除し、クライアント コンピュータは承認されたすべてのイントラネット リソースへのアクセスが許可されます。

#### ソリューションの必要条件

このような特性を持つプロジェクトを開始する場合、プロジェクトは特定の前提条件満たす必要があります。次のセクションでは、VPN 検疫の一般的な前提条件について説明します。

##### ユーザーおよびグループとの打ち合わせ

関係するユーザーおよびグループと打ち合わせすることは、ユーザー サービスに影響を与える変更を計画するうえで最も重要な手順の 1 つです。ユーザーは、既存のサービスの問題点およびパフォーマンスについての貴重なフィードバックを提供します。さらに、ユーザーは新しいサービスに期待する機能および操作性を指摘することもあります。ユーザーは、サービスに何を期待するか、また何が必要でないかを把握しておく必要があります。このような期待に対処することは、ユーザーに受け入れてもらうための鍵となります。プロジェクトの成功を判断するには、組織が達成可能な目標を設定することが重要になります。

Woodgrove National Bank は、複数の国や地域で操業しており、地域別にサポート センターがあります。初期チームは、リモート アクセス ユーザーおよびサポート チームからのフィードバックを広範囲に調査し、潜在的なユーザー、グループ、およびサポート スタッフを特定してパイロットに参加させました。

##### プロジェクト チームの編成

このような特性を持つプロジェクトを実装するために、必要な人員とスキルを検討することは重要なことです。プロジェクト チームは、必要なスキルの要件を社内で満たすことができるか、追加の人員を採用する必要があるのかを検討する必要があります。プロジェクトのすべての段階ですべての人員が必要になるわけではないので、プロジェクトの全期間を通じて個々の人員の作業状況を確認する必要があります。役割として必要なのは、ネットワーク設計者、ネットワーク管理者、サーバー管理チーム、スクリプト開発者、インフラストラクチャ セキュリティ チーム、およびプロジェクト管理チームです。

#### ソリューションの計画

計画プロセス中に、Woodgrove では以下を実施することの必要性を検討しました。

-   パイロットまたはテストの実装

-   ターミナル サービスでの境界領域ネットワーク サーバーの管理

-   検疫スクリプトのアップグレード

-   パフォーマンス データの収集

##### パイロットまたはテストの実装

組織の大きさおよび規模によってパイロットの大きさと数が決まります。Woodgrove の IT 部門では、2 つのパイロットを実装しました。最初のパイロットでは、概念を立証し、また潜在的な欠点を明らかにしビジネスと技術上の問題点を緩和するために、経験豊富なリモート アクセス ユーザーが携わりました。最初のパイロットでは、企業リソースへのアクセスを制限し、セキュリティ コンプライアンスに準拠していると考えられるコンピュータにセキュリティ上の問題点がないことを確認しました。VPN 検疫ソリューションを実装する組織では、ウイルスに感染したコンピュータ、または適切な更新プログラムが設定されていないコンピュータが、検疫セキュリティ チェックをすり抜けられないことを確認してから、VPN 検疫ソリューションを実装し、企業ネットワークを公開するべきです。2 番目のパイロットでは、多数のユーザーが携わることを基本とし、発生する可能性のあるサポート上の問題点をより現実に即してテストできるように、経験の浅いユーザーも含めました。

##### ターミナル サービスでの境界領域ネットワーク サーバーの管理

Woodgrove の IT チームでは、ターミナル サービス管理モードを使用して、境界ネットワーク上の既存のサーバーを管理します。Woodgrove の IT チームは、インターネットに接続する更新サーバーおよび VPN リモート アクセス サーバーをこのリストに追加する必要があります。Woodgrove は、これらの重要なサーバーの更新および維持方法を検討する必要があります。

##### 検疫スクリプトのアップグレード

時間の経過とともに、接続マネージャ プロファイルの新しいビルドによる検疫スクリプトの更新が必要になります。Woodgrove では、ユーザー認証が必要な Web サーバーを経由して、接続マネージャ プロファイルを配布することを選択しました。リモート アクセス ユーザーは、配布ポイントを通知する電子メールを受け取ります。

##### パフォーマンス データの収集

パフォーマンスを評価することは、サービスを改善するために重要です。Woodgrove の IT 部門は、サーバーのパフォーマンス、信頼性、およびセキュリティを監視する必要があります。ネットワーク チームは、既存の監視および管理構成に VPN 検疫ソリューションを統合できるようにします。

#### ソリューション アーキテクチャ

Woodgrove National Bank が VPN 検疫ソリューションを実装するには、次のコンポーネントが必要です。

-   Windows XP Professional SP2 以降を実行しているクライアント コンピュータ

-   CMAK を使用して作成された接続マネージャ プロファイル

-   接続マネージャ クライアント パッケージに含まれているクライアント側のスクリプト

-   VPN 検疫クライアント コンポーネント

-   Windows Server 2003 SP1 以降を実行しており、リモート アクセス検疫サービスをインストールしているリモート アクセス サーバー

-   検疫 IP ポート フィルタ

-   Windows Server 2003 上で実行しているインターネット認証サービス (IAS)

-   Active Directory

Woodgrove の IT 部門は当初、現在展開されているすべてのバージョンの Windows をサポート対象とすることを検討しました。しかし、インターネットに接続するコンピュータに対する脅威への認識が強まったことから、コンピュータのオペレーティング システムを Windows XP Professional SP2 を標準とすることに決定しました。Woodgrove では Windows XP Home Edition SP2 を搭載したコンピュータが VPN 経由で接続することを許可することも可能でしたが、Woodgrove の IT 部門は、Windows XP Home Edition ベースのコンピュータがドメインに参加できないことから、この構成をサポートしないことに決定しました。Woodgrove の IT 部門が初期のソリューションを実装する際に、Woodgrove は作業者の自宅のコンピュータにソリューションを拡張することを予定しています。

接続前のチェックの 1 つに、Windows ファイアウォールが有効になっていることを確認するチェックが含まれています。Woodgrove ではスクリプト内に例外を指定しませんが、リモート デスクトップの接続後などの例外は設定します。

CMAK は、クライアント通知コンポーネント (RQC.exe) や初期検疫スクリプトなどの、接続を開始するために必要なライセンスを供与されたすべてのソフトウェアを含めた、接続マネージャ プロファイルを設定するためのツールです。Woodgrove National Bank では Web サーバーを使用してこれらのプロファイルを配布します。Woodgrove National Bank が接続マネージャ プロファイルを更新する際には、決まった日までに新しいプロファイルが必要であることを電子メールでユーザーに通知します。

**注 :** グループ ポリシーや Microsoft Systems Management Server (SMS) 2003 などのソフトウェア配布メカニズムを使用するか、または自宅のコンピュータから企業のネットワークに接続する必要があるユーザーの場合、パスワード保護された USB キーにプロファイルを配置する方法が代替手段として考えられます。

Windows Server 2003 のリモート アクセスには、VPN ホストおよびルーターとしての役割を果たす機能が備えられています。Windows Server 2003 SP1 には、VPN 検疫ソリューションの主要なコンポーネントであるリモート アクセス検疫サービス (RQS) が含まれています。RQS は、実行可能ファイル (RQS.exe) として実装されるサーバー リスナ コンポーネントです。CMAK には通知コンポーネント (RQC.exe) が含まれています。

検疫ポート フィルタは、検疫された VPN クライアントと、ネットワーク上の制限されたリソース間の通信のみを許可します。パケット フィルタは、クライアント エージェントがリモート アクセス サーバー上のリスナ コンポーネントと通信し、ユーザー認証を行うことを許可します。

Windows Server 2003 上で実行している IAS は、RADIUS サーバーおよび RADIUS プロキシ サーバーの Microsoft の実装です。IETF (Internet Engineering Task Force) は RADIUS を RFC 2865 および 2866 で規定しています。IAS はリモート アクセス リクエストを認証し、アカウンティング情報を提供します。Woodgrove の IT 部門は、数社の ISP と契約し、これらの ISP によって複数の国/地域でのインターネットへのローミング アクセスが可能になります。ISP は、Woodgrove の IAS サーバーを経由して認証リクエストを渡すように RADIUS サーバーを構成します。この認証プロセスでは、Woodgrove の IAS サーバーに戻るように構成された ISP で、RADIUS サーバーと RADIUS プロキシを併用する必要があります。IAS を使用して認証を行うと、Woodgrove はリモート アクセス VPN の使用状況を追跡するために RADIUS のアカウンティング機能を利用できます。

Active Directory のユーザー アカウントとグループ メンバシップが、Woodgrove National Bank の企業リソースへのリモート接続および以降のアクセスを規制します。また、Woodgrove National Bank では、グループ ポリシー オブジェクト (GPO) を使用して、Windows ワークステーションが会社のネットワーク セキュリティ ポリシーを満たすように構成します。

#### ソリューションのしくみ

次の図は、Woodgrove National Bank における VPN 検疫ソリューションの実装を示しています。

![](images/Cc163112.PGFG0401(ja-jp,TechNet.10).gif)

**図 4.1: Woodgrove National Bank での VPN 検疫プロセス**

[画像を画面全体に表示](https://technet.microsoft.com/ja-jp/cc163112.pgfg0401_big(ja-jp,technet.10).gif)
Woodgrove National Bank における VPN 検疫ソリューションは、次のように動作します。

1.  ユーザーが VPN 接続プロファイルを選択します。また、アプリケーションが企業のイントラネット上のリソースを要求することも可能です。

2.  接続マネージャ プロファイルが、ダイヤルアップ エントリを使用してインターネットへの接続を開始します。クライアントが既にインターネットに接続している場合は、接続マネージャはこの手順を省略します。

3.  トンネル前のカスタム動作が、コンピュータに最新のセキュリティ更新プログラムとウイルス対策シグネチャが設定されていることを確認するスクリプトを実行します。クライアント コンピュータは、これらの更新プログラムをインストールするために Windows Update に接続します。トンネル前のカスタム動作に適したカスタム スクリプトの例については、このガイドの付録 A 「検疫スクリプトのサンプル」を参照してください。

4.  更新プログラムが正しく適用されると、接続マネージャ プロファイルが VPN サーバーに接続します。更新プログラムが正しく適用されないと、接続マネージャ プロファイルはその旨をユーザーに通知し、VPN 接続の試行を終了します。

5.  リモート アクセス クライアント コンピュータが、リモート アクセス サーバーに認証資格情報を渡し、リモート アクセス サーバーが、RADIUS アクセス リクエスト メッセージを IAS サーバーに送信します。IAS は Active Directory に対してユーザーの資格情報を認証します。資格情報が有効であれば、IAS はそのユーザーをリモート アクセス ポリシーと照合して確認します。

6.  VPN サーバーは接続を受け入れ、検疫タイムアウト属性と IP フィルタ属性を設定します。IAS サーバーは、MS-Quarantine-IPfilter 属性と MS-Quarantine-Session-Timeout 属性を含めた RADIUS アクセス受け入れメッセージを送信します。VPN サーバーはこれらの属性を検疫フィルタに適用し、セッション タイマを設定します。リモート アクセス クライアント コンピュータは、検疫フィルタに一致するトラフィックのみを転送できます。リモート アクセス クライアントは、リモート アクセス サーバーに対し、MS-Quarantine-Session-Timeout カウンタに指定した時間 (秒) が経過する前に、検疫スクリプトが正常に完了したことを通知する必要があります。

7.  リスナ コンポーネントは、リモート アクセス サーバーに対し、クライアントがポリシー要件を満たしていることを通知します。リモート アクセス サーバーは、MS-Quarantine-IPfilter 属性に指定したトラフィック ルール (ポート 7250) に一致するため、この通知を受け取ります。リモート アクセス サーバーは、MS-Quarantine-IPfilter 設定と MS-Quarantine-Session-Timeout 設定を接続から削除し、リモート アクセス ポリシーで事前に規定した通常の接続制約を設定します。

8.  これで、ユーザーは承認されたネットワーク リソースにアクセスできるようになります。

**注 :** 接続後のスクリプトは、接続マネージャ パッケージのバージョンを確認します。リモート コンピュータ上の接続マネージャのバージョンのうち 3 つ以上のマイナー バージョン、または 2 つ以上のメジャー バージョンの有効期限が切れていた場合、リモート コンピュータは最新の接続マネージャ パッケージをダウンロードし、ユーザーにその旨を通知し、接続を切断します。その結果、リモート コンピュータに最新の修正プログラム リストが備えられ、リモート ユーザーは再び接続可能になります。

このソリューションを実装するには、クライアント側とサーバー側で実行する多くのプロセスが必要になります。次のセクションでは、これらの要件について説明します。

##### スクリプトを使用してのカスタム動作の実装

接続サイクルのさまざまなポイントで実行するスクリプトは、VPN 検疫ソリューションのほとんどのクライアント側の操作を実施します。このソリューションの最も重要な要素は、特定のチェックをトンネル前の動作として実行するか、または接続後の動作として実行するかによって異なります。特定のチェックが間違った順序で実行された場合、コンピュータが脆弱性への攻撃に不必要にさらされることになり、別の問題が発生することにもなりかねません。次のセクションでは、このソリューション用に設計されたチェック リストを示します。

###### トンネル前のチェックの実装

クライアントがインターネットに接続していない場合は、接続マネージャはインターネットへの接続を開始します。インターネットに接続すると、VPN トンネルを確立する前に、同期化されたトンネル前の動作が必要なすべてのセキュリティ チェックを実行します。

接続マネージャは必要なすべてのセキュリティ チェックを順に実行します。接続マネージャは、それぞれのチェックを一連のスクリプトとして実装します。次の手順は、スクリプトに必要なワーキング ロジックを示したものです。

1.  **クライアント オペレーティング システムがサポートされていますか?**

    -   \[いいえ\] の場合、メッセージ ボックスが表示され、接続に失敗します。

    -   \[はい\] の場合、操作を続行します。

2.  **ウイルス対策ソフトウェアが既にインストールされ、実行されていますか?**

    -   \[いいえ\] の場合、メッセージ ボックスが表示され、接続に失敗します。トンネル前の動作の一環として必要になるライセンス供与されたすべてのソフトウェアを、接続マネージャのインストールにバンドルさせて、リモート サーバーからインストールする必要がないようにします。

    -   \[はい\] の場合、操作を続行します。

3.  **ウイルス対策シグネチャ ファイルの更新**

    -   正常に完了した場合、操作を続行します。

    -   正常に完了しなかった場合、警告メッセージが表示されて操作が継続するか、メッセージ ボックスが表示されて接続に失敗します。

4.  **Windows 自動更新クライアントが構成されていますか?**

    -   \[いいえ\] の場合、Windows 自動更新サービス クライアントを構成します。

    -   正常に完了した場合、操作を続行します。

    -   正常に完了しなかった場合、警告メッセージが表示されて操作が継続するか、メッセージ ボックスが表示されて接続に失敗します。

    -   \[はい\] の場合、操作を続行します。

5.  **優先順位の高いソフトウェア更新プログラムのダウンロードとインストール**

    -   正常に完了した場合、操作を続行します。

    -   正常に完了しなかった場合、警告メッセージが表示されて操作が継続するか、メッセージ ボックスが表示されて接続に失敗します。

6.  **\[ダイヤルアップ接続を使用してログオン\] の使用が必要 (省略可)**

    -   使用する場合、操作を続行します。

    -   使用しない場合、警告メッセージが表示されて操作が継続するか、メッセージ ボックスが表示されて接続に失敗します。このチェックを使用するには、ドメインに参加しているコンピュータだけが接続可能で、リモート クライアントは最低 1 度は企業 LAN に接続して、ドメインに参加する必要があります。このオプションを使用する場合、Woodgrove の IT 部門が必須セキュリティ チェックの一時的な例外を設定しなければ、リモート接続を介したドメインへの参加は不可能です (後の「例外と除外の処理」トピックを参照)。

7.  **追加のカスタム セキュリティ チェックの実行 (省略可)**

    インターネット アクセスは接続プロセスのこの時点でしか利用できないため、この制約を考慮してカスタム セキュリティチェックを設計する必要があります。

**注 :** スクリプトのサンプルについては、付録 A 「検疫スクリプトのサンプル」を参照してください。

接続マネージャは、これらのトンネル前の動作の結果を、レジストリ内の以下のキーに記録します。

**HKEY\_CURRENT\_USER\\Software\\MyCompany\\MyConnectionManager\\PreTunnelResults**

トンネル前の動作は常に成功を返す必要があり、またリモート アクセス検疫サービス エージェントの接続後の動作は、これらの結果を確認して、VPN サーバーに送信するステータスを決定する必要があります。この方法により、接続マネージャを変更することなく、柔軟性の高い例外管理が可能になります。次の図は、Woodgrove National Bank が使用するトンネル前のカスタム動作スクリプト ロジックを示しています。

![](images/Cc163112.PGFG0402(ja-jp,TechNet.10).gif)

**図 4.2: Woodgrove National Bank の トンネル前の動作**

[画像を画面全体に表示](https://technet.microsoft.com/ja-jp/cc163112.pgfg0402_big(ja-jp,technet.10).gif)
###### 接続後のチェックの実装

クライアントがトンネル前のチェックに合格すると、接続マネージャは VPN 接続を確立します。クライアントが企業のネットワークへアクセスした後、接続後のスクリプトを使用して、必須でない追加のチェックと管理動作を実行できます。

1.  **VPN 接続**

    トンネル前の動作がすべて完了すると、接続マネージャは VPN サーバーへの接続を確立します。

2.  **通知の送信**

    接続マネージャは、クライアント コンピュータ (RQC.exe) を使用して VPN サーバー上のリモート アクセス検疫サービス (RQS.exe) に共有キーを送信し、VPN サーバーは検疫ポリシーを破棄します。

3.  **パスワードの有効期限**

    Woodgrove National Bank では、パスワードの有効期限を確認するスクリプトを実行し、変更が必要な場合はユーザーにその旨を通知します。

    **注 :** パスワードの有効期限通知は、クライアントが企業のネットワークにリモート接続するために **\[ダイヤルアップ接続を使用してログオン\]** オプションを使用している場合にのみ送信されます。

4.  **グループ ポリシーの更新**

    ドメインに参加しているクライアントが、企業のネットワークにリモート接続するために **\[ダイヤルアップ接続を使用してログオン\]** オプションを使用していない場合、グループ ポリシーの更新プログラムは適用されません。これにより、グループ ポリシーを使用してクライアント上に重要なセキュリティ オプションを設定したときに、セキュリティ侵害が発生する可能性があります。このような潜在的な問題の発生を抑えるために、Woodgrove National Bank では、ユーザーがログオンした後にグループ ポリシーを更新する接続後スクリプトを実行します。スクリプトは、**gpupdate.exe /force /wait:0** コマンドを使用して、グループ ポリシー設定を即座に更新します。グループ ポリシーの更新ユーティリティの詳細については、マイクロソフトの Web サイトの「[グループ ポリシー更新ユーティリティの説明](http://support.microsoft.com/kb/298444/)」http://support.microsoft.com/kb/298444/ を参照してください。

次の図は、接続後カスタム動作のスクリプト ロジックの詳細を示しています。

![](images/Cc163112.PGFG0403(ja-jp,TechNet.10).gif)

**図 4.3: Woodgrove National Bank の接続後の動作**

[画像を画面全体に表示](https://technet.microsoft.com/ja-jp/cc163112.pgfg0403_big(ja-jp,technet.10).gif)
##### 接続マネージャ プロファイルの作成と配布

接続マネージャには、ユーザーが、企業リソースにすばやく、簡単に、信頼性を持ってアクセスできるようにするための便利なメカニズムが備えられています。Woodgrove National Bank では、IT 部門が CMAK を使用して作成した接続マネージャ プロファイルを介して、カスタム VPN 接続を実装することを決定しました。

Woodgrove National Bankでは、何万台ものクライアントと、数百もの電話番号に対して接続を構成しているので、Woodgrove の IT 部門では、構成前に以下の情報を調査する必要があります。

-   ダイアルアップ接続、また VPN 接続の構成は、場所、時刻などの要素によって変化します。

-   エラーの発生を防止するために、ユーザーがダイヤルアップ接続または VPN 接続プロパティの設定または変更ができないようにします。

-   一部の機能を動的にし、Woodgrove の IT スタッフはセキュリティ準拠を確保するためにこれらの値を管理する必要があります。

-   グローバル企業に見合った構成方法を設定します。

Woodgrove の IT 部門が使用する、リモート アクセス接続の接続マネージャ機能の一部を次の表に示します。

**表 4.1:Woodgrove の IT 部門が使用する接続マネージャの機能**

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >機能</th>
<th style="border:1px solid black;" >目的</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">ブランド化</td>
<td style="border:1px solid black;">グラフィックス、アイコン、メッセージ、およびヘルプをカスタマイズすることによって、パッケージに企業デザインを備えます。接続マネージャ パッケージは、出張中のユーザーにその地域のサポート番号を提供できます。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">カスタム動作</td>
<td style="border:1px solid black;">ログの収集およびアプリケーションの更新を実行します。</td>
</tr>
</tbody>
</table>
  
Woodgrove の IT 部門は、接続マネージャ プロファイルを CD、電子メール、Web サイト、またはファイル共有を使用してリモート ユーザーに配布できます。Woodgrove National Bank では既に、ソフトウェアおよび更新プログラムを、インターネットに接続している Webサイト を経由して配布しています。サポートされているインフラストラクチャが既に備わっているので、Woodgrove では、この方法で接続マネージャ プロファイルを配布することを選択しました。
  
##### IP フィルタを使用して検疫ネットワーク アクセスを行う
  
接続マネージャは、カスタム動作とベンダ固有の属性サポートを組み合わせて使用することで、ネットワーク検疫アクセスをサポートできます。ベンダ固有の属性を使用すると、RADIUS 標準規格 RFC 2138 に規定されていない RADIUS 規格の拡張機能が有効になります。以下は、Windows Server 2003 バージョンの IAS が指定する Microsoft ベンダ固有の属性です。
  
-   MS-Quarantine-IPFilter
  
-   MS-Quarantine-Session-Timeout
  
###### MS-Quarantine-IPFilter の設定
  
この設定により、スクリプトが正常に完了した後、クライアント通知コンポーネント (RQC) からの着信トラフィックが許可されます。たとえば、Woodgrove National Bank のネットワークでは DNS プロトコルと DHCP プロトコルを有効にし、リモート クライアントが検疫処理中にインフラストラクチャ サーバーと通信できるようにする必要があります。
  
**注 :** 特定のプロトコルを有効にするためにフィルタを使用すると、全体のセキュリティが低下します。必要な場合にのみ、検疫定義にこのようなプロトコルを含めてください。
  
次の表に、Woodgrove National Bank の検疫 IP フィルタで開かれる TCP/IP ポートの一覧を示します。
  
**表 4.2:VPN 検疫フィルタで開かれる TCP/IP ポート**

 
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >ポート番号</th>
<th style="border:1px solid black;" >用途</th>
<th style="border:1px solid black;" >コメント</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">UDP 67, 68</td>
<td style="border:1px solid black;">DHCP</td>
<td style="border:1px solid black;">クライアントの IP アドレスを要求します。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">UDP 53</td>
<td style="border:1px solid black;">DNS</td>
<td style="border:1px solid black;">名前解決を行います。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">UDP 137</td>
<td style="border:1px solid black;">WINS</td>
<td style="border:1px solid black;">NetBIOS 名前解決を行います。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">TCP 139, 445</td>
<td style="border:1px solid black;">ファイル共有</td>
<td style="border:1px solid black;">NetBIOS セッションと SMB ファイル共有を提供します。このオプションは、絶対不可欠な場合にのみ有効にするようにしてください。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">TCP/7250</td>
<td style="border:1px solid black;">RQC, RQS</td>
<td style="border:1px solid black;">VPN 検疫クライアント エージェントとサーバー側のリスナ コンポーネント間の通信を可能にします。</td>
</tr>
</tbody>
</table>
  
###### MS-Quarantine-Session-Timeout
  
この属性は、クライアント コンポーネントを検疫状態にしておく最大タイムアウトを設定します。この時間内にスクリプトが完了しない場合、リモート アクセス サーバーはクライアント コンピュータの接続を切断します。Woodgrove National Bank では、120 秒のタイムアウト制限を設定しました。120 秒に設定すると、着信接続の 1% 未満が破棄されることになります。
  
次の図は、VPN 検疫をサポートするためにリモート アクセス ポリシーに設定する必要があるベンダ固有の属性を示しています。
  
![](images/Cc163112.PGFG0404(ja-jp,TechNet.10).gif)
  
**図 4.4: VPN 検疫に必要な MS 検疫ベンダ固有の属性**
  
[画像を画面全体に表示](https://technet.microsoft.com/ja-jp/cc163112.pgfg0404_big(ja-jp,technet.10).gif)  
パイロット テスト プロセスでは、検疫 IP フィルタで許可されたいずれかのポートを削除したことで、クライアントが接続できなくなっていないかどうかを確認してください。実用に即したタイムアウト値の最小値を設定し、ネットワークの遅延の増加や低速リンクを見込んだ設定にします。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
### その他の考慮事項
  
このセクションでは、VPN 検疫の実装において Woodgrove の IT 部門が考慮したその他の事項について説明します。
  
#### ログインおよびアカウンティングの構成
  
IAS を使用することの 1 つの利点は、RADIUS を経由するクライアント接続のログ機能のサポートが組み込まれていることです。Woodgrove National Bank では、どの作業者が企業のネットワークに接続しているかを監視したいと考えています。VPN 検疫を使用したリモート アクセスの実装に必ずしも必要な条件ではありませんが、マイクロソフトでは、ログ機能を使用することを推奨します。RADIUS を使用すると、Woodgrove はサービスの改善を行う目的で、接続の傾向を分析できるようになります。
  
各 IAS RADIUS サーバーは、SQL Server 2000 Desktop Engine (MSDE 2000) にユーザー セッション データを収集します。このエンジンは、軽量な SQL Server 2000 ローカル データベースです。このデータベースはインフラストラクチャ サーバーのパフォーマンス データとクライアント固有のデータを収集することが可能で、ユーザー セッション データを収集する各 ISA サーバー上で実行されています。
  
IAS サーバーにより、MSDE に収集されたデータが中央の SQL Server 2000 データベースにほぼリアルタイムで転送されます。この方法は、SQL Server ライセンスを費用対効果の優れた方法で使用でき、パフォーマンスを低下させることもありません。
  
Woodgrove National Bank は、地域ごとに SQL Server ベースのデータ収集サーバーを配備して、リモート アクセス セッション データを収集しました。IAS での SQL Serverのログ機能の構成の詳細については、マイクロソフトの Web サイトの「[Deploying SQL Server Logging with Windows Server 2003 Internet Authentication Service (IAS)](http://www.microsoft.com/downloads/details.aspx?familyid=6e4357f7-4070-4902-95f1-3ad411d963b2&displaylang=en)」www.microsoft.com/downloads/details.aspx?FamilyId=6E4357F7-4070-4902-95F1-3AD411D963B2&displaylang=en (英語情報) を参照してください。
  
#### パイロット展開の実装
  
運用環境にリモート アクセス ソリューションをロールアウトする場合、事前にパイロット展開でソリューションをテストする必要があります。パイロット展開は、計画したソリューションの縮小版であることが理想です。
  
Woodgrove National Bank は、2 つのパイロット プログラムを実装します。1 つは、経験豊富なユーザー用で、もう 1 つは、さまざまな地域からの参加者で構成される一般的なパイロットです。Woodgrove IT チームはパイロットを監視し、その結果を基に最終的な設計に変更を加えました。
  
#### 高可用性の確保
  
Woodgrove National Bank は世界中に拠点を持つグローバル環境で操業しているため、ソリューションのシナリオには高い信頼性を備える必要があります。したがって、可用性を備えるために、Woodgrove National Bank は以下を検討する必要があります。
  
-   複数の負荷分散された VPN サーバー
  
-   負荷分散された IAS サーバー
  
-   フォールト トレラントなソフトウェア更新プログラムとウイルス対策ソフトウェアの更新サーバー
  
-   ルーターまたはスイッチでの障害が内部サーバーへのアクセスを阻害しないための、冗長化した内部ネットワーク パス
  
Woodgrove の IT 部門は、Woodgrove の Web サイトに Web アプリケーション クラスタおよびネットワーク負荷分散 (NLB) サポートを備えるために、Microsoft Application Center 2000 を採用しています。また、Application Center および NLB には、インターネットに接続する更新サーバーにフォールト トレランスを備えることも可能です。Woodgrove National Bank は Windows Server 2003 Enterprise Edition の標準機能である NLB を使用して、IAS サーバーの負荷分散を行います。
  
#### 適切なネットワーク帯域幅の確保
  
システム設計者は、現在のネットワーク パス、予想される接続時間、および予想されるリモート アクセス トラフィックの種類と量を考慮する必要があります。リモート アクセス ユーザーが必要とする追加の帯域幅を過小評価しないようにする必要があります。
  
パイロットを展開すると、リモート アクセス トラフィックの分析、および既存のインフラストラクチャに与える影響を分析できます。サービスの質が低いとソリューションは成功しないため、このテストには、通常使用する一般的な作業者を含めることが重要です。帯域幅のプロファイリングが組み込まれたネットワーク スイッチを使用すると、リモート アクセス トラフィックが他のユーザーに与える影響を緩和できます。
  
Woodgrove National Bank では、高い帯域幅を備えた良好なインターネット接続を実現しています。Woodgrove National Bank の利用者は、Web を閲覧し、電子メールを使用するためのインターネットへの内部アクセスに、既存の帯域幅のほとんどを使用しているため、追加のリモート アクセス トラフィックに対応できるように現在の割り当てを調整する必要があります。
  
#### 例外と除外の処理
  
Woodgrove National Bank のシステム設計者は、どのようなソリューションでも、ビジネスのニーズにより、検疫要件の適用対象から 1 つないし複数のデバイスを一時的に除外しなければならない状況に対応することの必要性を認識しています。たとえば、IT チームは、重要な会議中に役員がアクセスする場合に、例外を設定する必要があるかもしれません。このため、VPN アクセス ソリューションでは、例外のサポートが必要になります。
  
1 台のコンピュータの例外を許可することができないと、管理者はリモート アクセス要件を強制的に削除することになります。組織が個々の例外を処理できないと、IT チームはソリューションを展開できません。
  
**注 :** Woodgrove の IT セキュリティ グループは、例外を求めるビジネス ニーズをセキュリティ上のリスクより優先させるかどうかを決定する権限を、単独で有する必要があります。
  
組織は、次の例外シナリオを検討する必要があります。
  
-   **ドメイン以外のメンバ**。会社は、ドメイン メンバ以外のリモート クライアントに、ネットワークへのアクセスを許可する場合があります。ただし、この例外を許可すると、その他の多くのセキュリティおよびその他の管理オプションにグループ ポリシーが必要になるため、管理負担が増えます。グループ ポリシーは、ドメインのメンバであるコンピュータにのみ有効です。
  
-   **ドメイン ログオン オプション**。ドメインに参加しているコンピュータのユーザーが、接続マネージャを使用してログオンする際に Windows ログオン オプションを選択しない場合、Windows はキャッシュされている資格情報によりユーザーにログオンを許可します。パスワードが変更されていたり、パスワードの期限が切れていたりすると、キャッシュされている資格情報は認証されません。
  
-   **アプリケーションのタイムアウト**。コンピュータが検疫モードにとどまっている時間が長すぎて、遅延によりアプリケーションがタイムアウトしてしまうと、アプリケーションが動作しなくなる場合があります。これにより、データが破壊される場合があります。
  
最後に挙げた問題点の緩和措置の 1 つに、リモート アクセス クライアントが検疫モードにある間、アプリケーションのトラフィックが期待どおりに動作できるように入力パケット フィルタを作成するという方法があります。この方法の欠点は、アプリケーションのネットワーク トラフィックを識別し、追加のパケット フィルタを作成するための費用がかかることです。
  
この問題を解決するために、マイクロソフトでは、検疫パケット フィルタ数を最小限に抑え、トンネル前のカスタム動作を使用することを推奨しています。検疫パケット フィルタを適切に実装しないと、ドメイン コントローラを検疫ネットワークに公開する可能性があります。
  
構成方法によっては、アプリケーションが検疫ネットワークに接続したときにアプリケーションに影響する遅延を緩和できます。マイクロソフトでは、ネットワークを公開する構成は推奨しませんが、重要なアプリケーションに対しては、組織で緩和措置を講じる必要があります。検討すべき緩和措置を以下に示します。
  
-   ユーザーへのフィードバックの提供
  
-   検疫セッションのタイムアウトのみを使用
  
-   即時通知を使用
  
##### ユーザーへのフィードバックの提供
  
接続プロセス中であることをユーザーに通知するために、接続マネージャ インターフェイスを使用してユーザーにフィードバックを提供できます。これにより、ユーザーは不満を感じることなく、接続プロセスの完了を待つことができます。
  
##### 検疫セッションのタイムアウトのみを使用
  
この構成では、MS-Quarantine-Session-Timeout 属性は含まれますが、MS-Quarantine-IPFilter 属性は含まれません。アクセス クライアントは、検疫パケット フィルタにより、直ちに通常の無制限リモート アクセスが許可されます。しかし、リモート アクセス クライアントは、ネットワーク ポリシーに従っていることを示す通知メッセージを送信しなければなりません。リモート アクセス クライアントが通知メッセージを送信しないと、検疫セッションのタイムアウト時間が経過した時点で、接続が切断されます。
  
この構成の利点は、検疫パケットフィルタを構成する必要がないことと、アプリケーションの遅延の問題が発生しないことです。検疫が行われない場合と同様に、リモート アクセスが可能になります。この構成の欠点は、リモート アクセス クライアントがネットワーク ポリシーに従っていない場合も、検疫セッションのタイムアウト時間内はネットワークへの通常のアクセスが許可されることです。この状況は、明らかにセキュリティ ホールをもたらします。
  
##### 即時通知を使用
  
この構成では、検疫スクリプトがすべてのテストを完了する前に通知を送信する RQC.exe を実行します。その結果、接続の検疫制限が解除され、リモート アクセス クライアントは直ちに通常のアクセスを許可されます。検疫スクリプトによるネットワーク ポリシーのコンプライアンス テストは依然として実行されます。いずれかのテストが失敗した場合、検疫スクリプトはユーザーに対して必要な是正措置を通知し、検疫モードおよび検疫セッション タイマを使用した場合と同じように、指定した時間が経過すると自動的に接続を切断します。
  
**注 :** この構成では、コンピュータに古いバージョンの接続マネージャ パッケージまたはスクリプトがある場合、必要な検疫制限を課すために、MS-Quarantine-Session-Timeout 属性または MS-Quarantine-IPFilter 属性を設定します。
  
即時通知を使用する利点は、アプリケーションの遅延の問題が発生しないことです。検疫が行われない場合と同様に、リモート アクセスが可能になります。しかし、このアプローチは推奨されません。
  
#### ベスト プラクティスを適用する
  
このセクションでは、Woodgrove のソリューションの主要なベスト プラクティスをいくつか紹介します。これらのベスト プラクティスには、以下の操作が含まれます。
  
-   すべてのトラフィックをブロック検疫ポリシーを使用する。
  
-   ダイヤルアップ接続を使用したログオンをサポートする。
  
-   必要なセキュリティ チェックのためのトンネル前のカスタム動作を使用する。
  
-   ライセンス供与されたソフトウェアをクライアント パッケージに含める。
  
##### すべてのトラフィックをブロック検疫ポリシーを使用する
  
接続時、DHCP サーバーはクライアントに IP アドレスを割り当てます。クライアント通知コンポーネント (RQC.exe) は、リモート アクセス サーバー上のサーバー リスナ (RQS.exe) コンポーネントに共有キーを渡します。RQS は、リモート アクセス サーバーの内部 IP アドレスでのみリッスンします。これは、検疫ポリシーが通信を許可する唯一の IP アドレスです。IP フィルタは、RQS が RQC から共有キーを受信し、リモート アクセス サーバーが検疫を破棄するまで、他のすべてのトラフィックをブロックします。
  
##### ダイヤルアップ接続を使用したログオンをサポートする
  
ユーザーが Windows ログオン オプションの **\[ダイヤルアップ接続を使用してログオン\]** を選択すると、VPN クライアントは、LAN クライアントとほぼ同じ方法でグループ ポリシーの更新を受信できます。この設定により、内部のクライアントとリモート クライアントを統合管理できます。
  
**注 :** ダイヤルアップ接続を使用して、起動スクリプトとコンピュータ ソフトウェアの割り当てを適用することはできません。
  
このオプションを使用すると、ユーザーはパスワードの期限切れを知らせる通知を受け取り、コンピュータは必要なときにコンピュータ アカウントを更新できます。グループポリシーの設定は、接続プロセス後にリモート クライアントに適用されるため、接続マネージャは、最初の接続後に、VPN 検疫を解除しなければなりません。検疫の解除が遅れると、グループ ポリシーの更新、パスワードの有効期限通知、およびコンピュータ アカウントの更新が失敗する可能性があります。
  
すべてのクライアントに適用する 1 つ以上のグループ ポリシー オブジェクトで、グループ ポリシーの **\[低速リンクの検出\]** 設定を無効にすると、グループ ポリシー設定は VPN クライアントと LAN クライアントに等しく適用できます。実装を検討する前に、この設定が及ぼす影響をテストし、徹底した評価を行う必要があります。このオプションの実装は、絶対不可欠な場合にのみ行うようにしてください。グループ ポリシー設定の詳細については、 マイクロソフトの Web サイトの「[Windows Server 2003 のグループ ポリシーの紹介](http://www.microsoft.com/japan/windowsserver2003/techinfo/overview/gpintro.mspx)」www.microsoft.com/japan/windowsserver2003/techinfo/overview/gpintro.mspx を参照してください。
  
低速リンクの検出の詳細については、「[Specifying Group Policy for Slow Link Detection](http://technet2.microsoft.com/windowsserver/en/library/88586664-6a14-479f-8b10-8986020339931033.mspx)」http://technet2.microsoft.com/WindowsServer/en/library/88586664-6a14-479f-8b10-8986020339931033.mspx (英語情報) を参照してください。
  
##### 必要なセキュリティ チェックのためのトンネル前のカスタム動作を使用する
  
検疫モードでの不要な遅延を防止するために、すべてのセキュリティ チェックをトンネル前のカスタム動作として実行します。リモート アクセス クライアントが接続前にこれらの更新を処理すると、ユーザーは効率的に作業を進めることができます。
  
##### ライセンス供与されたソフトウェアをクライアント パッケージに含める
  
接続を確立するために必要となるすべてのライセンス供与されたソフトウェアを、組織がリモート コンピュータに提供する必要があります。サポートへの問い合わせや構成時に発生する問題を削減するために、このソフトウェアを接続マネージャ パッケージの一部として配布するようにしてください。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
### 監視と管理の実装
  
VPN 検疫ソリューションでは、ソリューションを運用するうえで健全性を監視するために必要な警告およびしきい値を割り当てし、監視する必要があります。このソリューションで、ネットワーク全体、単一の資産、または資産の一覧をリアルタイムで監視できるようにします。監視を行うことによって、組織が実施する運用サポートに必要な指標を明確にします。この要件を満たさない場合、セキュリティ部門はソリューションがリモート アクセス接続を安全に維持しているどうかを判断できなくなります。
  
#### 検疫処理の監視
  
次のセクションでは、VPN 検疫処理の監視において考慮すべきその他の事項について説明します。次のような考慮事項があります。
  
-   大規模な組織でリモート クライアントに問題が発生した場合にその問題を解決するには、別々の時間帯に働いている複数のチーム間での密接な協力が必要になります。厳格なテストと適切なパイロット展開が実行されれば、トラブルシューティングの要件を削減できます。
  
-   リモート アクセスのシナリオ、セキュリティ上の脅威、および両者の間でどのようにバランスを取るかを深く理解します。上級管理者は、最も厳格な保護を必要とする資産に最優順位を設定し、費用とリスクの間の適切なバランスを判断する必要があります。
  
-   インストールのルーチン作業や CD の配布など、技術的な課題の発生を予測しておきます。計画プロセス内でさらに必要なエンタープライズ管理ツールがないかどうかを検討します。
  
-   発生する可能性のあるパフォーマンス上の問題を監視および管理し、前もってユーザーの期待を把握しておきます。たとえば、Windows ログオン オプションを使用しているリモート ユーザーが、しばらくリモート アクセスを使用してネットワークにログオンしていなかった場合、ログオン時に時間がかかる可能性があります。クライアントがサービス パックを要求した場合、クライアントの接続速度によってはログオンに数時間かかることもあります。Woodgrove の IT チームは、ユーザーに電子メールを送信し、必要なサービス パック CD を郵送で受け取るか、ダウンロード サイトからダウンロードするかをユーザーが選択できるようにし、この遅延を避けることができます。
  
-   サーバーとクライアント コンピュータのプロジェクト設計を行う場合は、プロジェクトの実装プロセスの初期の段階で最新テクノロジにアップグレードするようにします。これにより、基準となるソリューション プラットフォームが用意され、ソリューションの展開中に組織が行う可能性のある変更作業を大幅に削減できます。こうした努力により、サービスの安定性が向上し、ユーザー サポート費用が減少します。
  
-   プロジェクトを段階的に実装し、各段階の間には、ユーザーによる切り替え、ネットワーク システムおよびプロセスの安定化、調整などに十分な時間を確保します。複数の段階が重なり合っていると、サービスの利用者に悪影響を与えます。また、サービスの問題の特定および隔離が困難になる可能性もあります。
  
-   従業員の自宅のコンピュータは個人の所有物であり、企業の IT 部門が管理することはできません。従業員が自宅のコンピュータからリモート アクセスするために必要となるソフトウェアおよびハードウェア ソリューションのインストールを希望しない、またインストールできない場合は、他のオプションを利用できるようにします。たとえば、Microsoft Outlook® Web Access を使用すると、従業員は Microsoft Exchange Server 2003 上の個人データ (電子メール、連絡先、仕事、カレンダー機能) やパブリック フォルダへの暗号化接続が可能になります。
  
#### ソリューションの拡張
  
VPN 検疫ソリューションでは、他のユーザーが自分の資格情報を盗んでネットワークにログオンすることを、防止できません。このような行為を減らすには、スマート カードに保存したデジタル証明書を使用してソリューションを拡張する方法を検討してください。
  
リモート アクセス接続の認証にスマート カードなどの 2 要素の認証方式を使用すると、ネットワークのセキュリティを強化しつつ、さらに多くの従業員が離れた場所から作業できるというようになります。スマート カードを実装するには、拡張認証プロトコル-トランスポート層セキュリティ (EAP-TLS) プロトコルが必要です。
  
Woodgrove National Bank では、既に適切な公開キー基盤 (PKI) を備えているため、リモート アクセス ソリューションを拡張してスマート カードを含めることができます。2 要素認証の計画の詳細については、マイクロソフトの Web サイトの「[スマート カードを使用した安全なアクセス計画ガイド](http://www.microsoft.com/japan/technet/security/topics/networksecurity/securesmartcards/default.mspx)」http://www.microsoft.com/japan/technet/security/topics/networksecurity/securesmartcards/default.mspx を参照してください。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
### 要約
  
Windows Server 2003 SP1 の新機能により、高い信頼性を備え十分にサポートされた方法で VPN 検疫を実装できます。VPN 検疫のロールアウトを適切に計画することは、リモート ユーザーへのサービスの中断を避けるために不可欠となります。このガイドでは、VPN 検疫の実装を計画するうえで必要な要因とプロセスについて検討し、Woodgrove National Bank が、ネットワークに対してこのソリューションをどのように実装したかについて説明しました。VPN 検疫の実装の詳細については、付録 C 「関連リンク」を参照してください。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
##### 目次
  
-   [概要](http://technet.microsoft.com/ja-jp/library/cc162926.aspx)  
-   [第 1 章 - はじめに](https://technet.microsoft.com/ja-jp/library/b0912680-7a6d-43ac-92d0-cea6dcc8a063(v=TechNet.10))  
-   [第 2 章 - 仮想プライベート ネットワーク検疫へのアプローチ](https://technet.microsoft.com/ja-jp/library/3ea09caf-8833-439b-be0c-039e639659b2(v=TechNet.10))  
-   [第 3 章 - 問題点と要件](https://technet.microsoft.com/ja-jp/library/7e20ac7b-c15a-4cab-9ca2-91f155b818ab(v=TechNet.10))  
-   第 4 章 - ソリューションの設計  
-   [付録 A - 検疫スクリプトのサンプル](https://technet.microsoft.com/ja-jp/library/a487808c-e193-4190-af9a-37f4ab5cd4c4(v=TechNet.10))  
-   [付録 B - リモート アクセス検疫サービス パラメータ](https://technet.microsoft.com/ja-jp/library/5f5b92bf-e8dc-4f83-9322-f7eaa27e306a(v=TechNet.10))  
-   [付録 C - 関連リンク](https://technet.microsoft.com/ja-jp/library/d59eca38-6dd3-4576-9ba9-70cca609bcae(v=TechNet.10))  
-   [謝辞](http://www.microsoft.com/japan/technet/security/prodtech/windowsserver2003/quarantineservices/vppgacks.mspx)
  
[](#mainsection)[ページのトップへ](#mainsection)
