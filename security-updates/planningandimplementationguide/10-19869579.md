---
TOCTitle: '第 10 章 :追加のレジストリ エントリ'
Title: '第 10 章 :追加のレジストリ エントリ'
ms:assetid: 'd148d54d-a020-4aef-9664-11b9a7d81c0c'
ms:contentKeyID: 19869579
ms:mtpsurl: 'https://technet.microsoft.com/ja-jp/library/Cc163050(v=TechNet.10)'
---

脅威とその対策
==============

### 第 10 章 :追加のレジストリ エントリ

公開日: 2006年8月14日

**ダウンロード**

[『脅威とその対策ガイド』のダウンロード](http://go.microsoft.com/fwlink/?linkid=15160)

この章では、管理用テンプレート (.adm) ファイルで定義されていないベースライン セキュリティ テンプレート ファイルのレジストリ エントリ (*レジストリ値*) に関する追加情報について説明します。.adm ファイルでは、ポリシーおよび Microsoft® Windows Server™ 2003 のデスクトップ、シェル、セキュリティの制約を定義します。

##### トピック

[](#egaa)[カスタマイズされたセキュリティ構成エディタ](#egaa)  
[](#efaa)[TCP/IP 関連のレジストリ エントリ](#efaa)  
[](#eeaa)[その他のレジストリ エントリ](#eeaa)  
[](#edaa)[Windows XP SP2 と Windows Server 2003 SP1 で利用可能なレジストリ エントリ](#edaa)  
[](#ecaa)[Windows XP SP2 で利用可能なレジストリ エントリ](#ecaa)  
[](#ebaa)[Windows Server 2003 SP1 で利用可能なレジストリ エントリ](#ebaa)  
[](#eaaa)[関連情報](#eaaa)

### カスタマイズされたセキュリティ構成エディタ

Microsoft 管理コンソール (MMC) の \[セキュリティ テンプレート\] スナップインを読み込み、セキュリティ テンプレートを表示したときに、次の表に示すエントリは表示されません。これらのエントリは、カスタマイズされたバージョンのセキュリティ構成エディタ (SCE) を使用して .inf ファイルに追加されています。これらのエントリは、メモ帳などのテキスト エディタを使用して表示または編集できます。レジストリは、コンピュータの SCE ユーザー インターフェイスが修正されているかいないかに関わらず、ポリシーがダウンロードされたときにコンピュータに適用されます。

また、これらのエントリは、変更を自動化するためにセキュリティ テンプレート内に組み込まれます。ポリシーが削除されてもこれらのエントリは自動的に削除されないため、Regedt32.exe などのレジストリ編集ツールを使用して手動で変更する必要があります。このガイドに付属の Microsoft Excel® ブック「Windows Default Security and Services Configuration」に、既定の設定が記載されています。

#### セキュリティ構成エディタのユーザー インターフェイスの変更方法

SCE は、グループ ポリシーを使用して個々のコンピュータまたは複数のコンピュータに適用されるセキュリティ テンプレートを定義するために使用します。セキュリティ テンプレートに含めることができるのは、パスワード ポリシー、ロックアウト ポリシー、Kerberos プロトコル ポリシー、監査ポリシー、イベント ログの設定、レジストリ値、サービスの起動モード、サービスのアクセス許可、ユーザー権利、グループ メンバシップの制限、レジストリのアクセス許可、およびファイル システムのアクセス許可です。SCE は、さまざまな MMC スナップインおよび管理ツールで使用されます。たとえば、\[セキュリティ テンプレート\] スナップインおよび \[セキュリティの構成と分析\] スナップイン で使用されます。\[グループ ポリシー エディタ\] スナップインでは、\[コンピュータの構成\] ツリーの \[セキュリティ設定\] の部分で使用されます。また、\[ローカル セキュリティ設定\]、\[ドメイン コントローラ セキュリティ ポリシー\]、および \[ドメイン セキュリティ ポリシー\] ツールにも使用されます。

このガイドには、Seregvl.inf ファイル (**%systemroot%\\inf** フォルダ) の変更および Scecli.dll ファイルの再登録により SCE に追加されたエントリが含まれます。元のセキュリティ設定および追加設定は、このガイドで前述したスナップインやツールの "**ローカルポリシー\\セキュリティ**" セクションに記述されます。次のセクションで説明しますが、このガイドと共に提供されるセキュリティ テンプレートおよびグループ ポリシーを編集するすべてのコンピュータ上にある Sceregvl.inf ファイルを更新し、Scecli.dll ファイルを再登録する必要があります。ただし、Sceregvl.inf ファイルのカスタマイズ情報では、Service Pack 1 (SP1) を適用済みの Microsoft Windows® XP Professional および Windows Server 2003 にのみ存在する機能を使用します。古いバージョンの Windows にはインストールしないでください。

Sceregvl.inf ファイルを変更して登録すると、そのコンピュータの SCE ユーザー インターフェイスにカスタム レジストリ値が表示されます。新しい設定は SCE の項目の一覧の最後に表示されます。設定の前には、すべて "MSS:" という名前が付いています。MSS は Microsoft Solutions for Security の意味で、このガイドを作成したグループの名前です。次に、これらの新しいレジストリ値を定義するセキュリティ テンプレートまたはポリシーを作成します。これらのテンプレートまたはポリシーは、ターゲットのコンピュータで Sceregvl.inf が変更されているかどうかに関わらず、すべてのコンピュータに適用されます。SCE UI の次回起動時にカスタム レジストリ値が表示されます。

SCE ユーザー インターフェイスを変更する方法については、次の手順で説明します。既に SCE に他のカスタマイズを加えた場合、手動で行う必要のある手順があります。最小限のユーザー操作で設定を追加できるスクリプトが提供されています。このスクリプトにはエラー検出と復元機能が組み込まれていますが、失敗することがあります。失敗した場合、原因を特定して問題を修正するか、手動の手順に従います。SCE インターフェイスを既定の状態に復元するときに使用する、別のスクリプトも提供されています。このスクリプトは、すべてのカスタム設定を削除し、Windows XP SP2 または Windows Server 2003 SP1 の既定のインストール時の状態に SCE を戻します。

**手動で sceregvl.inf を更新するには**

1.  メモ帳などのテキスト エディタを使用して、**SCE Update** フォルダの **Values-sceregvl.txt** ファイルを開きます。  
    (**SCE Update** フォルダは、このガイドを[ダウンロード](http://www.microsoft.com/downloads/details.aspx?familyid=1b6acf93-147a-4481-9346-f93a4081eea8&displaylang=en) (英語) し、展開したインストーラ プログラムを実行すると作成されます。)

    **※ スクリプトの訂正:** Values-sceregvl.txt ファイル内に一か所誤りがあります。こちらの値を修正の後次ステップへと進んでください。

    【誤】「Values-sceregvl.txt」ファイルでの設定値
    MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlog\\AutoAdminLogon,4,%DisableAutoLogon%,0  
    【正】
    MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon\\AutoAdminLogon,1,%DisableAutoLogon%,0

2.  テキスト エディタでもう 1 つウィンドウを開き、**%systemroot%\\inf\\sceregvl.inf** ファイルを開きます。

3.  **sceregvl.inf** ファイルの \[Register Registry Values\] セクションの下部に移動します。**Values-sceregvl.txt** ファイルからテキストをコピーし、改行せずに **sceregvl.inf** ファイルの \[Register Registry Values\] セクションに貼り付けます。

4.  **Values-sceregvl.txt** ファイルを閉じ、ダウンロードの **SCE Update** フォルダの **Strings-sceregvl.txt** ファイルを開きます。

5.  **sceregvl.inf** ファイルの \[Strings\] セクションの下部に移動します。Strings-sceregvl.txt ファイルからテキストをコピーし、改行せずに **sceregvl.inf** ファイルの \[Strings\] セクションに貼り付けます。

6.  **sceregvl.inf** ファイルを保存し、テキスト エディタを終了します。

7.  コマンド プロンプトを開き、**regsvr32 scecli.dll** を実行して DLL を再登録します。

SCE の次回起動時にこれらのカスタム レジストリ値が表示されます。

**sceregvl.inf を自動的に更新するには**

1.  スクリプトを実行するには、このガイドをダウンロードした **SCE Update** フォルダにある **Values-sceregvl.txt、Strings-sceregvl.txt、**    および **Update\_SCE\_with\_MSS\_Regkeys.vbs** ファイルが同じ場所にある必要があります。

2.  更新対象のコンピュータ上で **Update\_SCE\_with\_MSS\_Regkeys.vbs** スクリプトを実行します。

3.  画面に表示されるプロンプトに従います。

この手順は、前述の手順で説明した **Update\_SCE\_with\_MSS\_Regkeys.vbs** スクリプトを使用して作成されたカスタム エントリのみが削除されます。また、自動更新スクリプトによって加えられた変更を元に戻すこともできます。

**Update\_SCE\_with\_MSS\_Regkeys.vbs スクリプトによって加えられた変更を元に戻すには**

1.  更新対象のコンピュータ上で **Rollback\_SCE\_for\_MSS\_Regkeys.vbs** スクリプトを実行します。

2.  画面に表示されるプロンプトに従います。

この手順では、SCE ユーザー インターフェイスに追加した*すべての*カスタム エントリが削除されます。このガイドから加えられた変更、このガイドの旧バージョンまたは他のセキュリティ ガイドから加えられた変更も同様に削除されます。

**Windows XP SP2 および Windows Server 2003 SP1 の既定の状態に SCE を復元するには**

1.  スクリプトを実行するには、このガイドをダウンロードした **SCE Update** フォルダにある **sceregvl\_W2K3\_SP1.inf.txt、sceregvl\_XPSP2.inf.txt、**および **Restore\_SCE\_to\_Default.vbs** ファイルが同じ場所にある必要があります。

2.  更新対象のコンピュータ上で **Restore\_SCE\_to\_Default.vbs** スクリプトを実行します。

3.  画面に表示されるプロンプトに従います。

**SCE ユーザー インターフェイスを既定の外観に復元するには**

1.  \[スタート\] メニューの \[ファイル名を指定して実行\] をクリックし、**「regedit.exe」**と入力して Enter キーを押し、レジストリ エディタ ツールを開きます。

2.  **HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\SecEdit\\Reg Values** に移動します。

3.  この場所にあるサブキーは、それぞれ SCE のセキュリティ オプション セクションの 1 項目に対応します。すべてのサブキーを慎重に削除します。**親キー (Reg Values) は削除しないでください**。親キーに含まれるサブキーのみ削除してください。

4.  コマンド プロンプトを開き、**regsvr32 scecli.dll** を実行して SCE DLL を再登録します。

5.  以後起動される SCE では、お使いの Windows のバージョンに含まれる元のレジストリ値のみが表示されます。

[](#mainsection)[ページのトップへ](#mainsection)

### TCP/IP 関連のレジストリ エントリ

サービス拒否 (DoS) 攻撃を防ぐには、最新のセキュリティ更新プログラムでコンピュータを更新された状態に保ち、攻撃者による危険にさらされる Windows Server 2003 コンピュータの TCP/IP プロトコル スタックを強化する必要があります。既定の TCP/IP スタック設定は、標準的なイントラネット トラフィックを処理するように調整されています。コンピュータを直接インターネットに接続する場合は、DoS 攻撃から保護するために TCP/IP スタックを強化することをお勧めします。

TCP/IP スタックを狙った DoS 攻撃のほとんどは、次の 2 種類のいずれかです。1 つは、大量の TCP 接続を開くなど、システム リソースを過度に使用する攻撃です。もう 1 つは、ネットワーク スタックまたはオペレーティング システム全体に悪影響を与えるように作られたパケットを送り付ける攻撃です。次のレジストリ設定は、TCP/IP スタックを狙った攻撃から保護するために役立ちます。

次の表に示すレジストリ設定が **HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Services\\Tcpip\\Parameters\\** サブキー内のテンプレート ファイルに追加されました。各設定の詳細については、表の下のセクションおよび <http://www.microsoft.com/japan/technet/prodtechnol/windowsserver2003/technologies/networking/tcpip03.mspx> の「Microsoft Windows Server 2003 TCP/IP 実装詳細」を参照してください。

**表 10.1 Windows Server 2003 SP1 および Windows XP SP2 の TCP/IP 関連のレジストリ値**

 
<table style="border:1px solid black;">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >レジストリ エントリ</th>
<th style="border:1px solid black;" >形式</th>
<th style="border:1px solid black;" >XP SP2 の既定</th>
<th style="border:1px solid black;" >2003 SP1 の既定</th>
<th style="border:1px solid black;" >最も安全な値 (10 進数)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">DisableIPSourceRouting</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">2</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">EnableDeadGWDetect</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">0</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">EnableICMPRedirect</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">0</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">KeepAliveTime</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">7200000</td>
<td style="border:1px solid black;">7200000</td>
<td style="border:1px solid black;">300,000</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">PerformRouterDiscovery</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">2</td>
<td style="border:1px solid black;">2</td>
<td style="border:1px solid black;">0</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">SynAttackProtect</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">0</td>
<td style="border:1px solid black;">1</td>
<td style="border:1px solid black;">1</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">TcpMaxConnectResponseRetransmissions</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">2</td>
<td style="border:1px solid black;">2</td>
<td style="border:1px solid black;">2</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">TcpMaxDataRetransmissions</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">5</td>
<td style="border:1px solid black;">5</td>
<td style="border:1px solid black;">3</td>
</tr>
</tbody>
</table>
  
#### DisableIPSourceRouting:IP source routing protection level (protects against packet spoofing)
  
このエントリは、SCE に \[MSS:(DisableIPSourceRouting) IP source routing protection level (protects against packet spoofing)\] と表示されます。IP ソース ルーティングは、ネットワーク上でデータグラムが経由する IP ルートを送信者が指定できるようにするメカニズムです。
  
##### 脆弱性
  
攻撃者がソース ルーティングされたパケットを使用して、身元および場所をあいまいにできます。ソース ルーティングを使用すると、パケットを送信するコンピュータはその経路を指定できます。
  
##### 対策
  
\[MSS:(DisableIPSourceRouting) IP source routing protection level (protects against packet spoofing)\] エントリの値を \[Highest protection, source routing is completely disabled\] に設定します。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   0、1 または 2。既定の設定は 1 (ソース ルーティング パケットを転送しない) です。
  
SCE UI に、次のオプションが表示されます。
  
-   No additional protection, source routed packets are allowed\]
  
-   Medium, source routed packets ignored when IP forwarding is enabled
  
-   Highest protection, source routing is completely disabled
  
-   未定義
  
##### 考えられる影響
  
この値を 2 に設定すると、ソース ルーティングされた着信パケットがすべて破棄されます。
  
#### EnableDeadGWDetect:Allow automatic detection of dead network gateways (could lead to DoS)
  
このエントリは、SCE に \[MSS:(EnableDeadGWDetect) Allow automatic detection of dead network gateways (could lead to DoS)\] と表示されます。反応しないゲートウェイの検出が有効になっている場合、接続数が増えすぎると、IP はバックアップ ゲートウェイを変更する場合があります。
  
##### 脆弱性
  
攻撃者は、サーバーが意図しないゲートウェイに強制的に切り換えるようにしてしまう可能性があります。これを行うのは非常に難しいので、このエントリの値は小さくなっています。
  
##### 対策
  
\[MSS:(EnableDeadGWDetect) Allow automatic detection of dead network gateways (could lead to DoS)\] エントリの値を \[無効\] に設定します。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   1 または 0。Windows Server 2003 での既定の設定は 1 (有効) です。
  
SCE UI では、これらのオプションは次のように表示されます。
  
-   有効
  
-   無効
  
-   未定義
  
##### 考えられる影響
  
この設定を 0 に構成すると、Windows が使用不能なゲートウェイを検出して自動的に切り替えなくなります。
  
#### EnableICMPRedirect:Allow ICMP redirects to override OSPF generated routes
  
このエントリは、SCE に \[MSS:(EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes\] と表示されます。Internet Control Message Protocol (ICMP) のリダイレクトにより、スタックはホストのルートの深さを調べます。Open Shortest Path First (OSPF) により生成されたルートは、これらのルートに置き換えられます。
  
##### 脆弱性
  
この動作は仕様です。問題は、ICMP のリダイレクトにより深さが調べられたルートに対する 10 分間のタイムアウト期間により、ネットワークで一時的に影響を受けたホストへのトラフィックが適切にルーティングされなくなることです。
  
##### 対策
  
\[MSS:(EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes\] エントリの値を \[無効\] に設定します。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   1 または 0。既定の設定は 1 (有効) です。
  
SCE UI では、これらのオプションは次のように表示されます。
  
-   有効
  
-   無効
  
-   未定義
  
##### 考えられる影響
  
ルーティングとリモート アクセス サービス (RRAS) が、自律システム外部ルーター (ASBR) として構成されている場合、接続されたインターフェイス サブネット ルートが正しく読み込まれません。代わりに、このルーターは OSPF ルートにホストのルートを含めてしまいます。しかし、OSPF ルーターを ASBR ルーターとして使用することはできないため、接続されたインターフェイス サブネット ルートを OSPF に読み込むと、ルーティング テーブルに通常とは異なるルーティング パスが含まれ、混乱が生じます。
  
#### KeepAliveTime:How often keep-alive packets are sent in milliseconds (300,000 is recommended)
  
このエントリは、SCE に \[MSS:(KeepAliveTime) How often keep-alive packets are sent in milliseconds (300,000 is recommended)\] と表示されます。この値は、TCP がアイドル状態の接続に keep-alive パケットを送信し、引き続き同じ状態かどうかを調べる頻度を設定します。リモート コンピュータにまだ接続可能な場合、TCP は keep-alive パケットを認識します。
  
##### 脆弱性
  
ネットワーク アプリケーションに接続できた攻撃者が、大量の接続を確立して DoS 状態にする可能性があります。
  
##### 対策
  
\[MSS:(KeepAliveTime) How often keep-alive packets are sent in milliseconds (300,000 is recommended)\] エントリの値を \[300000 or 5 minutes\] に設定します。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   1 から 0xFFFFFFFF。既定の設定は 7,200,000 (2 時間) です。
  
SCE UI に、次のオプションが表示されます。
  
-   150000 or 2.5 minutes
  
-   300000 or 5 minutes **(推奨値)**
  
-   600000 or 10 minutes
  
-   1200000 or 20 minutes
  
-   2400000 or 40 minutes
  
-   3600000 or 1 hour
  
-   7200000 or 2 hours **(既定値)**
  
-   未定義
  
##### 考えられる影響
  
Windows は、既定では keep-alive パケットを送信しません。しかし、keep-alive パケットを要求する TCP スタック フラグを構成するアプリケーションもあります。このような構成では、既定の設定値の 2 時間を 5 分に短縮して非アクティブなセッションをより短時間で切断するようにできます。
  
#### PerformRouterDiscovery:Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)
  
このエントリは、SCE に \[MSS:(PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)\] と表示されます。この値は Internet Router Discovery Protocol (IRDP) を有効または無効にします。IRDP を使用すると、システムの既定のゲートウェイのアドレスを、インターフェイスごとに自動的に検出および構成できます (「RFC 1256」に記述されているとおり)。
  
##### 脆弱性
  
同じネットワーク セグメント上のコンピュータの制御権を取得した攻撃者は、ネットワーク上のコンピュータがルーターを偽装するように構成する可能性があります。その結果、IRDP が有効になっているその他のコンピュータは、既に構成済みのコンピュータを通じてトラフィックをルーティングしようとします。
  
##### 対策
  
\[MSS:(PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)\] エントリの値を \[無効\] に設定します。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   0、1 または 2。既定の設定は 2 (DHCP が \[ルーター発見の実行\] オプションを送信する場合のみ有効) です。
  
SCE UI では、これらのオプションは次のように表示されます。
  
-   0 (無効)
  
-   1 (有効)
  
-   2 (DHCP が \[ルーターの発見を実行\] オプションを送信する場合のみ有効）
  
-   未定義
  
##### 考えられる影響
  
このエントリを無効にすると、IRDP をサポートする Windows Server 2003 により、コンピュータ上の既定のゲートウェイのアドレスが自動的に検出および構成されません。
  
#### SynAttackProtect:SYN 攻撃保護レベル (DoS に対する保護)
  
このエントリは、SCE に \[MSS:(SynAttackProtect) Syn attack protection level (protects against DoS)\] と表示されます。このエントリにより、TCP で SYN-ACK の再送信が調節されます。このエントリを構成すると、接続要求 (SYN) 攻撃中の不完全な送信のオーバーヘッドが小さくなります。
  
このエントリを使用すると、RFC 1256 に記述されているように、Windows がマルチキャストの代替として、検出メッセージをブロードキャストとしてルーターに送信するように構成できます。既定では、ルーターの検出が有効になっていれば、ルーターの検出要求はすべてのルーターのマルチキャスト グループ (224.0.0.2) に送信されます。
  
##### 脆弱性
  
SYN 攻撃では、攻撃者はサーバーに SYN パケットを連続的に送ります。するとサーバーが処理不可能になって正規の要求に応答できなくなるまで、ハーフオープン接続が開いた状態のままになります。
  
##### 対策
  
\[MSS:(SynAttackProtect) Syn attack protection level (protects against DoS)\] エントリの値を \[Connections time out sooner if a SYN attack is detected\] に設定します。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   1 または 0。既定の設定は、Windows Server 2003 SP1 では 1 (有効)、Windows XP SP2 では 0 (無効) です。
  
SCE UI では、これらのオプションは次のように表示されます。
  
-   Connections time out more quickly if a SYN attack is detected
  
-   No additional protection, use default settings
  
-   未定義
  
##### 考えられる影響
  
この値により、接続の認識に時間がかかるようになり、SYN 攻撃が行われている場合 TCP 接続で即座のタイムアウトが要求されます。このレジストリ エントリを構成すると、Initial Round Trip Time (RTT) やウィンドウ サイズなど、各アダプタのソケット オプションで構成されるスケーラブル ウィンドウおよび TCP パラメータが機能しなくなります。システムが攻撃にさらされていることを検出すると、スケーラブル ウィンドウ (RFC 1323) およびアダプタ別構成の TCP パラメータ (初期 RTT、ウィンドウ サイズ) は、どのソケットについても有効ではなくなります。これは、保護が機能していると、SYN-ACK の送信前にルート キャッシュ エントリが照会されず、また、接続のこの段階では Winsock オプションが利用できなくなるためです。
  
#### TcpMaxConnectResponseRetransmissions:SYN-ACK retransmissions when a connection request is not acknowledged
  
このエントリは、SCE に \[MSS:(TcpMaxConnectResponseRetransmissions) SYN-ACK retransmissions when a connection request is not acknowledged\] と表示されます。このエントリでは、TCP による SYN 再送信の試行回数を設定します。再送信のタイムアウトは、1 回の接続試行での次の再送信では 2 倍になります。初期タイムアウト値は 3 秒です。
  
##### 脆弱性
  
SYN 攻撃では、攻撃者はサーバーに SYN パケットを連続的に送ります。ハーフオープン接続が開いた状態になり、サーバーが処理不可能になって正規の要求に応答できなくなります。
  
##### 対策
  
\[MSS:(TcpMaxConnectResponseRetransmissions) SYN-ACK retransmissions when a connection request is not acknowledged\] エントリの値を \[3 seconds, half-open connections dropped after nine seconds\] に設定します。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   0 から 0xFFFFFFFF。既定の設定は 2 です。
  
SCE UI には、次のオプションが表示されます。それぞれ 0、1、2、および 3 の値に対応します。
  
-   No retransmission, half-open connections dropped after 3 seconds
  
-   3 seconds, half-open connections dropped after 9 seconds
  
-   3 & 6 seconds, half-open connections dropped after 21 seconds
  
-   3, 6,& 9 seconds, half-open connections dropped after 45 seconds
  
-   未定義
  
##### 考えられる影響
  
この値を **2** 以上に設定する場合、スタックは内部的に SYN-ATTACK 保護を採用します。このエントリを **2** より小さい値に構成すると、スタックは SYN-ATTACK 保護のレジストリ値をまったく読み込めなくなります。このエントリは、半オープン状態の TCP 接続のクリーン アップに要する既定の時間を短縮します。激しい攻撃を受けているサイトは、この値を **1** まで下げることができます。値を **0** にすることも有効です。ただし、このパラメータを **0** に設定すると、SYN-ACK はまったく再送信されなくなるので、3 秒でタイムアウトになります。このように低い値を使用すると、離れた場所のクライアントからの正規の接続試行も失敗する可能性があります。
  
#### TcpMaxDataRetransmissions:How many times unacknowledged data is retransmitted (3 recommended, 5 is default)
  
このエントリは、SCE に \[MSS:(TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted (3 recommended, 5 is default)\] と表示されます。このエントリは、接続を切断するまでに TCP が個々のデータ セグメント (非接続セグメント) を再送信する回数を制御します。再送信のタイムアウトは、1 回の接続での次の再送信では 2 倍になります。応答が再開された場合は、リセットされます。基本のタイムアウト値は、接続中に測定されたラウンドトリップ時間に応じて決まります。
  
##### 脆弱性
  
ターゲットのコンピュータから転送されたデータの受信確認メッセージが送信されないと、悪意のあるユーザーがターゲットのコンピュータのリソースを使い切る可能性があります。
  
##### 対策
  
\[MSS:(TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted (3 recommended, 5 is default)\] エントリの値を **3** に設定します。このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   0 から 0 xFFFFFFFF。既定の設定は 5 です。
  
SCE UI では、テキスト入力ボックスを使用して設定を調整できます。
  
-   ユーザー定義の値
  
-   未定義\]
  
##### 考えられる影響
  
発信方向の各セグメントが IP に到達すると、TCP は再送信タイマを開始します。タイマが無効になる前に所定のセグメントのデータの受信確認を受け取らないと、セグメントは最大 3 回まで再送信されます。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
### その他のレジストリ エントリ
  
次の表のレジストリ エントリの使用もお勧めします。各レジストリ キー設定の場所の情報など、各エントリの詳細については表の下のサブセクションを参照してください。
  
**表 10.2 Windows Server 2003 のレジストリに追加された非 TCP/IP エントリ**

 
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >レジストリ エントリ</th>
<th style="border:1px solid black;" >形式</th>
<th style="border:1px solid black;" >最も安全な値 (10 進数)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">MSS:(AutoAdminLogon) Enable Automatic Logon (not recommended)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">未定義。非常に安全な環境でのみ 0 を使用します。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">MSS:(AutoReboot) Allow Windows to automatically restart after a system crash (recommended except for highly secure environments)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">未定義。非常に安全な環境でのみ 0 を使用します。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">MSS:(AutoShareWks) Enable Administrative Shares (not recommended except for highly secure environments)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">未定義。非常に安全な環境でのみ 1 を使用します。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">MSS:(DisableSavePassword) Prevent the dial-up passsword from being saved (recommended)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">1</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">MSS:(Hidden) Hide Computer From the Browse List (not recommended except for highly secure environments)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">未定義。非常に安全な環境でのみ 1 を使用します。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">MSS:(NoDefaultExempt) Enable NoDefaultExempt for IPSec Filtering (recommended)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">Windows XP が動作するコンピュータの場合 1 を、Windows Server 2003 の場合 3。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">MSS:(NoDriveTypeAutoRun) Disable Autorun for all drives (recommended)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">0xFF</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">MSS:(NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers (Only recommended for servers)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">1</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">MSS:(NtfsDisable8dot3NameCreation) Enable the computer to stop generating 8.3 style filenames (recommended)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">1</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">MSS:(SafeDllSearchMode) Enable Safe DLL search mode (recommended)</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">1</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">MSS:(ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires (0 recommended)</td>
<td style="border:1px solid black;">String</td>
<td style="border:1px solid black;">0</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">MSS:(WarningLevel) Percentage threshold for the security event log at which the system will generate a warning</td>
<td style="border:1px solid black;">DWORD</td>
<td style="border:1px solid black;">0</td>
</tr>
</tbody>
</table>
  
#### 自動ログオンを無効にする :自動ログオンを無効にする
  
このエントリは、SCE に \[MSS:(AutoAdminLogon) Enable Automatic Logon (not recommended)\] と表示されます。このエントリでは、自動ログオン機能を有効または無効に設定できます (このエントリは Windows XP のようこそ画面機能から独立しているため、ようこそ機能を無効にしても、エントリは影響を受けません)。既定では、このエントリは無効になっています。自動ログオンは、コンピュータの起動時にユーザーをコンピュータにログオンさせるために、レジストリに保存されたドメイン、ユーザー名、およびパスワードを使用します。ログオンのダイアログ ボックスは表示されません。
  
詳細については、 <http://support.microsoft.com/default.aspx?kbid=315231> のマイクロソフト サポート技術情報の記事「[Windows XP で自動ログオンを有効にする方法](http://support.microsoft.com/default.aspx?kbid=315231)」を参照してください。
  
このレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Windows NT\\**  
**CurrentVersion\\Winlogon\\**
  
サブキー内のテンプレート ファイルに追加できます。
  
##### 脆弱性
  
自動ログオンを設定すると、そのコンピュータに物理的にアクセスできるすべてのユーザーが、そのコンピュータが接続されたあらゆるネットワークを含むコンピュータ上のすべてにアクセスできることになります。また、自動ログオンを有効にすると、パスワードがプレーン テキスト形式でレジストリに保存されます。**Authenticated Users** グループのメンバは、この値が保存されている特定のレジストリ キーをリモートで読み取ることができます。そのため、この設定はコンピュータの安全が物理的に確保されていて、かつ信頼されていないユーザーがレジストリをリモートから参照できないようにしている場合にのみ使用してください。
  
##### 対策
  
非常に安全性の高いコンピュータ以外は、\[MSS:(AutoAdminLogon) Enable Automatic Logon (not recommended)\] エントリは設定しないでください。\[Disable\] に設定してください。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   1 または 0。既定の設定は 0 (無効) です。
  
SCE UI では、これらのオプションは次のように表示されます。
  
-   有効
  
-   無効
  
-   未定義
  
##### 考えられる影響
  
なし。既定では、このエントリは無効になっています。
  
#### システム クラッシュ後の自動再起動を設定する
  
このエントリは、SCE に \[MSS:(AutoReboot) Allow Windows to automatically restart after a system crash (recommended except for highly secure environments)\] と表示されます。システム クラッシュの後にコンピュータを自動的に再起動させるかどうかを設定します。
  
このレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\CrashControl\\**
  
サブキー内のテンプレート ファイルに追加できます。
  
##### 脆弱性
  
コンピュータがクラッシュと再起動の無限ループに陥るおそれがあります。ただし、このエントリの代替手段はコンピュータを停止させるというものなので、あまり有効ではありません。
  
##### 対策
  
\[MSS:(AutoReboot) Allow Windows to automatically restart after a system crash (recommended except for highly secure environments)\] エントリの値を \[無効\] に設定します。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   1 または 0。既定の設定は 1 (有効)です。
  
詳細については、<http://support.microsoft.com/?kbid=307973> のマイクロソフト サポート技術情報の記事「[Windows でシステム障害と回復のオプションを構成する方法](http://support.microsoft.com/?kbid=307973)」を参照してください。
  
SCE UI に、次のオプションが表示されます。
  
-   有効
  
-   無効
  
-   未定義
  
##### 考えられる影響
  
コンピュータがエラー後に自動的に再起動しなくなります。
  
#### 管理用共有を有効にする
  
このエントリは、SCE に \[MSS:(AutoShareWks) Enable Administrative Shares (not recommended except for highly secure environments)\] と表示されます。既定では、Windows XP Professional では C$ や IPC$ のような管理用共有が自動的に作成されます。
  
詳細については、(<http://support.microsoft.com/default.aspx?kbid=314984> のマイクロソフト サポート技術情報の記事「[クライアント コンピュータで隠し共有または管理用共有を作成および削除する方法](http://support.microsoft.com/default.aspx?kbid=314984)」を参照してください。
  
このレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Services\\LanmanServer\\**  
**Parameters\\**
  
サブキー内のテンプレート ファイルに追加できます。
  
##### 脆弱性
  
これらの組み込み管理用共有はよく知られており、大部分の Windows コンピュータに存在するため、悪意のあるユーザーは、しばしばこの管理用共有をパスワード推測の総当り攻撃やその他の攻撃の標的にします。
  
##### 対策
  
非常に安全性の高いコンピュータ以外は、\[MSS:(AutoShareWks) Enable Administrative Shares (not recommended except for highly secure environments)\] エントリは設定せず、\[有効\] に設定してください。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
●    1 または 0。既定の設定は 1 (有効) です。
  
SCE UI では、これらのオプションは次のように表示されます。
  
●    有効
  
●    無効
  
●    未定義
  
##### 考えられる影響
  
これらの管理用共有を削除すると、管理者やこれらの共有に依存するプログラムやサービスに対して問題が発生することがあります。たとえば、Microsoft Systems Management Server (SMS) および Microsoft Operations Manager 2000 の正常なインストールおよび運用には、管理用共有が必要です。また、多くのサードパーティのネットワーク バックアップ アプリケーションにも管理用共有が必要です。
  
#### ダイヤルアップ パスワードの保存を無効にする
  
このエントリは、SCE に \[MSS:(DisableSavePassword) Prevent the dial-up passsword from being saved (recommended)\] と表示されます。このエントリでは、ネットワーク接続の電話帳に関連付けられたパスワードを保存するかどうかを設定します。ユーザーが多くの電話帳のエントリを持つ場合、蓄積された保存パスワードによってユーザーが \[接続中\] ダイアログボックスに資格情報を入力した後に遅延が発生する可能性があります。
  
このレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\RasMan\\**  
**Parameters\\**
  
サブキー内のテンプレート ファイルに追加できます。
  
##### 脆弱性
  
モバイル コンピュータが盗まれた場合、ダイヤルアップ エントリの \[パスワードを保存する\] チェックボックスが有効になっていると、攻撃者は自動的に組織のネットワークに接続できてしまいます。
  
##### 対策
  
\[MSS: (DisableSavePassword) Prevent the dial-up password from being saved (recommended)\] エントリの値を \[無効\] に設定します。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   1 または 0。既定の設定は 0 (無効) です。
  
詳細については、<http://support.microsoft.com/default.aspx?kbid=172430> のマイクロソフト サポート技術情報の記事「[ダイヤルアップ ネットワークのパスワードを保存するオプションを無効にします。](http://support.microsoft.com/default.aspx?kbid=172430)」を参照してください。
  
SCE UI に、次のオプションが表示されます。
  
-   有効
  
-   無効
  
-   未定義
  
##### 考えられる影響
  
ユーザーはダイヤルアップおよび VPN 接続のログオン資格情報を自動的に保存できません。
  
#### ネットワーク コンピュータ参照リストでコンピュータを非表示にする :参照リストでコンピュータを非表示にする
  
このエントリは、SCE に \[MSS:(Hidden) Hide Computer From the Browse List (not recommended except for highly secure environments)\] と表示されます。コンピュータがドメインのブラウザにアナウンスを送信しないように設定できます。設定すると、ブラウザ リスト上でコンピュータが非表示になります。同じネットワーク上の他のコンピュータに対してアナウンスを送らなくなります。
  
詳細については、<http://support.microsoft.com/default.aspx?kbid=321710> のマイクロソフト サポート技術情報の記事「[HOW TO: ブラウザ一覧から Windows 2000 ベースのコンピュータを非表示をします。](http://support.microsoft.com/default.aspx?kbid=321710)」を参照してください。
  
このレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Services\\Lanmanserver\\**  
**Parameters\\**
  
サブキー内のテンプレート ファイルに追加できます。
  
##### 脆弱性
  
コンピュータ名が攻撃者に知られると、攻撃者はそのコンピュータについての詳細情報を収集しやすくなります。このエントリを有効にすると、攻撃者がネットワーク上のコンピュータの情報を収集するのに使用する手段を 1 つ取り除くことができます。また、このエントリを有効にするとネットワーク トラフィックの削減にも役立ちます。ただし、攻撃者が潜在的な標的の特定や検出に他の手段を使うこともありえるので、脆弱性は小さいと言えます。
  
##### 対策
  
非常に安全性の高いコンピュータ以外は、\[MSS:(Hidden) Hide Computer From the Browse List (not recommended except for highly secure environments)\] エントリは設定せず、\[有効\] に設定してください。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
●    1 または 0。既定の設定は 0 (無効) です。
  
SCE UI では、これらのオプションは次のように表示されます。
  
●    有効
  
●    無効
  
●    未定義
  
##### 考えられる影響
  
コンピュータがブラウザ リストや同じネットワーク上の他のコンピュータの \[ネットワーク コンピュータ\] に表示されなくなります。
  
#### IPSec を有効にして Kerberos RSVP トラフィックを保護する:IPSec フィルタの NoDefaultExempt を有効にする
  
このエントリは、SCE に \[MSS:(NoDefaultExempt) Enable NoDefaultExempt for IPSec Filtering (recommended)\] と表示されます。IPSec ポリシー フィルタの既定除外については、Microsoft Windows Server 2003 および Microsoft Windows XP のオンライン ヘルプを参照してください。これらのフィルタは、インターネット キー交換 (IKE) および Kerberos 認証プロトコルの機能を実現します。また、これらのフィルタは、データ トラフィックが IPSec で保護されていても、マルチキャスト トラフィックやブロードキャスト トラフィックのように保護されていなくても、ネットワークのサービス品質 (QoS) の送信 (RSVP) を実現します。
  
詳細については、<http://technet2.microsoft.com/windowsserver/en/library/c9a7d986-5b9a-4e01-bb80-82d5e3a87d5c1033.mspx> の TechNet の記事「[Specifying Default Exemptions to IPSec Filtering](http://technet2.microsoft.com/windowsserver/en/library/c9a7d986-5b9a-4e01-bb80-82d5e3a87d5c1033.mspx)」(英語情報) を参照してください。また、<http://support.microsoft.com/default.aspx?kbid=811832> のマイクロソフト サポート技術情報の記事「[一部の状況で、IPSec のデフォルトの適用除外項目が IPSec 保護の回避に利用されることがある](http://support.microsoft.com/default.aspx?kbid=811832)」も参照してください。
  
このレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Services\\IPSEC\\**
  
サブキー内のテンプレート ファイルに追加できます。
  
##### 脆弱性
  
特にインターネットに直接接続している環境で、基本的なホスト ファイアウォール パケット フィルタとしての IPSec の使用が増加しているにもかかわらず、これら既定の適用除外の影響は完全には理解されていません。このため、一部の IPSec 管理者は自分が安全であると思う IPSec ポリシーを作成することがありますが、それは実際には、既定の適用除外項目を悪用する着信攻撃に対して安全ではありません。攻撃者は、正当な IKE や RSVP、Kerberos プロトコル パケットを含むネットワーク トラフィックを装い、ホスト上の他のネットワーク サービスにトラフィックを送信することがあります。
  
##### 対策
  
IPSec フィルタを使用するコンピュータを除き、\[MSS:(NoDefaultExempt) Enable NoDefaultExempt for IPSec Filtering (recommended)\] エントリは設定せず、\[有効\] に設定します。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   0 は、マルチキャスト、ブロードキャスト、RSVP、Kerveros、および IKE (ISAKMP) トラフィックが IPSec フィルタの適用除外になります。これは Windows 2000 および Windows XP の既定の設定です。既に存在する IPSec ポリシーや Windows 2000 および Windows XP との互換性が必要な場合のみ、この設定を使用してください。
  
-   1 は、Kerberos プロトコルおよび RSVP トラフィックを IPSec フィルタから除外せず、マルチキャスト、ブロードキャスト、および IKE トラフィックを除外します。この設定は、Windows 2000 と Windows XP でお勧めします。
  
-   2 は、マルチキャストおよびブロードキャスト トラフィックを IPSec フィルタから除外せず、RSVP、Kerberos、および IKE トラフィックを除外します。この設定は、Windows Server 2003 でのみサポートされます。
  
-   3 は、IKE トラフィックのみ IPSec フィルタから除外します。この設定は、IKE トラフィックを IPSec から除外する既定の動作があり、レジストリ キーが既定で存在しない Windows Server 2003 でのみサポートされます。
  
SCE UI では、これらのオプションは次のように表示されます。
  
-   0
  
-   1
  
-   2
  
-   3
  
##### 考えられる影響
  
このエントリを有効にすると、既に存在するセキュリティ ポリシーが、正常な動作をするために変更されることがあります。詳細については、<http://support.microsoft.com/default.aspx?kbid=811832> のマイクロソフト サポート技術情報の記事「[一部の状況で、IPSec のデフォルトの適用除外項目が IPsec 保護の回避に利用されることがある](http://support.microsoft.com/default.aspx?kbid=811832)」も参照してください。
  
#### 自動実行を無効にする :すべてのドライブで自動実行を無効にする
  
このエントリは、SCE に \[MSS:(NoDriveTypeAutoRun) Disable Autorun for all drives (recommended)\] と表示されます。自動実行は、メディアが挿入されると同時にコンピュータ上のドライブからの読み込みを開始する機能です。これにより、プログラムのセットアップ ファイルおよびオーディオ メディアの音声がすぐに開始します。
  
すべてのドライブで自動実行を無効にするには、
  
**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\**  
**Policies\\Explorer\\**
  
サブキー内のテンプレート ファイルにレジストリ値を追加します。
  
また、CD/DVD ドライブのみ無効にするには、
  
**HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Cdrom\\**
  
サブキー内のテンプレート ファイルにレジストリ値を追加します。
  
##### 脆弱性
  
悪意のあるプログラムが、メディアの挿入時に実行されないようにするため、グループ ポリシーではすべてのドライブ上で自動実行を無効にします。
  
自動実行が有効になっていると、コンピュータに物理的にアクセスできる攻撃者が、自動実行が可能な DVD や CD をコンピュータに挿入し、悪意のあるプログラムを自動的に起動させる可能性があります。
  
##### 対策
  
\[MSS:(NoDriveTypeAutoRun) Disable Autorun for all drives (recommended)\] エントリの値を \[255, disable Autorun for all drives\] に設定します。
  
このレジストリ値で設定可能な値は、次のとおりです。
  
-   16 進数値
  
詳細については、<http://support.microsoft.com/default.aspx?kbid=330135> のマイクロソフト サポート技術情報の記事「[ドライブに CD-ROM を挿入しても自動実行または自動再生機能が動作しない](http://support.microsoft.com/default.aspx?kbid=330135)」を参照してください。
  
SCE UI に、次のオプションが表示されます。
  
-   Null, allow Autorun
  
-   255, disable Autorun for all drives
  
-   未定義
  
##### 考えられる影響
  
コンピュータに自動実行可能なディスクが挿入されても、自動実行が機能しなくなります。また、空の CD が認識されないので、CD-Burning ユーティリティが正常に動作しません。Windows Media Player のようなメディア アプリケーションが挿入された新規 CD や DVD を認識しないため、ユーザーが手動でメディアを起動する必要があります。
  
#### NetBIOS 名解放セキュリティを設定する :(NoNameReleaseOnDemand) WINS サーバー以外からの NetBIOS 名の解放要求を無視するように設定する
  
このエントリは、SCE に \[MSS:(NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers (Only recommended for servers)\] と表示されます。NetBIOS over TCP/IP (NetBT) は、Windows ベース コンピュータに登録された NetBIOS 名をそれぞれのコンピュータで設定された IP アドレスに簡単に解決できるネットワーク プロトコルです。この値では、コンピュータが名前解放要求を受信したときに、その NetBIOS 名を解放するかどうかを設定します。
  
このレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Services\\Netbt\\Parameters\\**
  
サブキー内のテンプレート ファイルに追加できます。
  
##### 脆弱性
  
NetBT プロトコルは、認証を使用しないように設計されているため、偽装に対する脆弱性があります。偽装は、実際に操作を行っているユーザー以外の別のユーザーから転送が行われているかのように見せかけます。悪意のあるユーザーが、認証が行われないというプロトコルの性質を悪用し、ターゲットのコンピュータに名前が競合するデータグラムを送信して名前を解放させ、クエリへの応答を停止させる可能性があります。
  
このような攻撃を受けると、ターゲットのコンピュータで接続が途切れる問題が発生したり、ネットワーク コンピュータ、ドメイン ログオン、NET SEND コマンド、または NetBIOS の名前解決機能を使用できなくなる可能性があります。
  
詳細については、<http://support.microsoft.com/default.aspx?kbid=269239> のマイクロソフト サポート技術情報の記事「[NetBIOS の脆弱性により、ネットワークの競合で名前が重複する](http://support.microsoft.com/default.aspx?kbid=269239)」を参照してください。
  
##### 対策
  
\[MSS:(NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers\] エントリの値を \[有効\] にします。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   1 または 0。既定の設定は 1 (有効) です。
  
SCE UI では、これらのオプションは次のように表示されます。
  
-   有効
  
-   無効
  
-   未定義
  
または、環境内で WINS の使用を無効にすることで、すべてのアプリケーションが名前解決サービスに DNS を使用するようにすることもできます。これは長期的な戦略としてはお勧めできますが、通常は、ほとんどの組織では短期的な解決策としては実践的でありません。今でも WINS を実行している組織は、通常、アプリケーションへの依存性をアップグレードやソフトウェアの展開なしに短期間で解決することは不可能で、そのためには慎重な計画と相当の時間が必要となります。
  
この対策を実施できない場合、また NetBIOS 名が確実に解決されるようにするには、特定のコンピュータの LMHOSTS ファイルの NetBIOS 名の "事前読み込み" を実行します。LMHOSTS ファイルの事前読み込みの詳細については、このセクションの前半で参照したマイクロソフト サポート技術情報の記事「NetBIOS の脆弱性により、ネットワークの競合で名前が重複する」を参照してください。
  
**注** :ほとんどの環境では、LMHOSTS ファイルのメンテナンスには多大な作業量が発生します。LMHOSTS ではなく WINS を使用することをお勧めします。
  
##### 考えられる影響
  
攻撃者が、コンピュータに NetBIOS 名の解放要求をネットワークで送信する可能性があります。アプリケーションに影響を与える可能性がある変更を行う場合と同様に、この変更を本番環境で行う前に、テスト用の環境での確認を行うことをお勧めします。
  
#### 8.3 ファイル名の自動生成を無効にする :Enable the computer to stop generating 8.3 style filenames
  
このエントリは、SCE に \[MSS:(NtfsDisable8dot3NameCreation) Enable the computer to stop generating 8.3 style filenames (recommended)\] と表示されます。Windows Server 2003 は、16 ビット アプリケーションとの下位互換を保つために 8.3 フォーマットのファイル名をサポートしています(8.3 ファイル名規則は、ファイル名に最大 8 文字まで使用できる命名規則です)。
  
このレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\FileSystem\\**
  
サブキー内のテンプレート ファイルに追加できます。
  
##### 脆弱性
  
8.3 形式のファイル名を許可すると、攻撃者にとっては 20 文字の長さのファイル名を 8 文字だけで参照できるようになります。たとえば、Thisisalongfilename.doc という名前のファイルの場合、8.3 ファイル名では Thisis~1.doc だけで参照できます。16 ビット アプリケーションを使用しない場合は、この機能をオフにできます。また、NTFS ファイル システム (NTFS) のパーティションで短縮名の生成を無効にすると、ディレクトリの一覧を迅速に取得できます。
  
攻撃者が短いファイル名を使用して、通常は見つけることが困難な長いファイル名のデータ ファイルやアプリケーションにアクセスする可能性があります。ファイル システムにアクセスできた攻撃者は、データにアクセスしたり、アプリケーションを実行したりする可能性があります。
  
##### 対策
  
\[MSS:(NtfsDisable8dot3NameCreation) Enable the computer to stop generating 8.3 style filenames (recommended)\] エントリの値を \[有効\] にします。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   1 または 0。既定の設定は 0 (無効) です。
  
SCE UI では、これらのオプションは次のように表示されます。
  
-   有効
  
-   無効
  
-   未定義
  
##### 考えられる影響
  
組織内の 16 ビット アプリケーションから、8.3 形式でない名前のファイルにアクセスできなくなります。短い名前のファイルにはスペースが含まれないことが多く、コマンド ラインで使われるときに引用符が不要なため、一部の 32 ビット アプリケーションも短い名前の存在に依存します。一部のプログラムのインストール ルーチンもエラーになります。複数の CPU アーキテクチャで実行されるように設計されたこれらのルーチンは、16 ビット アプリケーションであることが多いためです。このエントリが有効にされていると、Exchange 2000 SP2 のインストールは失敗します。このエントリが有効にされていて、システム変数 %temp% のパスに変数が含まれる場合、SQL 2000 のサービス パックのインストールは失敗します。この問題は、パスへの変数をスペースなしで再度定義すれば簡単に解決できます。
  
**注** :自動生成された 8.3 形式の名前のファイルが存在するサーバーにこのエントリを適用しても、それらのファイルは削除されません。既存の 8.3 形式のファイル名を削除するには、それらのファイルをサーバーから別の場所にコピーし、元の場所にあるファイルを削除した後、元の場所にファイルをコピーして戻す必要があります。
  
#### セーフ DLL の検索順序を有効にする :Enable Safe DLL search mode (recommended)
  
このエントリは、SCE に \[MSS:(SafeDllSearchMode) Enable Safe DLL search mode (recommended)\] と表示されます。ダイナミック リンク ライブラリ (DLL) の検索順序は、要求された DLL が次のいずれかで検索されるように構成できます。
  
SafeDllSearchMode を 1 に設定した場合、検索順序は次のとおりです。
  
-   アプリケーションが読み込んだディレクトリ
  
-   システム ディレクトリ
  
-   16 ビット システム ディレクトリ。このディレクトリへのパスを取得する機能はありませんが、検索されます。
  
-   Windows ディレクトリ
  
-   現在のディレクトリ
  
-   PATH 環境変数に記述されているディレクトリ
  
SafeDllSearchMode を 0 に設定した場合、検索順序は次のとおりです。
  
-   アプリケーションが読み込んだディレクトリ
  
-   現在のディレクトリ
  
-   システム ディレクトリ
  
-   16 ビット システム ディレクトリ。このディレクトリへのパスを取得する機能はありませんが、検索されます。
  
-   Windows ディレクトリ
  
-   PATH 環境変数に記述されているディレクトリ
  
このレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\ SYSTEM\\CurrentControlSet\\Control\\Session Manager\\**
  
サブキー内のテンプレート ファイルに追加できます。
  
##### 脆弱性
  
ユーザーが悪意のあるコードを気づかずに実行した場合、そのコードが変更されたシステム DLL を含む追加ファイルと共にパッケージされていると、それらの独自の DLL が読み込まれ、コードによる被害がさらに拡大するおそれがあります。
  
##### 対策
  
\[MSS:(SafeDllSearchMode) Enable Safe DLL search mode (recommended)\] エントリの値を \[有効\] にします。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   1 または 0。既定の設定は、Windows XP で 0、Windows Server 2003 で 1 です。
  
SCE UI では、これらのオプションは次のように表示されます。
  
-   有効
  
-   無効
  
-   未定義
  
##### 考えられる影響
  
アプリケーションでは、システム パスの DLL が最初に検索されます。アプリケーションが、そのアプリケーションで提供されている独自の DLL を必要とする場合、このエントリの設定がパフォーマンスまたは安定性に問題を起こす可能性があります。
  
#### スクリーンセーバーのパスワード保護をすぐに有効にする :The time in seconds before the screen saver grace period expires (0 recommended)
  
このエントリは、SCE に \[MSS:(ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires (0 recommended)\] と表示されます。Windows では、スクリーン セーバーが起動されてから、スクリーン セーバーのロック機能が有効な場合にコンソールが実際に自動ロックされるまでの猶予期間があります。
  
このレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\**  
**Winlogon\\**
  
サブキー内のテンプレート ファイルに追加できます。
  
##### 脆弱性
  
スクリーン セーバーのロックが有効になるまでの、ユーザーが操作を行うことが可能な既定の猶予期間は 5 秒です。猶予期間を既定の設定のままにすると、ロックが有効になるまでの間に誰かがコンソールに近づいてログオンしようとする可能性があり、コンピュータが潜在的な攻撃に対して脆弱になります。レジストリ項目で、猶予期間の長さを変更できます。
  
##### 対応策
  
\[MSS:(ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires (0 recommended)\] エントリの値を **0** に設定します。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   0 から 2,147,483。既定値は 5 秒です。
  
SCE UI では、テキスト入力ボックスにこのエントリの値が表示されます。
  
-   ユーザー定義の値
  
-   未定義
  
##### 考えられる影響
  
ユーザーは、スクリーン セーバーがアクティブになった直後に、コンソール セッションを再開するためのパスワードを入力しなければならなくなります。
  
#### セキュリティ ログが最大容量に近づくと警告する :Percentage threshold for the security event log at which the system will generate a warning
  
このエントリは、SCE に \[MSS:(WarningLevel) Percentage threshold for the security event log at which the system will generate a warning\] と表示されます。Windows Server 2003 および Windows 2000 の Service Pack 3 には、セキュリティ ログがユーザーによって定義されたしきい値に達すると、セキュリティ イベント ログのセキュリティ監査を実行する新機能があります。たとえば、この値が 90 に設定されている場合、セキュリティ ログが容量の 90% に達すると、eventID 523 のイベント エントリがログに記録されます。このエントリには、次のようなテキストが示されます。
  
"セキュリティ イベント ログは 90 パーセント使用されています。"
  
**注** :この設定は、セキュリティ イベント ログが、必要に応じてイベントが上書きされるように構成されている場合は効果がありません。
  
このレジストリ値は、
  
**HKEY\_LOCAL\_MACHINE\\ SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security\\**
  
サブキー内のテンプレート ファイルに追加できます。
  
##### 脆弱性
  
セキュリティ ログが全体の 90% に達した場合、イベントが必要に応じて上書きされるように構成されていないと、最新のイベントがログに書き込まれなくなります。ログがいっぱいになり、それ以上セキュリティ ログにイベントを記録できなくなった時点でコンピュータがシャット ダウンされるように構成されている場合は、コンピュータがシャット ダウンされ、ネットワーク サービスが提供されなくなります。
  
##### 対策
  
\[MSS:(WarningLevel) Percentage threshold for the security event log at which the system will generate a warning\] エントリの値を **90** に設定します。
  
このレジストリ エントリで設定可能な値は、次のとおりです。
  
-   0 から 100。既定の設定は 0 (警告イベントが生成されない) です。
  
SCE UI に、次のオプションが表示されます。
  
-   50%
  
-   60%
  
-   70%
  
-   80%
  
-   90%
  
-   未定義
  
##### 考えられる影響
  
この設定では、必要に応じてログにイベントが上書きされるように構成されていない場合は、セキュリティ ログがしきい値 (90%) に達した際に監査ログが生成されます。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
### Windows XP SP2 と Windows Server 2003 SP1 で利用可能なレジストリ エントリ
  
この章の前半で説明したレジストリ エントリは、Microsoft Windows XP SP1 および Windows Server 2003 に適用されます。
  
Windows XP SP2 および Windows Server 2003 SP1 のリリースで、組織の環境での特定のセキュリティ要件に対応するために設定が可能な、セキュリティ関連のレジストリ エントリが追加で提供されるようになりました。
  
次のレジストリ エントリは、Windows XP SP2 および Windows Server 2003 SP1 の両方で使用できます。
  
#### RestrictRemoteClients
  
インターフェイスが RpcServerRegisterIf を使用して登録されると、RPC によってサーバー アプリケーションはインターフェイスへのアクセスを制限できます。通常、これはセキュリティ コールバックによって行われます。インターフェイスに登録されたセキュリティ コールバックがない場合も、**RestrictRemoteClients** レジストリ キーは RPC にすべてのインターフェイスに対してさらにセキュリティ チェックを行うように強制します。名前付きパイプのプロトコル シーケンス (ncacn\_np) を使用する RPC クライアントはこれらの制限からは除外されます。名前付きパイプのプロトコル シーケンスには下位互換性に関するいくつかの重要な問題があるため、制限できません。
  
**RestrictRemoteClients** レジストリ キーには、次の 3 つの DWORD の値のいずれかを設定できます。
  
-   **0**。Windows Server 2003 SP1 の既定値です。コンピュータは RPC インターフェイス制限を回避します。RPC の適切な制限は、すべてサーバー アプリケーションで行います。この設定は、Windows の以前のバージョンの設定と同等です。
  
-   **1**。Windows XP SP2 での既定値です。すべてのリモート匿名呼び出しは、名前付きパイプ (ncacn\_np) を介して受信される呼び出しを除いて、RPC ラインタイムにより拒否されます。
  
-   **2**。すべてのリモート匿名呼び出しは、例外なく RPC ランタイムに拒否されます。この設定では、コンピュータは RPC を使用してリモート匿名呼び出しを受信できません。
  
開発者はアプリケーションを変更して、クライアントまたはサーバーが匿名 RPC 要求を受け付けるかどうかを示すフラグを RPC サブシステムに渡すことができます。
  
##### 脆弱性
  
認証されない接続を許可する RPC インターフェイスは、リモートからバッファ オーバーランを引き起こし、悪意のあるコードを拡散させるのに利用される可能性があります。
  
##### 対策
  
Windows Server 2003 SP1 および Windows XP SP2 の **RestrictRemoteClients** 値の既定の設定では、下位互換が可能になっています。リモートから RPC サービスでバッファ オーバーランを実行させようとするワームからシステムを保護するには、**RestrictRemoteClients** を **1** または **2** に設定します。
  
##### 考えられる影響
  
**RestrictRemoteClients** レジストリ キーを有効にすると、RPC エンドポイント マッパーのインターフェイスに匿名でアクセスできなくなります。この制限は重要なセキュリティ上の強化点ですが、エンドポイントの解決方法が変更されます。現在、動的なエンドポイントを使用して呼び出しを試行する RPC クライアントは、まずどのエンドポイントに接続するか、サーバー上の RPC エンドポイント マッパーに対してクエリを行います。このクエリは RPC クライアント呼び出しが RPC セキュリティを使用している場合も匿名で行われます。**RestrictRemoteClients** キーが 1 以上に設定されている場合、Windows Server 2003 SP1 では RPC エンドポイント マッパー インターフェイスへの匿名呼び出しは失敗します。したがって、エンドポイント マッパーへの認証クエリを実行するには、RPC クライアント ランタイムを変更する必要があります。**EnableAuthEpResolution** キーが設定されている場合、RPC クライアント ランタイムは NTLM を使用してエンドポイント マッパーへの認証を行います。この認証クエリは、実際の RPC クライアント呼び出しが RPC 認証を使用した場合にのみ有効になります。
  
このキーが有効になっていると動作しないアプリケーションやサービスがあります。したがって組織の環境に展開する前に、十分テストする必要があります。このキーを有効にする場合、**EnableAuthEpResolution** キーも使用して RPC エンドポイント マッパーの認証を有効にする必要があります。
  
#### EnableAuthEpResolution
  
RPC エンドポイント マッパー インターフェイスへの匿名呼び出しは、Windows XP SP2 では既定で失敗します。Windows XP SP2 での新しい **RestrictRemoteClients** キーの既定値が原因です。したがって、エンドポイント マッパーへの認証クエリを実行するには、RPC クライアント ランタイムを変更する必要があります。これを行うには、**EnableAuthEpResolution** キーを 1 に設定します。この設定が有効になると、RPC クライアント ランタイムは NTLM を使用してエンドポイント マッパー インターフェイスへの認証を行います。この認証クエリは、実際の RPC クライアント呼び出しが RPC 認証を使用した場合にのみ有効になります。
  
##### 脆弱性
  
認証されない接続を許可する RPC インターフェイスは、リモートからバッファ オーバーランを発生させ、悪意のあるコードを拡散させるのに利用される可能性があります。
  
##### 対策
  
リモートから RPC サービスにバッファ オーバーランを試みるワームからシステムを保護するには、前のセクションで説明したように **RestrictRemoteClients** を設定し、次に **EnableAuthEpResolution** を使用してコンピュータの RPC 要求に対する NTLM 認証を有効にします。
  
##### 考えられる影響
  
**EnableAuthEpResolution** キー セットがないクライアントは、**RestrictRemoteClients** が有効にされたサーバーの RPC サービス要求を作成できません。この制限により RPC ベースのサービスが停止する可能性があります。
  
#### RunInvalidSignatures
  
Windows Server 2003 SP1 および Windows XP SP2 の既定の設定では、無効な署名で署名されたコード オブジェクトはインストールされません。コードが変更されていたり、署名証明書の期限が切れていたり、署名証明書が証明書失効リスト (CRL) に登録されていると、コードは無効になります。Internet Explorer 6.0 で既に無効な署名のコードのインストールを防止する機能は提供されていますが、サービス パックでさらにすべてのアプリケーションに対してこの機能が拡張されます。
  
##### 脆弱性
  
改ざんされた署名済みの Microsoft ActiveX® コントロールがダウンロードされ、アプリケーションで実行されると、実行したコンピュータのセキュリティが侵害される可能性があります。
  
##### 対策
  
**RunInvalidSignatures** の既定の値ではこの脆弱性はブロックされます。
  
##### 考えられる影響
  
正当な署名済みのコントロールに依存するアプリケーションが、これらのコントロールの署名が何らかの理由で無効になっている場合、動作しなくなります。署名が無効と思われるアプリケーションがある場合、このキーの設定を変更してコントロールをダウンロードして実行できます。ただし、これによってセキュリティの脆弱性が発生します。アプリケーションに使用されているコントロールの開発者に問い合わせ、有効な署名付きのバージョンを取得するのが望ましい解決策です。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
### Windows XP SP2 で利用可能なレジストリ エントリ
  
次のレジストリ エントリは、Windows XP SP2 でのみ使用できます。
  
#### XP のセキュリティ センターのレジストリ エントリ
  
ユーザーが特定の機能の警告を受信するかどうかを決定する Security Center のレジストリ値は 3 つあります。キーの値が 0 の場合、または存在しない場合、指定の機能に対する通知アイコンおよび警告システムは有効になります。値が存在し、0 でない場合、指定の機能に対する通知アイコンと警告システムは無効になります。
  
この 3 つの値は、**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\**  
**Security Center** にあります。値は次のとおりです。
  
-   **AntiVirusDisableNotify**
  
-   **FirewallDisableNotify**
  
-   **UpdatesDisableNotify**
  
##### 脆弱性
  
コンピュータにインストールされているウイルス対策ソフトウェア、ファイアウォール、または自動更新サービスが何らかの理由で正常に動作していない場合、セキュリティ センターの警告機能を無効にしているユーザーは適切な警告を受信しません。
  
##### 対策
  
グループ ポリシー レジストリ エントリを適用し、組織の環境に適した警告を設定します。
  
##### 考えられる影響
  
セキュリティ センターの機能が有効になっていると、セキュリティ センター ユーザー インターフェイスでこれらのレジストリ値が表示されます。ローカル管理者の権限を持つユーザーは、セキュリティ センターの値を変更できます。
  
#### StorageDevicePolicies\\WriteProtect
  
Windows XP の既定では、ユーザーは USB ブロック ストレージ デバイスを取り付け、制限条件なしで読み書きすることが可能です。SP2 では、管理者向けにユーザーの USB ブロック ストレージ デバイスへの読み書きを制限する機能が追加されました。
  
これらのデバイスへのユーザーの読み書きを制限するには、**HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\StorageDevicePolicies** に **WriteProtect** DWORD 値を追加し、**1** に設定します。この値が設定されると、USB ブロック ストレージ デバイスの Windows ドライバによって、取り付けられた USB ブロック ストレージ デバイスへの書き込み要求は拒否されます。
  
##### 脆弱性
  
攻撃者は、リムーバブル USB デバイスにデータをコピーし、盗むことができます。
  
##### 対策
  
**WriteProtect** 値が 1 の場合、Windows XP SP2 は USB ブロック ストレージ デバイスへの書き込みをブロックします。
  
##### 考えられる影響
  
このレジストリ キーは、重大な脅威のリスクを部分的に軽減します。しかし、スキルのある攻撃者が、USB デバイスを用いてデータを盗む方法は他にも多数あります。たとえば、USB デバイスをプリンタや CD-ROM デバイスのような非ブロック ストレージ デバイスとして認識されるようにプログラムし、この制御を回避する方法があります。ユーザーまたは攻撃者による機密データの盗難を防ぐ必要がある組織は、物理的なアクセス制御やその他の手段と併せて、幅広いセキュリティ戦略の一環として、このエントリを使用して書き込み可能 USB デバイスへのアクセスを制限してください。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
### Windows Server 2003 SP1 で利用可能なレジストリ エントリ
  
次のレジストリ エントリは、Windows Server 2003 SP1 でのみ使用できます。
  
#### UseBasicAuth
  
WebDAV (Web Distributed Authoring and Versioning) は、ファイルおよびファイル サーバーへのリモート アクセスを可能にする HTTP ベースのプロトコルです。ユーザーは UNC パスを使って DAV サーバー上のリソースにアクセスできます。ただし、Windows Server 2003 の WebDAV リダイレクタは HTTP 経由で DAV をサポートする Web サーバーと通信しますが、SSL で保護された HTTP セッションは使用できません。これらの Web サイトが基本認証の使用を許可する場合、DAV 要求はユーザーの認証資格情報をプレーン テキストで送信します。
  
Windows Server 2003 SP1 では、WebDAV リダイレクタは変更され、ユーザーの資格情報を基本認証で送信しなくなりました。この修正は、コンピュータの既定の DAV リダイレクタに依存するアプリケーションやビジネス プロセスに影響を与える可能性があります (Microsoft Office は独自の DAV クライアントを使用しているため、このエントリの影響は受けません)。
  
Windows Server 2003 SP1 では **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WebClient\\**  
**Parameters\\UseBasicAuth** サブキーが導入されました。この値を 1 に設定すると、そのコンピュータの WebDAV リダイレクタは基本認証のみをサポートする Web サーバーとの通信が可能になります。
  
##### 脆弱性
  
攻撃者が基本認証を使用する Web サーバーをセットアップし、ユーザーを騙したりなりすましたりしてサーバーに接続を試行し、資格情報を取得する可能性があります。
  
##### 対策
  
既定では、Windows Server 2003 の WebDAV リダイレクタは基本認証を使用しません。これにより、この脆弱性は効果的にブロックされます。
  
##### 考えられる影響
  
Web サーバーが基本認証のみをサポートする場合、Web リソースにアクセスする組み込み WebDAV リダイレクタを使用するアプリケーションがエラーになる可能性があります。この問題を解決するには、より安全な認証方法をサポートするように Web サーバーを設定するか、**UseBasicAuth** 値を有効にします。ただし、ユーザーの資格情報を公開しない Web サーバーに再構成することが望ましい方法です。
  
#### DisableBasicOverClearChannel
  
WebDAV リダレクタは、リモート ファイル システム スタックの一部です。ユーザーがリモート コンピュータから URL を開こうとすると、リモート サーバーが基本認証のみをサポートする場合、ユーザーの資格情報が公開されます。攻撃者がユーザーを偽り、(DAV を使用して) 資格情報を要求し、基本認証を使用する Web サイトに転送する可能性があります。ユーザーが応答すると、ユーザーの資格情報が悪意のあるホストに公開されます。
  
**UseBasicAuth** レジストリ エントリは、基本認証を WebDAV 要求に使用するかどうかを制御します。**HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WebClient\\**  
**Parameters\\ DisableBasicOverClearChannel** 値を 1 に設定すると、他の Web リソースでの基本認証の使用はブロックされます。
  
##### 脆弱性
  
攻撃者が基本認証を使用する Web サーバーをセットアップし、ユーザーを騙したりなりすましたりしてサーバーに接続を試行し、資格情報を取得する可能性があります。
  
##### 対策
  
クライアント コンピュータ上で **DisableBasicOverClearChannel** 値を 1 に設定することで、基本認証を使用して HTTP サーバーに接続する機能を制限できます。
  
##### 考えられる影響
  
HTTP アクセスを提供する多数の組み込みデバイスは基本認証のみをサポートします (ルーター、プリント サーバー、コピー機など)。一部のビジネス アプリケーションも同様です。**DisableBasicOverClearChannel** を 1 に設定すると、クライアント コンピュータはこれらのデバイスやアプリケーションを認証できなくなります。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
### 関連情報
  
以下のリンクでは、この章で説明したいくつかの項目についての詳細を提供します。
  
-   DLL の Windows への読み込み方法と SafeDllSearchMode エントリの影響の詳細については、[http://msdn2.microsoft.com/en-US/library/ms682586.aspx](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dllproc/base/dynamic-link_library_search_order.asp) の「[Dynamic-Link Library Search Order](http://msdn2.microsoft.com/en-us/library/ms682586.aspx)」(英語情報) を参照してください。
  
-   レジストリ エントリを設定して Microsoft I/O デバイス ドライバを無効にするには、<http://support.microsoft.com/default.aspx?kbid=555324> のマイクロソフト サポート技術情報の記事「[HOWTO: USB と CD-ROM とフロッピー ディスクと LS-120 ドライバを無効にする 使用 グループ ポリシー](http://support.microsoft.com/default.aspx?kbid=555324)」を参照してください。
  
-   セキュリティ テンプレートの作成、編集、および処理の基礎となるアーキテクチャの詳細については、<http://technet2.microsoft.com/windowsserver/en/library/f546e58e-8473-4985-a05d-0b038dea4a9f1033.mspx?mfr=true> の「[How Security Settings Extension Works](http://technet2.microsoft.com/windowsserver/en/library/f546e58e-8473-4985-a05d-0b038dea4a9f1033.mspx?mfr=true)」(英語情報) を参照してください。この記事ではグループ ポリシー ストレージ、優先順位、および特定のグループ ポリシーがコンピュータに既に適用されていない状態における一部の設定の保持 (いわゆる "タトゥーイング") に関する詳細情報が説明されています。
  
-   詳細については、<http://support.microsoft.com/?scid=214752> のマイクロソフト サポート技術情報の記事「[カスタム レジストリ設定をセキュリティ構成エディタに追加する方法](http://support.microsoft.com/?scid=214752)」を参照してください。
  
-   一般的なネットワーク攻撃の種類の詳細については、「[Common Types of Network Attacks](http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/cnet/cndb_ips_ddui.mspx)」を参照してください。これは、「*Windows* *2000 Server Resource Kit*」の一部で、オンラインで <http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/cnet/cndb_ips_ddui.mspx> から参照できます。
  
-   Windows Server 2003 の TCP/IP スタックの強化方法の詳細については、<http://support.microsoft.com/?scid=324270> のマイクロソフト サポート技術情報の記事「[Windows Server 2003 で DoS 攻撃に対して TCP/IP スタックを強化する方法](http://support.microsoft.com/?scid=324270)」を参照してください。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
##### 目次
  
-   [概要](https://technet.microsoft.com/ja-jp/library/75849e66-9f52-4ceb-874e-cace62110b09(v=TechNet.10))  
-   [第 1 章 : 脅威とその対策 : Windows Server 2003 と Windows XP のセキュリティ設定](https://technet.microsoft.com/ja-jp/library/18593f91-27d4-49a8-a266-8fa587000c9f(v=TechNet.10))  
-   [第 2 章 :ドメイン レベルのポリシー](https://technet.microsoft.com/ja-jp/library/5d9e1e11-b8c8-4cd4-a9d6-9f4c25fb6031(v=TechNet.10))  
-   [第 3 章 :監査ポリシー](https://technet.microsoft.com/ja-jp/library/75931b0b-03b4-4dd5-a0a1-c8035c69916d(v=TechNet.10))  
-   [第 4 章 : ユーザー権](https://technet.microsoft.com/ja-jp/library/173734d6-0926-4736-b56d-7b5e2756f441(v=TechNet.10))  
-   [第 5 章 : セキュリティ オプション](https://technet.microsoft.com/ja-jp/library/5a9e0351-4fa5-40a1-a363-de18dc27a55b(v=TechNet.10))  
-   [第 6 章 : イベント ログ](https://technet.microsoft.com/ja-jp/library/4ee53fe7-4cd1-47ef-bfb9-6705c8f59aa9(v=TechNet.10))  
-   [第 7 章 : システム サービス](https://technet.microsoft.com/ja-jp/library/7a0506f6-5fc1-4f2f-8e0a-329a4b826769(v=TechNet.10))  
-   [第 8 章 : ソフトウェア制限ポリシー](https://technet.microsoft.com/ja-jp/library/9d5abd4f-6699-4c8b-b3f5-b00e43366d82(v=TechNet.10))  
-   [第 9 章 :Windows XP と Windows Server 2003 の管理用テンプレート](https://technet.microsoft.com/ja-jp/library/2c86440d-41f4-479e-8072-0f0b4693e885(v=TechNet.10))  
-   第 10 章 :追加のレジストリ エントリ  
-   [第 11 章 :追加の対策](https://technet.microsoft.com/ja-jp/library/ca39898c-bbdb-43ff-9543-92d8efabc89f(v=TechNet.10))  
-   [第 12 章 :結論](https://technet.microsoft.com/ja-jp/library/f631bd53-ba1c-4d73-8ff9-c5f870ec5551(v=TechNet.10))  
-   [謝辞](https://technet.microsoft.com/ja-jp/library/161ab5c8-f118-4c7e-95c0-3ce7c3e49136(v=TechNet.10))
  
[](#mainsection)[ページのトップへ](#mainsection)
