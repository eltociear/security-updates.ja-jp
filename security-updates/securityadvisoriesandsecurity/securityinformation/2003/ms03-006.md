---
TOCTitle: 'MS03-006'
Title: 'マイクロソフト セキュリティ情報 MS03-006 - 緊急'
ms:assetid: 'ms03-006'
ms:contentKeyID: 61228503
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms03-006(v=Security.10)'
---


マイクロソフト セキュリティ情報 MS03-006 - 緊急
===============================================

Windows Me の 「ヘルプとサポート」 の問題によりコードが実行される (812709)
--------------------------------------------------------------------------

公開日: 2003年2月27日 | 最終更新日: 2003年6月16日

[](http://www.microsoft.com/japan/security/bulletins/ms03-006e.mspx)

#### 概要 :

**このセキュリティ情報の対象となるユーザー :**  
Microsoft® Windows® Me をご使用のお客様

**脆弱性の影響 :**  
攻撃者の任意のコードが実行される

**最大深刻度 :**  
緊急

**推奨する対応策 :**  
お客様は、直ちにこの更新プログラムをインストールしてください。

**影響を受けるソフトウェア :**  

-   Microsoft Windows Me

### 詳細

問題
----

<span></span>
**技術的な説明 :**  
「ヘルプとサポート」 では様々なトピックに関してユーザーがサポートを受けることができる機能が集まっています。たとえば、製品に関する文書、ハードウェア互換性を確認するためのサポート、Windows Update へのリンク、マイクロソフトからのオンライン ヘルプおよびそのほかのサポートが提供されています。ユーザーおよびプログラムは、URL リンクの最初に "http://" ではなく、"hcp://" を入力することによって、「ヘルプとサポート」 への URL リンクを実行することができます。

"hcp://" の URL Handler に未チェックのバッファが含まれるため、Windows Me バージョンの 「ヘルプとサポート」 にセキュリティ上の脆弱性が存在します。
	
攻撃者がこの脆弱性を悪用し、URL を作成し、ユーザーがそれをクリックすると、ローカル コンピュータのセキュリティ コンテキストで攻撃者の任意のコードが実行される可能性があります。攻撃者はそのような URL を Web サイト上の Web ページにホストするか、または電子メールで直接ユーザーに送信する可能性があります。Web を悪用した場合のシナリオでは、ユーザーが Web サイトにホストされた URL をクリックした場合、攻撃者はローカル マシン上に既に存在するファイルを読み取るか、または起動する可能性があります。電子メールを悪用した攻撃の場合、Outlook Express 6 または Outlook 2002 を既定の構成で使用するか、または [Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)をインストールした Outlook 98 または 2000 を使用している場合、自動化された攻撃を行うことはできず、この脆弱性の悪用には、電子メールで送信された URL をユーザーがクリックすることが必要条件となります。しかし Outlook Express 6 または Outlook 2002 を既定の構成で、または[Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)をインストールした Outlook 98 または 2000 を使用していない場合、ユーザーが電子メールに含まれた URL をクリックしなくても攻撃者は自動的に攻撃を行うことができます。

**問題を緩和する要素 :**  

-   Internet Explorer 6 Service Pack 1 を実行している場合、「ヘルプとサポート」 の機能はOutlook Express または Outlook で自動的に開始されません。
-   攻撃者が攻撃を行うためには、ユーザーが攻撃者の管理する Web サイトに訪問するか、または攻撃者から HTML 形式の電子メールを受信することが必要条件となります。
-   HTML 形式の電子メールにより、この脆弱性を悪用した自動化された攻撃は、Outlook Express 6 および Outlook 2002 を既定の構成で使用するか、または [Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)をインストールした Outlook 98 または 2000 を使用することによって阻止することができます。

**深刻度 :**  

|                |      |
|----------------|------|
| **Windows Me** | 緊急 |

上記の[評価](http://technet.microsoft.com/security/bulletin/rating)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。


**脆弱性識別番号 :**  
[CAN-2003-0009](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0009)

**テストしたバージョン :**  
マイクロソフトは Windows Me および Windows XP のテストを行い、この脆弱性による影響を評価しました。それ以前のバージョンの Windows には問題のコードは含まれず、この脆弱性による影響はありません。

よく寄せられる質問
------------------

<span></span>
**どのようなことが起こる可能性がありますか?**  

これは[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者はこの脆弱性を悪用し、任意のコードをローカル マシンのコードのように実行する可能性があります。このようなコードにより、攻撃者はそのマシン上でシステム上のデータの追加、削除、変更、または攻撃者の任意のコードの実行など、任意の操作を行う恐れがありあます。

**何が原因で起こりますか?**  

「ヘルプとサポート」 の URL ハンドラに未チェックのバッファが存在するため、この脆弱性が起こります。

**「ヘルプとサポート」とは何ですか?**  

[ヘルプとサポート](http://www.microsoft.com/japan/technet/prodtechnol/winxppro/support/hsc.mspx) (HSC) は、様々なトピックに関してユーザーにサポートを提供する Windows の機能の 1 つです。たとえば、「ヘルプとサポート」 により、ユーザーは Windows の機能およびハードウェア デバイスと Windows の互換性に関しての情報を得たり、ソフトウェア アップデートのダウンロード、インストール、マイクロソフトからのサポートなどのサービスを受けることができます。

**「ヘルプとサポート」の何が問題になっていますか?**  

「ヘルプとサポート」 の URL ヘッダーには "hcp://" プリフィックスを使用してページを開くことができる機能が含まれます。しかし、この機能では、受信する入力のパラメータが適切にチェックされません。そのため、バッファがチェックされず、攻撃者が URL を作成し、コードを実行させる可能性があります。

**URL** **ハンドラとは何ですか?**  

URL ハンドラにより、アプリケーションが Web ページによって呼び出されると、自動的にそのアプリケーションが開始される新しい URL の種類を登録することができるようになります。たとえば、Outlook 2002 がシステムにインストールされている場合、カスタム URL ハンドラとして outlook:// が登録されます。次に Internet Explorer の \[ファイル名を指定して実行\] ボックスにこの URL を入力するか、またはハイパーリンクをクリックすることにより Outlook を呼び出すことができます。
「ヘルプとサポート」 の場合、カスタム URL のプリフィックスは “hcp://” となります。

**この脆弱性により攻撃者は何をする可能性がありますか?**  

この脆弱性により、攻撃者はシステム上で別の権限を獲得し、任意のコードを実行する可能性があります。これにより、攻撃者はシステム上のデータの追加、削除、変更または攻撃者の任意の操作を実行する可能性があります。

**攻撃者はどのようにしてこの脆弱性を悪用する可能性がありますか?**  

攻撃者がこの脆弱性を悪用するには、特別に作成した URL を立ち上げる Web ページを作成することが必要条件となります。この攻撃は、次の 2 つの方法で行われる可能性があります。1 つ目の方法では、攻撃者は Web サイトにそのような Web ページをホストし、ユーザーがそのサイトを訪問した際、その Web ページがその URL を立ち上げ、この脆弱性が悪用される可能性があります。2 つ目の方法では、攻撃者はそのような Web ページを HTML 形式の電子メールとして送信する可能性があります。受信者がその Web ページを開くと、「ヘルプとサポート」 の機能が呼び出され、この脆弱性が悪用される可能性があります。

HTML 形式の電子メールが悪用される場合のシナリオでは、ユーザーがOutlook Express 6 または Outlook 2002 を既定の構成で使用するか、または [Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)をインストールした Outlook 98 または 2000 を使用している場合、自動化された攻撃は行われず、この脆弱性が悪用されるには、電子メールで送信された URL をユーザーがクリックすることが必要条件となります。しかし、Outlook Express 6 または Outlook 2002 を既定の構成で、または[Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)をインストールした Outlook 98 または 2000 を使用していない場合、ユーザーが電子メールに含まれた URL をクリックしなくても、攻撃者によって自動化された攻撃が行われる可能性があります。

**更新プログラムは何を修正しますか?**  

この更新プログラムは、URL ハンドラの未チェックのバッファを修正することにより、この脆弱性を解決します。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからインストールできます。

-   Microsoft Windows Me:  
    [812709 : セキュリティ問題の更新プログラム (Windows Me)](http://update.microsoft.com/microsoftupdate/)![](../../images/Dn636325.wu_s(ja-JP,Security.10).gif)
	
    この更新プログラムは、 Windows Update のみにより提供されております。  
    なお、Windows Update カタログから更新プログラムをダウンロードすることができます。  
    更新プログラムのダウンロードは、 Windows Update カタログより、 "Windows Millennium Edition" で検索し、 "812709 : セキュリティ問題の更新プログラム (Windows Me)" を選択してください。

![](../../images/Dn636325.wu_s(ja-JP,Security.10).gif)このマークの付いている更新プログラムは [Windows Update](http://update.microsoft.com/microsoftupdate/) からインストールすることができます。
Windows Update、および Windows Update カタログの利用方法については以下のサイトを参照してください。

-   Windows Update 利用の手順  
    [http://www.microsoft.com/japan/athome/security/square/guard/WU5Steps.mspx](http://www.microsoft.com/japan/athome/security/square/guard/wu5steps.mspx)
-   Windows Update カタログの利用手順  
    [http://www.microsoft.comhttp://support.microsoft.com/kb/880733](http://support.microsoft.com/kb/880733)

#### 更新プログラムに関する追加情報

**対象プラットフォーム :**  
この更新プログラムは、Windows Me を実行しているシステムにインストールすることができます。

**再起動の必要性 :**  
あり

**更新プログラムのアンインストール :**  
不可

**更新プログラムに含まれる過去の修正 :**  
なし

**更新プログラムが正しくインストールされたかどうか確認する方法 :**  

-   この更新プログラムがマシンにインストールされたことを確認するためには、[Qfecheck.exe](http://support.microsoft.com/kb/295413) ツールを使用して、以下の情報が表示されることを確認してください。
    UPD812709 Windows Millennium Edition Q812709 のアップデート
    各ファイルを確認するためには、サポート技術情報 [812709](http://support.microsoft.com/kb/812709) のファイル欄を参照して下さい。

**警告 :**  
なし

**他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。 :**  

-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。
-   本セキュリティ情報及び公開された更新プログラムは、[TechNet CD サブスクリプション](http://www.microsoft.com/japan/technet/subscriptions/)でも入手可能です。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報 :**  

-   US マイクロソフトセキュリティ情報（MS03-006）  
    [http://www.microsoft.com/technet/security/bulletin/ms03-006.mspx](http://technet.microsoft.com/security/bulletin/ms03-006)
-   サポート技術情報 （KB） 文書番号 ： 812709  
    [\[MS03-006\] Windows Millennium Edition のヘルプとサポートに存在するセキュリティの脆弱性が原因で悪質なコードが実行される](http://support.microsoft.com/kb/812709)

**謝辞 :**  
この問題を連絡し、顧客の保護に協力して下さった Hackademy [Warning and Fozzy](http://www.thehackademy.net/) に対し、マイクロソフトは深い[謝意](http://technet.microsoft.com/security/bulletin/policy)を表します。

**更新履歴 :**  

-   2003/2/27: このセキュリティ情報ページを公開しました。
-   2003/2/28: この問題に対する日本語版 KB 812709 を公開しました。
-   2003/6/16: 「絵でみるセキュリティ情報」 へのリンクを追加しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
