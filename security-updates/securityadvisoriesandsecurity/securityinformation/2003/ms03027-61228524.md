---
TOCTitle: 'MS03-027'
Title: 'マイクロソフト セキュリティ情報 MS03-027 - 重要'
ms:assetid: 'ms03-027'
ms:contentKeyID: 61228524
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms03-027(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS03-027 - 重要
===============================================

Windows シェルの未チェックのバッファによりコンピュータが侵害される (821557)
---------------------------------------------------------------------------

公開日: 2003年7月17日 | 最終更新日: 2003年7月18日

[](http://www.microsoft.com/japan/security/bulletins/ms03-027e.mspx)

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Windows® XP をご使用のお客様

**脆弱性の影響** **:**
攻撃者の任意のコードが実行される

**最大深刻度** **:**
重要

**推奨する対応策** **:**
Microsoft Windows XP をご使用のお客様はできるだけ早期にこの更新プログラムをインストールしてください。

**影響を受けるソフトウェア** **:**

-   Microsoft Windows XP

**影響を受けないソフトウェア** **:**

-   Microsoft Windows Millennium Edition
-   Microsoft Windows NT® Server 4.0
-   Microsoft Windows NT 4.0, Terminal Server Edition
-   Microsoft Windows 2000
-   Microsoft Windows Server 2003

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
Windows シェルは、Windows のユーザー インターフェース エクスペリエンスの基本フレームワークを提供する役割を果たします。Windows シェルは、Windows デスクトップとしてユーザーにより広く知られていますが、ファイルおよびフォルダの管理、プログラムを開始する方法の提供など、ユーザーのコンピューティング セッションの定義を支援するためのその他の様々な機能も提供します。
その Windows シェルが使用し、特定のフォルダからカスタム属性情報を抽出する機能の 1 つに未チェックのバッファが存在します。悪意のあるユーザーがこの問題を悪用する攻撃を仕掛け、ユーザーのコンピュータ上でコードを実行する可能性があるためにセキュリティ上の脆弱性が存在します。
攻撃者はこの脆弱性を悪用し、不正なカスタム属性を含む Desktop.ini ファイルを作成し、それをネットワーク共有上にホストする可能性があります。ユーザーがそのファイルが保存されている共有フォルダを参照すると、この脆弱性が悪用される可能性があります。この攻撃により、Windows シェルが異常終了するか、またはユーザーのコンピュータ上で、攻撃者のコードがそのユーザーのセキュリティ コンテキストで実行される恐れがあります。

**問題を緩和する要素** **:**

-   攻撃者のコードが実行された場合、そのコードはユーザーのセキュリティ コンテキストで実行されます。したがって、ユーザーのアクセス権の制限により、攻撃者のコードで実行できる操作も制限されます。
-   攻撃者がこの脆弱性を悪用するために使う手段は、共有上に悪質なファイルをホストするというもののみです。
-   この脆弱性は Windows XP Service Pack 1 のみに影響を及ぼします。Windows XP を実行しているユーザーには影響は及びません。

**注意** **:**
サービス パックをインストールしていない環境でも、特定の更新プログラムをインストールしている場合、この脆弱性の影響を受けます。詳細については、「よく寄せられる質問」 の 「Windows XP を実行しています。更新プログラムを適用する必要がありますか?」 をご確認ください。

**深刻度** **:**

|                |      |
|----------------|------|
| **Windows XP** | 重要 |

上記の[評価](http://technet.microsoft.com/security/bulletin/rating)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。

**脆弱性識別番号** **:**
[CAN-2003-0306](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0306)

**テストしたバージョン** **:**
マイクロソフトは Windows Millennium Edition、Windows NT Server 4.0、Windows NT Server 4.0, Terminal Server Edition、Windows 2000、Windows XP および Windows Server 2003 のテストを行い、これらの脆弱性による影響を評価しました。それ以前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、これらの脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**サービスパックをインストールしていない** **Windows XP** **を実行しています。更新プログラムを適用する必要がありますか？**

サービスパックをインストールしていない Windows XP を実行しているお客様は、この問題による影響はありません。しかし、マイクロソフトは、製品サポート サービスからある特定の更新プログラムを受け取ったサービスパックをインストールしていない サービスパックをインストールしていない Windows XP のユーザーの中に、この更新プログラムをインストールし、コンピュータを保護する必要がある場合があることを確認しました。

これに伴い、サービスパックをインストールしていない Windows XP 環境でも動作する更新プログラムを 7 月 18 に再リリースしました。すでに 7 月 17 日に更新プログラムをダウンロードされたお客様で、サービスパックをインストールしていない Windows XP に更新プログラムをインストールされる場合は、お手数ですが更新プログラムの再ダウンロードをお願いいたします。
Windows XP SP1 環境でご利用のお客様は更新プログラムを再ダウンロードおよび再インストールしていただく必要はありません。

**その特定の更新プログラムが自分のコンピュータにインストールされているかどうかは、どのように確認することができますか？**

ご使用の Windows XP がこの脆弱性の影響を受けるかどうかを確認するには、以下の手順に従ってください。

1.  \[スタート\] メニューから \[検索\] を選択します。
2.  \[ファイルとフォルダすべて\] をクリックします。
3.  Shell32.dll と入力します。
4.  \[検索\] ボタンをクリックします。
5.  右側のペインの Shell32.dll ファイルをクリックします。
6.  \[プロパティ\] を選択します。
7.  \[バージョン\] タブをクリックします。

ファイルのバージョンが 6.0.2600.39 以降である場合、この更新プログラムを適用する必要があります。

**どのようなことが起こる可能性がありますか?**

これは[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者がこの脆弱性を悪用し、ユーザーのコンピュータで任意のコードが実行される恐れがあります。これにより、攻撃者はユーザーのアクセス権のレベルの境界内で実行できるすべての操作を実行できる可能性があります。

**何が原因で起こりますか?**

この脆弱性は、フォルダに保存されている （フォルダが存在する場合） Desktop.ini ファイルからそのフォルダのフォルダ属性を自動的に読み取り、適用する Windows シェルのコンポーネントに、未チェックのバッファが存在するために発生します。

**この脆弱性により攻撃者は何ができますか?**

この脆弱性が悪用された場合、最悪のケースで攻撃者によりユーザーのシステム上で攻撃者の任意のコードが実行される恐れがあります。Windows シェルはユーザーのコンテキストで実行されるため、攻撃者のコードもユーザーとして実行される可能性があります。データまたは構成情報を削除、追加、変更するユーザーのアクセス権の制限により、攻撃者によって実行される操作も制限されます。

**“Desktop.ini”** **ファイルとは何ですか?**

Desktop.ini ファイルには、ユーザーがファイル フォルダおよびそのコンテンツを参照する際に、それらが表示される方法に関する情報が保存されます。Desktop.ini ファイルは、フォルダを表示するためには必要なく、すべてのフォルダに存在するものではありません。Desktop.ini ファイルがフォルダに存在している場合、Desktop.ini ファイルにはそのフォルダにアクセスしているプログラムによって含まれる情報が異なります。たとえば、Windows Explorer では、フォルダを示すアイコンの名前および場所、マウス ポインタをフォルダ上に配置する際に表示されるヒントのテキスト、またはフォルダに含まれるファイルを表示する方法を保存するために Desktop.ini が使用される場合があります。

**攻撃者はどのようにこの脆弱性を悪用する可能性がありますか?**

攻撃者はこの脆弱性を悪用し、不正なカスタム属性を含む Desktop.ini ファイルを作成し、それをネットワークまたはインターネット共有上にホストする可能性があります。攻撃者は次にそのような共有にユーザーを誘導する可能性があります。

**Windows** **シェルとは何ですか?**

Windows シェルにより、Windows ユーザー インターフェースの基本的なフレームワークが提供されます。Windows シェルは [Windows Desktop](http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/) (英語情報) として最も一般的に使用されます。シェルは単なるデスクトップを越える多くの機能を提供し、コンピュータに一貫した外観にする方法を提供します。シェルは Windows Explorer からファイルおよびフォルダを検索するために使用することができ、\[スタート\] メニューのショートカットからプログラムを開始するための一貫した方法を提供し、またデスクトップ テーマと色の一貫したインターフェースを提供します。

**Windows** **シェルはこれらのファイル属性をどのように処理しますか?**

Windows シェルは、ファイル、フォルダおよびアイコンに関する情報の表示に関連する様々な操作を担います。たとえば、Windows シェルにより、コンピュータ上のファイルの 「縮小表示」 を表示するフォルダ ビューを変更することができます。フォルダ コンテンツの表示が 「縮小表示」 と設定されたコンピュータ上でフォルダが開かれると、Windows シェルが呼び出されます。Windows シェルは自動的にこの設定を検知し、その後フォルダのコンテンツを 「縮小表示」 で表示します。

**縮小表示とは何ですか?**

一般的には、縮小表示とは、画像を認識するのに十分な詳細のみが含まれた、画像が大幅に縮小されたバージョンを示します。縮小表示は、通常ギャラリー ビューで使用され、ユーザーは画像の集合を参照し、そこから選択することができます。

**Windows** **シェルの何が問題になっていますか?**

Windows シェルがファイルおよびフォルダの表示属性を自動的に抽出するための機能に、未チェックのバッファが含まれます。Windows シェルが Desktop.ini ファイルから不正な属性を読み取ろうとした場合、バッファ オーバーランが発生する可能性があります。

**Windows** **シェルはどのように呼び出され、ファイルまたはフォルダの属性を読み取るのですか?**

Windows シェルがフォルダおよびそのコンテンツに適用する必要があるカスタム属性に、Desktop.ini ファイルの解析を試みる場合にのみ、未チェックのバッファを含む特定の機能が呼び出されます。この機能は、フォルダが開かれる際に呼び出されます。

**攻撃者は、電子メールを直接使用することによってこの脆弱性を悪用する可能性がありますか?**

いいえ。この脆弱性を悪用するには、特別に作成された Desktop.ini ファイル を含む共有をユーザーが参照することが攻撃者にとっての必要条件となります。

**Windows XP** **を使用していません。この脆弱性による影響を受ける可能性がありますか?**

いいえ、ありません。この問題は、Windows XP Service Pack 1 のみに影響を及ぼします。Windows XP またはその他のバージョンの Windows には影響はありません。

**この脆弱性を悪用するために作成されたと思われるファイルを削除する安全な方法はありますか?**

不正なカスタム属性を含む Desktop.ini ファイルをコンピュータにダウンロードした可能性がある場合、Windows Explorer からそのファイルを削除しようとすべきではありません。そのようなファイルを含むフォルダを開くと、Windows シェルがそのファイルを処理し、この脆弱性の影響を受けるコードが実行される可能性があります。コマンド プロンプトを使用して、不正なファイルを削除してください。コマンド プロンプトは以下の方法でアクセスすることができます。

1.  \[スタート\] ボタンから \[ファイル名を指定して実行\] を選択します。
2.  ボックスの中に cmd.exe と入力します。\[OK\] ボタンをクリックします。これによりコマンド プロンプトが起動します。
3.  コマンド プロンプトで、DEL コマンドを使用して、ファイルのパスを指定し、そのファイルを削除します。使用するスイッチに関する特定の情報は、DEL /? と入力し、ヘルプを利用してください。

**更新プログラムは何を修正しますか?**

この更新プログラムは、この脆弱性の影響を受ける Windows シェルの機能で適切な入力確認が行われるように修正し、この脆弱性を排除します。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   [Windows XP 32 bit Edition](http://www.microsoft.com/downloads/details.aspx?familyid=27d02af5-a2e1-4e25-9d16-502886161a35&displaylang=ja)![](../../images/Dn636347.mu_s(ja-JP,Security.10).gif)
-   [Windows XP 64 bit Edition](http://www.microsoft.com/downloads/details.aspx?familyid=4ba84e2b-49f9-4416-8745-51f03503ab7d&displaylang=ja)![](../../images/Dn636347.mu_s(ja-JP,Security.10).gif)

![](../../images/Dn636347.mu_s(ja-JP,Security.10).gif)このマークの付いている更新プログラムは [Microsoft Update](http://update.microsoft.com/microsoftupdate/) からインストールすることもできます。
Microsoft Update の利用方法については以下のサイトを参照してください。

-   Microsoft Update 利用の手順
    <http://www.microsoft.com/japan/athome/security/update/j_musteps.mspx>

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**
この更新プログラムは Windows XP [Service Pack 1](http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/default.mspx) を実行しているコンピュータにインストールすることができます。

**この修正を含む予定のサービスパック** **:**
この問題に対する更新プログラムは Windows XP Service Pack 2 に含まれる予定です。

**再起動の必要性** **:**
あり

**更新プログラムのアンインストール** **:**
可

**更新プログラムに含まれる過去の修正** **:**
なし

**更新プログラムが正しくインストールされたかどうか確認する方法** **:**

-   この更新プログラムがコンピュータにインストールされたことを確認するためには、コンピュータに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP2\\KB821557
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP2\\KB821557\\Filelist

**警告** **:**
なし

**他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。** **:**

-   セキュリティ更新プログラムは[マイクロソフト ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード探索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。
-   本セキュリティ情報及び公開された更新プログラムは、[TechNet CD サブスクリプション](http://www.microsoft.com/japan/technet/subscriptions/)でも入手可能です。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS03-027）
    [http://www.microsoft.com/technet/security/bulletin/ms03-027.mspx](http://technet.microsoft.com/security/bulletin/ms03-027)
-   サポート技術情報 （KB） 文書番号 ： 821557
    [\[MS03-027\] Windows シェルの未チェックのバッファによりシステムが侵害される](http://support.microsoft.com/kb/821557)

**更新履歴** **:**

-   2003/7/17: このセキュリティ情報ページを公開しました。
-   2003/7/17: この問題に対するマイクロソフト サポート技術情報 821557 日本語版を公開しました。
-   2003/7/18: 脆弱性識別番号を修正しました。「よく寄せられる質問」 に、サービス パックをインストール していない Windows XP についての情報を追加しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
