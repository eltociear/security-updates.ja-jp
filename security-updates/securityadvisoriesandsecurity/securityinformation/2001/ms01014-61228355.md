---
TOCTitle: 'MS01-014'
Title: 'マイクロソフト セキュリティ情報 MS01-014 - 緊急'
ms:assetid: 'ms01-014'
ms:contentKeyID: 61228355
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms01-014(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS01-014 - 緊急
===============================================

不正な URL により IIS 5.0 及び Exchange 2000 のサービスにエラーが発生する
-------------------------------------------------------------------------

公開日: 2001年3月2日 | 最終更新日: 2001年3月21日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Internet Information Services 5.0 または Exchange 2000 を使用しているシステム管理者

**脆弱性の影響** **:**
サービス拒否

**推奨する対応策** **:**
システム管理者は該当の製品を実行しているサーバーに更新プログラムをインストールしてください。

**影響を受けるソフトウェアのバージョン** **:**

-   Microsoft Internet Information Services 5.0
-   Microsoft Exchange 2000

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
URL にある特定の構造があり、それが URL のあるとても狭い範囲内に含まれる場合、IIS 5.0 がその URL を処理する方法に問題が生じます。そのような URL が繰り返し該当のシステムに送信された場合、イベントが集中することによってメモリの割り当てエラーが発生し、IIS のサービスにエラーが発生する可能性があります。
Exchange 2000 もこの脆弱性の影響を受けます。Exchange 2000 にはWeb ベースのメール クライアントをサポートするために、ストア上のアイテムを URLで指定する機能が導入されています。これは IIS 5.0 によって使用される部分と、Exchange 2000 特有のコードを介した部分で実行されます。このコードの両方に問題がありますが、この脆弱性を利用した影響はどちらの場合でも同様で、IIS サービスを異常終了させる恐れがあります。しかし、この脆弱性を利用して Exchange サービス自体を攻撃しても、Web ベースのメールクライアントのサーバー使用を妨害する可能性はありますが、Outlook のような MAPI ベースのメール クライアントのサーバー使用を妨害することはできません。
この問題は、IIS 5.0 の一部としてインストールされるコード モジュールと Exchange 2000 の一部としてインストールされるコード モジュールの 2 種類の異なるコード モジュールで発生します。そのため Exchange 2000 管理者は、下にある IIS と Exchange の両方の更新プログラムを適用してください。

**問題を緩和する要素** **:**

-   攻撃者はこの脆弱性を利用してサーバーの管理者権限を獲得したり、サーバー上のデータを変更したりすることはできません。
-   エラーが発生すると、そのサービスは自動的に再起動するので、該当のシステムはサービスを即座に再開します。
-   Exchange サーバーへの攻撃が成功した場合でも、Web ベースのメール クライアントのサーバーの使用が妨害されることのみです。Outlook などの MAPI ベースのクライアントは引き続きサーバーを使用することができます。
-   この脆弱性に関連する ISAPI はリクエストに応答する前にユーザー認証を行います。したがって正しく構成された Exchange サーバーは IIS サーバーよりもこの脆弱性による危険性が低いと言えます。

**脆弱性識別番号** **:**
[CAN-2001-0146](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0146)

よく寄せられる質問
------------------

<span></span>
**どのようなことが起こる可能性がありますか?**

これは[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。この脆弱性を利用して、攻撃者は該当する Web サイトを一時的に混乱させたり、または該当するメール サーバーへの Web ベースのアクセスを一時的に妨害することができます。いずれの場合もサーバーは自動的に通常の操作を再開しますが、攻撃時に進行中であったセッションは失われます。この脆弱性により、攻撃者がサーバーでの管理者権限を不正に使用したり、サーバー上のデータの追加、変更そして削除を行うことはできません。

**何が原因で起こりますか?**

この脆弱性は URL にある特定の構造があり、それが URL のあるとても狭い範囲内に含まれる場合、Internet Information Services (IIS) 5.0 と [Exchange 2000](http://www.microsoft.com/japan/exchange/) がその URL を正しく取り扱わないために起こります。Internet Information Services (IIS) 5.0 や Exchange 2000 がそのような URL を何度も受信すると IIS サービスが異常終了します。

**URL** **は** **Web** **ブラウジングに関連して使用されるだけであると思っていました。なぜ** **Exchange 2000** **がこの脆弱性の影響を受けるのですか?**

Exchange 2000 は Web ベースのメール クライアントの使用をサポートします。このため、URL を受け入れ、そして処理することができます。Exchange サーバーへのリクエストは URL を介して行われます。URL を処理する Exchange のコードは IIS のコードと別のものですが、同じ問題が存在しています。

**ここで説明されている** **URL** **の何が問題になっていますか?**

URL 自体には何の問題もありません。URL が正当な目的で送信されることは極めてまれですが、IIS も Exchange も URL を適切に処理することができます。しかし、前述の問題がメモリの割り当てエラーを起こします。これが何度も発生すると、アクセス違反となる場合があります。そして、マシンでの IIS サービスが異常終了します。

**サーバーの種類によって、IIS** **または** **Exchange** **サービスが異常終了するということですか?**

いいえ。いずれのケースも、影響として IIS サービスが異常終了します。Exchange サービスはこの脆弱性により、異常終了することはありません。

**この脆弱性を利用した攻撃が成功すると、どのようなことが起きますか?**

攻撃の対象が Web サーバーに対してであるか、またはメール サーバーに対するものであるかによります。いずれの場合も IIS 5.0 サービスを異常終了させます。メール サーバーでは、この攻撃により Web ベースのメール クライアントがシステムを使用することが妨害されます。Outlook のようなメール クライアントは Web を介して操作を行わないため、そのメール サービスが混乱させられることはありません。

**URL** **を** **1** **度送信すると、サービスは異常終了しますか?**

いいえ。この脆弱性を利用するためには、攻撃者は攻撃用の構造と長さを持つ URL を準備するだけでなく、繰り返し URL を送信する必要があります。

**混乱はどのくらい続きますか?**

通常、攻撃はほんのわずかの間、サービスに混乱を起こすだけです。IIS 5.0 サービスはデフォルトで、異常終了時に自動的に再起動するように構成されています。このため、ほとんど即時に通常の操作を再開します。

**この脆弱性はサーバーを奪取するために使用されますか?**

いいえ。これはサービス拒否の脆弱性です。この脆弱性を利用して Web または メール サーバーで管理者権限を取得したり、サーバーのデータを変更をすることはできません。単にサーバーがサービスを提供することを妨害するためだけに利用されます。

**この脆弱性は偶発的に発生しますか?**

いいえ、偶発的に発生しません。特定の構造と長さを持つ ＵＲＬ が偶発的に送信されることは極めてまれです。

**この脆弱性は** **IIS** **と** **Exchange** **サーバーのどちらに、より大きな危険をもたらしますか?**

最善の対応策が講じられていれば、Exchange サーバーはこの危険にさらされる可能性は極めて低いです。該当するコンポーネントの設計様式により、通常、認証されたユーザーだけが Exchange サーバーにリクエストを送信することができます。つまり、インターネット ユーザーは該当する Exchange サーバーを攻撃することはできません。これに対し、通常、Web サーバーはどのようなユーザーからもリクエストを受け入れます。

**この脆弱性はより前のバージョンの IIS や Exchange に影響を及ぼしますか?**

いいえ。IIS 5.0 と Exchange 2000 だけがこの脆弱性の影響を受けます。

**更新プログラムは何を修正しますか?**

この更新プログラムは URL が適切に取り扱われるようにしてこの脆弱性を排除します。ほとんどの場合、このような URL は無効です。そして更新プログラムは IIS 5.0 と Exchange 2000 が無効な URL を無効として処理するようにします。
この問題に対する日本語版更新プログラムは現在準備中です。

**なぜ** **Exchange** **と** **IIS** **用の両方の更新プログラムを** **Exchange 2000** **に適用する必要があるのですか?**

IIS 5.0 と Exchange 2000 にはコードに関する同じ問題がありますが、その問題は 2 つの異なるコンポーネントに存在しています。このうち 1 つのコンポーネントは IIS 5.0 の一部で、もう 1 つのコンポーネントは Exchange 2000 の一部です。しかし、IIS は Exchange 2000 の一部としてインストールされていますので、Exchange 2000 サーバーに IIS 5.0 と Exchange 2000 用の両方の更新プログラムが必要となります。

更新プログラム
--------------

<span></span>
-   Microsoft Internet Information Services 5.0:
    この問題に対する修正は Windows 2000 Service Pack 3 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。
    <http://www.microsoft.com/japan/windows2000/downloads/>
    なお、個別の更新プログラムは以下の Web サイトから入手できます。
    [http://www.microsoft.com/downloads/details.aspx?FamilyId=8DEA064A-32D6-4E83-AB9A-9AE14D33AC64&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=8dea064a-32d6-4e83-ab9a-9ae14d33ac64&displaylang=ja)
    -   PC/AT 互換機用
        ダウンロード先のリストから Japanese Language Version を選択してください。
-   Microsoft Exchange 2000:
    この問題に対する日本語版更新プログラムは、現在準備中です。

**注** **:**
技術的な説明で説明されているように、Exchange 2000 の管理者は IIS 5.0 と Exchange 2000 の**両方の**更新プログラムをインストールする必要があります。

#### この更新プログラムに関する追加情報

**対象プラットフォーム** **:**

-   IIS 5.0 の更新プログラムは Windows 2000 Service Pack 1 または Service Pack 2 を動作しているシステムにインストールすることができます。

**今後リリースされるサービスパックに含まれる更新プログラム** **:**

-   IIS 5.0 の問題に対する更新プログラムは Windows 2000 Service Pack 3 に含まれています。

**更新プログラムのインストール確認方法** **:**
IIS 5.0:

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認してください。HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP2\\Q286818
-   この更新プログラムの各ファイルを確認するためには、次のレジストリ キーで、日付、時間、バージョン情報を参照してください。HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP2\\Q286818\\Filelist

**警告** **:**
Exchange 2000 システムには IIS 5.0 および Exchange 2000 の両方の更新プログラムが必要です。

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS01-014）
    [http://www.microsoft.com/technet/security/bulletin/ms01-014.mspx](http://technet.microsoft.com/security/bulletin/ms01-014)
-   サポート技術情報 （KB） 文書番号 ： 286818
    [不正な URL による IIS 5.0/Exchange 2000 サービスの問題](http://support.microsoft.com/kb/286818)
-   サポート技術情報 （KB） 文書番号 ： 287678
    [\[XWEB\] 不正な URL により IIS 5.0 及び Exchange 2000 のサービスにエラーが発生する](http://support.microsoft.com/kb/287678)

**更新履歴** **:**

-   2001/3/2: このセキュリティ情報ページを公開しました。
-   2001/3/12: この問題に対する日本語版更新プログラムを公開しました。
-   2001/3/21: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
