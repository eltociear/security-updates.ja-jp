---
TOCTitle: 'MS01-054'
Title: 'マイクロソフト セキュリティ情報 MS01-054 - 注意'
ms:assetid: 'ms01-054'
ms:contentKeyID: 61228419
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms01-054(v=Security.10)'
---


マイクロソフト セキュリティ情報 MS01-054 - 注意
===============================================

無効なユニバーサル プラグ アンド プレイのリクエストがシステムのオペレーションを妨害する
---------------------------------------------------------------------------------------

公開日: 2001年11月2日 | 最終更新日: 2001年11月21日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**  
Microsoft® Windows® ME または XP を使用しているお客様、または、Windows 98 または 98SE にインターネット接続共有 (ICS) クライアントをインストールしているお客様

**脆弱性の影響** **:**  
サービス拒否

**最大危険度** **:**  
低

**推奨する対応策** **:**  
Windows XP ユーザーは、下記の 「更新プログラム」 の欄から Microsoft Update の 「重要な更新」 ページをご参照の上、該当のアップデート パッケージを適用してください。「重要な更新」 には、この問題を含むほかの多くの問題に対する更新プログラムが含まれています。Windows 98、98SE または ME を使用しているお客様で、ユニバーサル プラグ アンド プレイサービスをインストールし、実行している場合は、この更新プログラムを適用してください。

**影響を受けるソフトウェア** **:**

-   Microsoft Windows 98
-   Microsoft Windows 98SE
-   Microsoft Windows ME
-   Microsoft Windows XP

**注** **:**  
Windows 98 および 98SE は、Windows XP に同梱されるインターネット接続共有のクライアント サービスをインストールした場合にのみこの脆弱性による影響を受けます。

### 詳細

問題
----


**技術的な説明** **:**  
2001 年 11 月 8 日 (米国日付)、マイクロソフトは Windows ME 用の更新プログラムが upnp.dll を適切に登録しないことを発見しました。2001 年 11 月 13 日 (米国日付) にマイクロソフトは Windows ME の更新プログラムに修正を加えたバージョンをリリースしました。マイクロソフトは Windows ME の更新プログラムの最初のバージョンをインストールしたお客様は新しいバージョンをダウンロードし、インストールすることを推奨いたします。エラーが含まれるのは Windows ME の更新プログラムのみであるため、そのほかのシステムを使用しているお客様は措置を取る必要はありません。  
ユニバーサル プラグ アンド プレイ (UPnP) サービスは、コンピュータがネットワークベースのデバイスを検知し、使用可能にするサービスです。Windows ME および XP には標準で UPnP サービスが含まれています。Windows 98 および 98SE には標準の UPnP サービスは含まれていませんが、UPnP サービスは Windows XP に同梱されるインターネット接続共有 (ICS) クライアントを介してインストールされます。  
その UPnP サービスがある種類の無効な UPnP リクエストを適切に処理しないために脆弱性が発生します。Windows 98、98SE、ME を実行しているシステムがこのようなリクエストを受け取ることにより、システムのパフォーマンス低下やシステムの異常終了など様々な影響を受けます。Windows XP では、その影響の深刻性は比較的低くはありますが、メモリ リークの問題が発生します。Windows XP システムがこのようなリクエストを受け取るたびに、システム メモリのごく一部が使用不可能の状態になります。それが何度も繰り返された場合、システム パフォーマンスが低下するか、またはシステムが停止するまでシステム リソースが使い果たされる可能性があります。

**問題を緩和する要素** **:**

**全般** **:**

-   標準的なファイアウォールでの対策を取ることにより （具体的にはポート 1900 および ポート 5000 のブロッキング） インターネットベースの攻撃から企業ネットワークを保護することができます。

Windows 98 および 98SE :

-   これらのシステムでは UPnP の標準サポートはされていません。Windows 98 および 98SE のシステムは、Windows XP からの インターネット接続共有 （ICS） クライアントがシステムにインストールされている場合にのみ影響を受けます。

Windows ME :

-   Windows ME では、UPnP の標準サポートが提供されていますが、既定ではインストールされず、実行もされません。 （しかし、OEM 製品の中には、既定の設定でこのサービスのインストール、実行を提供している場合もあります。）

Windows XP :

-   既定で実行される インターネット接続フォイアウォール により、攻撃者がシステムの場所を探し出し、そのシステムに攻撃を実行するのを妨害します。

**危険度** **:**

|                  | インターネット システム | イントラネット システム | クライアント システム |
|------------------|-------------------------|-------------------------|-----------------------|
| **Windows 98**   | なし                    | なし                    | 低                    |
| **Windows 98SE** | なし                    | なし                    | 低                    |
| **Windows ME**   | なし                    | なし                    | 低                    |
| **Windows XP**   | なし                    | なし                    | 低                    |

上記の[評価](http://technet.microsoft.com/security/bulletin/rating1) はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形態およびこの脆弱性がシステムに及ぼす影響に基づいています。この脆弱性は UPnP サービスが稼動しているクライアント オペレーティング システムにのみ影響を及ぼし、最悪の場合、サービス拒否の脆弱性が発生します。

**脆弱性識別番号** **:**  
[CAN-2001-0721](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0721)

**テストしたバージョン** **:**  
マイクロソフトは Windows ME、Windows NT 4.0、Windows 2000、Windows XP および Windows 98、Windows 98SE にインストールされる UPnP サービスのテストを行い、これらの脆弱性による影響を評価しました。それより前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------


**このセキュリティ情報が更新されたのはなぜですか?**

2001 年 11 月 8 日 (米国日付) に、マイクロソフトは英語版セキュリティ情報ページを更新し、Windows ME 用の更新プログラムに影響を及ぼすエラーに関して説明しました。ある状況下で、その更新プログラムを適用するとシステムが異常終了する可能性があります。2001 年 11 月 13 日 (米国日付)、英語版セキュリティ情報ページを再度更新し、修正が加えられた更新プログラムが入手可能になったことをお知らせしました。最初の Windows ME の更新プログラムを適用したお客様は新しいバージョンの更新プログラムをダウンロード、インストールしてください。新しいバージョンのプログラムをインストールする前に前のバージョンの更新プログラムをアンインストールする必要はありません。

**Windows ME** **以外の更新プログラムはこの問題の影響を受けますか?**

いいえ、 Windows ME の更新プログラムのみにエラーが含まれていました。

**どのようなことが起こる可能性がありますか?**

これは[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。影響を受ける Windows 98、98SE または ME マシンに特定のコマンドのセットを送信することにより、攻撃者がマシンのパフォーマンスを低下させたり、マシンを異常終了させるなど様々な影響を及ぼす可能性があります。Windows XP マシンへの影響は他のオペレーティング システムと比較すると深刻ではありませんが、最悪の場合の影響は、パフォーマンスが低下する、または停止するまで、攻撃者が除々にシステム リソースを使い果たす可能性があります。

この脆弱性に影響する重要な制限が数多くあります。

-   Windows 98 および 98SE では、ユーザーがオプションのアドオン パッケージをインストールしている場合のみ、このサービスが利用可能となります。
-   Windows ME では、影響を受けるコンポーネントはオペレーティング システムの一部として利用可能ですが、既定ではインストールされません。(ただし、OEM メーカーによっては、このコンポーネントを既定でインストールしている場合もあります。)
-   Windows NT 4.0 および Windows 2000 はこの脆弱性の影響を全く受けません。
-   Windows XP では影響を受けるコンポーネントがインストールされていますが、既定では実行されません。このコンポーネントが実行されているとしても、インターネット接続ファイアウォールにより、攻撃者がそのマシンを探し出す能力を著しく低減します。

**何が原因で起こりますか?**

この脆弱性は Windows 98、98SE、ME および XP に同梱されている、またはインストールすることのできるユニバーサル プラグ アンド プレイ サービスが特定のリクエストを正しく処理しないために起こります。Windows 98、98SE および ME では、これらのリクエストがアクセス違反を発生させ、システムが異常終了します。Windows XP では、メモリ リークが発生し、これが繰り返し利用された場合、システムのパフォーマンスが低下するまでシステム リソースが使い果たされる可能性があります。

**ユニバーサルプラグアンドプレイとは何ですか?**

[ユニバーサル プラグ アンド プレイ](http://www.microsoft.com/technet/prodtechnol/winxppro/evaluate/upnpxp.mspx) (UPｎP) (英語情報) とはネットワークのデバイスがほかのデバイスを発見し、それらのデバイスと動作する方法を確認することができるようにする機能です。UPnP は多くの Windows ユーザーにお馴染みの プラグ アンド プレイ (PnP) 機能と比較すれば、容易に理解することができるでしょう。PnP により、新しいハードウェアをシステムにインストールする時、オペレーティング システムがそれを検知することができます。例えば、新しいマウスを使用中のコンピュータにインストールする場合、PnP により Windows がそれを検知し、必要となるドライバをロードし、そしてそれを使用し始めます。  
UPnP はこの概念を拡張し、デバイスにシステムのデバイスではなく、ネットワークに存在するほかのデバイスを自動的に認識させます。例えば、UPｎP を使用すると、ネットワークに追加されたコンピュータがネットワークにプリンタがあるかどうかを検知し、そしてプリンタを制御することができます。

**どのオペレーティングシステムが** **UPｎP** **をサポートしていますか?**

-   Windows 98 および Windows 98SE は標準の UPｎP 機能を含みません。Windows XP で提供されている [インターネット接続の共有クライアント](http://www.microsoft.com/technet/prodtechnol/winxppro/reskit/default.mspx) (英語情報) をインストールすることによってのみ、この UPｎP 機能を追加することができます。
-   Windows ME は標準の UPｎP 機能を含みますが、既定ではインストール、また実行されません。
-   Windows NT 4.0 および Windows 2000 は UPnP をサポートしていません。
-   Windows XP は標準の UPnP 機能を含みます。これは既定でインストール、また実行されます。

**UPnP** **サービスの何が問題になっていますか?**

このサービスは特定の無効な UPnP リクエストを正しく処理しません。そのようなリクエストを受信した場合の影響は使用しているオペレーティング システムにより異なります。

**Windows 98、98SE** **または** **ME** **システムでそのようなリクエストを受信した場合、どのような影響がありますか?**

これらの実装では、そのようなリクエストがシステムのパフォーマンスが低下させたり、システムを異常終了させる可能性があります。システムを再起動することにより、通常の状態に回復することができます。

**Windows XP** **でそのようなリクエストを受信した場合、どのような影響がありますか?**

Windows XP でそのようなリクエストを受信した場合、システムのメモリが少量ずつ使い果たされます。長時間リクエストが繰り返し送信された場合、除々にシステム リソースが使い果たされ、システムが遅延、または異常終了する可能性があります。システムを再起動することにより、通常の状態に回復することができます。

**Windows NT 4.0** **または** **Windows 2000** **システムでそのようなリクエストを受信した場合、どのような影響がありますか?**

Windows NT 4.0 および Windows 2000 は UPnP をサポートしていません。このため、どちらもこの脆弱性の影響を受けません。

**攻撃者はどのようにしてこの脆弱性を利用することができますか?**

攻撃者は UPnP サービスがインストールされ、実行されているシステムを見つけ出し、そのシステムに上記で説明した UPnP リクエストを送信することにより、この脆弱性を利用することができます。

**攻撃者はまず、この脆弱性の影響を受けるシステムを見つけ出す必要があるとのことですが、これは困難ですか?**

Windows XP の場合、困難である場合があります。Windows XP は インターネット接続ファイアウォール (ICF) を同梱しています。ICF の目的は事実上、システムをネットワークで見えない状態にすることです。つまり、攻撃者がシステムを見つけるために使用する可能性のあるピング、ポート スキャン、そのほかの方法などにシステムが応答しないようにします。ICF は既定でインストールされ、実行されます。

**攻撃者は、インターネットから企業ネットワーク内のマシンに対してこの脆弱性を利用することができますか?**

ファイアウォールで適切に措置がとられている場合は、インターネットベースの攻撃をすることはできません。UPnP が動作するポート （ポート 1900 およびポート 5000） はファイアウォールでブロックする必要があります。

**UPnP** **サービスがマシンにインストールされているかどうかはどのように確認できますか?**

Windows 98、98SE および Windows ME では、以下の操作を行ってください。

1.  \[スタート\]、\[設定\]、\[コントロール パネル\] の順に選択します。
2.  \[アプリケーションの追加と削除\] を選択します。
3.  \[Windows ファイル\] タブを選択します。
4.  \[通信\] の詳細のコンポーネントを開きます。
5.  \[ユニバーサル プラグ アンド プレイ\] のチェックボックスがチェックされている場合、サービスはインストールされ、稼動しています。

Windows XP では、以下の操作を行ってください。

1.  \[スタート\] を選択し、\[マイコンピュータ\] 上で右クリックをし、\[管理\] を選択します。
2.  \[サービスとアプリケーション\] を選択し、次に \[サービス\] を選択します。
3.  サービスのリストで、Universal Plug and Plug Device Host を確認します。
4.  \[状態\] と書かれた列を確認します。\[開始\] となっていたら、サービスはインストールされ、稼動しています。

**UPnP** **がマシンで稼動している場合、サービスを無効にすればこの脆弱性から保護することができますか？**

はい、できます。サービスが稼動していない場合は、この脆弱性が利用されることはありません。

**サービスはどのようにして停止できますか？**

Windows 98、98SE および Windows ME では、以下の操作を行ってください。

1.  \[スタート\]、\[設定\]、\[コントロール パネル\] の順に選択します。
2.  \[アプリケーションの追加と削除\] を選択します。
3.  \[Windows ファイル\] タブを選択します。
4.  \[通信\] の詳細のコンポーネントを開きます。
5.  \[ユニバーサル プラグ アンド プレイ\] のチェックボックスをオフにします。

Windows XP では、以下の操作を行ってください。

1.  \[スタート\] を選択し、\[マイコンピュータ\] 上で右クリックをし、\[管理\] を選択します。
2.  \[サービスとアプリケーション\] を選択し、次に \[サービス\] を選択します。
3.  サービスのリストで、Universal Plug and Plug Device Host を確認します。
4.  サービス名の上で右クリックをし、プロパティを選択します。
5.  \[全般\] タブにある \[サービスの状態\] で、\[停止\] をクリックします。
6.  \[スタートアップの種類\] のプルダウン ボックスで、\[無効\] を選択します。

**更新プログラムは何を修正しますか？**

Windows 98、98SE、ME の更新プログラムは UPnP サービスへのアップデートから配布されます。そのアップデートは、この脆弱性と UPnP サービスにあるほかの比較的深刻性の低い多くのバグも排除します。Windows XP では、この更新プログラムは、最初の Windows XP の 「重要な更新」 の一部として配布され、この脆弱性に加えて、いくつかのセキュリティ関連の問題を含むほかの多くの問題を排除します。

**WindowsME** **の更新プログラムの前のバージョンをダウンロードしました。どのようにする必要がありますか?**

WindowsME の更新プログラムの前のバージョンをダウンロードしたお客様は、アップデートされた更新プログラムをダウンロード、インストールするか前のバージョンの更新プログラムの問題を手動で解決する操作手順に従ってください。

**WindowsME** **の更新プログラムの前のバージョンの問題を手動で解決する操作手順とはどのようなものですか?**

WindowsME の更新プログラムの前のバージョンをダウンロードしたお客様は、以下の操作に従うことによって、更新プログラムに含まれる問題を修正することができます。

-   \[スタート\] ボタンを押します。
-   \[ファイル名を指定して実行\] を選択します。
-   "regsvr32 upnp.dll" （クオーテーション マークは必要ありません） と入力し、\[OK\] ボタンをクリックします。

**上記の操作を行いましたが問題は排除されません。どのようにすればよいですか?**

WindowsME の更新プログラムの問題が排除されない場合、Microsoft Product Support Service に連絡してください。セキュリティ更新プログラムに関する通話はすべて無料です。

**Windows 98、Windows 98 SE** **で** **\[このアップデートは使用しているバージョンの** **Windows** **用ではありません\]** **のメッセージがでて、更新プログラムをインストールできません。**

上記のメッセージは、Windows 98、Windows 98 SE 上でインターネット接続共有クライアントがインストールされておらず、修正の対象となるモジュールが存在していないことを示しています。上記のメッセージが表示された場合、お客様のシステムは本問題の影響を受けませんので、更新プログラムをインストールする必要はありません。

更新プログラム
--------------


この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft 98 および 98SE :
    [http://www.microsoft.com/downloads/details.aspx?FamilyId=0806FDB7-1C17-47B4-A777-72FD3DAF1076&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=0806fdb7-1c17-47b4-a777-72fd3daf1076&displaylang=ja)
-   Microsoft ME :
    [http://download.microsoft.com/download/winme/Update/21388/WinMe/JA/311311JPNM.EXE](http://download.microsoft.com/download/winme/update/21388/winme/ja/311311jpnm.exe)

    **注** **:**
    マイクロソフトは Windows ME の更新プログラムの最初のバージョンをインストールしたお客様は上記のサイトから新しいバージョンをダウンロードし、インストールすることを推奨いたします。

-   Microsoft XP :
    この問題に対する修正は Windows XP Service Pack 1 以降に含まれています。Windows XP 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

    <http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/>
    この問題は、"Windows XP アップデート パッケージ - 2001 年 10 月 25 日" というタイトルのアップデートによって排除されます。<http://update.microsoft.com/microsoftupdate/> をご覧ください。

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**

-   Windows 98、98SE の更新プログラムは、Windows XP のインターネット接続の共有クライアントをインストールした Windows 98 または Windows 98SE システムにインストールすることができます。
-   Windows ME の更新プログラムは Windows ME を実行しているシステムにインストールすることができます。
-   Windows XP の更新プログラムは Windows XP を実行しているシステムにインストールすることができます。

**今後リリースされるサービスパックに含まれる更新プログラム** **:**

-   Windows 98、98SE または ME のサービス パックのリリースの予定はありません。
-   この問題に対する更新プログラムは Windows XP Service Pack 1 に含まれています。

**再起動の必要性** **:**
あり

**更新プログラムに含まれる過去の修正** **:**
なし

**更新プログラムのインストール確認方法** **:**
Windows 98 and 98SE:

-   この更新プログラムがマシンにインストールされたことを確認するためには、［スタート］、\[ファイル名を指定して実行\] を選択し、QFECheck ユーティリティを起動してください。更新プログラムがインストールされている場合は、インストールされた更新プログラムのリストに "Windows 98 Q309521 Update" が表示されます。
-   各ファイルを確認するためには、サポート技術情報 [309521](http://support.microsoft.com/kb/309521) のファイル欄を参照して下さい。

Windows ME :

-   この更新プログラムがマシンにインストールされたことを確認するためには、［スタート］、\[ファイル名を指定して実行\] を選択し、QFECheck ユーティリティを起動してください。更新プログラムがインストールされている場合は、インストールされた更新プログラムのリストに "Windows Millennium Edition Q311311 Update" が表示されます。
-   各ファイルを確認するためには、サポート技術情報 Q311311 のファイル欄を参照して下さい。

Windows XP :

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP1\\q309521
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP1\\q309521\\Filelist

**警告** **:**
なし

**ローカライズ** **:**

-   Windows 98、98SE、ME の更新プログラムのローカライズ版は現在開発中で、間もなく Windows Update から利用可能になります。ドイツ語および日本語版は、サポート技術情報 [311311](http://support.microsoft.com/kb/311311) で説明しているように、本日よりダウンロードすることができます。
-   Windows XP の更新プログラムのローカライズ版は Microsoft Update よりダウンロードすることができます。

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS01-054）
    [http://www.microsoft.com/technet/security/bulletin/ms01-054.mspx](http://technet.microsoft.com/security/bulletin/ms01-054)
-   サポート技術情報 （KB） 文書番号 ： 309521
    [Windows XP アップデート パッケージ - 2001 年 10 月 25 日](http://support.microsoft.com/kb/309521)
-   サポート技術情報 （KB） 文書番号 ： 311311
    [無効なユニバーサル プラグ アンド プレイ要求によりコンピュータが停止する](http://support.microsoft.com/kb/311311)

**更新履歴** **:**

-   2001/11/2: このセキュリティ情報ページを公開しました。
-   2001/11/16: このセキュリティ情報ページを更新し、Windows ME 用の新しいバージョンの日本語版更新プログラムが入手可能となったことをお知らせしました。
-   2001/11/21: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。  

*Built at 2014-04-18T01:50:00Z-07:00*
