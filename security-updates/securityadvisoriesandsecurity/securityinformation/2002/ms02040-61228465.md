---
TOCTitle: 'MS02-040'
Title: 'マイクロソフト セキュリティ情報 MS02-040 - 緊急'
ms:assetid: 'ms02-040'
ms:contentKeyID: 61228465
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-040(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS02-040 - 緊急
===============================================

MDAC 機能の未チェックのバッファにより、システムが侵害される (326573)
--------------------------------------------------------------------

公開日: 2002年8月1日 | 最終更新日: 2003年8月21日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Windows® を使用しているお客様

**脆弱性の影響** **:**
攻撃者の選択したコードが実行される

**最大深刻度** **:**
緊急

**推奨する対応策** **:**
ユーザーは直ちにセキュリティ更新プログラムをインストールして下さい。

**影響を受けるソフトウェア** **:**

-   Microsoft Data Access Components 2.5
-   Microsoft Data Access Components 2.6
-   Microsoft Data Access Components 2.7

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
このセキュリティ情報をリリースした後、実際の脆弱性自体は特に、**OpenRowSet** コマンド (Microsoft SQL Server のコマンド) に存在するのではなく、Windows のすべてのバージョンに存在する基礎となる MDAC コンポーネントである Open Database Connectivity (ODBC) に存在することが確認されました。さらに、Microsoft Windows インストーラがシステム ファイルの保護のキャッシュを更新する方法に存在する問題のため、最初の更新プログラムが正しくインストールされないコンピュータもありました。マイクロソフトはこの追加情報および更新された更新プログラムについてお知らせするため、このセキュリティ情報を更新しました。
**注** : このセキュリティ情報で提供する更新プログラムは [MS03-033](http://technet.microsoft.com/security/bulletin/ms03-033) に含まれています。MS02-040 の更新プログラムをインストールしようとしているお客様は [MS03-033](http://technet.microsoft.com/security/bulletin/ms03-033) の更新プログラムをインストールして下さい。
MDAC は Windows プラットフォームにデータベースの接続を提供するために使用されるコンポーネントの集合体です。MDAC は広く存在する技術であるため、ほとんどの Windows システムに存在する可能性があります。

-   MDAC は Microsoft Windows XP、Windows 2000 および Windows Millennium Edition の一部として既定で含まれます。
-   スタンドアロン技術として、ダウンロードすることができます。
-   そのほかの多数の製品および技術に同梱またはインストールされています。たとえば、MDAC は Windows NT® 4.0 Option Pack に同梱されています。また、Microsoft Access の一部として、また SQL Server の一部として含まれています。また、MDAC 自体がインストールされていなくても、Internet Explorer の一部として存在する MDAC のコンポーネントもあります。

MDAC はリモート データベースへの接続やクライアントへのデータの返却など、多くのデータベース操作のための基礎となる機能を提供します。具体的には、Open Database Connectivity (ODBC) と呼ばれる MDAC のコンポーネントがこの機能を提供します。
データ ソースに接続するために使用される MDAC の ODBC 機能の 1 つに未チェックのバッファが含まれるため、セキュリティ上の脆弱性が起こります。攻撃者は、ユーザーが訪問すると、攻撃者の選択によるコードをそのユーザーの特権で実行する Web ページを作成することにより、この脆弱性を悪用する可能性があります。このような Web ページは Web サイトにホストされるか、または電子メールで直接ユーザーに送られる可能性があります。
Microsoft SQL Server を実行しているコンピュータの場合、攻撃者は Transact-SQL **OpenRowSet** コマンドにより、この脆弱性を悪用する可能性があります。攻撃者は SQL Server を実行しているコンピュータを異常終了させる、または、SQL Server を実行しているコンピュータに攻撃者が指示する操作を行わせる目的で、 **OpenRowSet** への呼び出し内に、不正なパラメータを含むデータベースクエリを送信することにより、バッファ オーバーランを発生させる可能性があります。

**問題を緩和する要素** **:**

-   電子メールをテキスト形式で読み取るユーザーに対し、攻撃者がこの脆弱性を悪用するには、ユーザーに事前にある操作をさせる必要があります。
-   Internet Explorer でアクティブ スクリプティングを無効にするように構成されているコンピュータはこの脆弱性の影響を受けません。
-   Web ベースの攻撃のシナリオでは、この脆弱性を悪用する Web ページを含む Web サイトをホストすることが攻撃者にとっての必要条件となります。攻撃者は、HTML 形式の電子メールによる攻撃の方法以外で、ユーザーを強制的に悪質な Web サイトを訪問させることはできません。ユーザーに攻撃者の Web サイトに接続するリンクをクリックさせることにより、ユーザーを悪質な Web サイトに誘導することが攻撃者にとっての必要条件となります。
-   攻撃により取得される特権は ODBC が実行されているアプリケーションと同等の特権となります。ほとんどの場合、攻撃者により取得される可能性のある特権は、コンピュータにログオンしたユーザーの持つ特権と同レベルの特権のみです。
-   既定で、Outlook Express 6.0 および Outlook 2002 は HTML 形式の電子メールを「制限付きサイト ゾーン」で開きます。さらに [Outlook 2000 SR-1 アップデート: 電子メール セキュリティ (更新版)](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx) をインストールしている Outlook 98 および 2000 は HTML 形式の電子メールを「制限付きサイト ゾーン」で開きます。これらの製品を使用しているお客様は、電子メール内の悪質なリンクをクリックしない限り、この脆弱性を悪用する電子メールによる攻撃からの危険にさらされることはありません。

**深刻度** **:**

|              |      |
|--------------|------|
| **MDAC 2.5** | 緊急 |
| **MDAC 2.6** | 緊急 |
| **MDAC 2.7** | 緊急 |

上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。この脆弱性は、すでに、攻撃者が選択されたデータベース クエリを送信することができる場合のみ、悪用される可能性があります。

**脆弱性識別番号** **:**
[CVE-CAN-2002-0695](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0695)

**テストしたバージョン** **:**
マイクロソフトは MDAC 2.5、2.6 および 2.7 のテストを行い、これらの脆弱性による影響を評価しました。それより前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**マイクロソフトはなぜこのセキュリティ情報を再リリースしたのですか?**

このセキュリティ情報をリリースした後、実際の脆弱性自体は特に、Microsoft SQL Server のコマンドである **OpenRowSet** コマンドに存在するのではなく、Windows のすべてのバージョンに存在する基礎となる MDAC コンポーネントである OBDC に存在することが確認されました。さらに、インストーラがシステム ファイルの保護のキャッシュを更新する方法に存在する問題のため、最初の更新プログラムが正しくインストールされないコンピュータもありました。マイクロソフトはこの追加情報および更新された更新プログラムについてお知らせするため、このセキュリティ情報を更新しました。

**更新された更新プログラムはマイクロソフト セキュリティ情報** **MS03-033** **に含まれていますが、これはなぜですか?**

このセキュリティ情報の最初の更新プログラムは [MS03-033](http://technet.microsoft.com/security/bulletin/ms03-033) に含まれています。[MS03-033](http://technet.microsoft.com/security/bulletin/ms03-033) の更新プログラムは、[MS03-033](http://technet.microsoft.com/security/bulletin/ms03-033) で説明されているそのほかのセキュリティ上の脆弱性に加え、この脆弱性に対する更新プログラムも含みます。お客様は MS02-040 の更新プログラムではなく、[MS03-033](http://technet.microsoft.com/security/bulletin/ms03-033) の更新プログラムを適用して下さい。

**どのようなことが起こる可能性がありますか?**

これは[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者はこの問題を悪用し、影響を受けるプロセスの完全な制御を取得し、これにより、悪用された ODBC プロセスと同じレベルの特権で任意の操作を行う可能性があります。この操作には、コンピュータ上のデータの作成、変更、削除、コンピュータの再構成、ハード ドライブの再フォーマット、攻撃者の選択によるプログラムの実行などがあります。

**何が原因で起こりますか?**

ODBC ドライバを読み込むために使用される基礎となる機能のいくつかを提供する Microsoft Data Access Components に存在する問題のため、この脆弱性が起こります。この機能には未チェックのバッファが含まれています。攻撃者は ActiveX コントロールのインスタンスを作成する、または ActiveX を悪用することにより、HTML ベースの電子メールを介しこの脆弱性を悪用する可能性があります。いくつかの ActiveX コントロールは MDAC 機能へのアクセスを提供するため、この攻撃の方法により、この脆弱性を悪用する可能性があります。また、**OpenRowSet** への呼び出し内に不正なパラメータを含むデータベース クエリを送信することにより、T-SQL **OpenRowSet** コマンドを悪用し、Microsoft SQL Server を実行するコンピュータでこの脆弱性を悪用する可能性があります。

**Microsoft Data Access Components** **とは何ですか?**

Microsoft Data Access Components (MDAC) とは、プログラムがデータベースにアクセスし、そのデータベース内のデータを操作することを容易にするコンポーネントの集合体です。現代的なデータベースには様々な形式 (例 : SQL データベース、Access データベース、XML ファイルなど) があり、様々な場所 (例 : ローカル システムまたはリモート データベースサーバー) に設置されています。MDAC は一貫した方法で、それらのすべてと動作する機能の強化されたセットです。MDAC コンポーネントの 1 つに Open Database Connectivity (ODBC) と呼ばれるものがあります。

**ODEC** **とは何ですか?**

Open Database Connectivity (ODBC) とは、データ ソースにアクセスするための標準の API です。これは MDAC のコンポーネントおよびインターフェースであり、これにより、アプリケーションが ODBC ドライバのあるすべてのデータベース内のデータにアクセスすることができます。ODBC を使用することにより、ODBC ドライバのあるすべてのデータベースへのアクセスを持つデータベースアプリケーションを作成することができます。たとえば、Windows は Microsoft Excel、Access および SQL 用のドライバを含んでいます。

**この脆弱性により、攻撃者は何を行う可能性がありますか?**

攻撃者がバッファのオーバーランを発生させる方法によって異なります。攻撃者がバッファのオーバーランを発生させるためにランダム データを入力した場合、攻撃者のアプリケーションが異常終了し、これによりユーザーにセキュリティ上の危険性が発生することはありません。一方、攻撃者が綿密に作成したデータを入力した場合、MDAC の機能を変更し、攻撃者が指定するすべての操作が行われる恐れがあります。

-   攻撃者は、ユーザーが訪問すると、攻撃者の選択によるコードが、ユーザーの特権で実行される Web ページを作成することにより、この脆弱性を悪用する可能性があります。このような Web ページは Web サイトにホストされるか、または電子メールでユーザーに直接送られる可能性があります。
-   また、攻撃者は T-SQL OpenRowSet コマンドにより、この脆弱性を悪用する可能性があります。攻撃者は OpenRowSet への呼び出し内に不正なパラメータを含むデータベース クエリを送信し、SQL Server を異常終了させる、または SQL Server サービスに攻撃者が指定する任意の操作を行わせる目的で、バッファをオーバーランさせる可能性があります。

**システムに必要な更新プログラムのバージョンはどのように確認できますか?**

サポートされている MDAC のバージョンごとに更新プログラムがあります。以下の表は、様々なマイクロソフト製品に同梱された MDAC のバージョンを示します。

 
<table style="border:1px solid black;">
<thead>
<tr class="header">
<th style="border:1px solid black;" >MDAC のバージョン</th>
<th style="border:1px solid black;" >同梱されている製品<br />
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">MDAC 2.5</td>
<td style="border:1px solid black;">Windows 2000、Office 2000 SR1 およびそれ以降のバージョン、SQL Server 7.0 Service Packs 2 およびそれ以降のバージョン<br />
</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">MDAC 2.6</td>
<td style="border:1px solid black;">SQL Server 2000<br />
</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">MDAC 2.7</td>
<td style="border:1px solid black;">Windows XP、Visual Studio .Net</td>
</tr>
</tbody>
</table>
  
ご使用の MDAC のバージョンを別な方法で調べるためには、HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\DataAccess レジストリ キーを確認してください。FullInstallVer キーに、x.xx.yyyy.y の形式の値が表示されます。x.xx がバージョン番号を示します。（例 : FullInstallVer の値が 2.70.7713.0 である場合、MDAC 2.7 がシステムにインストールされていることを意味します。）  
MDAC のバージョンを確認するもう 1 つの方法は、C:\\Program Files\\Common Files\\System\\ado\\msado15.dll 上で右クリックし、\[プロパティ\] を選択し、バージョン情報を確認してください。バージョン情報は、FullInstallVer 値の形式と同じ x.xx.yyyy.y の形式で表示され、x.xx がバージョン番号を示します。
  
**MDAC** **は** **Windows、Office** **の様々なバージョンに同梱されていますが、これは、これらの製品のユーザーはすべてこの更新プログラムが必要であるということですか?**
  
はい、その通りです。多くのアプリケーションが MDAC コンポーネントの ODBC を使用しているため、MDAC を同梱している製品を使用するすべてのお客様がこの更新プログラムを適用する必要があります。MDAC は広く存在する技術であり、多くのマイクロソフト製品に同梱されています。
  
-   Windows XP、Windows Me および Windows 2000 の一部としてインストールされます。  
-   [マイクロソフト Web サイト](http://www.microsoft.com/data/) (英語情報) からダウンロードすることができます。  
-   多くのそのほかのマイクロソフトのアプリケーションによりインストールされます。一例として、Microsoft Access および SQL Server の両方により、Windows NT 4.0 Option Pack の一部としてインストールされます。  
-   MDAC のいくつかのコンポーネントはそのほかのマイクロソフト技術に含まれます。たとえば、Internet Explorer はいくつかの MDAC 機能を含みます。後半で説明されているように、これが非常に重要な要素となります。
  
コンピュータで実行されている MDAC のバージョンを確認するにあたり、手助けとなるツールも利用可能です。マイクロソフトサポート技術情報 [307255](http://support.microsoft.com/kb/307255) でこのツールとその使用方法について説明しています。
  
**この更新プログラムは、どのようにしてこれらの脆弱性を排除しますか?**
  
この更新プログラムは、この脆弱性に関連する機能でバッファの処理が適切に行われるように修正します。
  
更新プログラム  
--------------
  
<span></span>
この問題に対する更新プログラムは [MS03-033](http://technet.microsoft.com/security/bulletin/ms03-033) で提供している更新プログラムに含まれています。他の脆弱性に対する修正も含まれている [MS03-033](http://technet.microsoft.com/security/bulletin/ms03-033) の更新プログラムを適用してください。この更新プログラムのダウンロードについては [MS03-033](http://technet.microsoft.com/security/bulletin/ms03-033) の「更新プログラム」の欄をご覧ください。
  
**注意** **:**  
この更新プログラムを適用する前に、必ず次のサポート技術情報を参照してください。
  
-   [436469](http://support.microsoft.com/kb/436469) \[MDAC\] PRB: MS02-040 で提供される更新プログラムをインストールする際の注意点
  
#### 更新プログラムに関する追加情報
  
**対象プラットフォーム** **:**  
この更新プログラムの対象プラットフォームについては、[MS03-033](http://technet.microsoft.com/security/bulletin/ms03-033) の「更新プログラムに関する追加情報」欄をご覧下さい。
  
**この修正を含む予定のサービス パック** **:**  
この問題に対する更新プログラムは MDAC 2.5 Service Pack 5 および MDAC 2.7 Service Pack 2 に含まれる予定です。なお、この更新プログラムは MDAC 2.8 に含まれています。
  
**再起動の必要性** **:**  
あり
  
**更新プログラムのアンインストール** **:**  
不可
  
**更新プログラムに含まれる過去の修正** **:**  
なし
  
**更新プログラムが正しくインストールされたか確認する方法** **:**  
マイクロソフト サポート技術情報 [326573](http://support.microsoft.com/kb/326573) で、この更新プログラムのインストールの確認のために使用することができるファイル欄が記載されています。
  
**警告** **:**  
この更新プログラムは [MS03-033](http://technet.microsoft.com/security/bulletin/ms03-033) の更新プログラムに含まれます。ユーザーは [MS03-033](http://technet.microsoft.com/security/bulletin/ms03-033) の更新プログラムを適用して下さい。
  
**他のセキュリティ更新プログラムの入手先** **:**  
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。
  
-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード検索によって容易に見つけることができます。  
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。
  
更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)
  
### その他の情報
  
**詳細情報** **:**
  
-   US マイクロソフトセキュリティ情報（MS02-040）  
    [http://www.microsoft.com/technet/security/bulletin/ms02-040.mspx](http://technet.microsoft.com/security/bulletin/ms02-040)  
-   サポート技術情報 （KB） 文書番号 ： 326573  
    [\[MS02-040\] OpenRowset における未チェックのバッファのアップデートについて](http://support.microsoft.com/kb/326573)
  
**更新履歴** **:**
  
-   2002/08/01: このセキュリティ情報ページを公開しました。  
-   2002/8/14: この問題に対する日本語版 KB を公開しました。  
-   2003/08/21: このセキュリティ情報ページを更新し、Microsoft SQL Server のみではなく、Windows のすべてのバージョンがこの脆弱性の影響を受けることをお知らせしました。
  
本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。
  
*Built at 2014-04-18T01:50:00Z-07:00*
