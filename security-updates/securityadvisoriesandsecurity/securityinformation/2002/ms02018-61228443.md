---
TOCTitle: 'MS02-018'
Title: 'マイクロソフト セキュリティ情報 MS02-018 - 緊急'
ms:assetid: 'ms02-018'
ms:contentKeyID: 61228443
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-018(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS02-018 - 緊急
===============================================

Internet Information Services 用の累積的な修正プログラム (319733)
-----------------------------------------------------------------

公開日: 2002年4月10日 | 最終更新日: 2002年5月17日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Windows NT® 4.0、Windows® 2000、または Windows XP を使用して Web サーバーをホストしているお客様

**脆弱性の影響** **:**
10 個の新しい脆弱性。最も深刻な脆弱性については、攻撃者の選択したコードがサーバーで実行される可能性があります

**推奨する対応策** **:**
影響を受ける製品を使用しているお客様は、直ちにこの更新プログラムをインストールして下さい。

**最大深刻度** **:**
高

**影響を受けるソフトウェア** **:**

-   Microsoft Internet Information Server 4.0
-   Microsoft Internet Information Services 5.0
-   Microsoft Internet Information Services 5.1

**注** **:**
Windows Server 2003 の ビルド 3605 以降のベータ版は IIS 6.0 に影響を及ぼすすべての脆弱性に対する修正を含んでいます。「よく寄せられる質問」 で説明されているように、マイクロソフトは、即時の対処を行うために、運用環境で Windows Server 2003 ベータ バージョンを使用している少数のお客様に直接対応しています。

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
この更新プログラムは累積的な更新プログラムで、Windows NT 4.0 [Service Pack 6a](http://www.microsoft.com/japan/ntserver/downloads/sp6a.mspx) 以降の IIS 4.0 用にリリースされたすべての更新プログラムの機能、そして現在までにリリースされた IIS 5.0 および 5.1 用のすべてのセキュリティ上の更新プログラムを含んでいます。この更新プログラムに含まれる過去の更新プログラムの一覧を下記の 「更新プログラムに関する追加情報」 欄に示します。この更新プログラムを適用する前に、システム管理者は同じ欄にある 「警告」 の説明をご覧下さい。
この更新プログラムは以前リリースされたすべての更新プログラムを含むとともに、新しく確認された IIS 4.0、5.0 または 5.1 に影響を及ぼす次のセキュリティ上の脆弱性を排除する更新プログラムも含みます。

-   IIS 4.0 および 5.0 の Active Server Page によるチャンクされたエンコード転送メカニズムの操作に関連するバッファのオーバーランの脆弱性。攻撃者はこの脆弱性を利用し、システムのヒープ メモリをオーバーランさせ、IIS のサービスを異常終了させる、またはサーバーでコードを実行する可能性があります。
-   以前の脆弱性に関連した ASP データ転送メカニズムに存在するマイクロソフトが確認した脆弱性。これは前述の脆弱性と同じように利用される可能性があり、同じ影響の範囲があります。しかし、これは IIS 4.0、5.0 および 5.1 に影響を及ぼします。
-   特定の場合に IIS 4.0、5.0 および 5.1 が HTTP ヘッダー情報を処理する方法に関連するバッファのオーバーランの脆弱性。IIS は HTTP ヘッダーのフィールドを解析する前にセーフティ チェックを行い、予期されている区切り文字フィールドが適した場所に存在することを確認します。しかし、このチェックを回避することが可能で、区切り文字が存在していなくても、存在しているように IIS に認識させることができます。この問題により、攻撃者は HTTP ヘッダー フィールドの値が、それらを処理するために使用されるバッファをオーバーランさせる URL を作成する可能性があります。
-   サーバー側インクルード中に実行されるセーフティ チェックのエラーが原因となり発生する、マイクロソフトが確認した IIS 4.0、5.0 および 5.1 に存在する脆弱性。ユーザーの Web ページへのリクエストは、ファイルを ASP スクリプトに含め、それを処理することにより、適切に処理される場合があります。インクルード リクエストを処理する前に、IIS は、ファイル名が有効であり、静的なバッファに適合する適切なサイズであることを確認するようにデザインされている操作を、ユーザー特有のファイル名で実行します。しかし、極端に長い偽のファイル名を提供し、セーフティ チェックを通り抜け、バッファをオーバーランさせることができる場合があります。
-   IIS 4.0 および 5.0 の HTR ISAPI エクステンションに影響を及ぼすバッファのオーバーラン。一連の不正な HTR リクエストを送ることにより、IIS サービスを異常終了させるか、または特殊なリクエストにより最悪の場合には、コードをサーバーで実行される可能性があります。
-   IIS 4.0、5.0 および 5.1 が ISAPI フィルタからのエラー状況を処理する方法に関連するサービス拒否の脆弱性。少なくとも 1 つの ISAPI フィルタ (これは FrontPage Server Extensions および ASP.NETの一部として同梱されています。) と、場合によってはそのほかの要素が、フィルタによって設定された最大の長さを超える URL を含むリクエストが受信されると、エラーを生成します。このエラーを処理している間、フィルタは URL を Null 値と置き換えます。リクエストを行ったユーザーにエラー メッセージを送り返す間に IIS は URL を処理しようとしますが、これが IIS サービスを異常終了させる原因となるアクセス違反となるために問題が発生します。
-   IIS 4.0、5.0 および 5.1 の FTP サービスが状態リクエストを処理する方法に関連するサービス拒否の脆弱性。攻撃者が 影響を受けるサーバーとの FTP セッションを確立し、特定のエラー状態を作成する状態リクエストを行うことができる場合、FTP コードに存在する問題により、エラーが正しく報告されることが妨げられます。FTP サービスのそのほかのコードは初期化されていないデータを使用しようとし、これがアクセス違反の原因となります。これにより、FTP サービスだけでなく、Web サービスが中断される可能性があります。
-   IIS 4.0、5.0 および 5.1 に影響を及ぼす[クロスサイト スクリプティング](http://www.microsoft.com/japan/technet/archive/security/news/crssite.mspx) (CSS) の 3 つの脆弱性。1 つ目は IIS のヘルプ ファイルの検索結果ページに関連します。2 つ目は HTTP エラー ページに関連し、また、3 つ目はリクエストされた URL がリダイレクトされたことを通知するために戻されるエラー メッセージに関連します。これらのすべての脆弱性には同じ影響と影響の範囲があります。攻撃者がユーザーに攻撃者の Web サイト上のリンクをクリックするように誘導することができる場合、スクリプトを含んでいるリクエストを IIS を実行している第三者の Web サイトを中継し、これにより第三者の Web サイトの応答 (依然としてスクリプトを含んでいます。) がそのユーザーに送信される場合があります。スクリプトは攻撃者の Web サイトのセキュリティ設定ではなく、第三者の設定を使用してレンダリングを行います。

**問題を緩和する要素** **:**
チャンクされたエンコード転送のバッファのオーバーラン

-   既定の IIS 5.0 および 5.1のインストールでは、この脆弱性を利用してコードが実行された場合、攻撃者は対話的にログオンしているユーザーと同等の特権のみを持つ IWAM\_&lt;コンピュータ名アカウント&gt;の特権を取得します。
-   この脆弱性を利用するためには、Active Server Page (ASP) がシステムで有効にされていることが必要となります。[IIS Lockdown ツール](http://technet.microsoft.com/ja-jp/library/dd362854.aspx) のバージョン 1.0 は既定で ASP を無効にします。現在のバージョン (バージョン 2.1) は、Static Web Server が選択されている場合、ASP を無効にします。
-   [URLScan](http://technet.microsoft.com/ja-jp/security/cc242650.aspx) ツールはチャンクされたエンコード リクエストを防ぐように設定することができます。このような設定が行われていれば、この脆弱性が利用されることはありません。

マイクロソフトが確認したチャンクされたエンコードのバッファのオーバーランの変種 :

-   この脆弱性は 「チャンクされたエンコード転送」 の 「問題を緩和する要素」 と全く同じ条件が適用されますが、この脆弱性に対する保護のために、URLScan ツールを使用することはできません。

HTTP ヘッダー処理のバッファのオーバーラン :

-   既定の IIS 5.0 および 5.1 のインストールでは、この脆弱性を利用してコードが実行された場合、攻撃者は対話的にログオンしているユーザーと同等の特権のみを持つ IWAM\_&lt;コンピュータ名&gt;アカウントの特権を取得します。
-   この脆弱性を利用するためには、Active Server Page (ASP) がシステムで有効にされていることが必要となります。[IIS Lockdown ツール](http://technet.microsoft.com/ja-jp/library/dd362854.aspx) のバージョン 1.0 は既定で ASP を無効にします。現在のバージョン (バージョン 2.1) は、Static Web Server が選択されている場合、ASP を無効にします。
-   [URLScan](http://technet.microsoft.com/ja-jp/security/cc242650.aspx) ツールの既定のルールセットにより、攻撃者がこの脆弱性を利用して行う可能性のある攻撃をサービス拒否のみに制限する見込みがあります。

ASP サーバー側インクルード機能のバッファのオーバーラン :

-   既定の IIS 5.0 および 5.1のインストールでは、この脆弱性を利用してコードが実行された場合、攻撃者は対話的にログオンしているユーザーと同等の特権のみを持つ IWAM\_&lt;コンピュータ名&gt;アカウントの特権を取得します。
-   この脆弱性を利用するためには、Active Server Page (ASP) がシステムで有効にされていることが必要となります。[IIS Lockdown ツール](http://technet.microsoft.com/ja-jp/library/dd362854.aspx) のバージョン 1.0 は既定で ASP を無効にします。現在のバージョン (バージョン 2.1) は、Static Web Server が選択されている場合、ASP を無効にします。
-   [URLScan](http://technet.microsoft.com/ja-jp/security/cc242650.aspx) ツールの既定のルールセットにより、攻撃者がこの脆弱性を利用して行う可能性のある攻撃をサービス拒否のみに制限する見込みがあります。

HTR ISAPI エクステンションのバッファのオーバーラン :

-   マイクロソフトは長い間 HTR ISAPI エクステンション を無効にすることを推奨してきました。これが無効にされているシステムはこの脆弱性による危険にさらされません。(すべてのバージョンの [IIS Lockdown ツール](http://technet.microsoft.com/ja-jp/library/dd362854.aspx)は既定で HTR サポートを無効にします。)
-   [URLScan](http://technet.microsoft.com/ja-jp/security/cc242650.aspx) ツールは、その既定のルールセットを使用していれば、HTR サポートが有効になっている場合でも、この脆弱性が利用されることを防ぎます。
-   この脆弱性は、攻撃者がメモリ内の特定の情報の場所を知っている場合、サーバーでコードを実行するために使用される可能性があります。実際には、これが発生する可能性が最も高い状況は、Web サーバーが、再起動されているため、何の Web コンテンツも提供していない場合です。そのほかの場合では、単にサービス拒否攻撃を行うためにこの脆弱性が利用されます。
-   既定の IIS 5.0 および 5.1 のインストールでは、この脆弱性を利用してコードが実行された場合、攻撃者は対話的にログオンしているユーザーと同等の特権のみを持つ IWAM\_&lt;コンピュータ名&gt;アカウントの特権を取得します。
-   この脆弱性がサービス拒否攻撃で使用される場合、IIS 4.0 サーバーで通常の操作は IIS サービスを再起動することにより、復元することができます。また、IIS 5.0 およびそれ以降のバージョンでは、サービスは自動的に再起動します。

URL エラー処理のアクセス違反 :

-   IIS 4.0 サーバーはサービスを再起動することにより、通常の操作に戻すことができます。IIS 5.0 または 5.1 サーバーは自動的にサービスを再起動します。
-   この脆弱性はサービス拒否攻撃のみに使用することができます。この脆弱性を利用して、システムの特権を取得することはできません。
-   アクセス違反が発生した場合のエラーを生成すると理解されている唯一の ISAPI フィルタは FrontPage Server Extensions および ASP.NET の一部としてのみ同梱されています。ASP.NET は既定ではインストールされません。また FrontPage Server Extensions はアンインストールすることもできます。

FTP 状態リクエストによるサービス拒否 :

-   [IIS Lockdown ツール](http://technet.microsoft.com/ja-jp/library/dd362854.aspx)は既定で FTP サポートを無効にします。
-   IIS 4.0 サーバーはそのサービスを再起動することにより、通常の操作に戻すことができます。IIS 5.0 または 5.1 サーバーは自動的にサービスを再起動します。
-   この脆弱性はサービス拒否攻撃のみに使用することができます。この脆弱性を利用して、システムの特権を取得することはできません。

IIS ヘルプ ファイル検索機能、HTTP エラー ページ、およびリダイレクト応答のメッセージのクロスサイト スクリプティング :

-   この脆弱性は攻撃者がユーザーを Web サイトを訪問し、そのリンクをクリックする、または HTML 形式の電子メールを開くように誘導することができる場合のみ、利用することができます。
-   リダイレクト応答の脆弱性はユーザーが Internet Explorer 以外のブラウザを実行している場合のみ、利用することができます。Internet Explorer は実際にはリダイレクト応答のテキストをレンダリングしませんが、その応答ヘッダーにより、それを認識し、何のテキストも表示せずにリダイレクトを処理します。

**深刻度** **:**
ASP のチャンクされたエンコード データ転送メカニズムのバッファのオーバーラン :

|             | インターネット サーバー | イントラネット サーバー | クライアント システム |
|-------------|-------------------------|-------------------------|-----------------------|
| **IIS 4.0** | 高                      | 高                      | なし                  |
| **IIS 5.0** | 高                      | 高                      | なし                  |
| **IIS 5.1** | なし                    | なし                    | なし                  |

マイクロソフトが確認した ASP のチャンクされたエンコードのバッファのオーバーランの変種 :

|             | インターネット サーバー | イントラネット サーバー | クライアント システム |
|-------------|-------------------------|-------------------------|-----------------------|
| **IIS 4.0** | 高                      | 高                      | なし                  |
| **IIS 5.0** | 高                      | 高                      | なし                  |
| **IIS 5.1** | 高                      | 高                      | なし                  |

HTTP ヘッダー処理のバッファのオーバーラン :

|             | インターネット サーバー | イントラネット サーバー | クライアント システム |
|-------------|-------------------------|-------------------------|-----------------------|
| **IIS 4.0** | 高                      | 高                      | なし                  |
| **IIS 5.0** | 高                      | 高                      | なし                  |
| **IIS 5.1** | 高                      | 高                      | なし                  |

ASP サーバー側インクルード機能のバッファのオーバーラン :

|             | インターネット サーバー | イントラネット サーバー | クライアント システム |
|-------------|-------------------------|-------------------------|-----------------------|
| **IIS 4.0** | 高                      | 高                      | なし                  |
| **IIS 5.0** | 高                      | 高                      | なし                  |
| **IIS 5.1** | 高                      | 高                      | なし                  |

HTR ISAPI エクステンションのバッファのオーバーラン :

|             | インターネット サーバー | イントラネット サーバー | クライアント システム |
|-------------|-------------------------|-------------------------|-----------------------|
| **IIS 4.0** | 中                      | 中                      | なし                  |
| **IIS 5.0** | 中                      | 中                      | なし                  |
| **IIS 5.1** | なし                    | なし                    | なし                  |

URL エラー処理のアクセス違反 :

|             | インターネット サーバー | イントラネット サーバー | クライアント システム |
|-------------|-------------------------|-------------------------|-----------------------|
| **IIS 4.0** | 中                      | 中                      | なし                  |
| **IIS 5.0** | 中                      | 中                      | なし                  |
| **IIS 5.1** | 中                      | 中                      | なし                  |

FTP 状態リクエストによるサービス拒否 :

|             | インターネット サーバー | イントラネット サーバー | クライアント システム |
|-------------|-------------------------|-------------------------|-----------------------|
| **IIS 4.0** | 中                      | 中                      | なし                  |
| **IIS 5.0** | 中                      | 中                      | なし                  |
| **IIS 5.1** | 中                      | 中                      | なし                  |

IIS ヘルプ ファイル検索機能のクロスサイト スクリプティング :

|             | インターネット サーバー | イントラネット サーバー | クライアント システム |
|-------------|-------------------------|-------------------------|-----------------------|
| **IIS 4.0** | なし                    | なし                    | 中                    |
| **IIS 5.0** | なし                    | なし                    | 中                    |
| **IIS 5.1** | なし                    | なし                    | 中                    |

HTTP エラー ページのクロスサイト スクリプティング :

|             | インターネット サーバー | イントラネット サーバー | クライアント システム |
|-------------|-------------------------|-------------------------|-----------------------|
| **IIS 4.0** | なし                    | なし                    | 中                    |
| **IIS 5.0** | なし                    | なし                    | 中                    |
| **IIS 5.1** | なし                    | なし                    | 中                    |

リダイレクト応答メッセージのクロスサイト スクリプティング :

|             | インターネット サーバー | イントラネット サーバー | クライアント システム |
|-------------|-------------------------|-------------------------|-----------------------|
| **IIS 4.0** | なし                    | なし                    | 低                    |
| **IIS 5.0** | なし                    | なし                    | 低                    |
| **IIS 5.1** | なし                    | なし                    | 低                    |

上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。

**脆弱性識別番号** **:**

-   チャンクされたエンコード メカニズムのバッファのオーバーラン : [CAN-2002-0079](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0079)
-   マイクロソフトが確認したチャンクされたエンコードのバッファのオーバーランの変種 : [CAN-2002-0147](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0147)
-   HTTP ヘッダー処理のバッファのオーバーラン : [CAN-2002-0150](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0150)
-   ASP サーバー側インクルード機能のバッファのオーバーラン : [CAN-2002-0149](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0149)
-   HTR ISAPI エクステンションのバッファのオーバーラン : [CAN-2002-0071](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0071)
-   URL エラー処理のアクセス違反 : [CAN-2002-0072](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0072)
-   FTP 状態リクエストによるサービス拒否 : [CAN-2002-0073](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0073)
-   IIS ヘルプ ファイル検索機能のクロスサイト スクリプティング : [CAN-2002-0074](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0074)
-   HTTP エラー ページのクロスサイト スクリプティング : [CAN-2002-0148](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0148)
-   リダイレクト応答メッセージのクロスサイト スクリプティング : [CAN-2002-0075](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0075)

**テストしたバージョン** **:**
下の表は、現在サポートされている IIS のバージョンのこの脆弱性による影響を示しています。IIS 4.0 より前のバージョンは[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。IIS 6.0 はベータ製品であり、運用システムにおいての使用を意図していません。少数のお客様がマイクロソフトとの共同プログラムの一部として、IIS 6.0 を運用環境で展開しています。このようなお客様には直接、更新プログラムを提供する予定です。

|                                                                                    | IIS 4.0  | IIS 5.0  | IIS 5.1  |
|------------------------------------------------------------------------------------|----------|----------|----------|
| **チャンクされたエンコードメカニズムのバッファのオーバーラン**                     | 影響あり | 影響あり | 影響なし |
| **チャンクされたエンコードのバッファのオーバーランのマイクロソフトが確認した変種** | 影響あり | 影響あり | 影響あり |
| **HTTP** **ヘッダー処理のバッファのオーバーラン**                                  | 影響あり | 影響あり | 影響あり |
| **ASP** **サーバー側インクルード機能のバッファのオーバーラン**                     | 影響あり | 影響あり | 影響あり |
| **HTR ISAPI** **エクステンションのバッファのオーバーラン**                         | 影響あり | 影響あり | 影響なし |
| **URL** **エラー処理のアクセス違反**                                               | 影響あり | 影響あり | 影響あり |
| **FTP** **状態リクエストによるサービス拒否**                                       | 影響あり | 影響あり | 影響あり |
| **IIS** **ヘルプファイル検索機能のクロスサイトスクリプティング**                   | 影響なし | 影響あり | 影響あり |
| **HTTP** **エラーページのクロスサイトスクリプティング**                            | 影響あり | 影響あり | 影響あり |
| **リダイレクト応答メッセージのクロスサイトスクリプティング**                       | 影響あり | 影響あり | 影響あり |

よく寄せられる質問
------------------

<span></span>
**この更新プログラムによって排除される脆弱性はどれですか?**

この更新プログラムを適用すると Internet Information Server (IIS) 4.0 に影響を及ぼすほとんどのセキュリティ上の脆弱性と （例外は 「警告」 の欄に一覧されています。） Internet Information Service 5.0 および 5.1 に影響を及ぼすすべての脆弱性が排除されます。この更新プログラムは以前に説明した脆弱性だけでなく、新たに確認された脆弱性も排除します。

-   攻撃者が IIS 4.0 または 5.0 を実行している Web サーバーを制御することができる可能性がある脆弱性
-   以前の脆弱性と同じ危険性と影響を及ぼすが、IIS 4.0、5.0、5.1 に影響を及ぼすマイクロソフトによって発見された脆弱性
-   攻撃者が IIS 4.0 または 5.0 を実行している Web サーバーを制御することができる可能性がある脆弱性
-   攻撃者が IIS 4.0、5.0 または 5.1 を実行している Web サーバーを制御することができる可能性がある、マイクロソフトが確認した脆弱性
-   特殊な状況下において、攻撃者が IIS 4.0 または 5.0 を実行している Web サーバーを制御することができる可能性がある脆弱性
-   攻撃者が IIS 4.0、5.0 または 5.1 の Web サーバーのサービスの提供を妨害する可能性がある脆弱性
-   攻撃者が IIS 4.0、5.0 または 5.1 サーバー上の FTP サーバーのサービスの提供を妨害する可能性がある脆弱性
-   攻撃者が、IIS 4.0、5.0 または 5.1 の Web サーバーを介して、Web コンテンツを別のユーザーのブラウザ セッションに "中継する" ことができる可能性がある脆弱性

**IIS 4.0、5.0** **および** **5.1** **は、どの製品に同梱されていますか?**

-   Internet Information Server 4.0 は Windows NT 4.0 Option Pack (NTOP) の一部として出荷されます。
-   Internet Information Service 5.0 は Windows 2000 Datacenter Server、Advanced Server、Server および Professional の一部として出荷されます。
-   Internet Information Service 5.1 は Windows XP Professional の一部として出荷されます。Windows XP Home Edition には同梱されていません。

**IIS 4.0、5.0** **および** **5.1** **は既定で実行されますか?**

-   IIS 4.0 は NTOP が Windows NT 4.0 サーバーにインストールされている場合、既定で実行されます。IIS 4.0 は NTOP が Windows NT 4.0 workstation にインストールされ、そのインストール時に Peer Web Services が既に実行されていなかった場合には既定で実行されません。
-   IIS 5.0 は既定ですべての Windows 2000 サーバー製品上で実行されます。Windows 2000 Professional では既定で実行されません。
-   IIS 5.1 は Windows XP では既定で実行されません。

**この更新プログラムには、ほかの修正が含まれますか?**

はい、含まれます。上記で説明しているセキュリティ上の脆弱性の排除に加え、この更新プログラムにはセキュリティ上の脆弱性以外の問題に対する更新プログラムも含まれています。詳細はマイクロソフト サポート技術情報 319733 をご覧ください。

**これらの脆弱性の中には影響がある** **IIS** **のバージョンと影響がないバージョンがあるとのことですが、実行しているバージョンに更新プログラムが必要かどうかはどのようにして判断しますか?**

影響を受ける製品のいずれかを実行している場合、更新プログラムをインストールする必要があります。更新プログラムは実行しているバージョンの IIS に影響を及ぼす脆弱性に対する修正のみに適用します。

**最新の更新プログラムを適用するほかに、Web** **サーバーをセキュリティで保護するための手順はありますか?**

Web サーバーをセキュリティで保護する最も重要な方法は、IIS Lockdown ツールを使用することです。IIS Lockdown ツールを使用することにより、確実にサーバーの構成を保護します。また、[URLScan](http://technet.microsoft.com/ja-jp/security/cc242650.aspx) ツールがインストールされ、サーバーの実行中も常に保護されている状態にします。
さらに、ソフトウェアの更新プログラムでは排除することができない IIS 4.0 に影響を及ぼす脆弱性がいくつかあります。この脆弱性を排除するには管理者の操作が必要となります。このような脆弱性はすべて 「警告」 の欄で一覧できます。

**これらの更新プログラムは** **Personal Web Server** **または** **Peer Web Services** **を実行しているシステムにインストールすることができますか?**

できる場合とできない場合があります。Personal Web Server または Peer Web Services を実行している場合、マイクロソフト サポート技術情報 [307439](http://support.microsoft.com/kb/307439) で詳細情報をご覧ください。

**これらの脆弱性に関連して** **IIS 6.0** **の説明がないのはなぜですか?**

セキュリティ情報では、通常ベータ製品に触れることはありません。ベータ製品とは、定義上は完成していない製品であり、評価用であるため運用システムで使用すべきではありません。マイクロソフトと提携して IIS 6.0 の運用環境での展開に携わっている少数のお客様には、更新プログラムを直接提供しています。

**チャンクエンコーディング転送のバッファのオーバーラン** **(CVE-CAN-2002-0079)**
**どのようなことが起こる可能性がありますか?**

これは IIS 4.0 および 5.0 に影響を及ぼす[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者は綿密に選択したリクエストを該当の Web サーバーに送信することによって、Web サービスを妨害するか、またはサーバーでプログラムを実行する可能性があります。このようなプログラムは、IIS 4.0 では完全なシステム権限で実行され、IIS 5.0 では、より少なくなりますが、重要な権限で実行される可能性があります。
[IIS Lockdown ツール](http://technet.microsoft.com/ja-jp/library/dd362854.aspx)を使用してサーバーを静的な Web サーバーとして構成したお客様は、この脆弱性からすでに保護されています。同様に、[URLScan](http://technet.microsoft.com/ja-jp/security/cc242650.aspx) ツールを設定し、この脆弱性をブロックすることができ、影響を受けるメカニズム自体を無効にすることができます。しかし、この脆弱性は深刻であるため、これらの手順に従った場合でも、すべてのお客様に更新プログラムをインストールすることを推奨します。

**何が原因で起こりますか?**

この脆弱性は、Active Server Pages (ASP) 機能を実装する ISAPI エクステンションの演算エラーによって発生します。具体的には、データをチャンク エンコーディングによって Web サーバーにアップロードすることができる機能にエラーがあり、IIS が入力されるデータを収容するバッファを誤ったサイズで割り当て、その結果、そのデータがバッファの最後をオーバーランさせる可能性があります。

**ISAPI** **エクステンションとは何ですか?**

ISAPI (Internet Services Application Programming Interface) は、Web 開発者が Web サーバーの新しいサービスを提供するカスタム コード により Web サーバーの機能を拡張することができる技術です。このコードは以下の 2 つの形式で実装することができます。

-   ISAPI フィルタ -- ISAPI を使用してサーバー上で発生するイベントに応答するダイナミック リンク ライブラリ （.dll）
-   ISAPI エクステンション -- ISAPI を使用して IIS で標準に提供される機能以外の Web 機能を提供するダイナミック リンク ライブラリ

この脆弱性の場合、影響を受けるコードは、Active Server Pages を介してスクリプトを実装する ISAPI エクステンションです。

**Active Server Pages** **とは何ですか?**

[Active Server Pages](http://msdn2.microsoft.com/en-us/default.aspx) (英語情報) (ASP) は、Web サーバーが Web アプリケーションを動的に生成することができる技術です。Active Server Pages はイメージ的には Web サーバー上にあり、ユーザーが ASP ページをリクエストすると、ASP ISAPI エクステンションがその ASP ページを処理し、HTML ページを生成し、そしてユーザーにそのページを送信する機能です。この場合の脆弱性は、本来 ASP 技術との関連性はありませんが、チャンク エンコーディングと呼ばれる標準のデータ転送オペレーションでのASP 実装に関連します。

**チャンクエンコーディングとは何ですか?**

Web サーバーでは、ユーザーからデータを受信することができる必要がある場合がよくあります。例えば、ある Web サーバーへの訪問者がフォームに記入し、それを送信する場合、サーバーがデータを処理するためにアップロードする必要があります。このような場合には、転送されるデータの量は事前に認識され、サーバーは適切なサイズのバッファを割り当てることができます。しかし、そのほかの場合においては、転送されるデータの量を事前に認識することができません。たとえば、アプリケーションの実行中にデータを生成する場合、そのアプリケーションが生成するデータの正確な量を予測する方法はない場合があります。
[HTTP プロトコルの仕様](http://www.rfc-editor.org/rfc/rfc2068.txt) (英語情報) により、チャンク エンコーディングとよばれるプロセスを介してこのようなデータを処理することができるようになります。チャンク エンコーディングでは、クライアントはチャンクと呼ばれる変更可能な量のデータを生成し、次に Web サーバーにチャンクのサイズの情報を渡し、チャンクを送ります。サーバーは、転送されるチャンクを収容するためのバッファを割り当て、そのチャンクを受け取り、処理します。クライアントは別のデータを生成し、そのデータをチャンクにまとめ、サーバーに送る動作を続けます。

**IIS 4.0** **および** **5.0** **がチャンクエンコーディングの送信方法の何が問題になっていますか?**

IIS 4.0 および 5.0 の Active Server Pages の実装に演算エラーがあり、送信されるチャンクに必要なバッファのサイズを誤って計算し、小さすぎるサイズのバッファを割り当ててしまいます。その結果、チャンクのデータがバッファの最後でオーバーラップし、システム メモリ中のほかのデータを上書きしてしまい、それにより IIS のオペレーションが変更される可能性があります。

**データはどのように上書きされますか?**

仕様上、クライアントではすべてのサイズのチャンクを指定することができます。サーバーが大きなサイズのチャンクを収容することができない場合、サーバーはクライアントにエラー メッセージを送信します。しかし、その演算エラーにより、誤ったサイズのバッファを割り当てるだけでなく、IIS 4.0 および 5.0 がチャンクのサイズの実際の制限を指定できなくなります。その結果、クライアントによりシステム上のほとんど、またはすべてのデータを上書きしてしまうチャンクが送信される可能性があります。
これはこの脆弱性がサーバーにこのような深刻な危険性を及ぼす主な理由となるため、非常に重要なポイントです。これはヒープ オーバーランとよばれる脆弱性の例です。ヒープ オーバーランの脆弱性は、システム メモリの動的な性質により、大抵の場合利用するのが困難または不可能です。サーバー上のデータは、時によって場所が変更するため、攻撃者が選択したプログラムやデータを上書きすることは困難になります。しかし、今回の場合、攻撃者はプログラムの場所を知る必要はなく、容易にシステム メモリの大部分を無差別に上書きできる可能性があります。

**攻撃者はこれにより何をすることができますか?**

攻撃者は、以下の 2 つのいずれかの目的でこの脆弱性を利用する可能性があります。

-   サービス妨害 ： 攻撃者はバッファをランダム データでオーバーランさせることにより、プログラム コードを妨害し、IIS のサービスを異常終了させる可能性があります。これにより、サーバーのサービスを提供できないようにする恐れがあります。
-   サーバーのオペレーションの変更 ： この攻撃により、綿密に選択したデータでバッファをオーバーランさせ、サーバーのプログラム コードを新しいプログラム コードで上書きし、サーバー ソフトウェアの機能を変更する可能性があります。

**誰がこの脆弱性を利用する可能性がありますか?**

影響を受けるサーバーとの Web セッションを確立できたユーザーは、すべてこの脆弱性を利用できる可能性があります。

**この脆弱性を利用して** **IIS** **のサービスを異常終了させた場合、通常のオペレーションを回復するためには何が必要ですか?**

IIS 4.0 では、管理者が IIS サービスを再起動する必要があります。IIS 5.0 では、サービスは自動的に再起動します。

**この脆弱性が** **IIS** **サービスを異常終了させるためのみに利用されるのはなぜですか?** **攻撃者がシステムメモリを無差別に上書きできた場合、サーバー上のすべてのメモリを上書して、オペレーティングシステム全体を異常終了させないのですか?**

Windows NT 4.0、Windows 2000 および Windows XP は*保護モード*で動作します。保護モードでは、プロセスが所有するメモリのセクションにのみ書き込むことができます。その結果、攻撃者がオペレーティング システム用のメモリに上書きすることはできません。

**この脆弱性を利用してサーバーソフトウェアのオペレーションを変更した場合、攻撃者は何をすることができますか?**

簡単に言うと、攻撃者のコードにより、ASP ISAPI エクステンション、ASP.DLL を呼び出すソフトウェアの権限を獲得できる可能性があります。攻撃者が獲得できる権限は、サーバーで使用されている IIS のバージョンによって異なります。

-   IIS 4.0 では、ASP.DLL は既定で、インプロセスで、つまりオペレーティング システム自体の一部として実行される IIS Service の一部として実行されます。その結果、既定の IIS 4.0 インストールでこの脆弱性を利用すると、攻撃者はサーバーを完全に制御できるようになる可能性があります。
-   IIS 5.0 では、ASP.DLL は既定で、Out-of-Process で実行されます。つまり、Web Application Manager と呼ばれる特別なユーザー アカウントのセキュリティ コンテキストで実行されます。（Web 管理者には、このアカウントが、コンピュータ名がサーバーの名前である IWAM\_&lt;コンピュータ名&gt;という名前のほうがより有名かもしれません。） このアカウントは IIS サービスよりもはるかに少ない権限しかありません。

**Web Application Manager** **はどのような権限がありますか?**

基本的には、Web Application Manager アカウントはサーバーに対話的にログオンできた高い権限を所有しないユーザーの権限と同じ権限があります。Web Application Manager アカウントで、攻撃者がサーバーの再構成、Security Account Manager データベースなどの重要なファイルへのアクセスなど、管理者の操作を実行することはできません。
しかし、これらの権限を使用して引き起こされる可能性がある被害を低く見積もらないことが重要です。これらの権限も、深刻な被害をもたらすために使用される恐れがあります。さらに深刻な場合、この脆弱性により攻撃者は別の攻撃を実行する足がかりを得て、別の権限を獲得しようとする恐れがあります。

**IIS 4.0** **を実行しています。ASP.DLL** **を** **Out-of-Process** **で実行するように設定することはできますか?**

はい、できます。マイクロソフトは、可能な限り IIS 4.0 の設定を ASP.DLL およびほかのコンポーネントを Out-of-Process で実行するように推奨しています。これはセキュリティを向上させるのみでなく、システムの安定性のためでもあります。しかし、Out-of-Process での実行に関連してパフォーマンスに不利な条件が発生します。

**Active Server Pages** **を使用していません。この機能をすべて無効にするとサーバーを保護することができますか?**

はい、できます。IIS Lockdown ツールのバージョン 1.0 では ASP が既定で無効にされます。[現在のバージョン](http://technet.microsoft.com/ja-jp/library/dd362854.aspx) (バージョン 2.1) により、多くのサーバー機能が提供されます。Static Web Server が選択されている場合、既定で ASP を無効にします。

**URLScan** **ツールをサーバーに展開しました。この脆弱性から保護されますか?**

既定では保護されません。しかし、チャンク エンコーディングのリクエストをブロックするルールを追加することができます。" URLScan.ini の \[DenyHeaders\] セクションに “Transfer-Encoding:” を読み取る入力をしてください。（注 ： クオーテーション マークは入力しないでください。“Encoding” の最後にはコロンが必要です。）

**この更新プログラムはどのようにこの脆弱性を排除しますか?**

この更新プログラムは脆弱性を発生させる演算エラーを排除します。

**マイクロソフトが確認したチャンクエンコーディングのバッファのオーバーランの変種** **(CVE-CAN-2002-0147)**
**どのようなことが起こる可能性がありますか?**

この脆弱性は影響の与える範囲、影響、回復方法において前述の脆弱性と同じです。以下の 2 つの明確な違いがあるのみです。

-   この脆弱性は、IIS の別のバージョンに影響を及ぼします。具体的には IIS 4.0、5.0 および 5.1 に影響を及ぼします。
-   この脆弱性は URLScan ツールでは回避することができません。

**何が原因で起こりますか?**

この脆弱性はデータ転送のバッファの割り当てに処理エラーがあるために発生します。前述の脆弱性と同様の機能と関連し、同じ影響を及ぼしますが、これらの 2 つの脆弱性には重要な違いがいくつかあります。

**この脆弱性と前述の脆弱性との違いは何ですか?**

主に 2 つの違いがあります。1 つ目は、IIS 5.1 は前述の脆弱性の影響は受けませんが、この脆弱性の影響は受けます。2 つ目は、前述の脆弱性とは異なり、この脆弱性は URLScan ツールで回避することができません。

**この脆弱性はどのように確認されましたか?**

マイクロソフトが前述の脆弱性の調査の際のコード検査中に、この脆弱性を確認しました。

**ASP** **サーバー側インクルード機能のバッファのオーバーラン** **(CVE-CAN-2002-0149)**
**どのようなことが起こる可能性がありますか?**

これは IIS 4.0、5.0 および 5.1 に影響を及ぼす[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者は綿密に選択したリクエストを該当の Web サーバーに送信することによって、Web サービスを妨害するか、またはサーバーでプログラムを実行できる可能性があります。このようなプログラムは、IIS 4.0 では完全なシステム権限で実行され、IIS 5.0 および 5.1 では、より少なくなりますが、重要な権限で実行される可能性があります。
[IIS Lockdown ツール](http://technet.microsoft.com/ja-jp/library/dd362854.aspx)を使用してサーバーを静的な Web サーバーとして構成したお客様は、この脆弱性からすでに保護されています。同様に、[URLScan](http://technet.microsoft.com/ja-jp/security/cc242650.aspx) ツールを既定のルールセットで設定した場合、この脆弱性を利用してサーバーを制御するのが困難になり、この脆弱性による影響をサービス拒否のみに軽減できる可能性があります。

**何が原因で起こりますか?**

この脆弱性は Active Server Pages のサーバー側インクルードを処理する機能に論理エラーがあるために発生します。このエラーの結果、この機能はある特定のバッファの指定されたサーバー側ファイルの名前を保存する際に、そのファイル名が実際はバッファより長い場合にも安全であると認識してしまいます。

**サーバー側ファイルインクルードとは何ですか?**

開発者は、ファイルをプログラムに組み込むことが必要になる場合が多くあります。例えば、既存のコードを再利用する場合などです。ファイル インクルードによって、それができるようになります。開発者は、プログラムにインクルードする必要があるファイルを指定し、ファイルのコンテンツがプログラムの一部として処理されるように、またそのタイミングを指定します。
ASP は、ほとんどのプログラミング言語と同様にファイル インクルードをサポートしています。ASP では、インクルードされたファイルは Web サーバー自体から送信されるため、サーバー側ファイル インクルードという名前で知られています。ASP スクリプトが実行されると、処理前のステップにより、ASP ISAP フィルタが結果を処理した後にすべてのファイル インクルードが処理されます。

**Web** **サイトへ訪問者は、サーバー側インクルードをリクエストすることができますか?**

いいえ、できません。Web サイトへの訪問者は ASP スクリプトの操作に関わることは実際にはできません。すべての処理はサーバー上で実行されます。しかし、ユーザーの操作によって、サーバー上でファイル インクルードを実行させる影響が及ぶ可能性があります。この脆弱性は、この場合の IIS のある特定の動作に関連します。

**IIS** **がサーバー側インクルードを処理する方法の何が問題になっていますか?**

ある特定の Web ページをリクエストすると、ASP スクリプトの処理の一部として含まれる場合があります。これにより、ユーザーの入力がバッファに送られ、IIS は入力が有効であるかを確認するように設計されているため、常に事前にチェックを行います。具体的には、IIS はファイル名が有効で、実行できる場合のみファイル名にある操作を実施します。
非常に長い、無効なファイル名を含むリクエストを、次の 2 つの影響が及ぶ方法で送信することが可能になるためにセキュリティ上の脆弱性が発生します。まず ASP ISAPI エクステンションが、ファイル名を ASP ファイルの一部として処理する必要があると認識し、サーバー側インクルードを実行します。2 番目に、その長いファイル名がセーフティ チェックを通り抜けます。結果として、ファイル名を格納するために割り当てられたバッファより長いファイル名により、ASP ファイルが処理される際にバッファ オーバーランが発生します。

**この脆弱性を利用して攻撃者は何ができますか?**

攻撃者は、以下の 2 つのいずれかの目的でこの脆弱性を利用する可能性があります。

-   サービス妨害 ： 攻撃者はバッファをランダム データでオーバーランさせることにより、プログラム コードを妨害し、IIS のサービスを異常終了させる可能性があります。これにより、サーバーのサービスを提供できないようにする恐れがあります。
-   サーバーのオペレーションの変更 ： この攻撃により、綿密に選択したデータでバッファをオーバーランさせ、サーバーのプログラム コードを新しいプログラム コードで上書きし、サーバー ソフトウェアの機能を変更する可能性があります。

**誰がこの脆弱性を利用する可能性がありますか?**

影響を受ける Web サーバーとのセッションを確立できたユーザーは、すべてこの脆弱性を利用できる可能性があります。

**この脆弱性を利用して** **IIS** **のサービスを異常終了させた場合、通常のオペレーションを回復するためには何が必要ですか?**

IIS 4.0 では、管理者が IIS サービスを再起動する必要があります。IIS 5.0 および 5.1 では、サービスは自動的に再起動します。

**サーバーソフトウェアの操作を変更するためにこの脆弱性が利用された場合、攻撃者は何をする可能性がありますか?**

この方法で使用された場合、攻撃者は上記で説明したものと同じ権限を獲得する可能性があります。

-   IIS 4.0 では、攻撃者は、サーバーを完全に制御できるようになる可能性があります。
-   IIS 5.0 および 5.1 では、攻撃者は Web Application Manager に関連する権限を獲得することができる可能性があります。基本的には、高い権限を所有しないユーザーと同様の権限です。

**IIS Lockdown** **ツールでサーバーを保護することができますか?**

Active Server Pages がサーバーで有効にされている場合にのみ、この脆弱性を利用される可能性があります。IIS Lockdown ツールのバージョン 1.0 では、既定で ASP を無効にします。[現在のバージョン](http://technet.microsoft.com/ja-jp/library/dd362854.aspx) (バージョン 2.1) により、多くのサーバー機能が提供されます。Static Web Server が選択されている場合、既定で ASP を無効にします。

**URLScan** **ツールでこの脆弱性からシステムを保護することはできますか?**

全面的に保護できるわけではありませんが、この脆弱性による影響の範囲を大幅に減少させることができます。既定で URLScan は ASCII 以外のデータを含むすべての URL をブロックします。これにより、攻撃者がサービスの異常終了を引き起こすのを防ぐことはできず、攻撃者は実質上すべてのデータでバッファをオーバーランさせ、目的を果たす恐れがあります。しかし、攻撃者は ASCII データのみを使用して有効な実行可能なコードを作成する必要があるため、サーバー ソフトウェアの操作を変更するためのこの脆弱性の利用を困難にする可能性があります。

**この脆弱性はどのように確認されましたか?**

セキュリティ レビュー中にマイクロソフトがこの脆弱性を確認しました。

**更新プログラムはどのようにこの脆弱性を排除しますか?**

この更新プログラムは、切り捨てのエラーを修正し、ここで問題になっている URL がその機能に渡されないようにします。

**HTTP** **ヘッダー処理のバッファのオーバーラン** **(CVE-CAN-2002-0150)**
**どのようなことが起こる可能性がありますか?**

これは IIS 4.0、5.0 および 5.1 に影響を及ぼす[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者は綿密に選択したリクエストを該当の Web サーバーに送信することによって、Web サービスを妨害するか、またはサーバーでプログラムを実行することができる可能性があります。このようなプログラムは、IIS 4.0 では完全なシステム権限で実行され、IIS 5.0 および 5.1 では、より少なくなりますが、重要な権限で実行される可能性があります。
[IIS Lockdown ツール](http://technet.microsoft.com/ja-jp/library/dd362854.aspx)を使用してサーバーを静的な Web サーバーとして構成したお客様は、この脆弱性からすでに保護されています。同様に、[URLScan](http://technet.microsoft.com/ja-jp/security/cc242650.aspx) ツールを既定のルールセットで設定した場合、この脆弱性を利用してサーバーを制御するのが困難になり、この脆弱性による影響をサービス拒否のみに軽減させることができる可能性があります。

**何が原因で起こりますか?**

この脆弱性は Active Server Pages が HTTP ヘッダー情報を解析する際に発生する問題のために起こります。初期チェックが行われ、情報を処理するためにバッファに移動させる前に必要な区切り文字が適切な場所に表示されていることを確認します。しかし、そのチェックが偽装され、その結果バッファ オーバーランが発生する可能性があります。

**HTTP** **ヘッダーとは何ですか?**

クライアントが Web サーバーにリクエストを送信する場合、そのリクエストに関する Web サーバー特有の情報を送ることが必要となります。例えば、リクエスト中のデータがフォーマットされる方法、クライアントが使用している Web ブラウザ、サーバーの動作などの情報を指定する必要があります。これらすべての情報は、リクエスト中の [HTTP ヘッダー](http://msdn2.microsoft.com/en-us/library/aa287673(vs.71).aspx) （英語情報） として知られるフィールドに指定されます。

**IIS** **が** **HTTP** **ヘッダーを処理する方法の何が問題になっていますか?**

IIS が HTTP リクエストを受け取ると、IIS はヘッダーを解釈し、必要な動作を実行するために解析を行います。ヘッダーの解析は、ヘッダーを構成部分で区切り、それぞれをバッファに送り、IIS は区切り文字によってそれぞれの部分が終了している場所を決定します。
IIS はこの動作を実行する前にチェックを行い、区切り文字が実際に表示され、リクエスト内の適した場所に存在することを確認します。しかし、ある特定の方法でリクエストを作成することにより、このチェックを偽装し、区切り文字が表示されていなくても、表示されているように IIS に認識させることができます。

**この結果セキュリティ上の脆弱性が発生するのはなぜですか?**

このチェックの目的は、IIS が設計された収容量以上の情報がバッファにコピーされないように確認することです。しかし、このチェックを偽装することにより、この保護をすり抜け、バッファ オーバーランが発生する可能性があります。
具体的には、攻撃者が HTTP ヘッダー フィールド内に大量のデータを含んだリクエストを送信したとします。通常は IIS は必要な区切り文字を含んでいないデータおよびフィールドが大きくバッファに適合しないデータを検知します。そして、そのようなリクエストを無効にします。しかし、リクエストがこの脆弱性を利用するように作成されていた場合、IIS はそのリクエストを適切であると認識し、フィールドをバッファにコピーし、その結果、バッファ オーバーランを発生させます。

**この脆弱性を利用して攻撃者は何ができますか?**

攻撃者は、以下の 2 つのいずれかの目的でこの脆弱性を利用する可能性があります。

-   サービス妨害 ： 攻撃者はバッファをランダム データでオーバーランさせることにより、プログラム コードを妨害し、IIS のサービスを異常終了させる可能性があります。これにより、サーバーのサービスを提供できないようにする恐れがあります。
-   サーバーのオペレーションの変更 ： この攻撃により、綿密に選択したデータでバッファをオーバーランさせ、サーバーのプログラム コードを新しいプログラム コードで上書きし、サーバー ソフトウェアの機能を変更する可能性があります。

**誰がこの脆弱性を利用する可能性がありますか?**

影響を受けるサーバーとの Web セッションを確立できたユーザーは、すべてこの脆弱性を利用することができる可能性があります。

**この脆弱性を利用して** **IIS** **のサービスを異常終了させた場合、通常のオペレーションを回復するためには何が必要ですか?**

IIS 4.0 では、管理者が IIS サービスを再起動する必要があります。IIS 5.0 および 5.1 では、サービスは自動的に再起動します。

**この脆弱性を利用してサーバーソフトウェアのオペレーションを変更した場合、攻撃者は何をすることができますか?**

この方法で使用された場合、攻撃者は上記で説明したものと同じ権限を獲得する可能性があります。

-   IIS 4.0 では、攻撃者は、サーバーを完全に制御できるようになる可能性があります。
-   IIS 5.0 および 5.1 では、攻撃者は Web Application Manager に関連する権限を獲得することができる可能性があります。基本的には、高い権限を所有しないユーザーと同様の権限です。

**IIS Lockdown** **ツールでサーバーを保護することができますか?**

Active Server Pages がサーバーで有効にされている場合にのみ、この脆弱性を利用される可能性があります。IIS Lockdown ツールのバージョン 1.0 では、既定で ASP を無効にします。[現在のバージョン](http://technet.microsoft.com/ja-jp/library/dd362854.aspx) (バージョン 2.1) により、多くのサーバー機能が提供されます。Static Web Server が選択されている場合、既定で ASP を無効にします。

**URLScan** **ツールでこの脆弱性からシステムを保護することはできますか?**

全面的に保護できるわけではありませんが、この脆弱性による影響の範囲を大幅に減少させることができます。既定で URLScan は ASCII 以外のデータを含むすべての URL をブロックします。これにより、攻撃者がサービスの異常終了を引き起こすのを防ぐことはできず、攻撃者は実質上すべてのデータでバッファをオーバーランさせ、目的を果たす恐れがあります。しかし、攻撃者は ASCII データのみを使用して有効な実行可能なコードを作成する必要があるため、サーバー ソフトウェアの操作を変更するためのこの脆弱性の利用を困難にする可能性があります。

**更新プログラムはどのようにこの脆弱性を排除しますか?**

この更新プログラムは、チェック メカニズムを修正し、すべての場合において適切なチェックが行われるようにします。

**HTR ISAPI** **エクステンションのバッファのオーバーラン** **(CVE-CAN-2002-0071)**
**この脆弱性でどのようなことが起こる可能性がありますか?**

これは IIS 4.0 および 5.0 に影響を及ぼす[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。該当の Web サーバーに特別に選択したリクエストを送信することにより、攻撃者は一時的に Web サービスの提供を停止することができる可能性があります。また、非常にまれなケースでは、サーバーを制御することができる場合もあります。
この脆弱性の深刻性を軽減する多くの要素があります。

-   この脆弱性の利用による影響で最も可能性の高いものは、Web サーバーのサービスを中断することです。この脆弱性を利用してサーバーを制御することはできますが、ほとんどの場合、これは攻撃者にとって、偶然の状況を必要とします。
-   この脆弱性を含むコンポーネントは [IIS Lockdown ツール](http://technet.microsoft.com/ja-jp/library/dd362854.aspx)により、既定で排除されます。
-   [URLScan](http://technet.microsoft.com/ja-jp/security/cc242650.aspx) ツールの既定の設定はこの脆弱性が利用されることを防ぎます。

**何が原因で起こりますか?**

この脆弱性は HTR スクリプトを実装する ISAPI エクステンションが、入力値を保存するため、バッファのサイズを計算する際、off-by-one エラーを含むために起こります。HTR スクリプトへのリクエストが特定の方法で不正な形式にされている場合、この計算間違いを悪用し、バッファのオーバーラン攻撃を行うことができる可能性があります。これにより、IIS サービスが異常終了する場合があります。また、最も深刻なケース (利用は困難ですが) では、サーバーでコードが実行される可能性があります。

**HTR** **とは何ですか?**

HTR とは IIS 2.0 の一部として提供された第一世代の高度なスクリプト技術です。HTR は広範囲に適用されることはありませんでしたが、この主な理由は、洗練されていない技術であったからです。Active Server Pages (ASP) は IIS 4.0 に導入され、お客様が莫大な開発リソースを HTR に費やす前に一般的になりました。しかし、バージョン 5.1 までのすべての IIS のバージョンは過去のバージョンとの互換性のため、HTR のサポートを提供しています。
マイクロソフトは長い間、お客様にこの技術に対するビジネス上の必須のニーズがない限り、Web サーバーの HTR を無効にすることを推奨してきました。既定で、[IIS Lockdown ツール](http://technet.microsoft.com/ja-jp/library/dd362854.aspx)は HTR ISAPI エクステンションをマップ解除することにより、HTR サポートを無効にします。

**HTR** **の使用は普及しているのですか?**

現在HTR 技術の実質的な唯一の使用用途は [Web ベースのパスワード管理サービス](http://support.microsoft.com/kb/184619)です。IIS は HTR スクリプトのセットを同梱しており、これが展開されると、ユーザーは Windows NT のパスワードを Web サーバーを介し変更することができます。また、管理者は Web を介しパスワードの管理を行うことができます。
一般的に、マイクロソフトは Web でパスワードの管理を行わないことを推奨します。しかし、これを行う必要のあるお客様は必要な HTR スクリプトを ASP に変換することを推奨します。

**HTR ISAPI** **エクステンションの何が問題になっていますか?**

HTR ISAPI エクステンションがスクリプトを実行するためのリクエストを受けると、そのリクエストを含むために必要なバッファのサイズを計算します。しかし、HTR ISAPI エクステンションはこの値を間違って計算し、その結果、必要であるよりも 1 バイト小さいバッファを作成します。特定の方法で不正な形式にされた一連の HTR リクエストを送ることにより、この脆弱性を利用してサーバーのメモリを上書きする可能性があります。

**この脆弱性により、攻撃者は何をすることができますか?**

攻撃者はこの脆弱性を次の 2 通りに利用することができます。ランダムなデータで単にバッファをオーバーランさせる一連のリクエストを送ることにより、攻撃者はサーバーを異常終了させる可能性があります。しかし、データを綿密に選択することにより、操作上困難ですが、攻撃者の選択したタスクを実行するように IIS サービスの操作を変更する可能性があります。

**攻撃者がこの脆弱性を利用してサービスを異常終了させる場合、どのような結果が生じますか?**

IIS 4.0 サーバーに対し、この脆弱性が利用された場合、管理者が IIS サービスを再起動するまで、攻撃により、サーバーが Web リクエストを処理することが妨害されます。IIS 5.0 または 5.1 サーバーに対し、この脆弱性が利用された場合、IIS サービスは自動的にサービスを再起動するため、中断は一時的なものです。いずれの場合でも、サービスの異常終了時に進行中であった Web セッションは終了されます。

**攻撃者がこの脆弱性を利用してサービスの操作を変更した場合、どのような結果が生じますか?**

サービスの操作を変更するために利用された場合、攻撃者は上記で説明したように同じ特権を取得する可能性があります。

-   IIS 4.0 では、攻撃者はサーバーを完全に制御する可能性があります。
-   IIS 5.0 では、攻撃者は Web Application Manager に関連する特権を取得する可能性があります。本質的には、これは高い特権を持たないユーザーの特権です。

**この脆弱性を利用してサーバーを制御することはどの程度困難ですか?**

上記で説明した脆弱性のように、これはヒープのオーバーランです。しかし、この脆弱性を利用することは、より困難です。例えば、技術的な観点から、1 バイトのヒープのオーバーランを利用するツールを作成することは、さらに困難となります。
ツールが利用可能であったとしても、この脆弱性は特定の状況でのみ利用することができます。実際には、サーバーが起動してから Web リクエストを全く処理していない場合にのみ、このような特定の状況が生じます。そして、サーバーで実行されているソフトウェアに関する特定の情報が攻撃者に必要となります。しかし、状況によっては、これらの要素を克服することは不可能ではないことに注意して下さい。

**IIS Lockdown** **ツールを実行しましたが、この問題の影響を受けますか?**

既定で、[IIS Lockdown ツール](http://technet.microsoft.com/ja-jp/library/dd362854.aspx)は HTR のサポートを無効にします。この脆弱性を HTR サポートが無効にされているサーバーに対し、利用することはできません。

**URLScan** **を実行していますが、この問題の影響を受けますか?**

URLScan の既定のルールセットは、サーバーがこの脆弱性の影響を受ける製品であっても、この脆弱性が利用されることを防ぎます。URLScan は保護を行いますが、マイクロソフトは HTR が有効にされているすべてのサーバーにこの更新プログラムを適用することを推奨します。

**この脆弱性の影響を受ける疑いのあるシステムを実行していますが、何をすべきですか?**

最善の対策として、HTR ISAPI エクステンションのマップ解除を行うことにより、HTR サポートをすべて削除して下さい。(これを行う最も簡単な方法は [IIS Lockdown ツール](http://technet.microsoft.com/ja-jp/library/dd362854.aspx)を使用することです。) マイクロソフトはビジネス上必須のニーズがある場合のみ、HTR サポートを保持することを推奨します。
HTR を削除した後でも、マイクロソフトはこの更新プログラムを適用することを推奨します。まず、この更新プログラムはこの脆弱性とともに、そのほかの脆弱性も修正します。また、この更新プログラムの適用により、不注意のため HTR サポートが再度有効にされた場合でも、サーバーは依然として保護されていることを確実にします。

**更新プログラムはどのようにこの脆弱性を排除するのですか?**

この更新プログラムは HTR ISAPI エクステンションの計算間違いを修正し、受信するリクエストのサイズに適合するバッファを割り当てるようにします。

**URL** **エラー処理のアクセス違反** **(CVE-CAN-2002-0072)**
**この脆弱性でどのようなことが起こる可能性がありますか?**

これは IIS 4.0、5.0 および 5.1 に影響を及ぼす[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。この脆弱性を利用することにより、攻撃者は一時的に Web サーバーが Web サービスを提供することを妨害する可能性があります。
この脆弱性を利用しても、システムのデータを侵害することはできません。また、攻撃者はシステムの特権を取得することはできません。そのほかの状況でもこの脆弱性が発生することもありますが、最近のマイクロソフトの調査では、Front Page Server Extensions (FPSE) または ASP.NET がシステムにインストールされている場合にのみ、この脆弱性が発生することが分かりました。

**何が原因で起こりますか?**

この脆弱性は Front Page Server Extensions および ASP.NET によりインストールされた ISAPI フィルタの 1 つが、許容される最大の長さを超える URL を受信した際、発生するエラー状態を正しく処理しないために起こります。この問題は IIS にロードされている、そのほかの ISAPI フィルタでも発生する可能性があります。最近のマイクロソフトの調査では、他の ISAPI フィルタで、この問題は見つかっておりません。

**ISAPI** **フィルタとは何ですか?**

上記で説明したように、ISAPI フィルタは Web サーバーを介し利用可能な機能を拡張するためにインストールされた .dll です。このケースで問題となっている特定のフィルタは、、FPSE および ASP.NET によりインストールされます。

**FPSE** **とは何ですか?**

FrontPage Server Extensions (FPSE) (英語情報) とは Web サーバーにインストールすることのできるツールのセットで、これにより、権限を与えられた人物がサーバーの管理、コンテンツの追加や変更、そしてそのほかのタスクを行うことができます。

**ASP.NET** **とは何ですか?**

[ASP.NET](http://msdn2.microsoft.com/en-us/ms348103.aspx) (英語情報) とは Web アプリケーションを容易に、かつ迅速に作成することのできる開発プラットフォームです。ASP.NET は ASP のスーパーセットと考えられています。これは既存の ASP プログラムを直接 ASP.NET へ移植することができるだけでなく、新しい拡張された機能も提供します。

**FPSE** **および** **ASP.NET** **の何が問題になっていますか?**

このケースでの問題は IIS が ISAPIフィルタにより生成される特定のエラー状態を処理する方法に関連しています。マイクロソフトが現在までに確認した限りでは、これは実際にエラー状態を生成し、FPSE および ASP.NET に関連するISAPI フィルタのみに発生します。しかし、根本的な問題は ISAPI フィルタではなく、IIS がエラー状態を処理する方法にあります。
エラー状態とは何でしょうか? また、なぜそのエラー状態が IIS サービスを異常終了させるのでしょうか? このケースでのエラーは ISAPI フィルタのいずれかが最大の長さを超える URL を含むリクエストを受信した場合に発生します。これが発生した場合、フィルタはリクエストを終了させ、URL を Null 値に設定します。この脆弱性は IIS が要求者に応答を返す前に、URL を使用しようとするために起こります。これにより、IIS サービスを異常終了させるアクセス違反が起こります。

**これにより、攻撃者は何をすることができますか?**

この脆弱性を利用して、攻撃者は IIS サービスを異常終了する可能性があります。これにより、進行中であったセッションが終了され、サーバーが再起動されるまで、新しいセッションが妨げられます。

**攻撃者はどのようにしてこの脆弱性を利用するのですか?**

攻撃者は上記で挙げられた ISAPI フィルタのいずれかにより処理されるリクエストをこの脆弱性の影響を受けるサーバーに送る、またはフィルタに対して最大の長さを超える URL を含めることにより、この脆弱性を利用する可能性があります。(同様に、そのほかの ISAPI フィルタが同じエラー状態を生成しうる場合、攻撃者はリクエストをそのいずれかに送る可能性があります。)

**通常の操作を再開するためには何が必要ですか?**

IIS 4.0 では、オペレータはサービスを再起動する必要があります。IIS 5.0 または 5.1 では、サービスは自動的に再起動します。

**この脆弱性を利用して、攻撃者はサーバーのそのほかの特権を取得することができますか?**

いいえ、できません。これは全くのサービス拒否の脆弱性です。この脆弱性を利用して、サーバーのコンテンツの変更、管理、またはそのほかの操作を行うことはできません。

**使用中のサーバーに** **FPSE** **をインストールしていませんが、この脆弱性の影響を受ける可能性はありますか?**

Server Extensions の中には既定で IIS 4.0、5.0 および 5.1 の一部としてインストールされるものもあり、また別途インストールしなければならないものもあります。ここで問題となっている ISAPI フィルタは既定でインストールされるため、管理者が FPSE を削除していない限り、サーバーはこの脆弱性の影響を受けます。(FPSE は \[コントロール パネル\] の \[プログラムの追加と削除\] アプレットを介し削除することができます。) FPSE が削除されていても、IIS を異常終了させるエラー状態を生成するそのほかの ISAPI フィルタがサーバーにインストールされている可能性があることに注意して下さい。

**使用中のサーバーに** **ASP.NET** **をインストールしていませんが、この脆弱性の影響を受ける可能性はありますか?**

ASP.NET は既定で IIS の一部としてインストールされません。しかし、ASP.NET がシステムにインストールされていなくても、前述のように FPSE が存在する場合もあります。

**更新プログラムはこの脆弱性をどのように排除するのですか?**

この更新プログラムは IIS がここで問題となっているエラーを処理する時に URL をチェックするようにし、またそれを処理しないようにします。

**FTP** **状態リクエストによるサービス拒否** **(CVE-CAN-2002-0073)**
**この脆弱性でどのようなことが起こる可能性がありますか?**

これは IIS 4.0、5.0 および 5.1 に影響を及ぼす[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。この脆弱性を利用して、攻撃者は一時的に Web サーバーが Web サービスを提供することを妨害する可能性があります。
この脆弱性は FTPサービスを提供するように構成されている場合のみ、利用することができます。IIS 4.0 は FTP サービスを既定でインストールしますが、IIS 5.0 および 5.1 はインストールしません。既定で、[IIS Lockdown ツール](http://technet.microsoft.com/ja-jp/library/dd362854.aspx)は既定で FTP のサポートを無効にします。この脆弱性を利用しても、システムのデータを侵害することはできません。また、攻撃者はシステムの特権を取得することはできません。

**何が原因で起こりますか?**

IIS 4.0、5.0 および 5.1 の FTP の実装が、リクエストが特定の方法で不正な形式にされている場合、接続の状態のリクエストを正しく処理しないためにこの脆弱性が起こります。このようなリクエストを受信すると、IIS サービスが異常終了することがあります。

**FTP** **とは何ですか?**

File Transfer Protocol (FTP) とは業界標準プロトコル ([RFC 959](http://www.ietf.org/rfc/rfc959.txt) (英語情報) で指定されています。) で、これによりユーザーはファイルをサーバーに配置、またはサーバーからファイルを検索することができます。IIS のすべてのバージョンはこのプロトコルの実装を含みます。

**IIS 4.0、5.0** **および** **5.1** **の** **FTP** **実装の何が問題になっていますか?**

進行中の FTP 接続の状態リクエストを処理する方法に問題を含んでいます。具体的にはリクエストに特定の文字が含まれると、エラー状態を作成しますが、これが、ユーザーのリクエストを中継するソフトウェア モジュールに正しく報告されません。このため、呼び出しモジュールは初期化されていないデータを使用し、アクセス違反が発生します。

**これにより、攻撃者は何ができますか?**

FTP サービスは IIS サービス自体により提供されるため、この脆弱性を利用する攻撃者は FTP サービスだけでなく、Web サービスも中断させる可能性があります。これにより、攻撃時に進行していたすべてのセッションが終了します。

**誰がこの脆弱性を利用することができますか?**

この脆弱性の影響を受けるサーバーと FTP セッションを確立することができるユーザーであれば、この脆弱性を利用することができます。問題を含む状態リクエストはすでに存在しているセッションの一部としてのみ行うことができます。

**通常の操作を再開するためには何が必要ですか?**

IIS 4.0 サーバーでは、オペレータは IIS サービスを再起動する必要があります。IIS 5.0 および 5.1 サーバーでは、サービスは自動的に再起動します。

**攻撃者がサーバーとのセッションを確立することができる必要があることにどのような意味がありますか?**

攻撃者は 「セッションを確立せずに」 サーバーにデータを送信することはできないという意味です。FTP サービスが有効であり、実行されている必要があります。そして、攻撃者はログオン資格情報が必要であり、またはサーバーは匿名でログオンを許可するように構成されている必要があります。

**FTP** **は既定でインストールおよび実行されますか?**

IIS 4.0 の一部として有効であり、また実行されますが、IIS 5.0 または 5.1 ではそうではありません。既定で、[IIS Lockdown ツール](http://technet.microsoft.com/ja-jp/library/dd362854.aspx)は FTPを無効にします。

**FTP** **が実行されている場合、匿名ログオンは既定で有効ですか?**

はい、有効です。使用中の FTP サーバーへの匿名アクセスを許可したいかどうかを検討して下さい。匿名アクセスを許可したくない場合は、それを無効にして下さい。

**更新プログラムはどのようにこの脆弱性を排除しますか?**

この更新プログラムは FTP サービスがここで問題となっているコマンドを正しく処理するようにします。

**IIS** **ヘルプファイル検索機能、リダイレクト応答メッセージ、および** **HTTP** **エラーページのクロスサイトスクリプティング** **(CVE-CAN-2002-0074, 0075, 0148)**
**これらの脆弱性でどのようなことが起こる可能性がありますか?**

これらはすべてクロスサイト スクリプティングの脆弱性です。これらのすべての脆弱性による影響の範囲は同じです。これらの脆弱性により、攻撃者は、スクリプトを含む Web ページをそのほかのユーザーに送信する可能性があり、この脆弱性の影響を受けるサーバーにリクエストを送ることができる場合があります。スクリプトはユーザーのブラウザで、信頼している Web サイトからのものであるかのように実行されます。これにより、信頼している Web サイトに対し、適切なセキュリティ設定を使用してスクリプトが実行され、また攻撃者がその Web サイトに属すデータにアクセスすることができる可能性があります。
この脆弱性はユーザーが HTML 形式の電子メールを開く場合、または悪意のあるユーザーの Web サイトを訪問する場合 (コードは既存のセッションに 「挿入」 されません。) のみ、利用することができます。ここでの 2 つのケースのいずれかで、攻撃者がこの脆弱性を利用したとしても、Internet Explorer を使用しているユーザーには何の影響もありません。では、何がこの脆弱性の原因なのでしょうか? IIS により提供される特定の Web サービスは入力を使用する前に、そのすべての入力を適切に検証しません。このため、[クロスサイト スクリプティング](http://www.microsoft.com/japan/technet/archive/security/news/crssite.mspx) (CSS) の影響を受けます。

**クロスサイトスクリプティングとは何ですか?**

[CSS](http://www.microsoft.com/japan/technet/archive/security/news/crssite.mspx) とはセキュリティ上の脆弱性で、これにより悪意のあるユーザーがそのほかのユーザーの Web サイトとのセッションにコードを 「挿入」 する可能性があります。多くのセキュリティ上の脆弱性と異なり、CSS は単一のベンダーの製品に適用されません。Web サーバーで実行され、防御的なプログラミング対策を講じていないすべてのソフトウェアに影響を及ぼします。2000 年初旬、マイクロソフトおよび [CERT](http://www.cert.org/) (英語情報) は共同でソフトウェア業界にこの問題を知らせ、この問題に対する業界規模の応答を導きました。

**CSS** **はどのような仕組みなのですか?**

[クロスサイト スクリプティング のセキュリティ問題 概要](http://www.microsoft.com/japan/technet/archive/security/news/exsumcs.mspx) および[よく寄せられる質問](http://www.microsoft.com/japan/technet/archive/security/news/crsstfaq.mspx) に説明されています。しかし、高レベルの詳細をここで説明します。Web サイト A が検索機能を提供しており、これによりユーザーが検索したい語句を入力することができるとします。ユーザーが検索語句として “banana” と入力した場合、その Web サイトは語句を検索し、「“banana” という語句は見つかりませんでした。」 と表示する Web ページを生成します。この Web ページはユーザーのブラウザに送信され、ブラウザはその Web ページを解析し、表示します。
次に、検索語句として “banana” を入力する代わりに、ユーザーは “banana &lt;SCRIPT &gt; &lt;Alert(‘Hello’); &gt; &lt;/SCRIPT &gt;" のように入力するとします。検索機能が提供された検索語句が何であっても、それを使用するように書かれている場合、その文字列全体を検索し、「“banana &lt;SCRIPT &gt; &lt;Alert(‘Hello’); &gt; &lt;/SCRIPT &gt;” という語句は見つかりませんでした。」 と表示する Web ページを作成します。しかし、“&lt;SCRIPT &gt;” で始まり、“&lt;/SCRIPT &gt;” で終わるすべてのテキストは実際にはプログラム コードであり、その Web ページが処理されると、“Hello” というダイアログ ボックスがユーザーのブラウザにより表示されます。
ここまでの例で、ユーザーがコードを Web サーバーから 「中継」 し、それを自分のマシンで実行する方法について示しました。これはセキュリティ上の脆弱性ではありません。しかし、悪意のある Web サイト管理者は自分の Web サイトを訪問するユーザーのコンピュータでこの脆弱性を利用し、実行する可能性があります。Web サイト B が悪意のあるユーザーにより運営されているとします。悪意のあるユーザーが自分の Web サイトをユーザーに訪問させ、ハイパーリンクをクリックするように誘導する場合、Web サイト B は Web サイト A に接続し、検索ページに悪質なスクリプトを入力し、それをユーザーの代わりに送信する可能性があります。結果のページがユーザーに返され、 (そのユーザーはハイパーリンクをクリックしたため、要求者となります。) ユーザーのマシンで処理されます。

**スクリプトはユーザーのマシンで何をする可能性がありますか?**

Web サイト B (攻撃者の Web サイト) からのスクリプトはユーザーのマシンで Web サイト A からのものであるかのように実行されます。実際には、これには 2 つの意味があります。

-   Web サイト A に対し適切であるユーザーのマシンのセキュリティ設定を使用して実行されます。
-   Web サイト B からのスクリプトは Cookie および Web サイト A に属すユーザーのシステムのデータにアクセスすることができます。

**ユーザーが使用しているブラウザは問題になりますか?**

いいえ、問題にはなりません。ここで重要な点は、問題はブラウザではなく Web サーバーのソフトウェアに存在するということです。この脆弱性は提供された入力が何であっても使用する Web サーバーのソフトウェアにいつでも起こる可能性があります。適切でない入力はフィルタする必要があります。上記の例で、検索エンジンは “&lt;” or “&gt;” のような検索プロセスにスクリプトを挿入するために使用される文字を取り除く必要があります。サポート技術情報 [252985](http://support.microsoft.com/kb/252985) に、取り除く必要のある文字についての詳しい説明が掲載されています。

**IIS** **の何が問題になっていますか?**

IIS により提供される 3 つのサービスは入力を適切にフィルタしません。このため、クロスサイト スクリプティング攻撃で利用される可能性があります。

-   IIS ヘルプ ファイルを検索することができる検索機能。この機能は IIS 5.0 および 5.1 のみで提供されます。このため、これらのバージョンはこの脆弱性の影響を受けます。
-   新しい場所に移動された Web ページがリクエストされた場合に、返されるメッセージ。(このようなメッセージはリダイレクト応答として知られています。) IIS 4.0、5.0 および 5.1 により作成されるこのメッセージのバージョンは、攻撃の対象が Internet Explorer 以外のブラウザを実行している場合、この脆弱性の影響を受けます。
-   ユーザーの Web ページへのリクエストがエラーとなった場合に返されるいくつかのエラー メッセージ。IIS 4.0 および 5.0 で作成されるこれらのメッセージの既定のバージョンはこの脆弱性の影響を受けます。

**これらの脆弱性により、攻撃者は何をすることができますか?**

攻撃者は Web サイトを運営し、そのほかのユーザーにその Web サイトのリンクをクリックするよう誘導することができる場合、これらの脆弱性により、IIS を実行しているそのほかの Web サイトを介しクロスサイト スクリプティング攻撃を行う可能性があります。上記で説明したように、これにより攻撃者はそのほかの Web サイト (IIS を実行している Web サイト) のセキュリティ設定を使用するユーザーのブラウザでスクリプトを実行し、Cookie とそれに属すそのほかのデータにアクセスする可能性があります。

**上記では、これらの脆弱性の** **1** **つは、ユーザーが** **Internet Explorer** **以外のブラウザを使用している場合のみに利用することができるとのことでした。これはなぜですか?**

Web ページが移動された場合に返されるエラー メッセージのケースで、Internet Explorer は実際にエラー メッセージ内にテキストを表示しません。その代わり、サーバーの応答にある情報を処理し、即座にユーザーを新しい Web ページに接続します。このため、クロスサイト スクリプティングの影響を受けません。そのほかのブラウザに関しては、リダイレクト応答の処理の実装により、同じような仕組みであるものとそうでないものがあります。

**この脆弱性により、攻撃者は私の** **Web** **サイトに損害を与えることができますか?**

いいえ、できません。攻撃者はあなたの Web サイトに対し、何の操作も行うことはできません。しかし、あなたの Web サイトへの訪問者に対する攻撃において、無意識の共犯者として、あなたの Web サイトを利用することができる場合があります。

**攻撃のポイントは攻撃者が私の** **Web** **サイトのセキュリティ設定を使用するユーザーのブラウザでスクリプトを実行するとのことでしたが、これにより、攻撃者はどのようなことができるようになりますか?**

攻撃者の Web サイトおよびあなたの Web サイトが属している[セキュリティ ゾーン](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/zone_ovr.mspx) (英語情報) に基づき、Web サイトにより異なります。

-   両方の Web サイトが同じゾーンに属している場合 (ユーザーが移動しない限り、既定ですべての Web サイトがインターネット ゾーンに存在します)、これらは全く同じセキュリティ制限の対象となり、攻撃者はこの脆弱性を利用しても、何も取得できません。
-   ユーザーが攻撃者の Web サイトをあなたの Web サイトよりも制限の多いゾーンに設定している場合、攻撃者はあなたの Web サイトでの制限に基づきスクリプトを実行することができます。
-   ユーザーがあなたの Web サイトを攻撃者の Web サイトよりも制限の多いゾーンに設定している場合、攻撃者は実質的に攻撃能力を失います。

しかし、セキュリティ設定に関わらず、攻撃者のスクリプトは常に Cookie および第三者の Web サイトに属すユーザーのシステムのデータにアクセスすることができることに注意して下さい。ブラウザが認識する限りでは、攻撃者は第三者の Web サイトであるからです。

**更新プログラムはどのようにこの脆弱性を排除するのですか?**

この更新プログラムは上記で説明された両方のサービスが、入力を使用する前に、正しくその入力をフィルタするようにして、この脆弱性を排除します。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft IIS 4.0:
    -   Windows NT 4.0 Workstation、Windows NT 4.0 Server または Windows NT 4.0 Server、 Enterprise Edition :
        [http://download.microsoft.com/download/iis40/Patch/Q319733/NT4/JA/Q319733i.exe](http://download.microsoft.com/download/iis40/patch/q319733/nt4/ja/q319733i.exe)
    -   Windows NT 4.0 Server, Terminal Server Edition :
        Windows NT 4.0 Server, Terminal Server Edition [セキュリティ ロールアップ パッケージ](http://www.microsoft.com/japan/technet/archive/security/news/nt4tsesr.mspx)に含まれています。
-   Microsoft IIS 5.0:
    この問題に対する修正は Windows 2000 Service Pack 3 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。
    <http://www.microsoft.com/japan/windows2000/downloads/>
    なお、個別の更新プログラムは以下の Web サイトから入手できます。
    -   PC/AT 互換機用
        [http://download.microsoft.com/download/iis50/Patch/Q319733/NT5/JA/Q319733\_W2K\_SP3\_X86\_JA.exe](http://download.microsoft.com/download/iis50/patch/q319733/nt5/ja/q319733_w2k_sp3_x86_ja.exe)
    -   NEC PC-9800 シリーズ用
        [http://download.microsoft.com/download/iis50/PatchNEC/Q319733/NT5/JA/Q319733\_W2K\_SP3\_nec98\_JA.exe](http://download.microsoft.com/download/iis50/patchnec/q319733/nt5/ja/q319733_w2k_sp3_nec98_ja.exe)
        ダウンロード先のリストから Japanese NEC を選択してください。
-   Microsoft IIS 5.1 :
    この問題に対する修正は Windows XP Service Pack 1 以降に含まれています。Windows XP 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。
    <http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/>
    なお、個別の更新プログラムは以下の Web サイトから入手できます。
    [http://download.microsoft.com/download/iis50/Patch/Q319733/WXP/JA/Q319733\_WXP\_SP1\_x86\_JPN.exe](http://download.microsoft.com/download/iis50/patch/q319733/wxp/ja/q319733_wxp_sp1_x86_jpn.exe)

    **お詫びとお知らせ** **:**
    2002 年 4 月 10 日に公開されました Windows XP (IIS5.1) 用の更新プログラムに IIS のヘルプやサンプルの検索機能と FTP サーバーのメッセージの一部に日本語化されていない部分があることが確認されました。この問題に対応済みの更新プログラムを、2002 年 5 月 10 日に再公開いたしました。検索機能または FTP サーバーをご利用のお客様は、誠にお手数ではございますが新しい更新プログラムのインストールをお願いいたします。インストールの際には以前の更新プログラムを一度アンインストールした後に、新しい更新プログラムをインストールしてください。なお、今回の更新プログラムの再提供はセキュリティ上の問題ではなく、日本語化に関する問題です。そのため、以前の更新プログラムを適用している場合も本セキュリティ情報で報告している脆弱性の影響を受けることはございません。更新プログラムの問題により、お客様にご迷惑をお掛けいたしましたこと、心よりお詫び申し上げます。

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**

-   IIS 4.0 用の更新プログラムは Windows NT 4.0 [Service Pack 6a](http://www.microsoft.com/japan/products/ntserver/sp6/) を実行しているシステムにインストールすることができます。
-   Windows NT Server 4.0、Terminal Server Editionセキュリティ ロールアップ パッケージはWindows NT 4.0 Terminal Service Edition Windows NT 4.0 Terminal Server Edition [Service Pack 6](http://www.microsoft.com/japan/technet/downloads/winnt.mspx) を実行しているシステムにインストールすることができます。
-   IIS 5.0 用の更新プログラムは Windows 2000 Service Pack 1 または Service Pack 2 を実行しているシステムにインストールすることができます。
-   IIS 5.1 用の更新プログラムは Windows XP Professional を実行しているシステムにインストールすることができます。

**この修正を含む予定のサービスパック** **:**

-   Windows NT 4.0 用の今後の Service Pack の予定はありません。
-   IIS 5.0 に対する更新プログラムは Windows 2000 Service Pack 3 に含まれています。
-   IIS 5.1 に対する更新プログラムは Windows XP Service Pack 1 に含まれています。

**再起動の必要性** **:**

-   IIS 4.0 : IIS サービスを停止し、/z スイッチで更新プログラムをインストールします。その後、サービスを再起動することにより、再起動の必要性を回避することができます。サポート技術情報 [319733](http://support.microsoft.com/kb/319733) にこの手順に関する追加情報が記載されています。
-   IIS 5.0 : なし
-   IIS 5.1 : なし
    更新プログラムのインストール プロセスを完了させるために、システムを再起動する必要があることを通知するポップアップ ダイアログが表示される場合があります。このダイアログが表示されても、これを無視することができます。

**更新プログラムに含まれる過去の修正** **:**

-   IIS 4.0 および 5.0 : この更新プログラムはマイクロソフト セキュリティ情報 [MS01-044](http://technet.microsoft.com/security/bulletin/ms01-044) で提供された更新プログラムを含みます。(これは以前の IIS 4.0 および 5.0 用の累積的な更新プログラムで、そのほかの更新プログラムも含んでいます。)
-   IIS 5.1 : なし
-   Windows NT Sever 4.0、Terminal Server Edition セキュリティ ロール アップ パッケージには、以下のセキュリティ情報で提供された修正も含まれています。
    -   マイクロソフト セキュリティ情報 [MS99-041](http://technet.microsoft.com/security/bulletin/ms99-041)
    -   マイクロソフト セキュリティ情報 [MS99-046](http://technet.microsoft.com/security/bulletin/ms99-046)
    -   マイクロソフト セキュリティ情報 [MS99-056](http://technet.microsoft.com/security/bulletin/ms99-056)
    -   マイクロソフト セキュリティ情報 [MS99-060](http://technet.microsoft.com/security/bulletin/ms99-060)
    -   マイクロソフト セキュリティ情報 [MS00-005](http://technet.microsoft.com/security/bulletin/ms00-005)
    -   マイクロソフト セキュリティ情報 [MS00-006](http://technet.microsoft.com/security/bulletin/ms00-006)
    -   マイクロソフト セキュリティ情報 [MS00-007](http://technet.microsoft.com/security/bulletin/ms00-007)
    -   マイクロソフト セキュリティ情報 [MS00-021](http://technet.microsoft.com/security/bulletin/ms00-021)
    -   マイクロソフト セキュリティ情報 [MS00-027](http://technet.microsoft.com/security/bulletin/ms00-027)
    -   マイクロソフト セキュリティ情報 [MS00-029](http://technet.microsoft.com/security/bulletin/ms00-029)
    -   マイクロソフト セキュリティ情報 [MS00-040](http://technet.microsoft.com/security/bulletin/ms00-040)
    -   マイクロソフト セキュリティ情報 [MS00-047](http://technet.microsoft.com/security/bulletin/ms00-047)
    -   マイクロソフト セキュリティ情報 [MS00-052](http://technet.microsoft.com/security/bulletin/ms00-052)
    -   マイクロソフト セキュリティ情報 [MS00-083](http://technet.microsoft.com/security/bulletin/ms00-083)
    -   マイクロソフト セキュリティ情報 [MS00-087](http://technet.microsoft.com/security/bulletin/ms00-087)
    -   マイクロソフト セキュリティ情報 [MS00-091](http://technet.microsoft.com/security/bulletin/ms00-091)
    -   マイクロソフト セキュリティ情報 [MS00-094](http://technet.microsoft.com/security/bulletin/ms00-094)
    -   マイクロソフト セキュリティ情報 [MS00-100](http://technet.microsoft.com/security/bulletin/ms00-100)
    -   マイクロソフト セキュリティ情報 [MS01-003](http://technet.microsoft.com/security/bulletin/ms01-003)
    -   マイクロソフト セキュリティ情報 [MS01-008](http://technet.microsoft.com/security/bulletin/ms01-008)
    -   マイクロソフト セキュリティ情報 [MS01-009](http://technet.microsoft.com/security/bulletin/ms01-009)
    -   マイクロソフト セキュリティ情報 [MS01-017](http://technet.microsoft.com/security/bulletin/ms01-017)
    -   マイクロソフト セキュリティ情報 [MS01-033](http://technet.microsoft.com/security/bulletin/ms01-033)
    -   マイクロソフト セキュリティ情報 [MS01-040](http://technet.microsoft.com/security/bulletin/ms01-040)
    -   マイクロソフト セキュリティ情報 [MS01-041](http://technet.microsoft.com/security/bulletin/ms01-041)
    -   マイクロソフト セキュリティ情報 [MS01-052](http://technet.microsoft.com/security/bulletin/ms01-052)
    -   マイクロソフト セキュリティ情報 [MS02-001](http://technet.microsoft.com/security/bulletin/ms02-001)

**更新プログラムが正しくインストールされたか確認する方法** **:**
IIS 4.0 :
Windows NT 4.0 Workstation, Server および Server, Enterprise Edition :

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Hotfix\\Q319733.
-   各ファイルを確認するためには、サポート技術情報 [319733](http://support.microsoft.com/kb/319733) のファイル欄
    を参照して下さい。

Windows NT 4.0 Terminal Server Edition :

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Hotfix\\Q317636

IIS 5.0 :

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP3\\Q319733.
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP3\\Q319733\\Filelist.

IIS 5.1 :

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP1\\Q319733.
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP1\\Q319733\\Filelist.

**警告** **:**

-   IIS 4.0 サーバーに影響を及ぼす 4 つの脆弱性に対する更新プログラムは、ソフトウェアの変更ではなく、管理者の操作を必要とするため、この更新プログラムに含まれません。管理者はこの更新プログラムを適用するとともに、次のセキュリティ情報で説明されている管理操作が行われていることも確認する必要があります。
    -   マイクロソフト セキュリティ情報 [MS00-028](http://technet.microsoft.com/security/bulletin/ms00-028)
    -   マイクロソフト セキュリティ情報 [MS00-025](http://technet.microsoft.com/security/bulletin/ms00-025)
    -   マイクロソフト セキュリティ情報 [MS99-025](http://technet.microsoft.com/security/bulletin/ms99-025) (英語情報) (これはマイクロソフト セキュリティ情報 [MS98-004](http://technet.microsoft.com/security/bulletin/ms98-004) (英語情報) と同じ問題を説明しています。)
    -   マイクロソフト セキュリティ情報 [MS99-013](http://technet.microsoft.com/security/bulletin/ms99-013) (英語情報)
-   Front Page Server Extensions や Index Server は IIS と密接な関係のある製品であり、通常 IIS サーバーにインストールされますが、この更新プログラムはIIS 製品以外に関連する脆弱性に対する更新プログラムは含みません。このセキュリティ情報作成の現時点では、これらの脆弱性は次のセキュリティ情報で説明されています。

    -   マイクロソフト セキュリティ情報 [MS01-043](http://technet.microsoft.com/security/bulletin/ms01-043)
    -   マイクロソフト セキュリティ情報 [MS01-025](http://technet.microsoft.com/security/bulletin/ms01-025)
    -   マイクロソフト セキュリティ情報 [MS00-084](http://technet.microsoft.com/security/bulletin/ms00-084)
    -   マイクロソフト セキュリティ情報 [MS00-063](http://technet.microsoft.com/security/bulletin/ms00-063)
    -   マイクロソフト セキュリティ情報 [MS00-006](http://technet.microsoft.com/security/bulletin/ms00-006)

    しかし、例外が 1 つあります。マイクロソフト セキュリティ情報 MS01-033 で説明されている Index Server に影響を及ぼす脆弱性に対する更新プログラムはこの更新プログラムに含まれます。IIS サーバーに関するこの問題の深刻度のため、マイクロソフトはこれを更新プログラムに含むことにしました。

-   IIS 4.0 を使用しているお客様はこの更新プログラム、またはそのほかのセキュリティ上の更新プログラムをインストールする前に、正しいインストールの順番で行われたかどうかを確認して下さい。具体的には、IIS 4.0 サービスをインストールした後、Windows NT 4.0 Service Pack 6a が適用 （または再適用） されていることを確認して下さい。
-   Windows 2000 に Site Server 3.0 がインストールされた環境に、本更新プログラムをインストールすると、Membership 認証が行われなくなるという問題が確認されています。この問題を修正する Site Server の更新プログラムは、こちらからダウンロードすることが出来ます。詳細につきましては、サポート技術情報 [317815](http://support.microsoft.com/kb/317815) をご覧ください。
-   httpext.dll のアクセス権を制御することにより、IIS 5.0 サーバーで WebDAV を無効にしているお客様は、この更新プログラムをインストールする前に、WebDAV を再度有効にし、httpext.dll の更新されたバージョンがインストールされていることを確認して下さい。Windows 2000 Security Rollup Package 1 (SRP1) を適用されている場合、レジストリの設定変更により WebDAV を無効にすることができます。詳細については、[241520](http://support.microsoft.com/kb/241520) をご覧ください。

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-018）
    [http://www.microsoft.com/technet/security/bulletin/ms02-018.mspx](http://technet.microsoft.com/security/bulletin/ms02-018)
-   サポート技術情報 （KB） 文書番号 ： 319733
    [MS02-018 : 2002 年 4 月 Internet Information Services 用の累積的な修正プログラム](http://support.microsoft.com/kb/319733)

**更新履歴** **:**

-   2002/4/10: このセキュリティ情報ページを公開しました。
-   2002/4/12: このセキュリティ情報ページを更新し、更新プログラムのインストール後、IIS 4.0 システムを再起動する必要がないことをお知らせしました。また、「警告」 の欄で Site Server の認証問題について説明しました。
-   2002/4/16: この問題に対する IIS 5.0 の NEC PC-9800 シリーズ用の日本語版更新プログラムを公開しました。
-   2002/4/17: この問題に対する日本語版 KB を公開しました。
-   2002/5/7: このセキュリティ情報ページを更新し、Windows NT 4.0 Server, Terminal Server Edition セキュリティ ロール アップ パッケージが入手可能になったことをお知らせしました。
-   2002/05/17: 2002 年 5 月 10 日に Windows XP (IIS 5.1) 用の更新プログラムが再公開されたことを追記しました。詳細については「更新プログラム」の「お詫びとお知らせ」をご覧ください。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
