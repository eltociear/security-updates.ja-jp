---
TOCTitle: 'MS02-016'
Title: 'マイクロソフト セキュリティ情報 MS02-016 - 警告'
ms:assetid: 'ms02-016'
ms:contentKeyID: 61228441
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-016(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS02-016 - 警告
===============================================

グループ ポリシーを排他的に開くとポリシーの適用が妨害される (318593)
--------------------------------------------------------------------

公開日: 2002年4月5日 | 最終更新日: 2002年4月12日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Windows® 2000 ドメイン コントローラを使用しているネットワーク管理者

**脆弱性の影響** **:**
攻撃者はグループ ポリシーの適用を妨害する可能性があります。

**最大深刻度** **:**
中

**推奨する対応策** **:**
管理者はドメイン コントローラに更新プログラムを適用することを検討してください。

**影響を受けるソフトウェア** **:**

-   Microsoft Windows 2000 Server
-   Microsoft Windows 2000 Advanced Server
-   Microsoft Windows 2000 Datacenter Server

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
Windows 2000 のグループ ポリシーは、Active Directory およびドメイン コントローラのシステム ボリュームにデータを保存することにより実装されます。このデータの保存場所は Group Policy Object (GPO) と呼ばれます。マシンまたはユーザーがドメインにログオンする際、GPO を読み取り、それが含んでいる設定を適用します。また、これらの設定のほとんどが、既定で 90 分ごとに更新されます。Windows 2000 では、ほとんどのオペレーティング システムと同様に排他読み取りを含むいくつかの種類の読み取りアクセス権が提供されますが、これにより、攻撃者はグループ ポリシー ファイルをロックし、GPO の適用対象となる全てのユーザーにポリシーが適用されるのを妨害することができます。
攻撃者はまず通常通りドメインにログオンし、次に排他読み取りアクセス権でグループ ポリシー ファイルを開くことによってこの脆弱性を利用する可能性があります。攻撃者は次に再びネットワークにログオンします。ポリシー ファイルがロックされているため、2 度目のログオンは、グループ ポリシーが適用されないまま行われます。その結果、2 番目のマシンの以前のグループ ポリシー設定のすべてが強制的に残りますが、**新しい**ポリシー設定は適用されません。攻撃者の 2 番目のセッションは、最後に適用されたポリシーの設定を使用して行われます。
その影響は攻撃者のみに限定されません。グループ ポリシー ファイルがロックされている際にネットワークに偶然ログオンしたほかのユーザーも、新しいポリシー設定を適用しないでログオンすることができる可能性があります。しかし、攻撃に関係していないユーザーはポリシーがブロックされていることを確認することができない可能性があります。グループ ポリシーの適用はユーザーが気づくことがないプロセスで、このようなユーザーは、多くの場合、意図されたポリシー設定が適用されていないことに気が付きません。

**問題を緩和する要素** **:**

-   この脆弱性により、攻撃者は**新しい**グループ ポリシー設定の適用を妨害することができる可能性がありますが、以前のログオン中に適用された設定は強制的に残ります。
-   この脆弱性は、ネットワークでの正式のユーザー ID とパスワードを所有するユーザーによってのみ利用される可能性があります。
-   攻撃者が実行できるようになる操作は、管理者が設定したドメインでのグループ ポリシーのカスタマイズの程度によって異なります。
-   この脆弱性を利用しても、攻撃者はグループ ポリシーの変更を行うことはできません。また、ユーザー グループのメンバシップを取得することもできません。
-   管理者は、共有フォルダ MMC スナップインを使用してポリシー ファイルを開いた人物のユーザー ID を表示させ、攻撃者の身元を確認することができます。

**深刻度** **:**

|                  | インターネット サーバー | イントラネット サーバー | クライアント システム |
|------------------|-------------------------|-------------------------|-----------------------|
| **Windows 2000** | 低                      | 中                      | なし                  |

上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。インターネットベースのユーザーがドメインにログオンできるのを防ぐための最善策が推奨されるため、インターネット サーバーについてはこの脆弱性の深刻度は 「低」 になり、この脆弱性は承認されたドメイン ユーザーのみに利用される可能性があるためイントラネット サーバーについては、深刻度は 「中」 とされます。この脆弱性はワークステーションから利用される可能性がありますが、この脆弱性自体はドメイン コントローラに影響をおよぼすため、クライアント システムについては、「なし」 となります。

**脆弱性識別番号** **:**
[CAN-2001-0051](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0051)

**テストしたバージョン** **:**
マイクロソフトは Windows XP、Windows 2000 および Windows NT® 4.0 のテストを行い、これらの脆弱性による影響を評価しました。Windows NT 4.0 はグループ ポリシーをサポートしていないため、また Windows XP はクライアントのみのシステムであるため、この脆弱性による影響は受けません。それより前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**どのようなことが起こる可能性がありますか?**

この脆弱性により、攻撃者は Windows 2000 ドメインのグループ ポリシーの適用を妨害することができる可能性があります。グループ ポリシーにより、ドメイン管理者は、セキュリティ設定、デスクトップ設定、インストールすることができるアプリケーションなど、ネットワークのコンピュータとユーザーのグループのための設定を指定することができます。ポリシーを妨害することにより、攻撃者は管理者が設定した新しいポリシー設定ではなく、古いポリシーの設定を保持することができる可能性があります。
この脆弱性には次のようないくつかの制限があります。

-   以前のログオン中にグループ ポリシーが設定された場合、これらの設定は強制的に残ります。新しいポリシーのみが妨害されます。
-   この脆弱性は正当なネットワークのユーザーによってのみ利用することができます。
-   攻撃の進行中、管理者は攻撃者を識別することができます。
-   この脆弱性を利用しても、攻撃者はそのほかのユーザー アカウントにログオンすることはできません。またそのほかのユーザー グループのメンバシップを取得することはできません。
-   この脆弱性を利用しても、攻撃者はネットワークのグループ ポリシーを変更することはできず、その適用を一時的に妨害するのみにとどまります。

**何が原因で起こりますか?**

グループ ポリシー ファイルをロックすることができ、このためユーザーがそれらを読み取ることを妨げるために、この脆弱性が起こります。グループ ポリシー ファイルを読み取ることができない場合、新しいポリシー設定はマシンまたはユーザーのセッションに適用することはできません。

**グループポリシーとは何ですか?**

グループ ポリシーとは Windows 2000 に導入された技術で、これにより、ネットワーク管理者はユーザーに利用可能な多くのオプションを設定することができます。グループ ポリシーを介し、管理者はネットワークのユーザーおよびコンピュータに適用される設定を規制することができます。例えば、管理者はグループ ポリシーを使用して、セキュリティ設定の規制、ユーザーのシステムへのソフトウェアの自動インストール、ユーザーのデスクトップのカスタマイズなどを行うことができます。

**グループポリシーはどのように実装されるのですか?**

グループ ポリシーは [Active Directory](http://www.microsoft.com/windows2000/en/server/help/sag_adintro.htm) (英語情報) 内の Group Policy Objects (GPO) と呼ばれるデータ構造の形式で保存されます。異なる種類のポリシー設定が別個のファイルとして保存されます。例えば、デスクトップの画面設定等を規制するポリシー設定はあるファイルに保存され、またそのほかのポリシー設定情報は別のファイルに含まれます。
Windows 2000 マシンは起動時に、ドメイン コントローラに接続し、グループ ポリシー ファイルを読み取り、マシンに適用するポリシー設定を適用します。同様に、ユーザーがネットワークにログオンする時、Windows 2000 はドメイン コントローラに接続し、グループ ポリシー ファイルを読み取り、ユーザーに適用する設定を適用します。さらに、Windows 2000 は定期的に (90 分ごとに) ポリシー設定を更新します。

**グループポリシーが** **Windows 2000** **に実装される方法の何が問題になっていますか?**

Windows 2000 は、そのほかのユーザーがファイルを読み取ることを妨げる読み取りモード (排他読み取りモード) など、ファイルが開かれる時の多くのモードを提供します。グループ ポリシー ファイルは排他読み取りモードで開くことができ、このモードでファイルが開かれると、ユーザーやマシンがグループ ポリシー設定を適用することが妨げられます。

**排他読み取りのアクセス権でユーザーがファイルを開くことが許可されるのは問題なのですか?**

いいえ、問題ではありません。ほとんどのオペレーティング システムは排他読み取りのアクセス権を提供しています。もちろん、ユーザーが読み取り特権を与えられている場合、ファイルをロックすることのみができます。このため、ファイルの所有者は常にユーザーがファイルをロックすることを妨げることができます。グループ ポリシー ファイルは常にすべてのユーザーに読み取り可能である必要がありますが、この場合では、排他読み取りのオプションを提供することは不適切です。

**この脆弱性を利用して攻撃者は何をすることができますか?**

攻撃者はこの脆弱性を利用して、ネットワークのグループ ポリシー設定の適用を妨害することができる可能性があります。具体的には、攻撃者はネットワークに正常にログオンし、1 つ、またはそれ以上の GPO にある 1 つ、またはそれ以上のファイルをロックし、そして 2 度目に別のシステムからログオンすることができる可能性があります。2 度目のログオンはグループ ポリシーが適用されないまま行われます。(同様に、攻撃が進行中に、そのほかのユーザーまたはコンピュータが偶然ログオンした場合、グループ ポリシーは適用されません。)

**つまり、攻撃者が** **2** **度目にログオンする時、何のグループポリシー設定も有効ではないという意味ですか?**

状況によります。Windows 2000 がグループ ポリシーを適用する場合、ローカル システムの設定を変更し、その後、再変更されない限り、その変更された設定が強制的に残ります。グループ ポリシー ファイルをロックすることにより、攻撃者は**新しい**ポリシーが適用されることを妨害することができますが、以前に適用されたポリシーは依然として有効です。
これに関する実際の影響は、攻撃者が、グループ ポリシーを以前適用したシステムを介しログオンした場合、古いポリシー設定は有効のままとなります。一方、攻撃者が、グループ ポリシーが適用されたことのないシステムを介しログオンした場合、既定の設定が有効のままとなります。

**グループポリシーを妨害することにより、攻撃者はどのような追加の特権を取得することができる可能性がありますか?**

グループ ポリシーの妨害に関する影響は、攻撃者が最後にそのマシンからログオンしてから、管理者がグループ ポリシー設定の変更を行ったかどうかにより異なります。また、変更が行われた場合、どのような変更が行われたかにより異なります。

**GPO** **のファイルがロックされている間にネットワークにログオンしたユーザーについてはどうですか?** **この場合も、グループポリシーは妨害されますか?**

はい。グループ ポリシー ファイルがロックされている場合、攻撃者だけでなく、ログ オンしたすべてのユーザーはグループ ポリシーが適用されずにログ オンします。しかし、ここで重要な点として、グループ ポリシーはユーザーが気づくことがないプロセスであるということです。攻撃者はファイルをロックしたため、グループ ポリシーが適用されていないことを知っています。しかし、そのほかのユーザーにとってはグループ ポリシーが妨害されているという徴候がありません。(しかし、結果として生じるポリシーを示すツールがあり、これが使用されると、ユーザーに強制的に残っているポリシーと、それが適用された時を示します。)

**誰がこの脆弱性を利用する可能性がありますか?**

正当なネットワーク ユーザーのみがこの脆弱性を利用することができます。つまり、攻撃者はすでにドメインのアカウントに正当なユーザー ID とパスワードを持っている必要があります。

**誰かがこの脆弱性を利用した場合、それが分かりますか?**

はい、分かります。Microsoft 管理コンソールの共有フォルダ スナップ インにより、管理者は誰が攻撃を行っているかを知ることができます。このスナップ インにより、管理者は特定のファイルを開いているユーザーを識別することができます。つまり、誰がポリシー ファイルを開いているかをチェックすることにより、管理者は誰が攻撃者であるかを確認することができます。

**この脆弱性を利用して、攻撃者はグループポリシーを変更することができますか?**

いいえ、できません。この脆弱性を利用しても、攻撃者はポリシー ファイルへの書き込みアクセス権を取得することはできません。

**インターネットでのユーザーはこの脆弱性を利用することができますか?**

ネットワーク管理者がドメインを直接インターネットに公開し、インターネット ベースのユーザーにそのドメインへのログ オンを許可している場合のみ、この脆弱性をインターネットから利用することができます。しかし、標準のセキュリティ上の最善策は、これを行わないことを強く推奨しています。

**この脆弱性により、攻撃者はほかのユーザーとしてログオンすることはできますか?**

いいえ、できません。グループ ポリシーを妨害しても、ほかのユーザーとしてログ インすることはできません。また、ほかのユーザーのアカウントのグループ メンバシップを変更することもできません。例えば、この脆弱性を利用しても、攻撃者は管理者としてネットワークへログ オンする手段を取得することはできません。

**どのシステムに更新プログラムを適用する必要がありますか?**

ドメイン コントローラのみにこの更新プログラムを適用する必要があります。

**使用中のドメインコントローラは** **Windows NT 4.0** **を実行していますが、更新プログラムを適用する必要がありますか?**

いいえ、ありません。グループ ポリシーは Windows 2000 で導入され、Windows NT 4.0 には存在しません。

**Windows NT 4.0** **ドメインコントローラを実行していますが、ワークステーションは** **Windows 2000** **を使用しています。この場合、更新プログラムを適用する必要はありますか?**

いいえ、ありません。重要なことはドメイン コントローラがどのオペレーティング システムを使用しているかです。クライアント システムは問題となりません。ドメイン コントローラが Windows 2000 を実行している場合、更新プログラムの適用が必要です。そのほかのオペレーティング システムには必要ありません。

**Windows XP** **はこの脆弱性の影響を受けますか?**

いいえ、受けません。Windows XP はファイルを排他読み取りで開くことを許可しません。しかし、これはドメインコントローラのみに保存されるグループ ポリシー ファイルの特定の場合のみに問題となります。Windows XP はドメイン コントローラとして使用することはできません。このため、この脆弱性の影響は受けません。

**この更新プログラムはどのようにこの脆弱性を排除しますか?**

この更新プログラムは Windows 2000 がグループ ポリシー ファイルに対する読み取りリクエストを監視し、排他読み取りアクセス権のリクエストはすべて共有の読み取りアクセス権にマップするようにします。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft Windows 2000 Server および Advanced Server:
    この問題に対する修正は Windows 2000 Service Pack 3 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。
    <http://www.microsoft.com/japan/windows2000/downloads/>
    なお、個別の更新プログラムは以下の Web サイトから入手できます。
    -   PC/AT 互換機用 :
        [http://download.microsoft.com/download/win2000platform/Patch/Q318593/NT5/JA/Q318593\_W2K\_SP3\_X86\_JA.exe](http://download.microsoft.com/download/win2000platform/patch/q318593/nt5/ja/q318593_w2k_sp3_x86_ja.exe)
    -   NEC PC-9800 シリーズ用 :
        [http://download.microsoft.com/download/win2000platform/PatchNEC/Q318593/NT5/JA/Q318593\_W2K\_SP3\_nec98\_JA.exe](http://download.microsoft.com/download/win2000platform/patchnec/q318593/nt5/ja/q318593_w2k_sp3_nec98_ja.exe)
        ダウンロード先のリストから Japanese NEC を選択してください。
-   Microsoft Windows 2000 Datacenter Server:
    Windows 2000 Datacenter Server の更新プログラムの適用に関してはそれぞれのデータセンター サーバーを購入されたハードウェア ベンダー様へご相談下さい。

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**
この更新プログラムは Windows 2000 Service Pack 2 を実行しているシステムにインストールすることができます。

**この修正を含む予定のサービスパック** **:**
この問題に対する更新プログラムは Windows 2000 Service Pack 3 に含まれています。

**再起動の必要性** **:**
あり

**更新プログラムに含まれる過去の修正** **:**
この更新プログラムにはマイクロソフト セキュリティ情報 [MS01-036](http://technet.microsoft.com/security/bulletin/ms01-036) で提供された修正も含まれています。

**更新プログラムが正しくインストールされたか確認する方法** **:**

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP3\\Q318593
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP3\\Q318593\\Filelist.

**警告** **:**
なし

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-016）
    [http://www.microsoft.com/technet/security/bulletin/ms02-016.mspx](http://technet.microsoft.com/security/bulletin/ms02-016)
-   サポート技術情報 （KB） 文書番号 ： 318593
    [\[MS02-016\] グループ ポリシーを排他的に開くとポリシーの適用が妨害される](http://support.microsoft.com/kb/318593)

**更新履歴** **:**

-   2002/4/5: このセキュリティ情報ページを公開しました。
-   2002/4/10: 「更新プログラムに含まれる過去の修正」 の欄を更新し、この問題に対する更新プログラムに MS01-036 の修正が含まれていることをお知らせしました。
-   2002/4/12: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
