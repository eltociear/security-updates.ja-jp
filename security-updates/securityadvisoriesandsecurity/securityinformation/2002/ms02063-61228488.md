---
TOCTitle: 'MS02-063'
Title: 'マイクロソフト セキュリティ情報 MS02-063 - 緊急'
ms:assetid: 'ms02-063'
ms:contentKeyID: 61228488
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-063(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS02-063 - 緊急
===============================================

PPTP サービスの未チェックのバッファにより、サービス拒否の攻撃を受ける (329834)
------------------------------------------------------------------------------

公開日: 2002年10月31日 | 最終更新日: 2002年11月11日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Windows 2000 または Windows XP を使用しているお客様

**脆弱性の影響** **:**
サービス拒否

**最大深刻度** **:**
高

**推奨する対応策** **:**
PPTP サービスを提供している管理者は、直ちに更新プログラムをインストールしてください。PPTP を使用してリモート アクセスを利用しているユーザーは更新プログラムのインストールを検討してください。

**影響を受けるソフトウェア** **:**

-   Microsoft Windows 2000
-   Microsoft Windows XP

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
Windows 2000 および Windows XP では、ポイント ツー ポイント トンネリング プロトコル (PPTP)、リモート アクセス サービス (RAS) の一部として実装される仮想プライベート ネットワーク技術が標準でサポートされています。PPTP は Windows NT 4.0、Windows 98、Windows 98SE および Windows ME では、オプション コンポーネントでサポートされます。
PPTP 接続の確立、保守、切断を行うために使用されるコントロール データを処理するコードのある部分に未チェックのバッファが存在するため、Windows 2000 および Windows XP の実装にセキュリティ上の脆弱性が発生します。攻撃者は影響を受けるサーバーに不正な PPTP コントロール データを送信することにより、カーネル メモリを破壊させ、システムを異常終了させ、システムで進行中のすべての動作を妨害する可能性があります。
この脆弱性は、PPTP を提供しているすべてのサーバーに対して悪用される可能性があります。ワークステーションを PPTP サービスを提供する RAS サーバーとして実行する構成にした場合、同様に攻撃を受ける可能性があります。PPTP クライアントとして実行されているワークステーションはアクティブな PPTP セッション中にのみ攻撃される可能性があります。攻撃を受けたシステムは、システムを再起動し、通常の操作を再開することができます。

**問題を緩和する要素** **:**

-   「よく寄せられる質問」 にて詳細に説明されているように、この脆弱性を悪用した攻撃でマイクロソフトが確認しているのは、サービス拒否の攻撃のみです。オーバーランが発生する方法により、この脆弱性を悪用し、確実にシステムを制御する方法はないものと思われます。
-   サーバーが PPTP サービスを提供するように構成されている場合にのみ、この脆弱性の危険が及ぶ可能性があります。PPTP はすべての Windows システムで既定では実行されません。同様に、ワークステーションも PPTP サービスを提供するように構成することができますが、既定ではこのサービスは実行されません。
-   PPTP クライアントに対してこの脆弱性を悪用するのは困難です。PPTP は通常クライアントの IP アドレスが頻繁に変更される場合にのみ使用されます。（例 : クライアント システムがモバイルの場合など） 攻撃者は IP アドレスを知る必要があるだけでなく、クライアントがアクティブな PPTP セッションの実行中にこの攻撃を仕掛ける必要があります。

**深刻度** **:**

|              | インターネット サーバー | イントラネット サーバー | クライアント システム |
|--------------|-------------------------|-------------------------|-----------------------|
| Windows XP   | なし                    | なし                    | 低                    |
| Windows 2000 | 高                      | 低                      | 低                    |

上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。

**脆弱性識別番号** **:**
[CAN-2002-1214](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1214)

**テストしたバージョン** **:**
マイクロソフトは Windows 98、Windows 98 SE、Windows ME、Windows NT® 4.0、Windows 2000 および Windows XP のテストを行い、これらの脆弱性による影響を評価しました。それ以前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、これらの脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**どのようなことが起こる可能性がありますか?**

これは[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者はこの脆弱性を悪用し、ポイント ツー ポイント トンネリング プロトコル (PPTP) を介したセキュアなリモート接続を使用しているクライアントまたはサーバーのいずれかのサービスを妨害する可能性があります。
クライアントでこの脆弱性が悪用される可能性があるのは、通常アクティブ リモート ネットワーク セッションを維持している場合のみで、クライアントでは ＩＰ アドレスが頻繁に変更されるため、クライアントに対してこの脆弱性を悪用するのは困難です。システムを再起動することにより、クライアントまたはサーバーの通常のオペレーションを再開することができます。

**何が原因で起こりますか?**

Windows 2000 および Windows XP のポイント ツー ポイント トンネリング プロトコルを実装するコードの中の PPTP コントロール データを処理するコードの部分に未チェックのバッファが含まれるため、この脆弱性が発生します。

**ポイントツーポイントトンネリングプロトコルとは何ですか?**

[ポイント ツー ポイント トンネリング プロトコル](http://www.microsoft.com/technet/archive/winntas/plan/pptpudst.mspx) (英語情報) (PPTP) は、ユーザーが [仮想プライベート ネットワーク](http://www.microsoft.com/windows/products/windowsxp/) (英語情報) (VPN) を作成し、使用する際に用いられる、業界標準のプロトコルです。 (RFC [2637](http://www.ietf.org/rfc/rfc2637.txt?number=2637) に定義されています。) PPTP などの VPN 技術を使用することで、ユーザーはインターネットなどのセキュリティで保護されていないネットワークを通してリモート ネットワークに安全に接続し、データのやり取りをすることができます。 （PPTP の技術の基礎的な説明は MSDN をご覧ください。
Windows 2000 および Windows XP では PPTP が標準でサポートされています。サーバー バージョンでは、PPTP のサポートは、[Routing and Remote Access Service](http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/) （英語情報） （RAS） 内のオプションとして実装されています。ワークステーション バージョンでは、PPTP のサポートは、リモート アクセス クライアントに組み込まれています。Windows NT 4.0、Windows 98、Windows 98SE、Windows ME では PPTP のサポートは、オプショナル コンポーネントとして提供されています。

**PPTP** **コントロールデータとは何ですか?**

PPTP セッションを構成するデータは、セッション内のデータとセッションに関するデータの 2 つの種類に分類することができます。コントロール データはセッションに関する種類のデータです。コントロール データは、クライアントとサーバーの間で交換され、セッションを確立し、セッションが有効であることを確認し、またセッションが完了した際にはセッションを終了させます。

**PPTP** **サービスがコントロールデータを処理する方法の何が問題になっていますか?**

Windows 2000 および Windows XP の実装でコントロール データを処理するコードに未チェックのバッファが含まれます。ある特定な形式の不正なコントロール データが送信されることにより、バッファがオーバーフローし、システム カーネルのメモリが上書きされる可能性があります。

**この脆弱性により攻撃者は何ができますか?**

攻撃者はこの脆弱性を悪用し、影響を受けるシステムを異常終了させる可能性があります。攻撃者は PPTP サーバーを標的とし、ユーザーが VPN セッションを確立することを妨害する可能性があります。また、PPTP クライアントを標的とし、攻撃者はその際に確立中のセッションを損失させ、PPTP クライアントを異常終了させる可能性があります。いずれの場合も、システムを再起動することで通常の操作を再開することができます。

**この脆弱性を悪用し、該当のシステムを制御することができますか?**

バッファ オーバーランは、システムのオペレーションを妨害するだけでなく、攻撃者の任意のタスクを実行し、システムの制御を取得するためにシステムを変更することに悪用されることがよくあります。しかし、今回の場合、マイクロソフトは広く調査しましたが、システムを確実に制御する攻撃方法を確認できませんでした。その代わり、マイクロソフトは、この脆弱性が悪用され、システムのオペレーションが妨害される可能性のみを確認しました。
その理由は、オーバーランが発生するメモリの領域に関連します、ほとんどのバッファ オーバーランの場合、脆弱性を悪用することで、攻撃者はデータをスタックまたはヒープ、 2 つの領域のいずれかに格納することができます。このような場合、攻撃者はデータの場所およびデータの使用方法を制御することができます。しかし、この脆弱性の場合、オペーレーティング システムのカーネルのメモリにあるデータがオーバーランします。マイクロソフトは、データがオーバーフローする場所を予測する方法およびそのデータを使用してシステムの機能を変更する方法を確認していません。

**誰がこの脆弱性を悪用する可能性がありますか?**

PPTP が実行されている Windows 2000 システムまたは Windows XP システムにデータを送信できるすべてのユーザーにこの脆弱性を悪用される可能性があります。

**Windows** **サーバーにはどのような危険が及びますか?**

ルーティングとリモート アクセス (RRAS) サービスが実行され、管理者がサポートするプロトコルとしてPPTP を選択した場合にのみ Windows 2000 サーバーに危険が及ぶ可能性があります。つまりこのことは、PPTP サービスを提供する構成のサーバーのみに危険が及ぶ可能性があることを意味します。
この脆弱性は、Windows NT 4.0 の PPTP サービスに影響を及ぼさないため、PPTP サービスを提供している場合でも Windows NT 4.0 サーバーには危険は及びません。

**PPTP** **サービスを提供しているサーバーをファイアウォールによって保護することはできますか?**

いいえ、できません。PPTP の目的は、インターネットなどの不安定な媒体で安全な通信を提供するものです。そのため、PPTP サーバーが本来の役割を果たすには、ファイアウォールの PPTP ポート (ポート 1723) が開かれていることが必要となります。

**Windows** **ワークステーションへはどのような危険が及びますか?**

Windows 2000 または Windows XP ワークステーションに及ぶ危険には以下のような 2 つのシナリオがあります。

-   **PPTP セッションが既に実行中の場合** Windows クライアントがアクティブな外部ネットワークへの PPTP セッションを実行している際、その PPTP サービスも PPTP ポートに入力されるコントロール データを認識し、受信するためにこの脆弱性が悪用されます。しかし、通常の PPTP 使用のシナリオでは、これらの攻撃の可能性を低くなります。通常サーバーでは静的な、公開されている IP アドレスを使用します。それと比較すると、ワークステーションでは IP アドレスが頻繁に変更されるため、その結果攻撃の標的とされるのは、より困難であると言えます。
-   **RAS サーバーとして運用するように手動で構成されている場合** ワークステーションは PPTP を使用して RAS サービスを提供する構成にすることが可能です。その場合、ワークステーションは RAS サーバーと同じ危険が及ぶ可能性があります。しかしワークステーションがこの方法で構成されることはまれであると言えます。

Windows のそのほかのバージョンを実行しているワークステーションには、この脆弱性による危険は及びません。PPTP クライアントは Windows 95、Windows 98、Windows 98SE、Windows ME で利用できますが、これらの製品にはこの脆弱性の影響はありません。

**ファイアウォールで** **PPTP** **クライアントを保護することはできますか?**

はい、できます。ファイアウォール （Windows XP の[インターネット接続ファイアウォール](http://www.microsoft.com/japan/windowsxp/pro/using/howto/networking/icf.mspx)を含む） または[ネットワーク アドレス変換 (NAT)](http://www.microsoft.com/japan/technet/prodtechnol/winxppro/deploy/nattrnsv.mspx)を実行するルーター （ほとんどのブロードバンドは NAT を実行しています） によって保護されたアクティブな PPTP クライアントは、受信者側が送信を要求していないメッセージの送信をポート 1723 で防ぎます。

**Windows NT 4.0、Windows 98、Windows 98SE、Windows ME** **を実行しているユーザーは対策を講じる必要がありますか?**

いいえ、ありません。これらのバージョンの PPTP サービスはこの脆弱性の影響を受けません。

**更新プログラムは何を修正しますか?**

この更新プログラムは、PPTP サービスで適切なバッファの処理が行われるようにし、この脆弱性を排除します。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft Windows 2000:
    この問題に対する修正は Windows 2000 Service Pack 4 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。
    <http://www.microsoft.com/japan/windows2000/downloads/>
    なお、個別の更新プログラムは以下の Web サイトから入手できます。
    -   PC/AT 互換機用
        [http://download.microsoft.com/download/win2000platform/Patch/Q329834/NT5/JA/Q329834\_W2K\_SP4\_X86\_JA.exe](http://download.microsoft.com/download/win2000platform/patch/q329834/nt5/ja/q329834_w2k_sp4_x86_ja.exe)
    -   NEC PC-9800 シリーズ用
        [http://download.microsoft.com/download/win2000platform/PatchNEC/Q329834/NT5/JA/Q329834\_W2K\_SP4\_nec98\_JA.exe](http://download.microsoft.com/download/win2000platform/patchnec/q329834/nt5/ja/q329834_w2k_sp4_nec98_ja.exe)
        ダウンロード先のリストから Japanese NEC を選択してください。
-   Microsoft Windows XP:
    32-bit: [http://download.microsoft.com/download/whistler/Patch/Q329834/WXP/JA/Q329834\_WXP\_SP2\_x86\_JPN.exe](http://download.microsoft.com/download/whistler/patch/q329834/wxp/ja/q329834_wxp_sp2_x86_jpn.exe)
    64-bit: [http://www.microsoft.com/downloads/details.aspx?FamilyId=1b00f5df-4a85-488f-80e3-c347adcc4df1&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=1b00f5df-4a85-488f-80e3-c347adcc4df1&displaylang=ja)

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**

-   Windows 2000 用の更新プログラムは、Windows 2000 Service Pack 2、Service Pack 3 を実行しているシステムにインストールすることができます。
-   Windows XP 用の更新プログラムは、Windows XP または [Service Pack 1](http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/default.mspx) を実行しているシステムにインストールすることができます。

**この修正を含む予定のサービスパック** **:**

-   この問題に対する更新プログラムは Windows 2000 [Service Pack 4](http://www.microsoft.com/downloads/details.aspx?familyid=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&displaylang=ja) に含まれています。
-   この問題に対する更新プログラムは Windows XP Service Pack 2 に含まれる予定です。

**再起動の必要性** **:**
あり

**更新プログラムのアンインストール** **:**
可

**更新プログラムに含まれる過去の修正** **:**
なし

**更新プログラムが正しくインストールされたか確認する方法** **:**
Windows 2000:

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP4\\Q329834
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP4\\Q329834\\Filelist

Windows XP:

*Windows XP* *に更新プログラムをインストールした場合*

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKLM\\Software\\Microsoft\\Updates\\Windows XP\\SP1\\Q329834
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。
    HKLM\\Software\\Microsoft\\Updates\\Windows XP\\SP1\\Q329834\\Filelist

*Windows XP SP1* *に更新プログラムをインストールした場合*

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKLM\\Software\\Microsoft\\Updates\\Windows XP\\SP2\\Q329834
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。
    HKLM\\Software\\Microsoft\\Updates\\Windows XP\\SP2\\Q329834\\Filelist

**警告** **:**
なし

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-063）
    [http://www.microsoft.com/technet/security/bulletin/ms02-063.mspx](http://technet.microsoft.com/security/bulletin/ms02-063)
-   サポート技術情報 （KB） 文書番号 ： 329834
    [\[MS02-063\] PPTP サービスの未チェック バッファにより、サービス拒否の攻撃を受ける](http://support.microsoft.com/kb/329834)

**更新履歴** **:**

-   2002/10/31: このセキュリティ情報ページを公開しました。
-   2002/11/11: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
