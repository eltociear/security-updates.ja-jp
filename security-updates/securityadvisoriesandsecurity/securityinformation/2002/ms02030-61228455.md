---
TOCTitle: 'MS02-030'
Title: 'マイクロソフト セキュリティ情報 MS02-030 - 警告'
ms:assetid: 'ms02-030'
ms:contentKeyID: 61228455
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-030(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS02-030 - 警告
===============================================

SQLXML の未チェックのバッファによりコードが実行される (321911)
--------------------------------------------------------------

公開日: 2002年6月13日 | 最終更新日: 2002年6月24日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® SQL Server™ 2000 を使用しているシステム管理者

**脆弱性の影響** **:**
2 つの脆弱性があり、最も深刻な脆弱性については、攻撃者の選択したコードが実行される可能性があります。

**最大深刻度** **:**
中

**推奨する対応策** **:**
SQLXML を有効にし、HTTP 経由でデータ クエリを有効にしているシステム管理者は直ちに更新プログラムをインストールして下さい。

**影響を受けるソフトウェア** **:**

-   Microsoft SQLXML (SQL Server 2000 の一部として出荷され、別途ダウンロード可能です。)

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
SQLXML により、SQL Server 2000 との間で XML データの転送および取得が可能となります。データベース クエリは XML 文書の形式で返され、容易に保存や転送を行うことができます。SQLXML を使用することにより、ブラウザで HTTP を介して XML を使用し SQL Server 2000 にアクセスすることができます。
SQLXML に存在する 2 つの脆弱性 :

-   ISAPI エクステンションの未チェックのバッファに関する脆弱性。この脆弱性により、最悪の場合、攻撃者の選択したコードが Microsoft Internet Information Services (IIS) Server で実行される可能性があります。
-   XML タグを指定する機能に関する脆弱性。この脆弱性により、攻撃者は、より高い権限で、ユーザーのコンピュータ上でスクリプトを実行できる可能性があります。たとえば、スクリプトはインターネット ゾーンではなく、イントラネット ゾーンで実行される場合があります。

**問題を緩和する要素** **:**
SQLXML ISAPI エクステンションの未チェックのバッファ :

-   管理者は IIS Server の SQLXML HTTP コンポーネントにより使用される仮想ディレクトリ構造と名前付けを設定しています。この脆弱性により、攻撃者がディレクトリ構造を取得することはできません。
-   攻撃者は IIS Server 上で SQLXML のために設定された仮想ディレクトリの場所を知っている必要があります。

XML タグによるスクリプトの挿入 :

-   攻撃するためには、ユーザーが SQL Server で権限を所有している必要があります。
-   攻撃者は、そのユーザーが権限を所有している SQL Server のアドレスを知っている必要があります。
-   攻撃者は自分が管理する Web サイトを訪問するようにユーザーを誘導する必要があります。
-   既定では HTTP を介して送信されるクエリは有効ではありません。
-   マイクロソフトのセキュリティ上の最善策として、仮想ルートを介し、データベースにアドホックな URL クエリを許可しないことを推奨します。
-   スクリプトは、SQLXML コンポーネントをホストしている IIS Server への接続で使用される Internet Explorer のセキュリティ ゾーンに従い、ユーザーのブラウザで実行されます。最悪の場合、スクリプトはイントラネット ゾーンで実行されます。

**深刻度** **:**
SQLXML ISAPI エクステンションの未チェックのバッファ :

|                                                                            | インターネット サーバー | イントラネット サーバー | クライアント システム |
|----------------------------------------------------------------------------|-------------------------|-------------------------|-----------------------|
| **SQL Server 2000** **に同梱される** **Microsoft SQLXML** **のバージョン** | 中                      | 中                      | なし                  |
| **Microsoft SQLXML** **バージョン** **2**                                  | 中                      | 中                      | なし                  |
| **Microsoft SQLXML** **バージョン** **3**                                  | 中                      | 中                      | なし                  |

XML タグによるスクリプトの挿入 :

|                                                                            | インターネット サーバー | イントラネット サーバー | クライアント システム |
|----------------------------------------------------------------------------|-------------------------|-------------------------|-----------------------|
| **SQL Server 2000** **に同梱される** **Microsoft SQLXML** **のバージョン** | 中                      | 中                      | なし                  |
| **Microsoft SQLXML** **バージョン** **2**                                  | 中                      | 中                      | なし                  |
| **Microsoft SQLXML** **バージョン** **3**                                  | 中                      | 中                      | なし                  |

上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。深刻度はオペレーティング システムのセキュリティ コンテキストでコードがリモートで実行される可能性、および高い権限で、ユーザーのシステム上でスクリプトが実行される可能性を考慮し、評価されています。

**脆弱性識別番号** **:**

-   SQLXML ISAPI エクステンションの未チェックのバッファ : [CAN-2002-0186](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0186)
-   XML タグによるスクリプトの挿入 : [CAN-2002-0187](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0187)

**テストしたバージョン** **:**
マイクロソフトは SQL Server 2000 に同梱されている SQLXML の最初のバージョン、および SQLXML バージョン 1、2、3 でテストを行い、これらの脆弱性による影響を評価しました。SQLXML バージョン 1に関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、「よく寄せられる質問」 で説明されているように、これ以降のバージョンにアップグレードする必要があります。

よく寄せられる質問
------------------

<span></span>
**この更新プログラムはどのような脆弱性を排除しますか?**

この更新プログラムは SQLXML に影響を及ぼす 2 つの脆弱性を排除します。SQLXML とは、SQL Server 2000が XML を介し、データベース クエリを受け取り、XML を介し、その結果を送ることができるようにするコンポーネントです。これらの脆弱性は SQLXML HTTP コンポーネントに存在します。

**XML** **とは何ですか?**

XML ([Extensible Markup Language](http://msdn2.microsoft.com/en-us/default.aspx) (英語情報) ) はインターネットで情報を送信するためのユニバーサルなデータの形式と考えることができます。XML を使用して、異なるベンダーのハードウェアやソフトウェアのプラットフォームで実行され、異なるプログラミング言語で書かれた Web アプリケーションが、データを交換することができます。
XML は Web サービスが互いにシームレスに動作するために重要なツールです。たとえば、2 種類のデータが全く別のハードウェアおよびソフトウェア プラットフォームに実装されているサーバーに存在している場合でも、単一の Web ポータルで、ある企業が従業員への給与支払い情報の管理と休暇を調べる機能を提供したいとします。それぞれのシステム開発者が XML をデータ形式として標準化すれば、これを容易に行うことができます。

**SQLXML** **とは何ですか?**

XML を介し送信されるデータの多くの種類の中に、データベース クエリとデータベースからの応答があります。SQLXML により SQL Server 2000 は XML データベース クエリを処理し、その結果の XML ドキュメントを作成することができます。SQL Server 2000 がこのように構成されている場合、[HTTP で動作](http://msdn2.microsoft.com/en-us/library/aa226553(sql.80).aspx) (英語情報) します。SQLXML は XML と関連するデータ間のギャップの橋渡しをします。
SQLXML の最初のバージョンは SQL Server 2000 の一部として提供され、後のバージョンは [Microsoft Developers Network](http://msdn2.microsoft.com/en-us/library/aa286527.aspx) (英語情報) からダウンロード可能です。

**SQLXML HTTP** **コンポーネントとは何ですか?**

SQLXML は、いくつかの異なる通信メソッドを使用し、SQL Server と XML データの交換をするために使用されます。SQLXML が使用する通信メソッドの 1 つが Hyper-text Transmission Protocol (HTTP) であり、これは情報送信にインターネット プロトコルを使用しています。
SQLXML HTTP コンポーネントは IIS サーバーの仮想ディレクトリに設定されます。仮想ディレクトリは SQL Server と同じマシンもしくは別のコンピュータに存在します。

**仮想ディレクトリとは何ですか?**

HTTP を使用して SQL Server 2000 データベースにアクセスできるようにする前に、管理者は仮想ディレクトリを設定する必要があります。管理者は SQL Server の IIS 仮想ディレクトリ管理ユーティリティを使用し、IIS を実行しているコンピュータ上で、新しい仮想ディレクトリ (仮想ルートとも呼ばれています) を定義および登録します。このユーティリティは IIS に新しい仮想ディレクトリと Microsoft SQL Server のインスタンス間の関連付けを作成するように指示します。このユーティリティのユーザー インターフェースに関する情報は [IIS Virtual Directory Management Utility](http://msdn2.microsoft.com/en-us/library/aa196944(sql.80).aspx) (英語情報) をご覧下さい。
SQLXML HTTP 機能を使用する場合、IIS サーバーの名前と仮想ディレクトリは URL の一部として指定されなければなりません。仮想ディレクトリ内の情報 (ログイン、パスワード、アクセス許可などを含む) は特定のデータベースへの接続の確立とクエリの実行のために使用されます。

**SQLXML HTTP** **コンポーネントは既定で有効ですか?**

いいえ、既定では有効ではありません。ブラウザまたは HTTP クライアントを介し URL を使用して SQL Server にアクセスできるようにする前に、管理者はまず IIS サーバー で SQL Server 用の仮想ディレクトリを設定しなければなりません。管理者は、SQLXML のすべてのリリースで提供されている SQLXML Microsoft 管理コンソール (MMC) スナップインを使用します。SQLXML HTTP コンポーネントは IIS ツールを使用して設定することはできません。

**SQLXML** **は** **SQL Server 7.0** **で利用可能ですか?**

いいえ。SQLXML は SQL Server 2000 のみで利用可能です。

**SQLXML** **に影響を及ぼす脆弱性は何ですか?**

2 つの脆弱性があります。

-   IIS サーバー上で攻撃者が選択したコードを実行する可能性がある脆弱性。
-   この脆弱性の影響を受ける SQL Server にアクセス権を持つユーザーで、攻撃者がスクリプトを実行する可能性がある脆弱性。

**SQLXML ISAPI** **エクステンションの未チェックのバッファ** **(CVE-CAN-2002-0186) 1** **番目の脆弱性で、どのようなことが起こる可能性がありますか?**

これはバッファオーバーランの脆弱性です。攻撃者はこの脆弱性を利用し、影響を受けるデータベース サーバーを完全に制御することができる可能性があります。この脆弱性を利用して、攻撃者はサーバー上のデータの追加、削除、変更やハード ドライブの再フォーマットなど、そのほかの操作を行うことができます。
管理者が IIS サーバー で SQLXML HTTP コンポーネントを設定し、有効にしている場合のみ、この脆弱性が悪用される可能性があります。

**何が原因で起こりますか?**

この脆弱性は SQLXML ISAPI エクステンションに、HTTP でのデータ クエリを処理するセクションに未チェックのバッファが含まれるために起こります。

**ISAPI** **とは何ですか?**

ISAPI (Internet Services Application Programming Interface) とは Web 開発者がWeb サーバーの新しいサービスを提供するカスタム コードを書くことを可能にする技術です。このようなコードは次の 2 通りの形式で実装できます。

-   ISAPI フィルタとして実装 – これは ISAPI を使用して、サーバーで発生するイベントへ応答するダイナミック リンク ライブラリ (.dll) です。
-   ISAPI エクステンションとして実装 － これは ISAPI を使用して、IIS により提供される標準の機能のほかに、Web 機能を提供するダイナミック リンク ライブラリです。

この脆弱性で、影響を受けるコードは、SQLXML が HTTP を介し、ユーザーと通信できるようにする ISAPI エクステンションです。

**SQLXML ISAPI** **エクステンションの何が問題になっていますか?**

このエクステンションには未チェックのバッファが含まれています。HTTP で行われるデータベース リクエストが特定の方法で不正な形式にされている場合、バッファ オーバーランが発生します。

**攻撃者はどのようにしてこの脆弱性を利用する可能性がありますか?**

影響を受ける IIS サーバーが SQLXML コンポーネントをホストし、そのIIS サーバーと HTTP セッションを確立できるユーザーであれば誰でも、この脆弱性を利用することができます。

**この脆弱性により攻撃者は何ができますか?**

攻撃者が選択する特定のデータに依存し、次のいずれかの影響があります。

-   データがランダムに選択されている場合、IIS プロセスが異常終了します。
-   データが綿密に選択されている場合、ISAPI エクステンションの実行中に、攻撃者がISAPI エクステンションを変更する可能性があります。

**攻撃者がランダムなデータを攻撃に使用した場合、通常の操作を再開させるためには何が必要ですか?**

SQLXML HTTP サービスをホストしている IIS サーバーを再起動する必要があります。

**攻撃者が綿密に選択したデータを攻撃に使用し、ISAPI** **エクステンションを変更した場合、変更されたプロセスは何を行う可能性がありますか?**

変更されたプロセスは攻撃者の指示通りに任意の操作を行う可能性があります。SQLXML ISAPI エクステンションは LocalSystem 権限で実行されるため、攻撃者はサーバーを完全に制御でき、サーバーで任意の操作を行うことができる可能性があります。

**上記の説明では、攻撃者がサーバーと** **HTTP** **セッションを確立できる場合のみ、この脆弱性が悪用されるとのことでした。これを行うためにはどのようなことが必要条件となりますか?**

まず、管理者は SQLXML を有効にしている必要があります。既定で、これは無効となっています。第 2 に、SQLXML が HTTP を介し通信を行うことができるように構成されている必要があります。このように構成されている場合のみ SQLXML ISAPI エクステンションが存在します。SQLXML が有効である場合でも、別の構成ステップで HTTP 通信を有効にする必要があります。最後に、攻撃者はサーバーへの直接接続が必要となります。
ほとんどの場合、後者のステップはイントラネットのシナリオでのみ可能です。Web 対応であっても、データベース サーバーは通常インターネットに直接接続していません。一般的に、フロントエンド Web サーバーはインターネット ユーザーとデータベース サーバーの仲介をします。このため、攻撃者が Web セッションを確立し、この脆弱性を利用することを阻止します。ほとんどの場合、ユーザーがこのようなサーバーとセッションを確立することができる唯一のシナリオはイントラネットのシナリオです。

**更新プログラムはどのようにこの脆弱性を排除しますか?**

この更新プログラムは ISAPI エクステンション内でバッファが適切に処理されるようにして、この脆弱性を排除します。

**更新プログラムが** **3** **つありますが、どれをインストールする必要がありますか?**

使用中の SQLXML のバージョンにより異なります。SQLXML の最初のバージョンを同梱している SQL Server 2000 を実行している場合、少なくとも SQL Server 2000 用の更新プログラムをインストールする必要があります。しかし、最初のバージョン以降、3 つのバージョンがダウンロード可能となっています。

**SQLXML** **のどのバージョンをインストールしているか分かりません。どのように確認すればよいですか?**

次に SQLXML のどのバージョンがインストールされているかを確認する方法および必要な対策を説明します。

-   IIS サーバーが動作しているコンピュータで、\[スタート\] メニューに「Enterprise Manager」 プログラムを含む 「Microsoft SQL Server」 のプログラム グループが表示されているかどうか確認して下さい。このプログラムがある場合、SQL Server に同梱されている SQLXML のバージョンがインストールされていますので、そのバージョン用の更新プログラムをインストールして下さい。
    SQL Server に同梱されている SQLXML のバージョン用のパッケージは 2 つあります。使用中の MDAC のバージョンに一致するバージョンを選択して下さい。レジストリ キー HKEY\_LOCAL\_MACHINE/Software/Microsoft/DataAccess/FullInstallVer/ をチェックし、2.6 で始まる番号 (MDAC バージョンは 2.6)、または 2.7 で始まる番号 (MDAC バージョンは 2.7) を確認して下さい。
    更新プログラムのインストール中、SQLXML バージョン 1 がインストールされていることを示すメッセージが表示される場合、SQLXML バージョン 1 はサポートの対象となっていないため、下記の指示 (「SQLXML version 1 から、どのようにアップグレードするのですか?」 の項目の説明) に従って SQLXML の新しいバージョンにアップグレードして下さい。
-   IIS サーバーが動作しているコンピュータで、Sqlvdr2.dll を検索します。見つかった場合、SQLXML 2.0 用の更新プログラムをインストールして下さい。
-   IIS サーバーが動作しているコンピュータで、Sqlvdr3.dll を検索します。見つかった場合、SQLXML 3.0 用の更新プログラムをインストールして下さい。

**複数のバージョンをインストールしていますが、どの更新プログラムを適用する必要がありますか?**

インストールされている**各**バージョン用の更新プログラムをインストールする必要があります。

**SQLXML** **バージョン** **1** **から、どのようにアップグレードするのですか?**

SQLXML の最新バージョンは <http://www.microsoft.com/japan/msdn/sqlserver/downloads/sqlxml3.aspx> からダウンロードすることができます。また、<http://www.microsoft.com/downloads/search.aspx?displaylang=ja> で検索することもできます。
新しい SQLXML をインストールした後、IIS 構成ツールが提供され、これにより仮想ディレクトリのプロパティを設定することができます。SQLXML の新しいバージョンへアップグレードするためのボタンがありますので、これをクリックし、SQLXML バージョン 1 からのアップグレードを完了して下さい。

**XML** **タグによるスクリプトの挿入** **(CVE-CAN-2002-0187) 2** **番目の脆弱性で何が起こる可能性がありますか?**

これは特権の昇格の脆弱性です。攻撃者がこの脆弱性を利用し、SQLXML HTTP コンポーネントを実行している IIS サーバーに関連する Internet Explorer セキュリティ ゾーンで、別のユーザーのシステム上でスクリプトを実行する可能性があります。
この脆弱性には問題を緩和する要素が多くあります。

-   この脆弱性は、標的となるユーザーが、影響を受ける SQL Server にクエリを行う許可を所有する場合のみ、悪用される可能性があります。
-   攻撃者は影響を受ける SQL Server 名など、重要な情報を取得していることが必要条件となります。
-   多くの場合、スクリプトは 「イントラネット ゾーン」 で実行されますが、このゾーンは攻撃者自身の Web サイトが配置されているセキュリティ ゾーンと、ほとんど相違点はありません。

**何が原因で起こりますか?**

この脆弱性は XML SQL クエリに含まれるパラメータの 1 つ (Root と呼ばれています) が正しく検証されないために起こります。スクリプトが SQL クエリの一部として Root パラメータに含まれる場合、そのスクリプトはサーバーからの応答に含まれます。ブラウザでレンダリングされると、そのスクリプトは SQLXML HTTP コンポーネントを実行する IIS サーバーに関連する Internet Explorer のセキュリティ ゾーンで実行されます。

**Root** **パラメータとは何ですか?**

Root は SQLXML リクエストに含まれるパラメータで、クエリの結果が正しい形式の XML を構成するようにします。Root はクエリの結果が、単一のトップレベル XML タグを持つ完全な XML ドキュメントとなることを規定します。
たとえば、クエリの結果が次のようであるとしましょう。

`<Customers CustomerID="ALFKI" CompanyName="Alfreds Futterkiste" /><Customers CustomerID="ANATR" CompanyName="Ana Trujillo Emparedados y helados" />`

複数の 「Customers」 タグがあるということは、結果の処理を複雑にする場合もあります。Root パラメータを含むことにより、クエリの結果は次のようになります。

`<ROOT xmlns:sql="urn:schemas-microsoft-com:xml-sql"><Customers CustomerID="ALFKI" CompanyName="Alfreds Futterkiste" /><Customers CustomerID="ANATR" CompanyName="Ana Trujillo Emparedados y helados" />`

**SQLXML** **が** **Root** **パラメータを処理する方法の何が問題になっていますか?**

SQLXML はパラメータの値がスクリプトを含まないことを確認する必要があります。しかし、SQLXML はこれを行いません。このため、XML データベース リクエストが Root パラメータにスクリプトを含む場合、SQLXML は応答にスクリプトを含みます。続いてその応答がブラウザでレンダリングされると、スクリプトが実行されます。

**攻撃者はこれにより、何ができますか?**

最悪の結果をもたらすシナリオでは、この脆弱性により、攻撃者は別のユーザーのシステムでスクリプトを実行する手段を取得できる可能性があります。
攻撃者が、Web サイトを訪問するユーザーに、リンクをクリックするよう誘導することができるWeb サイトをホストしていると仮定します。そのリンクは XML クエリを SQL Sever に送信することができます。そのクエリが、クエリの Root パラメータにスクリプトを含んでいる場合、そのスクリプトはサーバーからの結果の応答に埋め込まれ、応答がレンダリングされる時に、ユーザーのブラウザで実行される可能性があります。

**これにより、攻撃者は何を取得しますか?** **ユーザーがリンクをクリックする時に、攻撃者は単にスクリプトを直接実行できないのではないですか?**

攻撃者の Web ページは、ユーザーがリンクをクリックする時、実際にスクリプトを直接実行しています。しかし、そのスクリプトは攻撃者の Web サイトに関連する Internet Explorer のセキュリティ ゾーンで実行される可能性があります。(既定では、「インターネット ゾーン」 です。) この脆弱性が悪用されると、攻撃者のスクリプトが SQLXML HTTP コンポーネントを実行している IIS サーバーに関連するセキュリティ ゾーンで実行される可能性があります。

**スクリプトはどのゾーンで実行されるのですか?**

特定のシナリオにより異なりますが、ほとんどのケースで、SQLXML コンポーネントを実行している IIS サーバー はイントラネット サーバーであり、このため、スクリプトは 「イントラネット ゾーン」 で実行されます。これにより、攻撃者は通常、追加の権限をほとんど取得することができません。「イントラネット ゾーン」 の既定の設定は、次の 3 点を除き、「インターネット ゾーン」 の設定とまったく同じです。これらの相違点のいずれも、攻撃者が破壊的な操作を行う原因とはなりません。

-   Java の許可 : この設定の既定は 「イントラネット ゾーン」 では 「中」、「インターネット ゾーン」 では 「高」 です。
-   ドメイン間でのデータ ソースのアクセス : これは 「イントラネット ゾーン」 では 「ダイアログを表示する」、「インターネット ゾーン」 では 「無効にする」 に設定されています。
-   既存のクライアント証明書が 1 つ、または存在しない場合の証明書の選択 : これは 「イントラネット ゾーン」 では 「有効にする」、「インターネット ゾーン」 では 「無効にする」 に設定されています。

**攻撃者の** **Web** **サイトを訪問するすべてのユーザーに対し、この脆弱性が悪用される可能性がありますか?**

いいえ。次の条件がすべて当てはまる場合のみ、攻撃者はこの脆弱性を利用することができます。

-   ユーザーが、更新プログラムを適用していない SQLXML HTTP コンポーネントを実行している IIS サーバーにアクセス権を所有する場合。
-   ユーザーが SQL 管理者により、サーバーでクエリを行う許可が与えられている場合。
-   攻撃者が SQLXML HTTP コンポーネント用の IIS サーバーに設定された仮想ディレクトリ名を知っている場合。仮想ディレクトリ名を知っている攻撃者は、ほとんどの場合、ユーザー ネットワークの内部の人物である必要があります。

**この脆弱性は偶発的に発生しますか?**

いいえ。攻撃者が不正なデータを Root パラメータに送る場合のみ、この脆弱性は悪用される可能性があります。

**更新プログラムはどのようにこの脆弱性を排除しますか?**

この更新プログラムは Root パラメータが有効であるかどうかを適切にチェックされるようにして、この脆弱性を排除します。

**更新プログラムを適用する必要があるかどうかはどのように分かるのですか?**

上記の説明 (「更新プログラムが 3 つありますが、どれをインストールする必要がありますか?」 の項目) をご覧ください。

更新プログラム
--------------

<span></span>
この問題に対する更新プログラムは、次のサイトからダウンロードできます。日本語環境でもご利用いただくことができます。

-   SQL Server 2000 に同梱される Microsoft SQLXML のバージョン :
    この問題に対する修正は SQL Server 2000 Service Pack 3 以降に含まれています。SQL Server 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。
    <http://www.microsoft.com/japan/sql/prodinfo/previousversions/downloads/2000/sp3.mspx>
    なお、個別の更新プログラムは以下の Web サイトから入手できます。
    この個別の更新プログラムは SQL Server 2000 **クライアントツール がインストールされている全ての環境** に適用をお願いいたします。クライアント ツールは、SQL Server 2000 をインストールするとデフォルトでインストールされます。

    **注意** **:**
    使用している MDAC のバージョンにより適用する修正モジュールが違いますのでご注意ください。
    使用している MDAC のバージョンの確認方法についてはサポート技術情報 [301202](http://support.microsoft.com/kb/301202) をご覧ください。違う更新プログラムを適用した場合はエラーが表示され更新プログラムの適用は行われません。
    次のファイル名をクリックして、ファイルをダウンロードしてください。

    -   MDAC 2.6 をご使用の環境 : [Q321858\_SQL\_Security\_MDAC26.exe](http://download.microsoft.com/download/sqlsvr2000/sqlxml/q321858/nt45xp/en-us/q321858_sql_security_mdac26.exe)
    -   MDAC 2.7 をご使用の環境 : [Q321858\_SQL\_Security\_MDAC27.exe](http://download.microsoft.com/download/sqlsvr2000/sqlxml/q321858/nt45xp/en-us/q321858_sql_security_mdac27.exe)

-   Microsoft SQLXML バージョン 2:
    [http://www.microsoft.com/downloads/details.aspx?FamilyID=b10fdc29-ba8e-4869-98e4-08464b2c8dd3&DisplayLang=en](http://www.microsoft.com/downloads/details.aspx?familyid=b10fdc29-ba8e-4869-98e4-08464b2c8dd3&displaylang=en)
-   Microsoft SQLXML バージョン 3:
    [http://www.microsoft.comdownloads/details.aspx?FamilyID=05f1a309-be6e-49fe-968d-9833fa15cc12&DisplayLang=en](http://www.microsoft.com/downloads/details.aspx?familyid=05f1a309-be6e-49fe-968d-9833fa15cc12&displaylang=en)

#### 更新プログラムの追加情報

**対象プラットフォーム** **:**
この更新プログラムは SQL Server 2000 [Service Pack 2](http://www.microsoft.com/japan/sql/prodinfo/previousversions/downloads/2000/sp2.mspx) を実行しているシステムにインストールすることができます。

**この修正を含む予定のサービス パック** **:**
この問題に対する更新プログラムは SQL Server 2000 Service Pack 3 に含まれています。

**再起動の必要性** **:**
あり

**更新プログラムに含まれる過去の修正** **:**
なし

**更新プログラムが正しくインストールされたか確認する方法** **:**
SQL Server 2000 に同梱されている SQLXML :

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\DataAccess\\Q321858

SQLXML バージョン 2.0 :

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\SQLXML 2.0\\Q321460

SQLXML バージョン 3.0 :

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\SQLXML 3.0\\Q320833

**警告** **:**
なし

**ローカライゼーション** **:**
この更新プログラムはすべての言語バージョンに適用することができます。

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-030）
    [http://www.microsoft.com/technet/security/bulletin/ms02-030.mspx](http://technet.microsoft.com/security/bulletin/ms02-030)
-   サポート技術情報 （KB） 文書番号 ： 321911
    [\[MS02-030\] SQLXML のセキュリティ アップデート](http://support.microsoft.com/kb/321911)

**更新履歴** **:**

-   2002/6/13: このセキュリティ情報ページを公開しました。
-   2002/6/24: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
