---
TOCTitle: 'MS02-049'
Title: 'マイクロソフト セキュリティ情報 MS02-049 - 警告'
ms:assetid: 'ms02-049'
ms:contentKeyID: 61228474
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-049(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS02-049 - 警告
===============================================

警告なしで Web ページが Visual FoxPro 6.0 アプリケーションを起動する (326568)
-----------------------------------------------------------------------------

公開日: 2002年9月5日 | 最終更新日: 2002年9月18日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Visual FoxPro 6.0 を使用しているお客様

**脆弱性の影響** **:**
攻撃者がユーザーのシステムを制御する可能性があります。

**最大深刻度** **:**
中

**推奨する対応策** **:**
Visual FoxPro 6.0 を使用しているお客様は直ちに更新プログラムをインストールして下さい。

**影響を受けるソフトウェア** **:**

-   Microsoft Visual FoxPro 6.0

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
一般的に、製品がインストールされる時、その製品自体が Internet Explorer に登録される必要があります。これにより、製品は、Web ページから参照される時、Internet Explorer がその製品に関連するファイルを処理する方法を指定することができます。たとえば、製品はファイルが開かれる前に警告ダイアログをユーザーに表示するかどうかを指定することができます。
Visual FoxPro 6.0 はこの登録を行なわないため、Web ページが Visual FoxPro アプリケーション (例 : .app ファイル) を自動的に起動する状況が発生します。ほとんどの場合、これはセキュリティ上の脆弱性とはなりません。この理由は Visual FoxPro 6.0 がファイル名を判断し Visual FoxPro 6.0 自体が起動されますが、通常 .app ファイルは実行されないためです。しかし、アプリケーションのファイル名が特定の方法で構成されている場合、2 度目のエラー (Visual FoxPro 6.0 がアプリケーションのファイル名を評価する方法に関連します。) により、Visual FoxPro 6.0 が起動されるだけでなく、そのアプリケーションも実行される可能性があります。
この脆弱性は、Visual FoxPro アプリケーションを参照する Web ページを作成し、それを Web サイトにホストするか、または HTML 形式の電子メールとしてユーザーに送ることにより、悪用される可能性があります。ユーザーが Visual FoxPro 6.0 または Visual FoxPro 6.0 ランタイムを含む製品をインストールしており、アプリケーションのファイル名が特定の方法で構成されている場合、そのアプリケーションが実行される可能性があります。これにより、そのアプリケーションはデータベースに問い合わせを行うばかりでなく、ユーザーのセキュリティ コンテキストでシステム コマンドを実行できる可能性があります。

**問題を緩和する要素** **:**

-   Visual FoxPro 6.0 (または Visual FoxPro 6.0 ランタイム) がシステムにインストールされている場合のみ、この脆弱性が悪用される可能性があります。そのほかの製品および Visual FoxPro のそのほかのバージョンはこの脆弱性の影響を受けません。
-   アプリケーションが取得できる最大の権限はユーザーの権限です。ユーザーがより低い権限を与えられたコンテキストで操作を行っている場合、アプリケーションにより引き起こされる損害が制限されます。

**深刻度** **:**

|                       | インターネット サーバー | イントラネット サーバー | クライアント システム |
|-----------------------|-------------------------|-------------------------|-----------------------|
| **Visual FoxPro 6.0** | 低                      | 低                      | 中                    |

上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。

**脆弱性識別番号** **:**
[CAN-2002-0696](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0696)

**テストしたバージョン** **:**
マイクロソフトは Visual FoxPro 6.0 および 7.0 のテストを行い、これらの脆弱性による影響を評価しました。それ以前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**どのようなことが起こる可能性がありますか?**

この脆弱性により、攻撃者は別のユーザーのシステムで Visual FoxPro アプリケーションを実行する可能性があります。これにより、攻撃者はプログラムの読み込み、実行、システム上のデータの変更、ハード ドライブの再フォーマットなど、ユーザーに可能な任意の操作を行う可能性があります。
この脆弱性は次の 2 つの条件が存在する場合のみ、悪用される可能性があります。

-   Visual FoxPro Version 6.0 (または下記で説明されているように Visual FoxPro Version 6.0 の特定の機能がインストールされている他の製品) がシステムにインストールされている場合。そのほかの製品および Visual FoxPro のそのほかのバージョンはこの脆弱性の影響を受けません。
-   アプリケーションのファイル名が特定の、通常とは異なる構成である場合。

**何が原因で起こりますか?**

ユーザーに警告をせずに Web ページから Visual FoxPro アプリケーションを起動することができるために、この脆弱性が起こります。

**Visual FoxPro** **とは何ですか?**

[Visual FoxPro](http://msdn.microsoft.com/vfoxpro/) (英語情報) とはオブジェクト指向データベース管理システムで、これによりデスクトップや Web のためのデータベース ソリューションの開発が可能になります。ここで問題となっている Visual FoxPro のバージョンは 6.0 で、スタンド アロン製品および [Visual Studio 6.0](http://www.microsoft.com/japan/msdn/vs_previous/vbasic/) (英語情報) の一部として出荷されています。

**Visual FoxPro** **アプリケーションとは何ですか?**

Visual FoxPro では (ほとんどのデータベース システムのように)、データベースへのアクセスを自動化するアプリケーションを書くことができます。このようなアプリケーションはデータベースへの問い合わせや、仕様上、ユーザーのシステムで操作を行うことができます。

**Visual FoxPro** **アプリケーションが処理される方法の何が問題になっていますか?**

2 つの問題が一体となり、この脆弱性を発生させます。1 番目の問題とは Visual FoxPro 6.0 自体が Internet Explorer に登録されません。製品がインストールされる時、その製品自体が Internet Explorer に登録され、そのアプリケーションに関連するファイルが自動で開かれるか、または開かれる前にユーザーの承認を必要とするかを示す必要があります。しかし、Visual FoxPro 6.0 はこれを行いません。
ほとんどの状況で、これはセキュリティ上の脆弱性とはなりません。ほとんどの場合、Visual FoxPro 6.0 アプリケーションが開かれると Visual FoxPro が起動しますが、実際にはアプリケーションを実行しません。しかし、アプリケーションのファイル名が特定の方法で構成されている場合、Visual FoxPro 6.0 に解釈させ、アプリケーションを実行させます。

**この脆弱性により、攻撃者は何ができますか?**

この脆弱性により、攻撃者は別のユーザーのシステムで Visual FoxPro アプリケーションを起動する可能性があります。その後、アプリケーションはユーザーがシステムで実行する権限のある任意の操作を行う可能性があります。

**攻撃者はどのようにしてこの脆弱性を悪用する可能性がありますか?**

攻撃者は Visual FoxPro アプリケーションを呼び出す Web ページを作成し、その Web ページを Web サイトにホストするか、または HTML 形式の電子メールとして別のユーザーに送る必要があります。いずれの場合でも、ユーザーがその Web ページを開き、Visual FoxPro 6.0 がシステムにインストールされている場合、アプリケーションは警告なしで起動します。

**システムに** **Visual FoxPro 6.0** **をインストールしていませんが、何か危険はありますか?**

この脆弱性は Visual FoxPro、具体的には Visual FoxPro の バージョン 6.0 がシステムにインストールされている場合のみ悪用される可能性があります。しかし、重要な点は Visual FoxPro がインストールされている可能性は 2 通りあるということです。最も一般的な例として、システムに Visual FoxPro 6.0 をインストールしたということです。
しかし、サードパーティの製品により Visual FoxPro 6.0 ランタイムが埋め込まれている可能性もあります。本質的にはサポート機能のセットのないコア データベース エンジンです。このような製品をインストールした場合もまた、この脆弱性の影響を受けます。

**どのようなサードパーティの製品に** **Visual FoxPro 6.0** **ランタイムがインストールされているのですか?**

この質問に答えることは不可能です。ランタイムは商業的な製品だけでなく、企業内部での使用のために書かれた多くのアプリケーションにより埋め込まれます。このような製品を使用していると考えられる場合、vfp6r.dll、vfp6t.dll または vfp6run.exe のいずれかのファイルをシステムで検索することにより、Visual FoxPro 6.0 ランタイムがシステムに存在しているかどうかを確認することができます。これらのいずれかのファイルが存在している場合、Visual FoxPro 6.0 はシステムにインストールされており、更新プログラムが必要となります。

**システムに** **Visual FoxPro 7.0** **をインストールしていますが、何か危険はありますか?**

いいえ、ありません。この脆弱性は Visual FoxPro 6.0 のみに影響を及ぼします。

**過去に** **Visual FoxPro 6.0** **がシステムに存在していましたが、バージョン** **7.0** **にアップグレードしました。何か危険はありますか?**

いいえ、ありません。バージョン 7.0 にアップグレードすることにより、この脆弱性は排除されます。これはサイド バイ サイド インストールを行っていても当てはまります。つまり、バージョン 6.0 がすでに存在しているシステムにバージョン 7.0 をインストールしており、両方のバージョンをシステムに存在させている場合にも当てはまります。

**更新プログラムをインストールする以外に、この脆弱性を排除する方法はありますか?**

はい、あります。上記で説明したように、Visual FoxPro 6.0 が Internet Explorer に Visual FoxPro アプリケーションの処理方法を伝えないことが原因の一部となって、この脆弱性が発生します。手動で次の手順に従うことにより、Visual FoxPro アプリケーションの処理方法を Internet Explorer に伝えるようにすることができます。

1.  \[Control Panel\] を開きます。
2.  \[Tools\] を選択し、次に \[Folder Options\] を選択します。
3.  \[File Types\] タブをクリックします。
4.  \[Registered File Types\] という名前のついたスクロール ボックスで、“APP” 拡張子を選択します。（この拡張子が一覧に表示されない場合、Visual FoxPro はインストールされていないという意味です。）
5.  \[Advanced\] をクリックします。
6.  \[Confirm open after downloading\] を選択します。
7.  \[OK\] をクリックし、\[Edit File Type\] ダイアログを閉じます。
8.  \[OK\] をクリックし、\[Folder Options\] ダイアログを閉じます。
9.  \[Control Panel\] を閉じます。

**更新プログラムは何を修正しますか?**

この更新プログラムは Visual FoxPro アプリケーション (.app) ファイルを Internet Explorer に登録し、また特定のファイル名が判断され、起動される原因となるコードの問題を排除します。

更新プログラム
--------------

<span></span>
Microsoft Visual FoxPro 6.0 は英語版製品のみが提供されております。そのため、日本語版更新プログラムはございません。なお、この問題に対する英語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft Visual FoxPro 6.0:
    [http://www.microsoft.com/downloads/details.aspx?FamilyId=532F6120-578E-43AD-A75F-E492696167BC&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=532f6120-578e-43ad-a75f-e492696167bc&displaylang=en)

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**
この更新プログラムは Visual FoxPro 6.0 を実行しているシステムにインストールすることができます。Service Pack の必要はありません。

**この修正を含む予定のサービスパック** **:**
Visual FoxPro 6.0 用の Service Pack は現在予定されていません。

**再起動の必要性** **:**
なし

**更新プログラムのアンインストール** **:**
不可

**更新プログラムに含まれる過去の修正** **:**
なし

**更新プログラムが正しくインストールされたか確認する方法** **:**

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\VFPODBC\\Q326568
-   各ファイルを確認するためには、サポート技術情報 [326568](http://support.microsoft.com/kb/326568) のファイル欄に記載されている日付、時間、およびバージョン情報を参照して下さい。

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-049）
    [http://www.microsoft.com/technet/security/bulletin/ms02-049.mspx](http://technet.microsoft.com/security/bulletin/ms02-049)
-   サポート技術情報 （KB） 文書番号 ： 326568
    [\[MS02-049\] 警告なしで Web ページが Visual FoxPro 6.0 アプリケーションを起動する](http://support.microsoft.com/kb/326568)

**更新履歴** **:**

-   2002/9/5: このセキュリティ情報ページを公開しました。
-   2002/9/18: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
