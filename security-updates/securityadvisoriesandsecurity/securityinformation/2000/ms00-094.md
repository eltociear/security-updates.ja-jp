---
TOCTitle: 'MS00-094'
Title: 'マイクロソフト セキュリティ情報 MS00-094 - 緊急'
ms:assetid: 'ms00-094'
ms:contentKeyID: 61228260
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-094(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS00-094 - 緊急
===============================================

「電話帳サービス バッファ オーバーフロー」 の脆弱性に対する対策
---------------------------------------------------------------

公開日: 2000年12月5日 | 最終更新日: 2001年8月6日

#### 概要 :

マイクロソフトは Microsoft® Windows NT® 4.0 と Windows® 2000 Server オプショナル サービスの脆弱性を排除する更新プログラムをリリースしました。この脆弱性を利用することでサービスを動作しているリモート サーバーで悪意を持ったプログラムが実行可能となります。

**影響を受けるソフトウェアのバージョン** **:**

-   Microsoft Windows NT 4.0 Server
-   Microsoft Windows NT 4.0 Server, Enterprise Edition
-   Microsoft Windows 2000 Server
-   Microsoft Windows 2000 Advanced Server

**注** **:**
電話帳サービスは IIS 4 または IIS 5 にのみインストールできます。

### 詳細

問題
----

電話帳サービスは NT 4 Option Pack と Windows 2000 に付随して出荷されているオプショナル コンポーネントです。このサービスは ダイアル アップ ネットワーク クライアントと一緒に使用され、あらかじめ登録されたダイアルアップ ネットワーキング サーバーのリストを提供します。

特定の形式の不正な URL が、電話帳サービスを動作している IIS 4 や IIS 5 Web サーバーで任意のコードを実行するために使用されます。これで悪意のあるユーザーが IUSR\_コンピュータ名アカウント （IIS 4） や IWAM\_コンピュータ名アカウント （IIS 5） と同等のマシンで、潜在的にその権限を取得することができます。 IUSR アカウントと IWAM アカウントは Everyone グループのメンバーです。上記のアカウントを含む Everyone グループは Web サーバーでオペレーティング システム コマンドを実行できる場合があります。

この脆弱性を利用して、悪意のあるユーザーが管理者レベルの権限を取得することはできませんが、特定のデータの追加、変更、削除、または既にサーバーにあるコードの実行、新しいコードをサーバーにアップロードして実行することは可能です。

電話帳サービスはデフォルトでは IIS 4 と IIS 5 サーバーにはインストールされていません。このサービスは NT 4 Option Pack や Windows 2000 オプショナル ネットワーク コンポーネントにより、特別にインストールする必要があります。このサービスをインストールしていないお客様はこの脆弱性による影響を受けません。

よく寄せられる質問
------------------

**マイクロソフトセキュリティ情報** **MS00-094** **はどのような内容の通知ですか?**

このマイクロソフト セキュリティ情報 MS00-094 は、Microsoft® Windows NT® 4 と Windows® 2000の一部として出荷されるオプショナル サービスのセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことを、お客様にお知らせするものです。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**この脆弱性はどれくらいの範囲に影響を与えますか?**

これは[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。この脆弱性を利用して、悪意のあるユーザーが自身の選択によるコードを特定のオプショナル サービスを動作している Web サーバーで実行することができます。そして、悪意のあるユーザーが、対話的にサーバーにログインしているユーザーが動作可能なコードを潜在的に実行することができます。コードのインストールや動作、ファイルや Web ページの追加、変更、削除そしてその他の操作が可能になります。

この脆弱性は Web サーバー上の電話帳サービスの存在によるものです。特に電話帳サービスを Web サーバーにインストールしていないユーザーにはこの脆弱性による危険はありません。

**この脆弱性の原因は何ですか?**

電話帳サービスが電話帳更新の要求を処理するコードの部分にチェックされていないバッファを持つため、この脆弱性が発生します。特殊な形式の間違った要求が供給されると、バッファをオーバーランします。

**電話帳サービスとは何ですか?**

電話帳サービスを使用して、リモート ユーザーはダイアルインの電話番号の最新一覧が得られます。どのように使用されるかを理解するために、典型的なシナリオを考えてみましょう。

BigCorp 社が、在宅で、または通勤中に仕事をしている従業員にネットワークにダイアルさせるとします。おそらく情報技術部が RAS (Remote Access Service) や PPTP (Point-to-Point Tunneling Protocol) サーバーをセット アップして、従業員がダイアルできるようにするでしょう。しかし、従業員は正しいダイアルイン番号を見つけ、ネットワークへの接続を設定する方法が必要となります。情報技術部は Connection Manager　を使用して、この方法を簡単にします。Connection Manager はユーザーがプログラムされる前の一覧からダイアルイン番号を選択し、ダイアルアップ接続を簡単にするアプリケーションです。

Connection Manager の電話番号一覧をどのように最新のものにしておくかが問題となります。ここで電話帳サービスが役立ちます。電話帳サービスは IIS サーバーで動作し、ダイアルアップ番号に関する情報を提供します。通常、これは各ダイアルイン接続中に Connection Manager により、裏面で呼び出されます。しかし、これは通常の HTTP 要求を使用して、ユーザーが直接呼び出すこともできます。

**電話帳サーバーの何が問題なのですか?**

電話帳サービスには要求を扱うコードの 1 部にチェックされていないバッファがあります。悪意のあるユーザーが特殊な形式の間違った HTTP 要求を電話帳更新のために送信すると、電話帳サービスがクラッシュしたり、悪意のあるユーザーの選択によるコードがサーバーで実行可能となります。

**この脆弱性を利用して、悪意のあるユーザーは何ができますか?**

形式の間違った HTTP 要求を該当するサーバーに送信することにより、悪意のあるユーザーは次の 2 つのことができます。

-   無作為なデータでバッファをオーバーランさせ、該当するマシンの電話帳サービスを異常終了させることができます。
-   特別に選択したデータでバッファをオーバーランさせ、悪意のあるユーザー自身が選択したコードをサーバーで実行することができます。

**この脆弱性により電話帳サービスが異常終了させられた場合、通常のサービスに戻すにはどうしたらいいですか?**

運用者はサービスを再起動させる必要があります。サーバーを再ブートする必要はありません。

**この脆弱性によりコードが動作された場合、コードは何をしますか?**

IIS サーバーがどのように構成されているかによります。デフォルトで、電話帳サーバーは IUSR\_コンピュータ名 アカウントのセキュリティ コンテキスト内の IIS 4.0 で動作しています。IIS 5.0 はデフォルトで IWAM\_マシン名アカウントのコンテキストで動作します。

**上記のことでコードは何ができますか?**

IUSR\_コンピュータ名と IWAM\_コンピュータ名はどちらも権限の高いアカウントではありません。実際、Web サーバーへの匿名の接続で作成されるものです。これらのアカウントでコードを実行する権限があっても、悪意のあるユーザーはサーバーに対する管理的コントロールを取得できません。しかし、どちらのアカウントも Everyone グループのメンバーであるため、システムでのデータの追加、変更、削除、マシンでの既存のプログラムの実行、新しいソフトウェアのアップロードと実行を行うことができます。

**該当するマシンは通常インターネットに接続していますか?**

電話帳サービスは IIS サーバーにインストールされる必要があります。この IIS サーバーはインターネットを介してアクセス可能ですが、回避策として電話帳サービスはリモート ユーザーが接続している RAS や PPTP サーバーを介してのみアクセス可能な IIS サーバーにインストールして下さい。

**電話帳サービスはデフォルトでインストールされていますか?**

いいえ、インストールされていません。これは管理者がインストールしなければなりません。IIS 4.0 システムでは NT 4 Option Pack に付随して出荷される Internet Connection Services for Microsoft RAS の 1 部分として読み込まれます。IIS 5.0 システムではアプリケーションの追加と削除のアプレットにより Optional Networking Components の一部分として読み込まれます。重要な点は、電話帳サーバーは IIS サーバーでのみ動作しますが、特別にインストールしてあれば、動作します。電話帳サーバーがマシンにインストールされていなければ、この問題による影響は受けません。

**だれが更新プログラムを適用する必要がありますか?**

マイクロソフトは IIS サーバーに電話帳サービスをインストールしているユーザーにこの更新プログラムのインストールを考慮することを推奨します。

**どこで更新プログラムを入手できますか?**

マイクロソフト セキュリティ情報 MS00-094 をご覧ください。

**更新プログラムはどのように使用するのですか?**

マイクロソフト サポート技術情報 [276575](http://support.microsoft.com/kb/276575) には、お客様のサイトに更新プログラムを提供するための詳細な情報が記載されています。

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS00-094 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](http://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトはサポート技術情報 [276575](http://support.microsoft.com/kb/276575) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](http://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカルサポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](http://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

この問題を解決するための日本語版更新プログラムは、以下のサイトからダウンロードできます。

-   Microsoft Windows NT 4.0:  
    この問題に対する更新プログラムは Windows NT 4.0 セキュリティ ロールアップ パッケージに含まれています。セキュリティ ロールアップ パッケージは次のリンクから入手してください。

    [299444](http://support.microsoft.com/kb/299444) Post Windows NT 4.0 SP6a セキュリティ ロールアップ パッケージ (SRP)

    なお、個別モジュールは次のリンクから入手することができます。

    -   PC/AT 互換機用  
        [http://www.microsoft.com/downloads/details.aspx?FamilyId=37B1473A-33E6-446A-BD16-39B85548CCC6&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=37b1473a-33e6-446a-bd16-39b85548ccc6&displaylang=ja)  
        ダウンロード先のリストから Japanese Language Version を選択してください。
    -   NEC PC98 用  
        [http://download.microsoft.com/download/winntsp/patchNEC/q276575/NT4/JA/jpnQ276575n.EXE](http://download.microsoft.com/download/winntsp/patchnec/q276575/nt4/ja/jpnq276575n.exe)
        ダウンロード先のリストから Japanese NEC Language Version を選択してください。

    **注** **:**  
    NT 4.0 の更新プログラムは Windows NT 4.0 Server Service Pack 4、5、6a を実行しているシステムにインストールすることができます。

-   Windows 2000

    この問題に対する修正は Windows 2000 Service Pack 2 以降に含まれております。最新の Windows 2000 Service Pack については次のリンクから入手してください。

    <http://www.microsoft.com/japan/windows2000/downloads/>

    個別モジュールは次のリンクから入手することができます。  
    [http://www.microsoft.com/downloads/details.aspx?FamilyId=c2efb014-bc57-4caf-ad28-4e3e735e1934&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=c2efb014-bc57-4caf-ad28-4e3e735e1934&displaylang=ja)

    -   PC/AT 互換機用  

        ダウンロード先のリストから Japanese Language Version を選択してください。

    -   NEC PC-9800 シリーズ用

        ダウンロード先のリストから Japanese NEC Language Version を選択してください。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS00-094）  
    [http://www.microsoft.com/technet/security/bulletin/ms00-094.mspx](http://technet.microsoft.com/security/bulletin/ms00-094)
-   サポート技術情報 （KB） 文書番号 ： 276575  
    [「電話帳サービス バッファ オーバーフロー」の更新プログラム](http://support.microsoft.com/kb/276575)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*