---
TOCTitle: 'MS00-086'
Title: 'マイクロソフト セキュリティ情報 MS00-086 - 緊急'
ms:assetid: 'ms00-086'
ms:contentKeyID: 61228252
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-086(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS00-086 - 緊急
===============================================

「Web サーバーによるファイル要求の解析」 の脆弱性に対する対策
-------------------------------------------------------------

公開日: 2000年11月8日 | 最終更新日: 2001年1月18日

#### 概要 :

2000 年 11 月 6 日にマイクロソフトは元のこのセキュリティ情報にて、Microsoft® Internet Information Services 5.0 の脆弱性を排除する英語版更新プログラムをリリースしました。この脆弱性を利用することにより、悪意のあるユーザーは、標的とする Web サーバー上でオペレーティング システムのコマンドを実行することができます。最初の発表からセキュリティ情報は何度か更新されています。

2000 年 11 月 10 日に、この脆弱性の影響を明らかにしました。  
2000 年 11 月 21 日に、再度新たに見つかった２つの新種の脆弱性について説明しました。  
2000 年 11 月 30 日に、更に再度、IIS 5.0 の更新プログラムに脆弱性が見つかりましたので、最新の英語版更新プログラムを適用することを推奨します。

最新の脆弱性は、前回リリースした IIS 5.0 版用の更新プログラムにのみ影響がありました。一部新たに発見されたこの脆弱性は、今回リリースされた更新プログラムにより解決されます。しかし、MS00-078 で改善された更新プログラムを導入した場合でも、マイクロソフト セキュリティ情報の MS00-078 に記述がある 「Web サーバー フォルダへの侵入でサーバーに問題」が発生します。この 脆弱性のため、マイクロソフトは IIS 5.0 をお使いのお客様には下記にある最新更新プログラムを適用することを推奨します。 「Web サーバーによるファイル要求の解析」と「 Webサーバー フォルダへの侵入」の両者の脆弱性を防ぎます。IIS 4.0 版用の更新プログラムにはこの脆弱性は存在しませんので IIS 4.0 の更新プログラムを適用済みのお客様は今回対応する必要はありません。

**影響を受けるソフトウェアのバージョン** **:**

-   Microsoft Internet Information Server 4.0
-   Microsoft Internet Information Services 5.0

### 詳細

問題
----

IIS は、実行可能ファイルに対する有効なリクエストを受け取ると、ファイルを実行するために、リクエストされたファイルの名前をオペレーティング システムに渡します。しかし、実装上の問題により、ファイル名と 1 つ以上のオペレーティング システム コマンドを含む、特殊なファイル リクエストを特別に生成することが可能です。こうしたリクエストを受け取った場合、IIS は、その文字列全体をオペレーティング システムに渡します。この結果、まずファイルが処理され、その後コマンドが実行されます。

Web サーバー上でオペレーティング システムのコマンドを実行できるため、悪意のあるユーザーは、対話的にログオンするユーザーで実行可能なほとんど全ての操作を行うことができます。この脆弱性により、悪意のあるユーザーがサーバーの管理者権限を取得できるわけではありませんが、それでも広範囲に渡って損害を与えることが可能になります。たとえば、サーバー上のファイルの追加、削除、変更を行ったり、既にサーバーに存在するコードを実行したり、自分で選択したコードをアップロードして実行したりすることが可能です。

この脆弱性を利用するために使われるファイル リクエストの 種類に３つの重要な制約があります。

-   悪意のあるユーザーが.bat か.cmd ファイルを要求する場合
-   ファイルが存在する場合
-   悪意のあるユーザーがファイルの実行権限を持っている場合

上記の制約は問題の範囲を制限しますが、軽減される訳ではないことに注意してください。多くのサード パーティ製のウェブ サーバー用のソフトウェア製品はデフォルトでバッチ ファイルをインストールします。マイクロソフトは該当するIIS バージョンを使用中のお客様にシステム中に、サイトにアクセスした訪問者が実行できる.bat か .cmd ファイルを含んでいないか確認することを推奨します。そしてファイルが存在する場合は、直ちに更新プログラムを導入してください。この更新プログラムは Microsoft Security Bulletin MS00-078 に説明のある「Web サーバー フォルダへの侵入」の脆弱性も排除します。

よく寄せられる質問
------------------

**マイクロソフトセキュリティ情報** **MS00-086** **はどのような内容の通知ですか?**

このマイクロソフト セキュリティ情報 MS00-086 は、Microsoft® Internet Information Server 4.0 と Microsoft® Internet Information Services 5.0のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことを、お客様にお知らせするものです。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**なぜこのセキュリティ情報は再発行されたのですか?**

マイクロソフトはこのセキュリティ情報を何度か再発行しています。最近のセキュリティ情報では、IIS 5.0 バージョンの更新プログラムにエラーがあったことをお知らせし、IIS 5.0 を使用する全てのお客様に現在利用可能である最新バージョンの更新プログラムをインストールすることを推奨しました。IIS 4.0 バージョンの更新プログラムはエラーによる影響はありませんので、IIS 4.0 バージョンの更新プログラムを適用したお客様は新たな対応策は必要ありません。

**エラーとは何ですか?**

IIS 5.0 バージョンの更新プログラムはここで説明している脆弱性に対する保護を行います。 しかし、この更新プログラムを適用すると、サーバーが過去に修正された別の脆弱性による影響を受けることが分かりました。その脆弱性に対する更新プログラムがインストールされていても、影響を受けます。ここで言う過去の脆弱性とは、マイクロソフト セキュリティ情報 [MS00-078](http://technet.microsoft.com/security/bulletin/ms00-078) で説明した 「Web サーバー フォルダへの侵入」 の脆弱性です。

**このエラーはこの脆弱性が与える影響の範囲を変えますか?**

いいえ、変えません。「Web サーバーのファイル リクエスト」 の脆弱性による影響の範囲は前回説明したものと同じです。

**この脆弱性はどれくらいの範囲に影響を与えますか?**

この脆弱性により、悪意のあるユーザーは該当する Web サーバーでオペレーティング システム コマンドを実行することが可能となります。これにより Web ページの変更やファイルの追加、変更、削除、ハード ドライブの再フォーマット、その他サーバーに対して自分の選択したコードをアップロードしてそれを実行するなど、いろいろな操作が可能になってしまいます。

この脆弱性は、悪意のあるユーザーが .bat ファイルまたは .cmd ファイルの少なくとも 1 つに実行権限がある場合に利用されてしまいます。それでもこの脆弱性により、悪意のあるユーザーにサーバーの管理者コントロールを与えられるわけではありません。しかし、サーバーに対話的にログオンしているユーザーが持つ通常の権限を与えます。これらの権限だけでも、悪意のあるユーザーが広範囲に及ぶ損害を起こすことが可能です。また、別の権限を得るためにさらにどこから攻撃を開始するかを考える手助けとなる場合もあります。

**この脆弱性の原因は何ですか?**

この脆弱性は IIS がファイル リクエストを解析する方法における問題が原因です。無効なファイル リクエストをサーバーに送ることにより、悪意のあるユーザーもまた、サーバーにオペレーティング システム コマンドを送ることが可能となります。これは IIS の匿名ユーザー アカウントのセキュリティ コンテキストで処理します。

**「IIS** **がファイルリクエストを解析する方法における問題」とはどういう意味ですか?**

「ファイル リクエストを解析する」とは、IIS がユーザーのリクエストをファイルのために解釈する課程を意味します。ユーザーが Web サーバーからファイルをリクエストする時、サーバーが行わなければいけないタスクの 1 つは、そのリクエストを解釈して正しい動作を決定することです。

正しい動作とはリクエストされているファイルの種類によります。たとえば、ユーザーが静的 HTML ファイルをリクエストする場合、単にそのファイルをユーザーに送ることが正しい動作となります。同様に、ユーザーが ASP ファイルをリクエストする場合、サーバーでそのファイルを処理して、その結果をユーザーに送ることが正しい動作となります。各種ファイルにはそれに関連した適切な動作があります。

**どのような種類のファイルがこの脆弱性と関係があるのですか?**

この問題は IIS がスクリプト、バッチ ファイル、コンパイルされたファイルなど、実行可能ファイルへのリクエストを扱う方法に関連しています。IIS は実行可能ファイルへの有効なリクエストを受け取ると、オペレーティング システムにそのファイル名を渡し、そしてそのファイルを実行します。

しかし、IIS がリクエストを扱う方法に問題があります。ファイル名以外を含む実行可能ファイルへのリクエストを生成することができます。このファイルはオペレーティング システム コマンドの前のファイルの名前を実際に含んでいます。この問題のため、IIS はリクエストを拒否せず、ファイル名とオペレーティング システム コマンドの全体の文字列をオペレーティング システムに渡します。この結果、オペレーティング システム コマンドがサーバーで実行されてしまいます。

**リクエストで使用されるファイルに何か制限はありますか?**

はい。3 つあります。

-   ファイルは実際にサーバーに存在している必要があります。悪意のあるユーザーは単にファイル名を作りあげることはできません。
-   ファイルは .bat か .cmd のいずれかの拡張子を持たなければなりません。
-   ファイルはユーザーが実行許可を持っているフォルダの中に存在している必要があります。

**Web** **サーバーがバッチファイルをホストしていて、それらのバッチファイルを** **Web** **サイト訪問者が実行できることは一般的なのですか?**

一般的にそれは推奨されていません。しかし、サード パーティ による Web サーバー向けの製品の多くはデフォルトで Web 訪問者が許可により実行可能なバッチ ファイルをインストールしています。このため、該当する製品を運用している管理者はサーバーがそのようなコンテンツをホストしているかどうか確認することが重要です。

**悪意のあるユーザーがこの脆弱性を利用した場合、どのセキュリティコンテキストでオペレーティングシステムコマンドが実行されるのですか?**

オペレーティング システム コマンドは Web サイトに認証されているユーザーのセキュリティ コンテキストで実行されます。つまり、ほとんどの場合、組み込みの「IUSR\_コンピュータ名」アカウントでコマンドが実行されます。これは Web サイトへの匿名訪問者に代わり、Web 操作を行うアカウントです。

公共の Web サイトが、「IUSR\_コンピュータ名」以外のユーザー アカウントをユーザーに認証を許可することはまれですが、このような場合、オペレーティング システム コマンドはユーザーが認証を行ったアカウントの権限で実行されます。たとえば、Web 管理者が Joe という名前のユーザー アカウントを作成したとします。すると悪意のあるユーザーはJoe として Web サイトに対し認証を行います。悪意のあるユーザーがこの脆弱性を利用すると、オペレーティング システム コマンド はJoe アカウントのセキュリティ コンテキストで実行します。

**「IUSR\_コンピュータ名」アカウントはどのような権限を持っているのですか?**

「IUSR\_コンピュータ名」 アカウントは IIS では比較的少ない権限しか持っていません。Web サイト訪問者の一般的な目的のための使用に適切な権限だけです。しかし、この脆弱性により悪意のあるユーザーが IIS により強制されている制限を回避し、直接オペレーティング システム レベルで操作ができます。本質的に、「IUSR\_コンピュータ名」 アカウントのセキュリティ コンテントでオペレーティング システム コマンドを実行する権限の取得すると、マシンにローカルでログオンできるユーザーに通常可能な権限と同じものが可能となります。

**この脆弱性により悪意のあるユーザーはマシンでの完全なコントロールを取得してしまうのですか?**

いいえ。取得しません。「IUSR\_コンピュータ名」アカウントはそれほど多くの重要なファイルやツールにアクセス権を持ちません。たとえば、Security Account Manager ファイル (sam.\_) を含む winnt\\repair フォルダにあるシステム ファイルのバックアップ コピーは管理者だけがアクセス可能です。これは、この脆弱性により取得できません。同様に ローカル ユーザーとグループ スナップインなどのツールは実行の際、管理者権限が必要となります。

しかし、悪意のあるユーザーが引き起こす可能性のある損害を過小評価してはいけません。これらの権限でさえも、悪意のあるユーザーが大きな損害を引き起こす機会を阻止できるとは限りません。さらに、この脆弱性で悪意のあるユーザーはまた別の攻撃をどこから行うかを決める足がかりをつかみ、さらに別の権限を得ようとするかもしれません。たとえば、既知の脆弱性を利用する悪意のあるコードをアップロードし、これを利用する可能性もあります。

**悪意のあるユーザーはどのようなことができるのですか?**

本質的に、この脆弱性で、悪意のあるユーザーは、対話的にログオンしているユーザーと同じ操作ができます。デフォルトで、ファイルの読み書き、ハード ドライブの再フォーマット、Web ページの変更などさまざまな操作が可能となります。さらに追加ソフトウェアをマシンにアップロードし、それを実行することも可能です。「IUSR\_コンピュータ名」アカウントとして、コードの操作の権限を取得すると、悪意のあるユーザーはこのアクセスを利用して、また別の権限を取得しようとする可能性があります。

**この脆弱性はセキュリティ情報**[**MS00-078**](http://technet.microsoft.com/security/bulletin/ms00-078)**で説明されている「Web** **サーバーフォルダへの侵入」の脆弱性と関連がありますか?**

いいえ。ありません。これらの脆弱性を利用するためのシナリオや影響に類似点があるため、互いに関連があると言い切ってしまうのは簡単です。しかし、実際には 2 つの脆弱性は関連していません。

**これら** **2** **つの脆弱性が関連していないとしたら、なぜこの問題に対する更新プログラムは「Web** **サーバーフォルダへの侵入」の脆弱性も排除するのですか?**

これら 2 つの問題は W3SVC.DLL. による機能を含みます。ここで提供されている更新プログラムは 「Web サーバー フォルダへの侵入」 の脆弱性を排除するために以前施された変更とともに、この脆弱性を排除するために必要となる変更も含んでいます。結果として、ここで提供されている更新プログラムを適用するお客様は 「Web サーバー フォルダへの侵入」 の脆弱性に対しても保護されます。

**だれが更新プログラムを適用する必要がありますか?**

マイクロソフトでは IIS 4.0 または 5.0 を使用しているすべてのお客様に対し、この脆弱性の更新プログラムを直ちに適用することを強くお勧めします。

**更新プログラムは何を修正しますか?**

ここで問題とされているファイル リクエストを IIS が無効として取り扱うようにしてこの脆弱性を排除します。

**どこで更新プログラムを入手できますか?**

マイクロソフト セキュリティ情報 MS00-086 をご覧ください。

**更新プログラムはどのように使用するのですか?**

サポート技術情報 [277873](http://support.microsoft.com/kb/277873) には、お客様のサイトに更新プログラムを提供するための詳細な情報が記載されています。

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS00-086 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](http://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトはサポート技術情報 [277873](http://support.microsoft.com/kb/277873) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](http://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカルサポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](http://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

-   Internet Information Server 4.0:  
    この問題に対する更新プログラムは Windows NT 4.0 のセキュリティ ロールアップ パッケージ (SRP) に含まれています。  
    個別の更新プログラムよりもセキュリティ ロールアップ パッケージを適用することをお勧めします。  
    NT 4.0 のセキュリティ ロールアップ パッケージは次のリンクから入手してください。  

    [299444](http://support.microsoft.com/kb/299444) Post Windows NT 4.0 SP6a セキュリティ ロールアップ パッケージ (SRP)  

    なお、個別の更新プログラムは次のリンクから入手することができます。

    -   PC/AT 互換機用    
        [http://www.microsoft.com/downloads/details.aspx?FamilyId=9CF4FAA1-D7C0-4F4A-83FC-5D97DDA00DE2&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=9cf4faa1-d7c0-4f4a-83fc-5d97dda00de2&displaylang=ja)

-   Internet Information Services 5.0:  
    この問題に対する修正は [MS01-026](http://technet.microsoft.com/security/bulletin/ms01-026) の修正モジュールに含まれております(NEC PC98 シリーズを除く)。MS01-026 には、それまでの IIS 関連の修正がすべて含まれておりますので、MS01-026 のご利用をお勧めします。    
    また、Windows 2000 の場合、この問題に対する修正は Windows 2000 Service Pack 2 以降に含まれております。最新の Windows 2000 Service Pack については次のリンクから入手してください。    
    <http://www.microsoft.com/japan/windows2000/downloads/>  
    個別の修正モジュールは次のリンクから入手することができます。この更新プログラムは Windows 2000、または Windows 2000 Service Pack1 がインストールされた環境に適用できます。    
    -   PC/AT 互換機用    
        [http://www.microsoft.com/downloads/details.aspx?FamilyId=DFBF1FE0-A2B0-4BF0-BDAA-B939D693DD69&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=dfbf1fe0-a2b0-4bf0-bdaa-b939d693dd69&displaylang=ja)

**注** **:**  
IIS 4.0 更新プログラムは Windows NT 4.0 Service Pack 5 以上がインストールされた環境に適用できます。  

この問題を解決するための日本語版更新プログラムは、現在最優先で準備しておりますが、残念ながらまだ完成していないものがあります。しかし以下の方法によって、この脆弱性による被害を回避することができます。お手数ですが、以下の設定をお願いいたします。

Microsoft Internet Information Services 5.0  
Microsoft Internet Information Server 4.0  
(1) IIS サーバーから .bat か.cmd ファイルを削除してください。  
(2) 削除できない .bat や.cmd ファイルが存在する場合には、URL等からアクセス可能な仮想ディレクトリではなく、アクセス不可能な他のフォルダーに移動させてください。  
(3) 念のために、「IUSER\_マシン名」( IIS にアクセスしたユーザーに割り当てられまで) が所属するグループの、“CMD.exe”へのアクセス権を削除してください。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS00-086）  
    [http://www.microsoft.com/technet/security/bulletin/ms00-086.mspx](http://technet.microsoft.com/security/bulletin/ms00-086)  
-   サポート技術情報 （KB） 文書番号 ： 277873  
    [Web サーバーによるファイル要求の解析の脆弱性への対策](http://support.microsoft.com/kb/277873)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*