---
TOCTitle: 'MS00-044'
Title: 'マイクロソフト セキュリティ情報 MS00-044 - 重要'
ms:assetid: 'ms00-044'
ms:contentKeyID: 61228210
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-044(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS00-044 - 重要
===============================================

「ディレクトリ ブラウザ引数の不在」 脆弱性に対する対策
------------------------------------------------------

公開日: 2000年7月18日 | 最終更新日: 2001年2月9日

#### 概要 :

弊社では、Microsoft® Internet Information Server における 2 つのセキュリティ脆弱性を排除する更新プログラムをリリースしました。この脆弱性により、悪質なユーザーが、Web サーバーによる役に立つサービスの提供を停止したり、または一定の種類の情報を Web サーバーから抽出したりすることが可能になる恐れがあります。

**影響を受けるソフトウェアのバージョン :**

-   Microsoft Internet Information Server 4.0
-   Microsoft Internet Information Services 5.0

### 詳細

問題
----

 
この問題には、次の 2 つの脆弱性があります。

-   「ディレクトリ ブラウザ引数の不在」脆弱性。IIS 4.0 もしくは IIS 5.0 に含まれる管理用スクリプトに、予期されない引き数が渡されると、不正な処理が行われる場合があります。この問題は、IIS 3.0 からアップグレードされた IIS 4.0 もしくは IIS 5.0 において発生します。この引数が存在しないと、スクリプトが無限のループにはいり、その時点でスクリプトはサーバー上のすべての CPU リソースを消費します。さらに、このツールおよび関連のいくつかのツールの権限 (IIS 3.0 では適切だったもの) は、IIS 4.0 および 5.0 では不適切です。これにより、Web サイト訪問者が、これらのツールを使用できるようになり、サーバー上のディレクトリ構造を表示できるようになる恐れがあります。
-   「.HTR 経由のファイル フラグメント読み取り」脆弱性の新種。この脆弱性の元の バージョンについては Microsoft Security Bulletin MS00-031 で説明しました。新しい脆弱性は、具体的な悪用方法が異なるだけです。元のバージョンと同様に、この脆弱性の影響は、.ASP およびその他のファイルのフラグメントがサーバーから取得できる恐れがあるということです。元のバージョンと同様に、新種の構造により、悪質なユーザーにとって最も興味深い .ASP ファイルの一部が取り去られる可能性が生じます。

弊社では、これらの脆弱性を排除する最適の方法は、IIS 4.0 セキュリティ チェックリストで説明されているように、HTR のスクリプト マッピングを削除することだと考えています。ビジネス クリティカルな HTR スクリプトをお持ちのお客様に限り、機能を維持して更新プログラムをインストールしてください。

よく寄せられる質問
------------------

 
**マイクロソフトセキュリティ情報 MS00-044 はどのような内容の通知ですか?**

マイクロソフト セキュリティ情報 MS00-044 は、Microsoft® Internet Information Server のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことをお客様にお知らせするものです。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**この脆弱性はどれくらいの範囲に影響を与えますか?**

これは、[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)に関する脆弱性で、悪意のあるユーザーは IIS サーバーによるサービスの提供を阻止することができます。更に、Web サーバー上のディレクトリ構造を参照することもできます。この脆弱性の影響を受けるのは、IIS 3.0 からアップグレードした IIS 4.0 または IIS 5.0 のみです。

この更新プログラムはまた、以前に説明された “HTR 経由のファイル フラグメントの読み取り” [MS00-031](http://technet.microsoft.com/security/bulletin/ms00-031) の脆弱性の変形にも、対処しています。この新しい脆弱性により、元のバージョンのようにサーバー上の特定のファイルの一部が読み取り可能になりますが、ファイルの追加、削除、改ざんを行うことはできません。

以前より HTR ファイルのファイル マッピングを削除するように推奨してきましたが、この推奨に従っている場合には、いずれの脆弱性による影響も受けません。最初の選択として、HTR 機能を完全に無効にしてしまい、どうしてもこの機能を使用する必要のある人のみ、この機能を有効にした上でこの更新プログラムを適用することを推奨します。

**これらの脆弱性には、どのような関連性がありますか?**

HTR ファイルの処理に関与しているという点においてのみ関連性があります。

**HTR とは何ですか?**

HTR は、IIS 2.0 の一部として提供されている第一世代の高度なスクリプト技術です。HTRは、あまりにも進んだ技術のためにあまり普及せず、カスタマにより HTR の重要な開発リソースに力が注がれる前に IIS 4.0 でアクティブ サーバー ページ (.ASP) が導入されると、ASP が普及しました。

今日最も普及している HTR 技術は、デフォルトの IIS に含まれている HTR スクリプトの集合体です。これにより、IIS は IIS web サーバーを通じて Windows NT パスワードサービスを提供することができます。Windows NT ユーザーは自分のパスワードを変更するために HTR スクリプトを使用することが可能で、管理者は多くのパスワード管理機能を実行することができます。これらのスクリプトに関する詳細は、[184619](http://support.microsoft.com/kb/184619) を参照してください。

**HTR 機能を無効にすることはできますか?**

はい、以前からhtr機能を無効にするように推奨していますが (例えば、”[microsoft internet information server 4.0 セキュリティ チェックリスト](http://www.microsoft.com/japan/technet/archive/security/chklist/iis4cl.mspx)”および "[internet information services 5 セキュリティのチェックリスト](http://www.microsoft.com/japan/technet/archive/security/chklist/iis5cl.mspx)" ) 最近の調査の結果によると、もっと強く推奨する必要があるように思われます。

仕事上必要でない場合には htr スクリプト マッピングを削除することを、現在、全てのユーザーに推奨しています。大部分のカスタマにとっては、この機能を保持することで失うものは得るものよりずっと大きいでしょう。まず始めに、近々 htr のマップ解除および、サーバー上の全ての htr スクリプトを排除するツールが提供されます。将来的には、htr は iisで全くサポートされないようになります。

**どうして Microsoft は HTR を無効にすることを強く推奨するのですか?**

HTR 機能はセキュリティの観点から見ると問題のあるコンポーネントで、いくつかのセキュリティの脆弱性に関係しています。(マイクロソフトセキュリティ情報の [MS99-019](http://technet.microsoft.com/security/bulletin/ms99-019) と [MS00-031](http://technet.microsoft.com/security/bulletin/ms00-031) を参照してください。) この機能がほとんど使用されず、マイクロソフトが最終的にはこの機能を廃止するつもりでいても、大部分のカスタマにとってこの機能を使用し続ける理由はありません。 この機能を無効にした場合には、HTR機能に関する以前リリースされた更新プログラムも、今回提供されているものも、今後もこの機能に関する更新プログラムを適用する必要はありません。

**どのようにして HTR 機能を無効にするのですか?**

以下の手順に従ってください。

-   インターネット インフォメーション サービスを開く。
-   web サーバーを右クリックして、\[プロパティ\]、\[マスタ プロパティ\]、\[www サービス\] を順にクリックする。
-   \[編集\] をクリックし、\[ホーム ディレクトリ\]、\[構成\] の順にクリックする。
-   htrエントリを削除する。

htr に加えて、いわゆるスクリプト マッピングと呼ばれるいくつかのほかの機能も削除することも推奨します。これらについては、[”microsoft internet information server 4.0 セキュリティ チェックリスト"](http://www.microsoft.com/japan/technet/archive/security/chklist/iis4cl.mspx) を参照してください。

**“ディレクトリブラウザ引数の不在” の脆弱性とは何ですか?**

IIS 3.0 (IIS 4.0 および IIS 5.0 にアップグレードされているもの) で提供されているデフォルトの HTR スクリプトの中には、Webサイト管理者がサーバー上のディレクトリを参照できるものもいくつかあります。このようなスクリプトのうちの 1 つが、想定した引数で呼び出されない場合、無限ループにはいりシステムの CPU を使い切ってしまいます。その結果、サーバーはサービスの要求に応答できなくなります。

**攻撃されたサーバーは、どのようにしたら回復しますか?**

IIS サービスを停止して、再起動するだけです。サーバーの再起動は必要ありません。

**IIS 4.0 および IIS 5.0 システムは全てこの脆弱性の影響を受けますか?**

いいえ、IIS 3.0 からアップグレードしたシステムのみ影響を受けます。 ここで問題になっている管理者スクリプトは IIS 4.0 および 5.0 の一部としてインストールされませんが、IIS 3.0 の初期のバージョンでインストールされた場合にはそれが依然として残っていることになります。

**Web サーバーに IIS 3.0 をインストールしたことがない場合、この脆弱性の影響を受けませんか?**

受けません。 (しかし、次に説明される ”HTR 経由のファイル フラグメント読み取り” の脆弱性の変形では、IIS 3.0 がインストールされていたかいないかに関係なく、IIS 4.0 および 5.0 に影響を与えます。)

**この管理用スクリプトに関係したほかの問題はありますか?**

はい、このスクリプト、および同じフォルダ内の関連のあるスクリプトは、許可されていない権限を得ることになります。これにより、攻撃された Web サイトを訪れているユーザーはこれらのスクリプトを実行することができます。

**これらのスクリプトを使用して何ができますか?**

スクリプトを利用することで、Webサーバー上のディレクトリ構造を参照することができます。このスクリプトを利用しても、ファイルの追加、削除および改ざんはできませんが、このスクリプトを利用することで、悪意あるユーザーはサーバー上の特定のファイルの場所を確認することができるため、有益な調査ツールといえます。

**どうしてスクリプトは本来与えられていない権限を持ってしまうのですか?**

IIS 3.0 では、HTR スクリプトはローカルでのみ実行可能です。つまり、サーバー自身から実行されることのみ可能です。 管理者のみが Web サーバーにローカルにログオンできるので、スクリプトがユーザーを認証する必要はなくスクリプトを誰が実行できるか制限する必要もありません。しかし、IIS 4.0 では HTR スクリプトをリモートから呼び出す機能が導入されました。これらの2つの要素、IIS 3.0 から継承された弱められた権限のセキュリティと、IIS 4.0 のリモートから HTR スクリプトを実行できる機能を合わせると、セキュリティ上の危険につながります。

この問題を修正するために、各 Web サイトのサーバー上にある /scripts/iisadmin フォルダに対して、フォルダとその内容には管理者のみアクセスが可能なようにセキュリティを高めることを推奨します。もちろん、この手段はHTR 機能を保持する場合にのみ必要であり、HTR 機能を無効にした場合には、スクリプトは実行できないので権限の問題はもはや重要ではありません。

**”HTR 経由のファイルのフラグメントが読み取られてしまう” という脆弱性の変形とは何ですか?**

元の脆弱性についてはマイクロソフトセキュリティ情報 [MS00-031](http://technet.microsoft.com/security/bulletin/ms00-031) で説明されています。新しい種類のものは、同じ脆弱性をほかの手段で利用しています。

**この脆弱性にはどのような危険がありますか?**

この脆弱性と、それによりどのような危険があるかについての詳細は、マイクロソフト セキュリティ情報 [MS00-031](http://technet.microsoft.com/security/bulletin/ms00-031) を参照してください。しかし一言で言うと、悪意あるユーザーがサーバーからファイルをリクエストすると、そのファイルが HTR ファイルのように処理されるというものです。その結果、ASP のソース コードの一部が悪意あるユーザーに送信されるというものです。

論理的には、このことにより ASP ファイル内の重要なデータが露呈することになります。しかし実際には、以下のことを考慮すると起こり得ません。HTR 処理は悪意あるユーザーが最も興味を持つであろう個所の内容を削除する傾向があります。更に、推奨されることに従っている場合、ファイル内に重要な情報はないはずなので、その情報が改ざんされることもありません。

**だれが更新プログラムを適用する必要がありますか?**

上記に述べられているように、必要な場合以外は HTR 機能を完全に削除することを推奨します。ですから、仕事上 HTR スクリプトを必要とする場合のみ、この更新プログラムを適用する必要があります。

**更新プログラムは何を変更するのですか?**

“ディレクトリ ブラウザ引数の不在” の脆弱性に対しては、スクリプトが失われた引数を正しく処理するようにします。 “HTR 経由のファイルのフラグメントが読み取られてしまう”、という脆弱性の変形に対しては、不正な URL を拒否するようにします。

更新プログラムを適用した後でも、各 Web サイトの /scripts/iisadmin フォルダが、管理者のみアクセス可能になるように厳しく管理するように推奨します。

**更新プログラムはどのように使用するのですか?**

サポート技術情報 [267559](http://support.microsoft.com/kb/267559) には、お客様のサイトに更新プログラムを提供するための詳細な情報が記載されています。

**どこから更新プログラムを入手できますか?**

マイクロソフト セキュリティ情報 MS00-044 からダウンロードしていただけます。
Microsoft IIS 4.0:  
[http://www.microsoft.com/downloads/details.aspx?FamilyId=75ae54fe-d0d2-4fdc-a411-45fa9e957352&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=75ae54fe-d0d2-4fdc-a411-45fa9e957352&displaylang=ja)  
Microsoft IIS 5.0:  
[http://www.microsoft.com/downloads/details.aspx?FamilyId=3ECD460A-EF0B-4203-AE24-668A9DEB7491&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=3ecd460a-ef0b-4203-ae24-668a9deb7491&displaylang=ja)

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS00-044 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](http://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトは、[267559](http://support.microsoft.com/kb/267559) を公開し、この “ディレクトリ ブラウザ引数の不在” の脆弱性と更新プログラムの詳細を説明しています。
-   マイクロソフトは、[267560](http://support.microsoft.com/kb/267560) を公開し、この “htr 経由のファイルのフラグメントが読み取られてしまう”、という脆弱性の変形と更新プログラムの詳細を説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](http://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカルサポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](http://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

 
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft Internet Information Server 4.0:  
    この問題に対する更新プログラムは Windows NT 4.0 のセキュリティ ロールアップ パッケージ (SRP) に含まれています。
    個別の更新プログラムよりもセキュリティ ロールアップ パッケージを適用することをお勧めします。
    NT4.0 のセキュリティ ロールアップ パッケージは次のリンクから入手してください。

    [299444](http://support.microsoft.com/kb/299444) Post Windows NT 4.0 SP6a セキュリティ ロールアップ パッケージ (SRP)

    なお、個別の更新プログラムは次のリンクから入手することができます。
    この問題を解決する更新プログラムは、マイクロソフト セキュリティ情報 [MS01-004](http://technet.microsoft.com/security/bulletin/ms01-004) でリリースされた更新プログラムに含まれています。

-   Internet Information Services 5.0:  
    現在、この問題に対する修正 ([MS01-004](http://technet.microsoft.com/security/bulletin/ms01-004) を含む) は [MS01-026](http://technet.microsoft.com/security/bulletin/ms01-026) の修正モジュールに含まれています(NEC PC98 シリーズを除く)。MS01-026 には、それまでの IIS 関連の修正がすべて含まれていますので、MS01-026 のご利用をお勧めします。

    なお、個別の更新プログラムは次のリンクから入手することができます。

    この問題を解決する更新プログラムは、マイクロソフト セキュリティ情報 [MS01-004](http://technet.microsoft.com/security/bulletin/ms01-004) でリリースされた更新プログラムに含まれています。

**注 :**  
この更新プログラムの適用を選択されたお客様も、それぞれの Web サイト の/scripts/iisadmin フォルダのアクセス権限をサーバー上で強化し、管理者のみがアクセスできるように確認しておく必要があります。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報 :**

-   US マイクロソフトセキュリティ情報（MS00-044）  
    [http://www.microsoft.com/technet/security/bulletin/ms00-044.mspx](http://technet.microsoft.com/security/bulletin/ms00-044)
-   サポート技術情報 （KB） 文書番号 ： 267559  
    [HTR ファイルの GET で "サービス停止" またはディレクトリが参照される](http://support.microsoft.com/kb/267559)
-   サポート技術情報 （KB） 文書番号 ： 267560  
    [URL を変更するとファイルの内容が参照される](http://support.microsoft.com/kb/267560)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
