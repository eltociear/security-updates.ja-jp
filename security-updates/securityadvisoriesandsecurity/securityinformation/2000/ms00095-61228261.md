---
TOCTitle: 'MS00-095'
Title: 'マイクロソフト セキュリティ情報 MS00-095 - 緊急'
ms:assetid: 'ms00-095'
ms:contentKeyID: 61228261
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-095(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS00-095 - 緊急
===============================================

「レジストリのアクセス権」 の脆弱性を解決するツール
---------------------------------------------------

公開日: 2000年12月7日 | 最終更新日: 2001年6月29日

#### 概要 :

マイクロソフトは、Microsoft® Windows NT® 4.0.のいくつかのレジストリ値のアクセス権を修正するツールをリリースしました。デフォルトのアクセス権では、悪意のあるユーザーが、該当するマシンに関して付加的な特権を獲得する可能性があります。 

**影響を受けるソフトウェアのバージョン** **:**

-   Microsoft Windows NT 4.0
-   Microsoft Windows NT 4.0 Server
-   Microsoft Windows NT 4.0 Server, Enterprise Edition
-   Microsoft Windows NT 4.0 Server, Terminal Server Edition

### 詳細

問題
----

<span></span>
3 つのレジストリ キーに対するデフォルトのアクセス権には、不具合があります。それらのキーとリスクは以下の通りです。
「SNMPパラメータ キー」、HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SNMP\\Parametersは、SNMP コミュニティ名と SNMP 管理 ステーション識別子が存在する場合、それらの情報を提供します。SNMP コミュニティ文字列で、SNMP サービスへの読み込み、または読み書きアクセスが可能になります。読み書きアクセス文字列が存在しない場合、悪意のあるユーザーは、この脆弱性を利用して、通常ローカル ユーザーが使用できる SNMP から情報を読み込むことだけができます。読み書きアクセス文字列が存在する場合は、悪意のあるユーザーはこの脆弱性を利用して、読み書きアクセスをするのに同じコミュニティ文字列を使用している全てのシステムを変更することができます。 SNMP v1.0 は設計上、セキュリティで保護されておらず、ネットワーク トラフィックを監視できるユーザーならば SNMP コミュニティ文字列を取得できるということを覚えておくことが重要です。SNMP は、Windows NT 4.0のマシンに、デフォルトではインストールされません。
「 RAS 管理」キー、 HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\RAS は、サードパーティのRAS 製品に、インストールに必要な情報を提供します。これらの RAS 製品は、Windows NT の付属の RAS サービスで動作するものが対象です。悪意のあるユーザーが、このキーの値の 1 つを変更し、不正なコードをサードパーティ管理ツールとして指定する恐れがあります。そしてそのコードを LocalSystem セキュリティ コンテキストで実行させることで、悪意のあるユーザーは、必要なレジストリをリモートから変更し、該当するマシンに対話的にログオンして、さらに新たな特権を行使することが可能になります。悪意のあるユーザーのコードは、リモートからレジストリの変更を行うことはできますが、レジストリ自体を作成することはできないため、該当のマシンにこのキーが存在している必要があります。RASはWindows NT 4.0のマシンに、デフォルトではインストールされません。
「MTS パッケージ 管理キー」、HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Transaction Server\\Packages には、MTS パッケージをインストール、または、変更するユーザーに関する情報が含まれています。悪意のあるユーザーが、自分自身を MTS マネージャーとして追加し、MTS パッケージを追加、削除、変更する恐れがあります。そして悪意のあるユーザーは、必要なレジストリをリモートから変更して、該当するマシンに対話的にログオンし、新たな特権を行使することができます。MTS は、Windows NT 4.0 のマシンに、デフォルトでは、インストールされません。
これらのキーに関するアクセス権の修正に加えて、このツールは、すでに説明した他のキーのアクセス権も変更することができます。具体的には、このツールはマイクロソフトセキュリティ情報 MS00-008とMS00-024で説明したすべての変更を行うことができます。

よく寄せられる質問
------------------

<span></span>
**マイクロソフトセキュリティ情報** **MS00-095** **はどのような内容の通知ですか?**

マイクロソフト セキュリティ情報 MS00-095 は、Microsoft® Windows NT® 4.0 のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことをお客様にお知らせするものです。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**この更新プログラムが、3** **つの脆弱性に対処しているのはなぜですか?**

3 つの脆弱性には、デフォルトのアクセス権の強化が必要なレジストリ値がある、という共通の問題があります。この 3 つの脆弱性に対する共通の対策としては、アクセス権を必要な値にリセットすることがあります。お客様が適用する更新プログラムの数を最小限にするために、マイクロソフトは 3 つのキーのアクセス権を一括でリセットできる英語版更新プログラムをリリースしました。

**３つのレジストリキーとは何ですか?**

レジストリ キーには次の 3 つがあります。

-   「SNMP 管理」キー
-   ｢RAS 管理｣ キー
-   「MTS パッケージ管理」キー

**｢SNMP** **管理｣キーに関連して、この脆弱性はどれくらいの範囲に影響を与えますか?**

この脆弱性を利用して、悪意のあるユーザーがネット ワーク デバイスの管理または設定を行う可能性があります。獲得できる特権は、ネットワークによって異なり、Simple Network Management Protocol ( SNMP ) がどの程度使用されているかに拠ります。最悪の場合、この脆弱性を利用して、悪意のあるユーザーがルーターとファイアウォールを不正に設定し、Web サーバーとデータベース サーバーのコンテンツを改ざんし、ローカル マシンのサービスが停止したり、開始したりする可能性があります。
SNMP は設計上、セキュリティで保護されたプロトコルではありません。レジストリへの不正のアクセス権がなくても、悪意のあるユーザーはネットワークを監視でき、ネットワーク上で SNMPを管理するのに必要な情報を得ることができます。SNMPは、Windows NT 4.0 のシステムにデフォルトではインストールされません。

**SNMP** **とは何ですか?**

SNMP (Simple Network Management Protocol) を利用すると、管理者はサーバー、ワークステーション、ルーター、ブリッジ、ファイアウォールなどのネットワーク デバイスをリモートで管理することができます。SNMPは業界標準のプロトコルで、他のベンダー製のデバイスを １ つのプロトコルで管理することを可能にするものです。

**SNMP** **はどのような働きをしますか?**

[TechNet](http://www.microsoft.com/technet/itsolutions/network/deploy/confeat/snmp.mspx) の Web サイトに、SNMP がマイクロソフトのネットワークでどのように働くかの詳しい情報をご覧頂けますが、高水準な情報を以下でもご覧頂けます。
SNMPの主な概念の １ つに、コミュニティ中で使用されるものであるいうことがあります。コミュニティとはつまり、おなじレベルの特権を持った共通の管理者が管理するデバイスの集合のことです。例えば、あるネットワークに １０ のルーターがあり、アクセス権をもつ管理者が ３ 人いる場合、そのルーターとユーザー マシンは １ つのコミュニティの １ 部です。ルーターを監視するアクセス権のみを持つユーザーが追加された場合、ルーターとユーザーは別のコミュニティのメンバーになる必要があります。推測できるように、 １ つのデバイスが多数のコミュニティのメンバーになることは、よくあることです。
コミュニティ内の全てのデバイスは、そのコミュニティに関する情報をローカルに記憶しています。例えば、それぞれのマシンにはコミュニティ名を設定する必要があり、そのコミュニティ名は、基本的に、前もって設定された共通のパスワードとして機能します。また、それぞれのマシンは SNMP 管理者がコマンドを発行するマシンを認知しています。マシンから正しいコミュニティ名が含まれたコマンドを受け取ると、デバイスはコマンドを処理します。
管理者の SNMP ソフトは、MIB (Management Information Base) というローカル データベースを参照して、デバイスが判別できるコマンドを送信することができます。 MIB は、それぞれのデバイスとのコミュニケーションの方法、呼び出す機能、コマンドの情報を送信する方法等を正確に指定する情報を含んでいます。 MIB を参照すると、管理者のマシン ( SNMP 専門用語で、管理ステーションと呼びます。 ) は、デバイスに、意味をもつコマンドを発行することができます。

**デバイスの管理をするのにSNMP** **はどのように使用されますか?**

デバイスの種類、SNMP 管理者が認められている特権のレベルなどのさまざまな要因によって左右されます。デバイスで実行できる管理機能の例は以下の通りです。

-   ワークステーション、サーバーの開始、停止
-   アプリケーションサーバーのCPU とメモリー使用の監視
-   Web サーバーやデータベース サーバーのコンテンツの追加、変更、削除
-   ルーターの再設定
-   ファイアウォールのフィルター ルールの変更

**「SNMP** **管理」レジストリキーとは何ですか?** **また何をするものですか?**

｢SNMP 管理｣ キーは、HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SNMP\\Parameters を指します。このキーには、以下の ２ つの値が指定されています。

-   PermittedManagers は、コミュニティの管理ステーションのマシン名か IP アドレスを指定します。
-   ValidCommunities は、マシンが所属する全てのコミュニティを指定します。

**SNMP** **管理レジストリキーのアクセス権の何が問題なのですか?**

このアクセス権は強化が必要です。このキーの情報は設計上では、マシンの管理特権を持つユーザーのみがアクセスできるようになっていますが、実際にはそのマシンのユーザーは誰でもアクセスして、情報を見て、変更することができます。

**この情報で悪意のあるユーザーは何ができますか?**

悪意のあるユーザーは、以下の２つの方法で、この脆弱性を利用する恐れがあります。

-   ２つの値に情報を追加して、自分のローカル マシンのみでコミュニティを構成し、自分自身を SNMP 管理者に設定する恐れがあります。それによりローカル マシンを管理することができるようになります。
-   悪意のあるユーザーのマシンがすでにコミュニティに属している場合、SNMP Parameter キーの 2 つの値を読み込むことで、SNMP 管理者を装うことができます。 IP アドレスや正規の管理ステーションのマシン名を偽装し、コミュニティ名を使用し、コミュニティ内の他のデバイスにコマンドを発行する恐れがあります。

**悪意のあるユーザーが、自分のローカルマシンでコミュニティを構成すると、何ができますか?**

悪意のあるユーザーが使用するマシンのタイプによって異なります。ワークステーション上では、マシンの開始と停止のサービスしかできません。 Web サーバーやデータベース サーバー上では、マシンのデータ、データにアクセスした人物の情報の改ざんする可能性があります。

**悪意のあるユーザーのマシンがコミュニティの一部になっていると、何ができますか?**

上で説明されているように、ネットワークで実行される管理機能はそれぞれ大幅に異なり、それぞれのネットワーク独自のさまざまな要因によって異なります。したがって、悪意のあるユーザーが得られる特権を限定することはできませんが、｢ ハイジャックした ｣ コミュニティ内で SNMP 管理者が行使できる全ての特権を取得できることは確実です。ルーターだけで構成されたコミュニティで SNMP 管理者になり、ルーターを監視するだけの場合には、この脆弱性から発生するリスクはわずかです。ところが Web とデータベース サーバーで構成したコミュニティと SNMP 管理者に、サーバー上のコンテンツを変更する特権がある場合には、リスクはより大きくなります。

**この脆弱性はリモートで利用できますか?**

この質問の答えの前に、この脆弱性を明確にしておく必要があります。この脆弱性は、悪意のあるユーザーが SNMP の情報を含むレジストリ値を読み、改ざんすることができるという事実にあります。この脆弱性は、悪意のあるユーザーが、 SNMP 情報を読み込み、改ざんした後、ネットワーク デバイスを管理できるために発生するわけではありません。SNMP の設計上、この情報の処理者の全てに、デバイス管理の権利が与えられてしまいます。
マシンのレジストリにリモートでアクセスできるかどうかは、Winreg キーと呼ばれるレジストリ キーの設定によって決定します。デフォルトでは、Windows NT 4.0 のサーバーの [Winreg](http://support.microsoft.com/kb/153183) キーはリモート アクセスができないように設定されています。ところが Windows NT 4.0 のワークステーションでは、Winreg キーのデフォルトの設定によってレジストリにリモート アクセスすることができます。マイクロソフト セキュリティ情報 [MS00-008](http://technet.microsoft.com/security/bulletin/ms00-008)、[MS00-024](http://technet.microsoft.com/security/bulletin/ms00-024) で得られるツールでこの問題を解決することができます。またこのページで得られるツールでも問題解決が可能です。

**SNMP** **の安全性はどのくらいですか?**

SNMP は設計上、セキュリティで保護されたプロトコルではありません。コミュニティ名、管理ステーションの ID など、この脆弱性によって漏れる情報は、プロトコルの通常オペレーションの実行中、普通のテキストでネットワークに流れます。結果、ネットワークのコミュニケーションの監視をする能力を獲得した攻撃者は、この脆弱性が存在しない場合にも、これまでに説明した攻撃を実行する可能性があります。

**SNMPはWindows NT 4.0マシンにデフォルトでインストールされますか?**

いいえ、されません。SNMP は、管理者がインストールした場合のみマシンに存在します。

**｢** **RAS** **管理｣レジストリキーに関しては、この脆弱性はどれくらいの範囲に影響を与えますか?**

これは[特権の昇格](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。悪意のあるユーザーは、このレジストリ キーの値の １ つを変更して、該当マシンに[対話的にログオン](http://www.microsoft.com/japan/security/glossary.mspx)し、オペレーティング システムの特権を利用して、マシン上に任意のコードを実行する可能性があります。これにより、データの追加、削除、変更、ハード ドライブのリフォーマット、ローカル ユーザー アカウントの作成などの操作をマシンで実行するコードが事実上可能になります。
この脆弱性によってローカル マシンの制御をすることができるようにはなりますが、ドメインでの特権を得るために直接使用することはできません。また、この脆弱性はリモート アクセス サービス ( RAS ) がインストールされているマシンでのみ悪用される可能性があるものです。後に説明するように、不正に設定されたマシン、または最善策がとられていないマシンでのみこの脆弱性が発生するようになります。

**｢RAS** **管理｣キーとは何ですか?**

｢RAS 管理｣ キーは、HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\RAS を指します。このキーは、管理者がマイクロソフトの RAS サービスの機能を拡張するためのサード パーティの製品をインストールするためのものです。

**｢RAS** **管理｣キーの何が問題なのですか?**

キーのアクセス権には強化が必要です。特権のないユーザーがこのキーの値を変更することが可能です。これにより、キーで指定可能な値が原因でキュリティ上の危険性が発生します。サード パーティの RAS 管理ツールがインストールされている場合は、この値がツールを開始するときに必要な DLL の名前を供給します。RSA 管理キーのアクセス権が無制限になっているため、悪意のあるユーザーがこの値を変更し、任意のDLL の名前を指定することが可能です。

**RAS** **管理ツールを無断でインストールする人いるのはなぜですか?**

問題は、 RAS ツールをインストールすることではなく、この脆弱性を悪用して、マシン上での特権を得るということにあります。RAS 管理キーに指定された DLL は LocalSystem 特権と一緒に作動します。つまり、ローカル マシン上のオペレーティング システムの一部として作動します。悪意のあるユーザーは、RAS 管理キーで任意のコードを指定し、オペレーティングシステムの一部にこのコードを実行する可能性があります。
しかし、このコードにも制約があることに注意することが重要です。悪意のあるユーザーは、エントリ ポイントが正規の RAS 管理ツールのものとマッチしている DLL をインストール必要があります。これは、この目的のためにコードを特別に設定する必要があることを意味します。

**この脆弱性を利用して、悪意のあるユーザーは何をする可能性がありますか?**

この脆弱性を利用すると、悪意のあるユーザーはローカル マシンを完全に制御することができます。データの改ざん、ハード ドライブのリフォーマットから新しいシステム コンポーネントのインストール、ローカル ユーザーの作成にいたるまで文字通り思うままに実行することができます。

**この脆弱性はリモートで利用できますか?**

ある特定な場合には、悪意のあるユーザーがレジストリ値をリモートで変更することが可能です。マシンのレジストリへのリモート アクセスは、[Winreg](http://support.microsoft.com/kb/153183) キーによって制限されています。Windows NT 4.0 サーバーの Winreg キーは、デフォルトでリモート アクセスができないように設定されています。しかし、Windows NT 4.0 ワークステーションでは、Winreg キーのデフォルトの設定でレジストリへのリモート アクセスが可能となります。マイクロソフトセキュリティ情報 [MS00-008](http://technet.microsoft.com/security/bulletin/ms00-008) と [MS00-024](http://technet.microsoft.com/security/bulletin/ms00-024) で更新プログラムを入手できます。またこのページでも入手可能です。
しかし、悪意のあるユーザーがリモートでレジストリ値を変更できても、コードを実行することはできません。レジストリ値で指定された DLL が悪意のあるユーザーが攻撃したローカル マシン上に備わっている必要があります。そして、リモートでマシンに不正のコードをロードする手段が必要となります。その手段を得たとしても、オペレーターに RAS 管理ツールを開始させ、コードを実行させるようにする方法が必要となります。

**この脆弱性を利用して、悪意のあるユーザーはドメインでの付加的な特権を得ることができますか?**

いいえ、できません。コードはローカル マシン上のみで実行されます。この脆弱性でドメインでの付加的な特権を直接得ることは不可能です。

**この脆弱性を利用するにはコンピュータにRAS** **のインストールが必要ですか?**

はい、必要です。RAS がマシンにインストールされていない限り、キーはは存在しません。Windows NT 4.0 は、ワークステーションもサーバーもデフォルトでインストールされません。これは、重要なポイントです。というのは、この脆弱性は、全くの不正な使用方法である次の 3 つのシナリオにだけ発生することを意味するからです。

-   特権のないユーザーのマシンが RAS サーバーとして使用されている場合に発生する可能性があります。あまりよくない例ではありますが、ユーザーはモデムの電源を切ってサービスへの攻撃を拒否することができます。
-   特権のないユーザーがRAS サーバーに対話的にログオンする場合に発生する可能性があります。しかし、重要なサーバーは常に物理的に保護される必要があり、サーバーは管理者のみがログオンできるようになっていなければなりません。
-   特権のないユーザーが、この脆弱性を悪用するために RAS を自分のマシンにインストールすることができる場合に発生する可能性があります。しかし、RAS をインストールするためには管理特権が必要なので、ユーザーがインストールできるということは、そのユーザーは既にマシンを完全に制御できていることになります。

**｢MTS** **パッケージ管理｣レジストリキーに関して、この脆弱性はどれくらいの範囲に影響を与えますか?**

この脆弱性を利用すると、悪意のあるユーザーが新しい Microsoft Transaction Server (MTS) をマシンにインストールしたり、 Windows NT 4.0 のマシンに既にあるものを変造したりすることができます。悪意のあるユーザーが対話的にビジネス クリティカル マシンにログオンした場合に、任意の方法でマシンのビジネスロジックを変更することが可能です。MTS は Windows NT 4.0 にデフォルトではインストールされません。

**MTSとは何ですか?**

[MTS](http://msdn2.microsoft.com/en-us/library/aa480405.aspx) とはマイクロソフト トランザクション サーバーのことです。MTS について説明する前に、トランザクションとはなにを意味するのか説明することが必要です。
トランザクションとは、アトミック単位の仕事のことです。つまり、 1 度、または数回に分けて実行される仕事の単位のことです。トランザクションは成功、または異常終了することもあります。異常終了の場合、トランザクションを実行する前と同じ状態に復元する必要があります。トランザクションの 一例としては、銀行口座間の送金があります。送金は、口座 1 から預金を引出し、口座 2 に預金するといったものです。しかし、預金引出しは、対応する入金も行われるときにのみ実行される必要があります。つまり、送金はアトミック操作であり、入金が停止すると預金引出しも停止する必要があります。
MTS は、Windows サーバー製品のトランザクション ベースのコンポーネントの開発、使用をサポートする技術です。MTS により、管理者は MTS パッケージを作成することができます。MTS パッケージとはトランザクションとして一緒に操作するソフトウエア モジュールの集合のことです。管理者は、ソフトウエアのコンポーネント、それらの処理の順序、トランザクションが異常終了した場合の対処、他のパラメータを指定します。

**｢MTS** **パッケージ管理｣キーとは何ですか?**

｢MTS パッケージ管理｣ キーは、HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Transaction Server\\Packages を指します。このキーと下位のキーは、マシンのトランザクション パッケージのオペレーティング バラメータを供給します。

**MTS** **パッケージ管理キーの何が問題なのですか?**

MTS パッケージ管理キーのアクセス権には強化が必要です。ユーザーがこのキーの値を変更するのには、設計上では管理特権が必要です。しかし実際には、このキーのアクセス権を利用して、マシンに対話的にログオンできる全てのユーザーが設定を変更することができます。
このキーに記憶されている値の中に、マシン上の MTS パッケージの MTS 管理者のリストが含まれています。特に、System Package という独自のパッケージは、 MTS がマシンにインストールされる時はいつでも現れます。そしてこのパッケージの管理者は、設計上マシン上の全ての MTS パッケージを管理することができます。悪意のあるユーザーは、システム パッケージの管理者リストに自分自身のユーザー ID を追加し、マシン上の全ての MTS パッケージを再構成したり、新しいパッケージを追加したりすることができるようにする可能性があります

**この脆弱性を利用して悪意のあるユーザーは何ができますか?**

まず、この脆弱性を利用してもできないことから確認してみましょう。悪意のあるユーザーがこの脆弱性を利用し、自分のマシンで非常に権限のあるセキュリティ コンテキストのコードを実行することはできません。新しいパッケージをインストールする際に、MTS 管理者は、パッケージが実行されるアカウントのユーザー ID とパスワードを入力する必要があります。したがって、悪意のあるユーザーがマシンに入力したコードは、自分のアカウントと資格情報がわかっているアカウントの全てコンテキストの中でのみ、実行が可能です。別な言い方をすると、悪意のあるユーザーが、管理者のパスワードを知っている場合は、自分を管理者と偽ってパッケージを実行することのみができ、その場合、管理者としてログオンするほうが簡単です。
この脆弱性から発生する危険性は、悪意のあるユーザーがこの脆弱性を利用して、マシン上の既存の MTS パッケージを改ざんする恐れがあるということです。例えば、ある給料のデータを保有するサーバーに、対話的にログインすることができる場合、既存の MTS パッケージと、例えば全ての従業員の給料から 小額のお金をその悪意のあるユーザーの口座に払われるように設定したパッケージと交換することも可能です。しかし、特権のないユーザーが重要なサーバーに対話的にログオンできないように最善策を講じるべきだということを強調します。

**この脆弱性はリモートで利用できますか?**

ある特定な場合には、悪意のあるユーザーがレジストリ値をリモートで変更することが可能です。マシンのレジストリへのリモート アクセスは、[Winreg](http://support.microsoft.com/kb/153183) キーによって制限されています。デフォルトでは、Windows NT 4.0 サーバーの Winreg キーは、リモート アクセスができないように設定されます。しかし、Windows NT 4.0 ワークステーションでは、Winreg キーのデフォルトの設定でレジストリへのリモート アクセスが可能となります。マイクロソフトセキュリティ情報 [MS00-008](http://technet.microsoft.com/security/bulletin/ms00-008) と [MS00-024](http://technet.microsoft.com/security/bulletin/ms00-024) で更新プログラムを手に入れることができます。またこのページでも入手可能です。
しかし、悪意のあるユーザーがリモートでレジストリ値を変更できても、 MTS パッケージの追加、変更を実行することはできません。MTS Explorer、MTS パッケージ の管理に使用するツールのみをローカルマシンで作動することができます。そのため、MTS 管理者として自分を追加登録できたとしても、新規に獲得した特権を実際に利用するためには、標的となるマシンにログオンする必要があります。

**MTS** **はデフォルトでインストールされますか?**

いいえ、されません。MTS は Windows NT 4.0 Option Pack の一部として出荷されます。MTS をインストールできるのは管理者のみです。

**修正ツールは何を修正しますか?**

修正ツールはここで説明したレジストリ キーの正規のアクセス権を設定します。さらに、マイクロソフトセキュリティ情報 [MS00-008](http://technet.microsoft.com/security/bulletin/ms00-008) と [MS00-024](http://technet.microsoft.com/security/bulletin/ms00-024) で説明した不適切なアクセス権に関しても修正します。

**どこから修正ツールを入手できますか?**

マイクロソフト セキュリティ情報 MS00-095 をご覧ください。

**修正ツールはどのように作動するのですか?**

この修正ツールはローカル マシンとリモート マシンと対話的に、またはスクリプトから作動します。
使用方法は以下のとおりです。
regacl40 \[-v \] \[-m remotecomputername\]

-   –v が指定されている場合、キーの処理の情報を返します。
-   -m が指定されている場合、リモート コンピュータ名をコマンド行に入力する必要があります。その時、リモートマシンの管理特権をもつアカウントにログインしているか、アカウント下の標的のマシンで前にセッションが発生した可能性があります。例えば IPC$ に ｢ネット使用｣ し、正規の資格情報を供給することですることができます。

**この修正ツールを再作動する必要がありますか?**

該当のレジストリ キーのアクセス権のリセット操作をする際にのみこのツールの再作動が必要です。

**修正ツールが正しく作動しているのはどのように確認できますか?**

冗長なオプションの (-v) を使用する際に、修正ツールはそれぞれのキーが問題なく確保されたかを示します。さらに、修正ツールはキーが設定されない場合は １ のリターン コードを供給し、他の場合は 0 を供給します。また、regedt32 を使用し、レジストリのアクセス権が上のテーブルに表示されていることを確かめて、修正ツールが正しく作動しているかを確認することができます。

**修正ツールによってどんなアクセス権が設定できますか?**

修正ツールは下記のようにキーとサブキーのアクセス権を設定します。

 
<table style="border:1px solid black;">
<thead>
<tr class="header">
<th style="border:1px solid black;" >ハイブ</th>
<th style="border:1px solid black;" >キー</th>
<th style="border:1px solid black;" >アクセス権</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">HKEY_LOCAL_MACHINE<br />
\SYSTEM\CurrentControlSet</td>
<td style="border:1px solid black;">Services\SNMP\Parameters<br />
\PermittedManagers</td>
<td style="border:1px solid black;">管理者、システム、 クリエータ 所持者 ： 完全</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">HKEY_LOCAL_MACHINE<br />
\SYSTEM\CurrentControlSet</td>
<td style="border:1px solid black;">Services\SNMP\Parameters<br />
\ValidCommunities</td>
<td style="border:1px solid black;">管理者、システム、クリエータ 所持者 ： 完全</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">HKEY_LOCAL_MACHINE<br />
\SOFTWARE</td>
<td style="border:1px solid black;">\Microsoft\RAS</td>
<td style="border:1px solid black;">管理者、システム、クリエータ 所持者 ： 完全</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">HKEY_LOCAL_MACHINE<br />
\SOFTWARE</td>
<td style="border:1px solid black;">\Microsoft\Transaction Server<br />
\Packages</td>
<td style="border:1px solid black;">管理者、システム、クリエータ 所持者 ： 完全</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">HKEY_LOCAL_MACHINE\SOFTWARE</td>
<td style="border:1px solid black;">Microsoft\Cryptography<br />
\Offload\</td>
<td style="border:1px solid black;">認証されているユーザー： 読み取り<br />
管理者、システム、クリエータ 所持者 ： 完全<br />
</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">HKEY_LOCAL_MACHINE\SOFTWARE</td>
<td style="border:1px solid black;">Microsoft\Windows NT\CurrentVersionAeDebug</td>
<td style="border:1px solid black;">認証されているユーザー ： 読み取り<br />
管理者、システム、クリエータ 所持者 ： 完全</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">HKEY_LOCAL_MACHINE<br />
\SOFTWARE</td>
<td style="border:1px solid black;">Microsoft\Windows<br />
\CurrentVersion\Explorer<br />
\User Shell Folders</td>
<td style="border:1px solid black;">認証されているユーザー ： 読み取り<br />
管理者、システム、クリエータ 所持者 ： 完全</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">HKEY_LOCAL_MACHINE<br />
\SOFTWARE</td>
<td style="border:1px solid black;">Microsoft\DataFactory</td>
<td style="border:1px solid black;">認証されているユーザー ： 読み取り<br />
管理者、システム、クリエータ 所持者 ： 完全<br />
</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">HKEY_LOCAL_MACHINE<br />
\SOFTWARE</td>
<td style="border:1px solid black;">CurrentControlSet<br />
\Services\W3SVC\Parameters<br />
\ADCLaunch</td>
<td style="border:1px solid black;">認証されているユーザー ： 読み取り<br />
管理者、システム、クリエータ 所持者 ： 完全</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">HKEY_LOCAL_MACHINE<br />
\SOFTWARE</td>
<td style="border:1px solid black;">CurrentControlSet<br />
\Control\SecurePipe Servers<br />
\winreg</td>
<td style="border:1px solid black;">管理者 ： フル<br />
バックアップ オペレータ ： 読み取り</td>
</tr>
</tbody>
</table>
 

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する修正ツールを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS00-095 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](http://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトはサポート技術情報 [153183](http://support.microsoft.com/kb/153183) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](http://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカルサポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](http://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、以下のサイトからダウンロードできます。

-   Windows NT 4.0 Workstation、Windows NT 4.0 Server、および Windows NT 4.0 Server, Enterprise Edition:
    この問題に対する更新プログラムは Windows NT 4.0 のセキュリティ ロールアップ パッケージ (SRP) に含まれています。
    個別の更新プログラムよりもセキュリティ ロールアップ パッケージを適用することをお勧めします。
    NT 4.0 のセキュリティ ロールアップ パッケージは次のリンクから入手してください。

    [299444](http://support.microsoft.com/kb/299444) Post Windows NT 4.0 SP6a セキュリティ ロールアップ パッケージ (SRP)

    なお、個別の更新プログラムは次のリンクから入手することができます。
    <http://www.microsoft.com/ntserver/nts/downloads/critical/q265714/default.asp>

    -   PC/AT 互換機用
        [http://download.microsoft.com/download/winntsp/Patch/Q266794/NT4/JA/JPNQ265714i.exe](http://download.microsoft.com/download/winntsp/patch/q266794/nt4/ja/jpnq265714i.exe)
    -   NEC PC-9800 シリーズ用
        [http://download.microsoft.com/download/winntsp/PatchNEC/Q266794/NT4/JA/JPNQ265714n.exe](http://download.microsoft.com/download/winntsp/patchnec/q266794/nt4/ja/jpnq265714n.exe)

-   Windows NT 4.0 Server, Terminal Server Edition:
    [http://www.microsoft.com/downloads/details.aspx?FamilyId=2DE21079-468C-4A47-BA65-3D9028558D4A&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=2de21079-468c-4a47-ba65-3d9028558d4a&displaylang=ja)

**注** **:**
このツールは Windows NT 4.0 Service Packs 4、5 および 6a を動作しているマシンに適用できます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS00-095）
    [http://www.microsoft.com/technet/security/bulletin/ms00-095.mspx](http://technet.microsoft.com/security/bulletin/ms00-095)
-   サポート技術情報 （KB） 文書番号 ： 265714
    [NT 4.0 で SNMP の レジストリ エントリを読み取ることができる](http://support.microsoft.com/kb/265714)
-   サポート技術情報 （KB） 文書番号 ： 267861
    [管理者権限なしで RAS のレジストリの修正が許可される](http://support.microsoft.com/kb/267861)
-   サポート技術情報 （KB） 文書番号 ： 267864
    [MTS パッケージ管理キーにユーザーに関する情報が含まれる](http://support.microsoft.com/kb/267864)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
