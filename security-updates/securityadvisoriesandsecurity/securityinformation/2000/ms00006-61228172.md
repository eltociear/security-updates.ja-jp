---
TOCTitle: 'MS00-006'
Title: 'マイクロソフト セキュリティ情報 MS00-006 - 重要'
ms:assetid: 'ms00-006'
ms:contentKeyID: 61228172
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-006(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS00-006 - 重要
===============================================

「Hit-Highlighting 引数の形式不良」 の脆弱性に対する対策
--------------------------------------------------------

公開日: 2000年2月1日 | 最終更新日: 2001年2月26日

#### 概要 :

2000 年 1 月 26 日、マイクロソフトは、Microsoft® Index Server における 2 つのセキュリティ脆弱性を排除する日本語版更新プログラムをリリースしました。1 つ目の脆弱性では、悪質なユーザーが Web サーバー上のファイルを表示することが可能になる恐れがあります (ただし、変更、追加、削除はできません)。2 つ目の脆弱性では、Web ディレクトリが物理的にサーバー上のどこに配置されているかが暴露される恐れがあります。
2000 年 2 月4 日、2 つ目の脆弱性の新種が確認されましたが、この脆弱性は既に更新プログラムによって排除されています。マイクロソフトはこのセキュリティ情報を更新し、そのことをご案内しておりますが、その更新プログラムを既に適用済みのお客様は、特に対策をとる必要がありません。
2000 年2 月 11 日、マイクロソフトは、更新プログラム パッケージ ツールの改善点を含んだ Windows 2000 用の更新プログラムを再リリースしました。更新プログラム ツールが改善されたことにより、システムのデフォルトの言語を検出できるようになり、またサポート技術情報とサービス パックを基に、より良いインベントリ管理もお客様に提供できるようになります。この新しい更新プログラムには、プログラム自体の変更は含まれておりませんが、マイクロソフトは、Windows 2000 ユーザーに、新しいバージョンの更新プログラムを適用し、新しいツールがシステムにインストールされたことを確認することを推奨します。
2000 年 3 月 31 日にマイクロソフトは、この更新プログラムの Windows NT 4.0 バージョンを再リリースし、その際確認された脆弱性の新種についてお知らせしました。この新種の脆弱性の影響を受けるのは Windows NT 4.0 の更新プログラムのみです。

**影響を受けるソフトウエア バージョン :**

-   Microsoft Index Server 2.0
-   Windows 2000 の Indexing Service

### 詳細

問題
----

<span></span>
この更新プログラムでは、2 つの脆弱性が排除されますが、それらの唯一の共通点は、Index Server で発生するということです。1 つ目は、「Hit-Highlighting 引数の形式不良」の脆弱性です。hit-highlighting ("WebHits" としても知られています) 機能を実装する ISAPI アプリケーションは、どのファイルを要求できるかを制限しません。故意に形式不良にされた引数を、ドキュメントを hit-highlight するための要求に使用することにより、仮想ディレクトリを超えたアクセスを行うことが可能となります。これにより、サーバー自体、または Web ルート ディレクトリと同じ論理ドライブ上に常駐しているファイルが、アクセス権にかかわらず取得できてしまう恐れがあります。この脆弱性の新種の存在は、2000 年 3 月 31 日に発表されました。この新種の脆弱性によって、.ASP ファイルなどのサーバー側ファイルのソースが読み取られる可能性があります。この新種の脆弱性は、Index Server 2.0 のみに影響を与えます。元の更新プログラムを適用されたWindows 2000 ユーザー はこの新種の脆弱性による危険性は全くありません。
2 つ目の脆弱性には、存在しない Internet Data Query ファイルをユーザーが要求した場合に返されるエラー メッセージが関連します。このエラー メッセージでは、要求に含まれていた Web ディレクトリに対する物理的パスが示されます。この脆弱性では、悪質なユーザーがデータを改ざんしたり表示したりすることが可能になる恐れはありませんが、これは Web サーバーのファイル構造をマップするための調査ツールになり得ます 。この脆弱性の新種の存在が2000 年 2 月 4 日に発表されました。この新種の脆弱性によって、悪意のあるユーザーはファイルを読み取ることができます。この新種の脆弱性は元の更新プログラムで排除され、この更新プログラムの元のバージョンを適用されたお客様はこの脆弱性による危険性は全くありません。
Windows 2000 の Indexing Services は、「Hit-Highlighting 引数の形式不良」の脆弱性の影響のみを受け、2 つ目の脆弱性による影響はありません。また、Windows 2000 の Indexing Services はデフォルトでインストールされますが、管理者が明示的に設定しない限り起動しません。

よく寄せられる質問
------------------

<span></span>
**マイクロソフトセキュリティ情報** **MS00-006** **はどのような内容の通知ですか?**

このマイクロソフト セキュリティ情報 MS00-006 は、Microsoft® Index Server のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことをお客様にお知らせするものです。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**このセキュリティ情報が再びリリースされたのはなぜですか?**

このセキュリティ情報は脆弱性の 1 つに新種が発生し、更新プログラムの新バージョンを適用する必要があることをWindows NT 4.0 ユーザーお知らせするために 2000 年 3 月 31 日に 再リリースされました。新種の脆弱性は Windows 2000 の Indexing Services には影響を与えないので、Windows 2000 システムに更新プログラムを適用されたユーザーは何の対策も講ずる必要がありません。

**この脆弱性はどれくらいの範囲に影響を与えますか?**

最初の脆弱性を利用すると、悪意のあるユーザーが Web サーバー上のファイルを表示できる可能性があります。ファイルの変更、削除、追加はできません。この脆弱性は Web サーバーとサーバーのルート ディレクトリと同じ論理ドライブ上にあるファイルのみに影響を与えます。例えばリモート データベース サーバーなどの Web サイトのリモート サーバーにあるファイルは この脆弱性による危険性はありません。
2 番目の脆弱性はサーバーの Web ディレクトリの物理的な場所を明らかにする可能性があります。それにより悪意のあるユーザーがサーバー上のファイルを読み取り、作成、変更、削除することはできません。しかし、それは偵察ツールとしては役に立つ恐れがあります。例えば、悪意のあるユーザーはサーバー上の興味のあるファイルの場所を決め、次にそれを取得するのに上記の脆弱性を利用する可能性があります。

**これらの脆弱性の共通点は何ですか?**

これらの脆弱性は、両方ともIndex Server で発生するという点以外には関連性はありません。お客様の利便性のためにこれらを同じ更新プログラムにまとめてあります。

**Index Server** **とは何ですか?**

Index Server は Internet Information Server と Windows NT と一体化した検索エンジンです。Index Server を使用するとユーザーは、ブラウザを使用してオンライン サイトをフル テキストで検索することができます。他の多くの検索エンジンとは異なり、Index Server は Word、 Excel そしてPowerPoint の文書がHTML 文書と同様に検索することができます。
Index Server の 2 つのバージョンはこれらの脆弱性の影響を受けます。Index Server 2.0 は Windows NT 4.0 オプション パックの 1 部として出荷されているスタンドアロン サーバー製品です。Windows 2000 では、Index Server は Indexing Services として知られるシステム サービスとして組み込まれています。簡潔にするために、このセキュリティ情報ではこの製品を Index Server と呼んでいます。

**Index Server** **はデフォルトでインストールされ、動作しますか?**

いいえ、Windows NT 4.0 では Index Server は Windows NT 4.0 オプション パックの 1 部として供給されています。Index Server がインストールされていても Index Server を使用できるようにきちんと設定しなければ動作しません。Windows 2000 では、Indexing Services がデフォルトでインストールされますが、管理者が明確に開始する操作をしなければサービスは開始しません。

**これらの脆弱性はどんなものですか?**

1 つ目の脆弱性は 「Hit-Highlighting 引数の形式不良」 の脆弱性です。2 つ目には不適切な情報が含まれた間違いのメッセージが 1 個所含まれるだけなので名前はありません。

**Windows 2000** **の** **Indexing Service** **は両方の脆弱性の影響を受けますか?**

いいえ。Windows 2000 の Indexing Services は 「Hit-Highlighting 引数の形式不良」 の脆弱性の影響のみを受けます。2 つ目の脆弱性は Windows NT 4.0 の Index Server のみに影響を及ぼします。

**「Hit-Highlighting** **引数の形式不良」の脆弱性とは何ですか?** **またなぜ発生しますか?**

この脆弱性は Index Server の "Hit-Highlighting" 機能 ("Webhits" 機能としても知られる) が、ユーザーのできる要求を正しく制約しないために発生します。ある特定の種類の不正な要求が出された場合、管理者が設定したアクセス権に関わらずサーバー上のファイルを取得します。取得できるファイルの種類にはいくつかの制約があり、下記に詳細が説明されています。

**"Hit-Highlighting"** **機能とは何ですか?**

Index Server で書類を検索する際、Hit-Highlighting 機能が問い合わせを満たす文書の該当の部分を表示します。Hit-Highlighting 機能はヒットした部分がハイライトされた語句を含むマッチしたもののリストが載った HTML ページを作成します。それぞれのヒットは文書中のその言葉の周辺の語句を含むテキストと一緒に表示されます。また、Index Server を使用すると、ヒットした文書のそれぞれにその文書のフルテキストへのリンクが表示されます。

**Hit-Highlighting** **機能の何が問題になっていますか?**

設計上はHit-highlighting 機能によりユーザーは文書の名前を指定し、ヒットした部分をハイライトさせることができます。ユーザーはサーバーの仮想ディレクトリ、例えばwww.microsoft.com/security/document.doc 内の文書を要求のみができます。しかし、ある特定の種類の不正引数が供給された場合、例えば c:\\folder\\document.doc のドライブの物理的な場所でのファイルの要求に使用される可能性があります。

**なぜセキュリティ上の問題なのですか?**

Web サイトに訪問者は Web サーバー上の全てのファイルを表示できるわけではありません。例えば、システム構成ファイル、使用ログ他のファイルはサーバー管理者によってのみ表示できるように設定する必要があります。仮想ディレクトリの目的の 1 つに訪問者のために意図されたものとそうでないものをはっきりと分けることにあります。ユーザーが仮想ディレクトリの外にあるファイルを検索できるようにすると、この脆弱性によって悪意のあるユーザーが、単にファイルを表示する方法としてサーバー上にあるファイルを検索する偽の要求を出すことが可能になります。

**表示できるファイルには何らかの制限がありますか?**

はい、この脆弱性によって表示できるファイルの種類には 2 つの重要な制限があります。

-   サーバー自体にあるファイルのみが表示できます。例えば、Web サーバーがデータベース サーバーとの組み合わせで動作している場合、この脆弱性を利用しても悪意のあるユーザーはデータベース サーバーからのファイルを要求できません。
-   Web ルート ディレクトリと同じ理論ドライブ上のファイルのみが表示できます。例えば、Web サーバーのハード ドライブが C: ドライブと D: ドライブに分割され、サーバーの仮想ルートが D: ドライブにおかれている場合、この脆弱性によって取得できるファイルは D: ドライブのファイルのみです。

**この脆弱性によってファイルが変更できますか?**

いいえ、変更できません。ファイルの読み取りはできますが、変更することはできません。同じように、ファイルはサーバーから削除することもサーバーに追加することもできません。

**この脆弱性は偶発的に発生しますか?**

いいえ。ここで問題になっている不良形式の引数を偶発的に入力してしまう可能性はきわめて低いといえます。

**2000年** **3** **月** **31** **日に公表されたこの脆弱性の新種とは何ですか?**

元の更新プログラムをリリースした後で Windows NT 4.0 のみに影響を与えるこの脆弱性の新種があるということがわかりました。この新種によって悪意のあるユーザーは、更新プログラムの元のバージョンを適用した後でもある種類のファイルを読み取りつづける恐れがあります。具体的には、悪意のあるユーザーがサーバー側の Web ファイルを Hit-highlighting する文書として指定できるようになります。これにより悪意のあるユーザーがそのようなファイルのソース コードを表示できるようになります。

**サーバー側のファイルとは何ですか?** **またサーバー側のファイルのソースコードを表示できるのはなぜセキュリティ上の脆弱性なのですか?**

“サーバー側の” ファイルはサーバー上で処理され、ユーザーには送られることがないファイルのことです。例としては .ASP ファイルがあります。. ASP ファイルはユーザーに送られる Web ページを生成するのに使用され、そのファイル自体は送られることがないファイルです。
サーバー側のファイルを読み込んでしまうのはセキュリティ上の脆弱性です。なぜならWeb 開発者は時々サーバー側のファイルに機密情報を含むことがあるからです。しかし、推奨されるセキュリティ最善策で防ぐことができます。このご案内に従えばサーバー側のファイルに機密情報を含むこともなく、侵害されることもありません。

**この更新プログラムに説明がある** **2** **番目の脆弱性はどんなものですか?** **またなぜ発生するのですか?**

2 番目の脆弱性は実在しない Internet Data Query ファイルが要求されたときに Index Server が返す障害のあるエラー メッセージが原因で発生します。エラー メッセージは、要求されたのと同じ条件で要求されたファイルを参照する必要があります。例えば、ユーザーが www.microsoft.com/xyz/query.idq を要求した場合、エラー メッセージは www.microsoft.com/xyz/query.idq not found と返す必要があります。その代わり、例えば"c:\\webroot\\xyz\\query.idq not found" のように、そのファイルの物理的な位置を参照します。これにより要求者が "xyz" 仮想ディレクトリがc:\\webroot\\xyz にマップしていると推測できます。

**この脆弱性はWindows 2000** **の** **Indexing Service** **に影響を及ぼしますか?**

いいえ、この脆弱性が影響を及ぼすのは Windows NT 4.0 の Index Server のみです。

**Internet Data Query** **ファイルとは何ですか?**

Internet Data Query (.IDQ) は Index Server での検索のクエリー パラメータを定義し、検索範囲、検索制限、クエリー結果設定などの情報を含むことができます。通常 .IDQ ファイルを含む検索は他の 2 つのファイルを含みます。1 つはクエリーを作成する .htm ファイル、もう 1 つは、検索結果をフォーマットする .htx ファイルです。

**これはなぜセキュリティ上の脆弱性なのですか?**

それ自体ではセキュリティ上の脆弱性ではありません。この脆弱性によって悪意のあるユーザーがデータを変更したり、マシン上の制御を奪ったりできるようになるわけではありません。しかし、この脆弱性を利用するとサーバー上の興味深いファイルの場所を知りたがっている悪意のあるユーザーにとっては有益な偵察ツールとなってしまいます。例えば、悪意のあるユーザーはこの脆弱性をまず利用してサーバー上の .ASP ページが格納されている場所を知り、次に “Hit-Highlighting の引数の形式不良” の脆弱性を利用してそのページのソース コードを取得する可能性があります。

**この脆弱性は偶発的に発生しますか?**

はい、発生します。存在しない Internet Data Query ファイルをユーザーが要求したときは常に、ここで間違いのエラー メッセージが作成されます。これはタイプミスや他のミスから発生します。しかし、存在しない .IDQ ファイルを繰り返し要求があるということは、悪意のあるユーザーがサーバーをマップするために仮想ディレクトリ名を意図的に試していることを示します。

**2000** **年** **2** **月** **4** **日に公表されたこの脆弱性の新種とはどんなものですか?**

このセキュリティ情報と更新プログラムを最初にリリースしたすぐ後に、この脆弱性の新種の存在が報告されました。元のバージョンの更新プログラムでこの新種も排除するので、元のバージョンの更新プログラムを適用されたお客様は新しい更新プログラムを適用する必要はありません。
新種の脆弱性を利用するとサーバーからファイルを読み取る別の方法が得られます。IDQ ファイルは常に検索結果をフォーマットするのに使用される .HTXを指定します。しかし、ある特定の状況下では任意のファイルを要求することが可能でした。 “Hit-Highlighting 引数の不良方式” の脆弱性の場合、サーバー上、またWeb ルートと同じ論理ドライブ上でのファイルのみを読み込むことが可能になります。ファイルを変更することはできません。

**新種の脆弱性は** **Windows 2000** **の** **Indexing Services** **に影響を及ぼしますか?**

いいえ、及ぼしません。

**新種の脆弱性に関してなにか他の対策が必要ですか?**

はい、必要です。この更新プログラムは Index Server の脆弱性を排除しますが、この脆弱性には何も対策をとる必要のない別の側面も存在します。Web サイト開発者が .IDQ ファイルを作成し.HTX ファイルのみが出力をフォーマットするのに選択されるようにユーザーの入力を制限しない場合、ユーザーは必要なファイルは全て出力フォーマッタとして指定し、ファイルを読み取ることができるようになります。特に、Index Server に含まれているサンプル ファイルの 1 つの prxrch.idq, はユーザーの入力を適切に制限しません。これは製品サーバー上に、全てのサンプル ファイルと同様にこのファイルは存在すべきでないものです。

**私は** **Windows NT 4.0** **上で** **Web** **サイトをホストしており、Index Server 2.0** **を使用して検索サービスを提供しています。この更新プログラムを適用する必要がありますか?**

はい、あります。

**私は** **Windows 2000** **上で** **Web** **サイトをホストしており、Indexing Services** **を使用して検索サービスを提供しています。この更新プログラムを適用する必要がありますか?**

はい、あります。

**私は** **Web** **サイトをホストしていますが、検索サービスを供給していません。この更新プログラムを適用する必要がありますか?**

以下の ２ つの方法をとることができます。

-   更新プログラムを適用できます。適用のメリットは、将来あなたの Web サイトで検索サービスを供給することにした場合、この脆弱性の影響から保護されます。
-   該当のファイルの種類をマップしているスクリプトを削除することができます。Internet Service Manager では、 .HTW、 .IDQ、.IDA ファイルをマップしているスクリプトを削除します。そうすることにより、この脆弱性の影響を受けるコンポーネントのいずれかが呼び出されるのを防ぎます。

**更新プログラムは何を変更しますか?**

この更新プログラムは 特定の不良形式の引数が処理されるのを防いで 「Hit-Highlighting 引数の不良形式」 の脆弱性を排除します。要求されたファイルを物理的な位置よりも仮想ディレクトリの観点から参照するようにエラー メッセージを変更し、2 つ目の脆弱性が発生するのを防ぎます。

**どこから更新プログラムを入手できますか?**

マイクロソフト セキュリティ情報 MS00-006 をご覧ください。

**この更新プログラムの新しいリリースがいくつかあります。再度適用する必要があるかはどのようにしたらわかりますか?**

Windows 2000 ユーザー

-   更新プログラムの元のバージョンを適用した場合、新しいバージョンを適用する必要ありません。元のバージョンはこの脆弱性の考えられるあらゆる新種を排除します。
-   2000 年 2 月 11 日にリリースされた更新プログラムをインストールするよう選択し、新しいWindows 2000 hotfix ツールをインストールすることもできます。

Windows NT 4.0 ユーザー

-   更新プログラムの元のバージョンを適用した場合、2000 年 3 月 31 日にリリースされた新しいバージョンを提供する必要があります。そのバージョンを適用すると、この脆弱性の考えられる新種を排除します。

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 [MS00-007](http://technet.microsoft.com/security/bulletin/ms00-007) と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](http://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトは、[251170](http://support.microsoft.com/kb/251170) と [252463](http://support.microsoft.com/kb/252463) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](http://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカルサポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](http://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

<span></span>
この問題を解決するための更新プログラムは、以下のサイトからダウンロードできます。

-   Windows 2000 :
    この問題に対する修正は Windows 2000 Service Pack 1 以降に含まれております。
    個別の更新プログラムよりも Service Pack を適用することをお勧めします。
    最新の Windows 2000 Service Pack については次のリンクから入手してください。
    <http://www.microsoft.com/japan/windows2000/downloads/>
-   Windodws NT 4.0 :
    この問題に対する更新プログラムは Windows NT 4.0 のセキュリティ ロールアップ パッケージ (SRP) に含まれています。
    個別の更新プログラムよりもセキュリティ ロールアップ パッケージを適用することをお勧めします。
    NT4.0 のセキュリティ ロールアップ パッケージは次のリンクから入手してください。

    [299444](http://support.microsoft.com/kb/299444) Post Windows NT 4.0 SP6a セキュリティ ロールアップ パッケージ (SRP)

    なお、個別の更新プログラムは次のリンクから入手することができます。

    -   PC/AT 互換機用 :
        [http://www.microsoft.com/downloads/details.aspx?FamilyId=87bce044-43fd-470e-8cac-c2b51bec872a&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=87bce044-43fd-470e-8cac-c2b51bec872a&displaylang=ja)
    -   NEC PC-9800 シリーズ用 :
        [http://download.microsoft.com/download/winntsp/Patch/MHH/NT4/JA/Q252463n.exe](http://download.microsoft.com/download/winntsp/patch/mhh/nt4/ja/q252463n.exe)
    -   Alpha 用 :
        [http://www.microsoft.com/downloads/details.aspx?FamilyId=EB8CFE7D-8959-41A8-9F45-1B0F70E256C9&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=eb8cfe7d-8959-41a8-9f45-1b0f70e256c9&displaylang=ja)

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS00-006）
    [http://www.microsoft.com/technet/security/bulletin/ms00-006.mspx](http://technet.microsoft.com/security/bulletin/ms00-006)
-   サポート技術情報 （KB） 文書番号 ： 251170
    [\[IIS\] Hit-Highlighting 引数の不正利用](http://support.microsoft.com/kb/251170)
-   サポート技術情報 （KB） 文書番号 ： 252463
    [Index Server のエラー メッセージから Web フォルダの物理位置が暴露される](http://support.microsoft.com/kb/252463)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
